﻿function _onError(e,t,r,n,s){if(!t&&$app&&!$app._startScript)return!1;if(t.startsWith&&t.startsWith("moz-"))return!1;var i=$common.getHostUrl();if(t.startsWith&&t.startsWith("http")&&!t.startsWith(i))return!1;if(t&&s&&navigator.userAgent.indexOf("QQBrowser")>1){if(s.toString().indexOf("getBoundingClientRect")>-1)return!0}var o=window._lastError;return handleError(o,e,t,r,_onError,s,!0),window._lastError=null,!!o}function _Z_242$_setProperties(e,t){var r,n=Object.getType(e),s=n===Object||n===Sys.UI.DomElement,i=_Z_242.isInstanceOfType(e)&&!e.get_isUpdating();i&&e.beginUpdate();for(var o in t){var a=t[o],l=s?null:e["get_"+o];if(s||"function"!=typeof l){var c=e[o];if(!s&&void 0===c)throw Error.invalidOperation(String.format(Sys.Res.propertyUndefined,o));!a||"object"!=typeof a||s&&!c?e[o]=a:_Z_242$_setProperties(c,a)}else{var d=e["set_"+o];if("function"==typeof d)d.apply(e,[a]);else if(a instanceof Array){if(!((r=l.apply(e))instanceof Array))throw new Error.invalidOperation(String.format(Sys.Res.propertyNotAnArray,o));for(var h=0,u=r.length,y=a.length;h<y;h++,u++)r[u]=a[h]}else{if("object"!=typeof a||Object.getType(a)!==Object)throw new Error.invalidOperation(String.format(Sys.Res.propertyNotWritable,o));if(void 0===(r=l.apply(e))||null===r)throw new Error.invalidOperation(String.format(Sys.Res.propertyNullOrUndefined,o));_Z_242$_setProperties(r,a)}}}i&&e.endUpdate()}function evil(e){return new Function(e)()}function evil2(e){return new Function("return "+e)()}var $settings={__notInited:!0,DisabledFetch:!1,FormOverlayOpacity:50,GridRowNoColumnCaption:"行号",CancelButtonText:"取消",OkButtonText:"确定",CloseButtonText:"关闭",SplitterText:"信息",StaticVersionName:"_v_",ImageColumnPreivew:"none",UsePrintButton:!1,ShowExportButton:!0,DecimalPrecision:14,DecimalScale:4,DateYearMinValue:1900,DateYearMaxValue:3900,VSplitterMinWidth:100,HSplitterMinHeight:100,GridDefaultRowHeight:30,DefaultItemHeight:30,DefaultGridSpace:8,FlowItemMarginRight:8,PagerNumericButtonCount:10,DefaultDropDownRows:10,GridPagerDefaultMaxPageSize:100,GridColumnDefaultHeaderAlignCache:0,GridPagerDefaultShowRefreshButton:!1,GridDefaultAutoPagerPageSize:!1,DisplayEmptyForZero:!1,FormShowMaxButton:!0,GridPagerDefaultShowGotoButton:!1,GridDefaultAllowFilter:!1,GridDefaultRowNoMaxWidth:0,TreeGridLazyPageSize:0,GridLazyPageSize:0,FrozenTabMaxCount:5,MaxRecordCountToCloseFrozen:1e3,StepOpacity:50,FiscalColumnCellWidth:15,StepSaveClient:!0,UseBigNumber:!1,GridDefaultShowLines:!0,MaxMDIPageCount:50,PrintAllFields:!1,LayoutMaxLevel:3,AllPrintUseService:!0,AllPrintUseWebTool:!1,CloudPrintAppName:"",HideAccessCode:!1,GridUseColumnsDisplayOrder:!0,DefaultMDIShowNavButtons:!0,EnableGlobalTitle:!0,DefaultUseEscClose:!0,DefaultMDIMouseWheel:!0,DefaultMDITabContextMenu:!0,DefaultMDIContextMenu:!1,DefaultAllowSaveFormSize:!0,DefaultAllowClearIcon:!1,DefaultUseClientSize:!1,DefaultAllowResizeMDI:!0,DefaultAllowResizeForm:!0,DefaultShowExceptionNo:!1,GridDefaultAllowPopup:!1,GridDefaultAllowFrozen:!1,DisplayThousandSeperator:!1,EnableDebugJson:!1,EnableSaveClientLog:!1,GridDefaultWordWrap:!1,UseCustomScrollBar:!1,IsCallbackOnDispose:!0,DefaultAllowBrowserPassword:!0,EnableGlobalUIConfig:!0,NumberEditDefaultCalculate:!1,NumberEditUseSpace:!0,NumberColumnFormatNumber:!0,GridDefaultShowEditor:!0,SwitchButtonCheckedValue:!0,GridDefaultScrollUsePageSize:!1,GridDefaultChangePageByRecord:!1,DefaultCheckBrowser:!0,DefaultUsePrintPopup:!0,GridDefaultReportRowNo:!0,GridDefaultOnTabNext:!1,DefaultTipsTimer:4,DisplayZeroToDigits:!1,UserHashID:"",DefaultEnableStep:!0,WaitingTimerValue:500,PageWaitingTimerValue:100,DefaultMDITabIcon:"aicon-wendang5",GridPagerPageSizeItems:"5,10,15,20,25,50,100",PrintDefaultDisabledPDF:!1,PrintDefaultUsePDF:!1,PrintDefaultCreateReport:!0,PrintExportAPI:"_Sys/UI/Report/Export.gspx",PrintMustNewClient:!1,ReportConfig:{PrintMode:0,TeemoJsUrl:"",MustNewClient:!1},TreeToolBarItems:[{icon:"aicon-add",type:"add",hint:"点击添加"},{icon:"aicon-bianji11",type:"modify",hint:"点击修改"},{icon:"aicon-shanchu",type:"delete",hint:"点击删除"},{icon:"aicon-drag",type:"drag",hint:"点击启用或关闭拖动"}]};window.XMLHttpRequest||(window.XMLHttpRequest=function(){for(var e=["Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP"],t=0,r=e.length;t<r;t++)try{return new ActiveXObject(e[t])}catch(n){}return null}),window.hasScrollbar=function(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)},window._px=function(e){return Object.isUndefinedOrNull(e)?"":e+"px"},window.getClientBounds=function(e){var t,r;return Sys.Browser.isIE?document.documentElement&&document.documentElement.clientHeight?(t=document.documentElement.clientWidth,r=document.documentElement.clientHeight):self.innerHeight?(t=self.innerWidth,r=self.innerHeight):document.body&&(t=document.body.clientWidth,r=document.body.clientHeight):self.innerHeight?(t=self.innerWidth,r=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(t=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(t=document.body.clientWidth,r=document.body.clientHeight),!e&&window.hasScrollbar()&&(t=Sys.Browser.isIE?t-18:t-10),new _Z_217(0,0,t,r)},window.getClientScrollPosition=function(){var e=0;e=document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft;var t=0;return t=document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,{x:e,y:t}},window.setClientScrollPosition=function(e,t){document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft=e:document.body.scrollLeft=e,document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop=t:document.body.scrollTop=t},window.$getRootURI=function(){var e=window.__rootURI;return e||"/"},window.asyncCall=function(e){return window.setTimeout(e,0)};var __pathMapName=null;window.console=window.console||function(){var e={};return e.log=e.warn=e.debug=e.info=e.error=e.time=e.dir=e.profile=e.clear=e.exception=e.trace=e.assert=function(){},e}(),Error.__typeName="Error",Error.__class=!0,Error.create=function(e,t){var r=new Error(e);if(r.message=e,r.ErrorMessage=t?t.message:e,r.description==r.message&&delete r.description,t)for(var n in t)r[n]=t[n];return r.innerException=t,r.popStackFrame(),window._lastError=r,r},Error.argument=function(e,t){var r=t||Sys.Res.argument,n=Error.create(r,{name:"Sys.ArgumentException",paramName:e});return n.popStackFrame(),n},Error.argumentNull=function(e,t){var r="Sys.ArgumentNullException: "+(t||Sys.Res.argumentNull),n=Error.create(r,{name:"Sys.ArgumentNullException",paramName:e});return n.popStackFrame(),n},Error.argumentOutOfRange=function(e,t,r){var n=r||Sys.Res.argumentOutOfRange,s=Error.create(n,{name:"Sys.ArgumentOutOfRangeException",paramName:e,actualValue:t});return s.popStackFrame(),s},Error.argumentType=function(e,t,r,n){var s="Sys.ArgumentTypeException: ";s+=n||(t&&r?String.format(Sys.Res.argumentTypeWithTypes,t.getName(),r.getName()):Sys.Res.argumentType),e&&(s+="\n"+String.format(Sys.Res.paramName,e));var i=Error.create(s,{name:"Sys.ArgumentTypeException",paramName:e,actualType:t,expectedType:r});return i.popStackFrame(),i},Error.argumentUndefined=function(e,t){var r="Sys.ArgumentUndefinedException: "+(t||Sys.Res.argumentUndefined);e&&(r+="\n"+String.format(Sys.Res.paramName,e));var n=Error.create(r,{name:"Sys.ArgumentUndefinedException",paramName:e});return n.popStackFrame(),n},Error.parameterCount=function(e){var t="Sys.ParameterCountException: "+(e||Sys.Res.parameterCount),r=Error.create(t,{name:"Sys.ParameterCountException"});return r.popStackFrame(),r},Error.format=function(e){var t="Sys.FormatException: "+(e||Sys.Res.format),r=Error.create(t,{name:"Sys.FormatException"});return r.popStackFrame(),r},Error.invalidOperation=function(e){var t=e||Sys.Res.invalidOperation,r=Error.create(t,{name:"Sys.InvalidOperationException"});return r.popStackFrame(),r},Error.notImplemented=function(e){t=Function._validateParams(arguments,[{name:"message",type:String,mayBeNull:!0,optional:!0}]);if(t)throw t;var t,r="Sys.NotImplementedException: "+(e||Sys.Res.notImplemented);return(t=Error.create(r,{name:"Sys.NotImplementedException"})).popStackFrame(),t},Error.message=function(e){var t=Error.create(e,{showMessage:!0});return t.popStackFrame(),t},Error.abort=function(e,t){e&&$msg.alert(e,t);var r=Error.create(null,{isAbort:!0});return r.popStackFrame(),r},Error.prototype.popStackFrame=function(){if("undefined"!=typeof this.stack&&null!==this.stack&&"undefined"!=typeof this.fileName&&null!==this.fileName&&"undefined"!=typeof this.lineNumber&&null!==this.lineNumber){for(var e=this.stack.split("\n"),t=e[0],r=this.fileName+":"+this.lineNumber;void 0!==t&&null!==t&&-1===t.indexOf(r);)e.shift(),t=e[0];var n=e[1];if(void 0!==n&&null!==n){var s=n.match(/@(.*):(\d+)$/);void 0!==s&&null!==s&&(this.fileName=s[1],this.lineNumber=parseInt(s[2]),e.shift(),this.stack=e.join("\n"))}}},Function.__typeName="Function",Function.__class=!0,Function.emptyFunction=Function.emptyMethod=function(){},Function.createCallback=function(e,t){return function(){var r=arguments.length;if(r>0){for(var n=[],s=0;s<r;s++)n[s]=arguments[s];return n[r]=t,e.apply(this,n)}return e.call(this,t)}};var $createDelegate=Function.createDelegate=function(e,t){if("string"==typeof t){var r=t;if(!(t=e[r]))throw Error.invalidOperation("事件代码 "+r+" 不能为空，类名 "+Object.getTypeName(e));if("function"!=typeof t)throw Error.invalidOperation("事件代码 "+r+" 不能是属性，必须是函数，类名 "+Object.getTypeName(e))}return function(){try{return t.apply(e,arguments)}catch(r){if(handleError(r),r.isAbort)throw r}}};Function._validateParams=function(e,t){var r=Function._validateParameterCount(e,t);if(r)return r.popStackFrame(),r;for(var n=0;n<e.length;n++){var s=t[Math.min(n,t.length-1)],i=s.name;if(s.parameterArray&&(i+="["+(n-t.length+1)+"]"),r=Function._validateParameter(e[n],s,i))return r.popStackFrame(),r}return null},Function._validateParameterCount=function(e,t){for(var r=t.length,n=0,s=0;s<t.length;s++)t[s].parameterArray?r=Number.MAX_VALUE:t[s].optional||n++;if(e.length<n||e.length>r){var i=Error.parameterCount();return i.popStackFrame(),i}return null},Function._validateParameter=function(e,t,r){var n=t.type,s=!!t.integer,i=!!t.domElement,o=!!t.mayBeNull,a=Function._validateParameterType(e,n,s,i,o,r);if(a)return a.popStackFrame(),a;var l=t.elementType,c=!!t.elementMayBeNull;if(n===Array&&void 0!==e&&null!==e&&(l||!c))for(var d=!!t.elementInteger,h=!!t.elementDomElement,u=0;u<e.length;u++){var y=e[u];if(a=Function._validateParameterType(y,l,d,h,c,r+"["+u+"]"))return a.popStackFrame(),a}return null},Function._validateParameterType=function(e,t,r,n,s,i){var o;if(void 0===e)return s?null:((o=Error.argumentUndefined(i)).popStackFrame(),o);if(null===e)return s?null:((o=Error.argumentNull(i)).popStackFrame(),o);if(t&&t.__enum){if("number"!=typeof e)return(o=Error.argumentType(i,Object.getType(e),t)).popStackFrame(),o;if(e%1==0){var a=t.prototype;if(t.__flags&&0!==e){var l=e;for(var c in a){var d=a[c];if(0!==d&&((d&e)===d&&(l-=d),0===l))return null}}else for(var c in a)if(a[c]===e)return null}return(o=Error.argumentOutOfRange(i,e,String.format(Sys.Res.enumInvalidValue,e,t.getName()))).popStackFrame(),o}if(n){var h;if("number"!=typeof e.nodeType){var u=e.ownerDocument||e.document||e;if(u!=e){var y=u.defaultView||u.parentWindow;h=y!=e&&!(y.document&&e.document&&y.document===e.document)}else h="undefined"==typeof u.body}else h=3===e.nodeType;if(h)return(o=Error.argument(i,Sys.Res.argumentDomElement)).popStackFrame(),o}return t&&!t.isInstanceOfType(e)?((o=Error.argumentType(i,Object.getType(e),t)).popStackFrame(),o):t===Number&&r&&e%1!=0?((o=Error.argumentOutOfRange(i,e,Sys.Res.argumentInteger)).popStackFrame(),o):null},window||(this.window=this),window.Type=Function,Type.__fullyQualifiedIdentifierRegExp=new RegExp("^[^.0-9 \\s|,;:&*=+\\-()\\[\\]{}^%#@!~\\n\\r\\t\\f\\\\]([^ \\s|,;:&*=+\\-()\\[\\]{}^%#@!~\\n\\r\\t\\f\\\\]*[^. \\s|,;:&*=+\\-()\\[\\]{}^%#@!~\\n\\r\\t\\f\\\\])?$","i"),Type.__identifierRegExp=new RegExp("^[^.0-9 \\s|,;:&*=+\\-()\\[\\]{}^%#@!~\\n\\r\\t\\f\\\\][^. \\s|,;:&*=+\\-()\\[\\]{}^%#@!~\\n\\r\\t\\f\\\\]*$","i"),Type.parse=function(e,t){var r;if(t)return(r=Sys.__upperCaseTypes[t.getName().toUpperCase()+"."+e.toUpperCase()])||null;if(!e)return null;if(Type.__htClasses||(Type.__htClasses={}),!(r=Type.__htClasses[e])){if("function"!=typeof(r=evil2(e)))throw Error.argument("typeName",Sys.Res.notATypeName);Type.__htClasses[e]=r}return r},Type.getRootNamespaces=function(){return Array.clone(Sys.__rootNamespaces)},Type.registerNamespace=function(e){if(!Type.__fullyQualifiedIdentifierRegExp.test(e))throw Error.argument("namespacePath",Sys.Res.invalidNameSpace);for(var t=window,r=e.split("."),n=0;n<r.length;n++){var s=r[n],i=t[s];if(i&&!i.__namespace)throw Error.invalidOperation(String.format(Sys.Res.namespaceContainsObject,r.splice(0,n+1).join(".")));if(!i){i=t[s]={__namespace:!0,__typeName:r.slice(0,n+1).join(".")},0===n&&(Sys.__rootNamespaces[Sys.__rootNamespaces.length]=i);var o;try{o=evil2(i.__typeName)}catch(a){o=null}if(o!==i)throw delete t[s],Error.argument("namespacePath",Sys.Res.invalidNameSpace);i.getName=function(){return this.__typeName}}t=i}},window.Sys={__namespace:!0,__typeName:"Sys",getName:function(){return"Sys"},__upperCaseTypes:{}},Sys.__rootNamespaces=[Sys],Sys.__registeredTypes={},Type.isInstanceOfPrimitiveType=function(e){var t=typeof e;return"string"==t||"number"==t||"boolean"==t||Date.isInstanceOfType(e)},Type.prototype.getName=function(){return"undefined"==typeof this.__typeName?"":this.__typeName},Type.prototype.registerClass=function(e,t,r){if(!Type.__fullyQualifiedIdentifierRegExp.test(e))throw Error.argument("typeName",Sys.Res.notATypeName);var n;try{n=evil2(e)}catch(c){throw Error.argument("typeName",c.message+Sys.Res.argumentTypeName)}if(n!==this)throw Error.argument("typeName",Sys.Res.badTypeName+e);if(arguments.length>1&&void 0===t)throw Error.argumentUndefined("baseType");if(t&&!t.__class)throw Error.argument("baseType",Sys.Res.baseNotAClass);if(this.prototype.constructor=this,this.__typeName=e,this.__class=!0,t&&(this.__baseType=t,this.__basePrototypePending=!0),Sys.__upperCaseTypes[e.toUpperCase()]=this,r){this.__interfaces=[],this.resolveInheritance();for(var s=2,i=arguments.length;s<i;s++){var o=arguments[s];if(!o.__interface)throw Error.argument("interfaceTypes["+(s-2)+"]",Sys.Res.notAnInterface);for(var a in o.prototype){var l=o.prototype[a];this.prototype[a]||(this.prototype[a]=l)}this.__interfaces.push(o)}}return Sys.__registeredTypes[e]=!0,this},Type.prototype.registerInterface=function(e){if(!Type.__fullyQualifiedIdentifierRegExp.test(e))throw Error.argument("typeName",Sys.Res.notATypeName);var t;try{t=evil2(e)}catch(r){throw Error.argument("typeName",Sys.Res.argumentTypeName)}if(t!==this)throw Error.argument("typeName",Sys.Res.badTypeName);return Sys.__upperCaseTypes[e.toUpperCase()]=this,this.prototype.constructor=this,this.__typeName=e,this.__interface=!0,Sys.__registeredTypes[e]=!0,this},Type.isNamespace=function(e){return void 0!==e&&null!==e&&!!e.__namespace},Type.isClass=function(e){return void 0!==e&&null!==e&&!!e.__class},Type.isInterface=function(e){return void 0!==e&&null!==e&&!!e.__interface},Type.prototype.isInstanceOfType=function(e){if(void 0===e||null===e)return!1;if(e instanceof this)return!0;var t=Object.getType(e);return!(t!==this)||t.inheritsFrom&&t.inheritsFrom(this)||t.implementsInterface&&t.implementsInterface(this)},Type.prototype.resolveInheritance=function(){if(this.__basePrototypePending){var e=this.__baseType;e.resolveInheritance();for(var t in e.prototype){var r=e.prototype[t];this.prototype[t]||(this.prototype[t]=r)}delete this.__basePrototypePending}},Type.prototype.inheritsFrom=function(e){this.resolveInheritance();for(var t=this.__baseType;t;){if(t===e)return!0;t=t.__baseType}return!1},Type.prototype.initializeBase=function(e,t){if(!this.isInstanceOfType(e))throw Error.argumentType("instance",Object.getType(e),this);return this.resolveInheritance(),this.__baseType&&(t?this.__baseType.apply(e,t):this.__baseType.apply(e)),e},Type.prototype.getBaseType=function(){return"undefined"==typeof this.__baseType?null:this.__baseType},Type.prototype.getBaseMethod=function(e,t){if(!this.isInstanceOfType(e))throw Error.argumentType("instance",Object.getType(e),this);var r=this.getBaseType();if(r){var n=r.prototype[t];return n instanceof Function?n:null}return null},Type.prototype.callBaseMethod=function(e,t,r){var n=this.getBaseMethod(e,t);if(!n)throw Error.invalidOperation(String.format(Sys.Res.methodNotFound,t));return r?n.apply(e,r):n.apply(e)},Type.prototype.getInterfaces=function(){for(var e=[],t=this;t;){var r=t.__interfaces;if(r)for(var n=0,s=r.length;n<s;n++){var i=r[n];Array.contains(e,i)||(e[e.length]=i)}t=t.__baseType}return e},Type.prototype.implementsInterface=function(e){this.resolveInheritance();var t=e.getName(),r=this.__interfaceCache;if(r){var n=r[t];if(void 0!==n)return n}else r=this.__interfaceCache={};for(var s=this;s;){var i=s.__interfaces;if(i&&-1!==Array.indexOf(i,e))return r[t]=!0;s=s.__baseType}return r[t]=!1},Type.prototype.isImplementedBy=function(e){if(void 0===e||null===e)return!1;var t=Object.getType(e);return!(!t.implementsInterface||!t.implementsInterface(this))},Type.prototype.registerEnum=function(e,t){if(!Type.__fullyQualifiedIdentifierRegExp.test(e))throw Error.argument("name",Sys.Res.notATypeName);var r;try{r=evil2(e)}catch(i){throw Error.argument("name",Sys.Res.argumentTypeName)}if(r!==this)throw Error.argument("name",Sys.Res.badTypeName);for(var n in this.prototype){var s=this.prototype[n];if(!Type.__identifierRegExp.test(n))throw Error.invalidOperation(String.format(Sys.Res.enumInvalidValueName,n));if("number"!=typeof s||s%1!=0)throw Error.invalidOperation(Sys.Res.enumValueNotInteger);if("undefined"!=typeof this[n])throw Error.invalidOperation(String.format(Sys.Res.enumReservedName,n))}Sys.__upperCaseTypes[e.toUpperCase()]=this;for(var n in this.prototype)this[n]=this.prototype[n];this.__typeName=e,this.parse=function(e,t){var r,n,s;if(t){if(!(r=this.__lowerCaseValues)){this.__lowerCaseValues=r={};var i=this.prototype;for(var o in i)r[o.toLowerCase()]=i[o]}}else r=this.prototype;if(this.__flags){for(var a=(t?e.toLowerCase():e).split(","),l=0,c=a.length-1;c>=0;c--){if("number"!=typeof(n=r[a[c].trim()]))throw Error.argument("value",String.format(Sys.Res.enumInvalidValue,e.split(",")[c].trim(),this.__typeName));l|=n}return l}if(s=t?e.toLowerCase():e,"number"!=typeof(n=r[s.trim()]))throw Error.argument("value",String.format(Sys.Res.enumInvalidValue,e,this.__typeName));return n},this.__string=this.toString(),this.toString=function(e){if(void 0===e||null===e)return this.__string;if("number"!=typeof e||e%1!=0)throw Error.argumentType("value",Object.getType(e),this);var t,r=this.prototype;if(this.__flags&&0!==e){var n=this.__sortedValues;if(!n){n=[];for(t in r)n[n.length]={key:t,value:r[t]};n.sort(function(e,t){return e.value-t.value}),this.__sortedValues=n}var s=[],i=e;for(t=n.length-1;t>=0;t--){var o=n[t],a=o.value;if(0!==a&&((a&e)===a&&(s[s.length]=o.key,0===(i-=a))))break}if(s.length&&0===i)return s.reverse().join(", ")}else for(t in r)if(r[t]===e)return t;throw Error.argumentOutOfRange("value",e,String.format(Sys.Res.enumInvalidValue,e,this.__typeName))},this.__flags=t,this.__enum=!0,Sys.__registeredTypes[e]=!0},Type.prototype.injectMembers=function(e){if(!e)throw Error.argumentNull("srcObj");if("object"!=typeof e)throw Error.invalidOperation("srcInstance 必须是对象类型，但现在是 "+typeof e);for(var t in e)this.prototype[t]=e[t]},Type.isEnum=function(e){return void 0!==e&&null!==e&&!!e.__enum},Type.isFlags=function(e){return void 0!==e&&null!==e&&!!e.__flags},Object.__typeName="Object",Object.__class=!0,Object.getType=function(e){var t=e.constructor;return t&&"function"==typeof t&&t.__typeName&&"Object"!==t.__typeName?t:Object},Object.getTypeName=function(e){return Object.getType(e).getName()},Object.isUndefined=function(e){return void 0===e},Object.isUndefinedOrNull=function(e){return void 0===e||null===e},Object.isEmpty=function(e){var t=Object.isUndefinedOrNull(e);if(!t)if(String.isInstanceOfType(e))t=0==e.trim().length;else if(String.isInstanceOfType(e)||Array.isInstanceOfType(e))t=0==e.length;else if("object"==typeof e){for(var r in e)return!1;t=!0}return t},Object.clone=function(e,t){if(e){var r=$crabaJSON.serialize(e,t);return $crabaJSON.deserialize(r,t===undefined||t)}return e},Object.copyTo=function(e,t,r){if(e&&t)for(var n in e)t[n]=e[n];if(t&&r)for(var n in t)Array.contains(r,n.toLowerCase())&&delete t[n];return t},Object.cloneTo=function(e,t){if(t)for(var r in t)delete t[r];else t={};if(e)for(var r in e)t[r]=e[r];else t=e},Object.isEqual=function(e,t,r){if(!e&&!t)return!0;if(!e||!t)return!1;if(r)return Array.forEach(r,function(r){if(e[r]!==t[r])return!1}),!0;for(var n in e)if(e[n]!==t[n])return!1;for(var n in t)if(e[n]!==t[n])return!1;return!0},String.__typeName="String",String.__class=!0,String.prototype.trim=function(e){if(null==e||""==e)return this.replace(/(^\s*)|(\s*$)/g,"");var t=new RegExp("^"+e+"*"),r=this.replace(t,"");t=new RegExp(e);for(var n=r.length;t.test(r.charAt(--n)););return r.slice(0,n+1)},String.prototype.trimStart=function(e){if(null==e||""==e)return this.replace(/^\s+/,"");var t=new RegExp("^"+e+"*");return this.replace(t,"")},String.prototype.trimEnd=String.prototype.trimEndChar=function(e){if(null==e||""==e)return this.replace(/\s+$/,"");for(var t=new RegExp(e),r=this.length;t.test(this.charAt(--r)););return this.slice(0,r+1)},String.prototype.padLeft=function(e,t){var r=this+"";return(e=e-r.length+1)<0?r:new Array(e).join(t,"")+r},String.prototype.padRight=function(e,t){var r=this+"";return(e=e-r.length+1)<0?r:r+new Array(e).join(t,"")},String.prototype.startsWith=function(e){return this.substr(0,e.length)===e},String.prototype.endsWith=function(e){return this.substr(this.length-e.length)===e},String.getByteLength=function(e){if(!e)return 0;for(var t=0,r=0,n=e.length;r<n;r++){t+=e.charCodeAt(r)>127?2:1}return t},String.format=function(e,t){return String._toFormattedString(!1,arguments)},String.localeFormat=function(e,t){return String._toFormattedString(!0,arguments)},String._toFormattedString=function(e,t){for(var r="",n=t[0],s=0;;){var i=n.indexOf("{",s),o=n.indexOf("}",s);if(i<0&&o<0){r+=n.slice(s);break}if(o>0&&(o<i||i<0)){if("}"!==n.charAt(o+1))throw Error.argument("format",Sys.Res.stringFormatBraceMismatch);r+=n.slice(s,o+1),s=o+2}else if(r+=n.slice(s,i),s=i+1,"{"!==n.charAt(s)){if(o<0)throw Error.argument("format",Sys.Res.stringFormatBraceMismatch);var a=n.substring(s,o),l=a.indexOf(":"),c=parseInt(l<0?a:a.substring(0,l),10)+1;if(isNaN(c))throw Error.argument("format",Sys.Res.stringFormatInvalid);var d=l<0?"":a.substring(l+1),h=t[c];void 0!==h&&null!==h||(h=""),h.toFormattedString?r+=h.toFormattedString(d):e&&h.localeFormat?r+=h.localeFormat(d):h.format?r+=h.format(d):r+=h.toString(),s=o+1}else r+="{",s++}return r},Number.__typeName="Number",Number.__class=!0,Number.parseLocale=function(e){return Number._parse(e,_Z_228.CurrentCulture)},Number.parseInvariant=function(e){return Number._parse(e,_Z_228.InvariantCulture)},Number.parse=function(e){return parseFloat(e)},Number._parse=function(e,t){if((e=e.trim()).match(/^[+-]?infinity$/i))return parseFloat(e);if(e.match(/^0x[a-f0-9]+$/i))return parseInt(e);var r=t.numberFormat,n=Number._parseNumberNegativePattern(e,r,r.NumberNegativePattern),s=n[0],i=n[1];""===s&&1!==r.NumberNegativePattern&&(s=(n=Number._parseNumberNegativePattern(e,r,1))[0],i=n[1]),""===s&&(s="+");var o,a,l=i.indexOf("e");l<0&&(l=i.indexOf("E")),l<0?(a=i,o=null):(a=i.substr(0,l),o=i.substr(l+1));var c,d,h=a.indexOf(r.NumberDecimalSeparator);h<0?(c=a,d=null):(c=a.substr(0,h),d=a.substr(h+r.NumberDecimalSeparator.length));var u=s+(c=c.split(r.NumberGroupSeparator).join(""));if(null!==d&&(u+="."+d),null!==o){var y=Number._parseNumberNegativePattern(o,r,1);""===y[0]&&(y[0]="+"),u+="e"+y[0]+y[1]}return u.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?parseFloat(u):Number.NaN},Number._parseNumberNegativePattern=function(e,t,r){var n=t.NegativeSign,s=t.PositiveSign;switch(r){case 4:n=" "+n,s=" "+s;case 3:if(e.endsWith(n))return["-",e.substr(0,e.length-n.length)];if(e.endsWith(s))return["+",e.substr(0,e.length-s.length)];break;case 2:n+=" ",s+=" ";case 1:if(e.startsWith(n))return["-",e.substr(n.length)];if(e.startsWith(s))return["+",e.substr(s.length)];break;case 0:if(e.startsWith("(")&&e.endsWith(")"))return["-",e.substr(1,e.length-2)]}return["",e]},Number.prototype.format=function(e,t){return this._toFormattedString(e,_Z_228.InvariantCulture,t)},Number.prototype.localeFormat=function(e){return this._toFormattedString(e,_Z_228.CurrentCulture)},Number.prototype._toFormattedString=function(e,t,r){function n(e,t,r,n,s){var i=r[0],o=1,a=e.toString(),l="",c="",d=a.split(".");if(d.length>1){a=d[0];var h=(l=d[1]).split(/e/i);h.length>1&&(l=h[0],c="e"+h[1])}if(t>0){var u=l.length-t;if(u>0)l=l.slice(0,t);else if(u<0)for(var y=0;y<Math.abs(u);y++)l+="0";l=s+l}else l="";l+=c;for(var p=a.length-1,f="";p>=0;){if(0===i||i>p)return f.length>0?a.slice(0,p+1)+n+f+l:a.slice(0,p+1)+l;f=f.length>0?a.slice(p-i+1,p+1)+n+f:a.slice(p-i+1,p+1),p-=i,o<r.length&&(i=r[o],o++)}return a.slice(0,p+1)+n+f+l}if(!e||0===e.length||"i"===e)return t&&t.name.length>0?this.toLocaleString():this.toString();var s=t.numberFormat,i=Math.abs(this);e||(e="D");var o=-1;e.length>1&&(o=parseInt(e.slice(1),10));var a;switch(e.charAt(0)){case"d":case"D":if(a="n",-1!==o){var l=""+i,c=o-l.length;if(c>0)for(var d=0;d<c;d++)l="0"+l;i=l}this<0&&(i=-i);break;case"c":case"C":a=this<0?["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"][s.CurrencyNegativePattern]:["$n","n$","$ n","n $"][s.CurrencyPositivePattern],-1===o&&(o=s.CurrencyDecimalDigits),i=n(Math.abs(this),o,s.CurrencyGroupSizes,s.CurrencyGroupSeparator,s.CurrencyDecimalSeparator);break;case"n":case"N":a=this<0?["(n)","-n","- n","n-","n -"][s.NumberNegativePattern]:"n",-1===o&&(o=s.NumberDecimalDigits),i=n(Math.abs(this),o,s.NumberGroupSizes,r?s.NumberGroupSeparator:"",s.NumberDecimalSeparator);break;case"p":case"P":a=this<0?["-n %","-n%","-%n"][s.PercentNegativePattern]:["n %","n%","%n"][s.PercentPositivePattern],-1===o&&(o=s.PercentDecimalDigits),i=n(Math.abs(this),o,s.PercentGroupSizes,s.PercentGroupSeparator,s.PercentDecimalSeparator);break;default:throw Error.format(Sys.Res.formatBadFormatSpecifier)}for(var h=/n|\$|-|%/g,u="";;){var y=h.lastIndex,p=h.exec(a);if(u+=a.slice(y,p?p.index:a.length),!p)break;switch(p[0]){case"n":u+=i;break;case"$":u+=s.CurrencySymbol;break;case"-":u+=s.NegativeSign;break;case"%":u+=s.PercentSymbol}}return u},Number.prototype.toHex=function(e){var t=this.toString(16).toUpperCase();if(e&&e>0)for(var r=t.length;r<e;r++)t="0"+t;return t},Math.roundTo=function(e,t,r){var n=Math.abs(e),s=Math.pow(10,t),i=1/s;if(n<i&&n.toString().indexOf("e")>-1)return 0;(n-Math.floor(n)).toString().length>=17&&(n+=1e-10);var o=!1===r,a=n.toString().split(".");if(2==a.length){var l=o?1*a[1].substr(0,t).padRight(t,"0"):("0."+a[1])*s;n=a[0]*s+l}else n*=s;o&&(n=parseInt(n)),n.toString().length>=17&&(n+=1e-10);return 0==(i=Math.round(n)/Math.pow(10,t))?i:(e<0?-1:1)*i},Boolean.__typeName="Boolean",Boolean.__class=!0,Boolean.parse=function(e){var t=e.trim().toLowerCase();if("false"===t)return!1;if("true"===t)return!0;throw Error.argumentOutOfRange("value",e,Sys.Res.boolTrueOrFalse)},Boolean.convert=function(e){return"boolean"==typeof e?e:"string"==typeof e?"false"!=e.toLocaleLowerCase()&&"0"!=e:!!e},function(){if(Sys.Browser={},Sys.Browser.InternetExplorer={},Sys.Browser.Firefox={},Sys.Browser.Safari={},Sys.Browser.Opera={},Sys.Browser.Charset=document.charset,Sys.Browser.agent=null,Sys.Browser.hasDebuggerStatement=!1,Sys.Browser.name=navigator.appName,Sys.Browser.version=parseFloat(navigator.appVersion),Sys.Browser.isStandard=!0,navigator.userAgent.indexOf(" MSIE ")>-1||navigator.userAgent.indexOf("Trident/")>-1){Sys.Browser.agent=Sys.Browser.InternetExplorer,Sys.Browser.isIE=!0;r=null;try{for(var e=window,t=0;t<4;t++){var r;if(r=e.__crabaBrowser_IEVersion)break;if(!(e=e.parent))break}}catch(s){}var n=0;n=r?parseInt(r):navigator.userAgent.indexOf(" MSIE ")>-1?parseFloat(navigator.userAgent.match(/MSIE\s(\d+\.\d+)/)[1]):parseFloat(navigator.userAgent.match(/rv:(\d+\.\d+)/)[1]),Sys.Browser.version=n,n>=8?(Sys.Browser.isIE8=!0,n>=9&&(Sys.Browser.isIE9=!0),Sys.Browser.isIE10=10==n,Sys.Browser.isIE11=11==n):n>=7?Sys.Browser.isIE7=!0:n>=6&&(Sys.Browser.isIE6=!0),Sys.Browser.isStandard=Sys.Browser.isIE8,Sys.Browser.hasDebuggerStatement=!0,Sys.Browser.name="IE"}else navigator.userAgent.indexOf(" Firefox/")>-1?(Sys.Browser.agent=Sys.Browser.Firefox,Sys.Browser.isFirefox=!0,Sys.Browser.version=parseFloat(navigator.userAgent.match(/\sFirefox\/(\d+\.\d+)/)[1]),Sys.Browser.name="Firefox",Sys.Browser.hasDebuggerStatement=!0,Sys.Browser.charset=document.characterSet):navigator.userAgent.indexOf(" AppleWebKit/")>-1?(Sys.Browser.agent=Sys.Browser.Safari,Sys.Browser.isSafari=!0,Sys.Browser.isChrome=navigator.userAgent.indexOf(" Chrome/")>-1,Sys.Browser.isChrome?(Sys.Browser.name="Chrome",Sys.Browser.version=parseFloat(navigator.userAgent.match(/\sChrome\/(\d+(\.\d+)?)/)[1])):(Sys.Browser.name="Safari",Sys.Browser.version=parseFloat(navigator.userAgent.match(/\sAppleWebKit\/(\d+(\.\d+)?)/)[1])),navigator.userAgent.indexOf(" Edge/")>-1&&(Sys.Browser.isEdge=!0)):navigator.userAgent.indexOf("Opera/")>-1&&(Sys.Browser.agent=Sys.Browser.Opera,Sys.Browser.isOpera=!0,Sys.Browser.name="Opera");"Safari"==Sys.Browser.name&&(Date=function(e){function t(){if(1===arguments.length){var t=arguments[0];if("[object String]"===Object.prototype.toString.call(t)){var r=(t=t.replace(/-/g,"/")).indexOf("+");r>1&&(t=t.substr(0,r)),arguments[0]=t}}var n=Function.bind;return new(n.bind(n)(e,null).apply(null,arguments))}return t.prototype=e.prototype,t}(Date))}(),Date.__typeName="Date",Date.__class=!0,Date._appendPreOrPostMatch=function(e,t){for(var r=0,n=!1,s=0,i=e.length;s<i;s++){var o=e.charAt(s);switch(o){case"'":n?t.append("'"):r++,n=!1;break;case"\\":n&&t.append("\\"),n=!n;break;default:t.append(o),n=!1}}return r},Date._expandFormat=function(e,t){if(t||(t="F"),1===t.length)switch(t){case"d":return e.ShortDatePattern;case"D":return e.LongDatePattern;case"t":return e.ShortTimePattern;case"T":return e.LongTimePattern;case"F":return e.FullDateTimePattern;case"M":case"m":return e.MonthDayPattern;case"s":return e.SortableDateTimePattern;case"Y":case"y":return e.YearMonthPattern;default:throw Error.format(Sys.Res.formatInvalidString)}return t},Date._expandYear=function(e,t){if(t<100){var r=(new Date).getFullYear();if((t+=r-r%100)>e.Calendar.TwoDigitYearMax)return t-100}return t},Date._getParseRegExp=function(e,t){if(e._parseRegExp){if(e._parseRegExp[t])return e._parseRegExp[t]}else e._parseRegExp={};var r=Date._expandFormat(e,t);r=r.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1");for(var n,s=new Sys.StringBuilder("^"),i=[],o=0,a=0,l=Date._getTokenRegExp();null!==(n=l.exec(r));){var c=r.slice(o,n.index);if(o=l.lastIndex,(a+=Date._appendPreOrPostMatch(c,s))%2!=1){switch(n[0]){case"dddd":case"ddd":case"MMMM":case"MMM":s.append("(\\D+)");break;case"tt":case"t":s.append("(\\D*)");break;case"yyyy":s.append("(\\d{4})");break;case"fff":s.append("(\\d{3})");break;case"ff":s.append("(\\d{2})");break;case"f":s.append("(\\d)");break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":s.append("(\\d\\d?)");break;case"zzz":s.append("([+-]?\\d\\d?:\\d{2})");break;case"zz":case"z":s.append("([+-]?\\d\\d?)")}Array.add(i,n[0])}else s.append(n[0])}Date._appendPreOrPostMatch(r.slice(o),s),s.append("$");var d={regExp:s.toString().replace(/\s+/g,"\\s+"),groups:i};return e._parseRegExp[t]=d,d},Date._getTokenRegExp=function(){return/dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z/g},Date.parseLocale=function(e,t){if(e.length>10){var r=new Date(e);if(r instanceof Date&&!isNaN(r.getTime()))return r}return Date._parse(e,_Z_228.CurrentCulture,arguments)},Date.parseInvariant=function(e,t){return Date._parse(e,_Z_228.InvariantCulture,arguments)},Date._parse=function(e,t,r){for(var n=!1,s=1,i=r.length;s<i;s++){var o=r[s];if(o){n=!0;if(l=Date._parseExact(e,o,t))return l}}if(!n)for(var a=t._getDateTimeFormats(),s=0,i=a.length;s<i;s++){var l=Date._parseExact(e,a[s],t);if(l)return l}return null},Date._parseExact=function(e,t,r){e=e.trim();var n=r.dateTimeFormat,s=Date._getParseRegExp(n,t),i=new RegExp(s.regExp).exec(e);if(null===i)return null;for(var o=s.groups,a=null,l=null,c=null,d=null,h=0,u=0,y=0,p=0,f=null,m=!1,g=0,_=o.length;g<_;g++){var b=i[g+1];if(b)switch(o[g]){case"dd":case"d":if((c=parseInt(b,10))<1||c>31)return null;break;case"MMMM":if((l=r._getMonthIndex(b))<0||l>11)return null;break;case"MMM":if((l=r._getAbbrMonthIndex(b))<0||l>11)return null;break;case"M":case"MM":if((l=parseInt(b,10)-1)<0||l>11)return null;break;case"y":case"yy":if((a=Date._expandYear(n,parseInt(b,10)))<0||a>9999)return null;break;case"yyyy":if((a=parseInt(b,10))<0||a>9999)return null;break;case"h":case"hh":if(12===(h=parseInt(b,10))&&(h=0),h<0||h>11)return null;break;case"H":case"HH":if((h=parseInt(b,10))<0||h>23)return null;break;case"m":case"mm":if((u=parseInt(b,10))<0||u>59)return null;break;case"s":case"ss":if((y=parseInt(b,10))<0||y>59)return null;break;case"tt":case"t":var v=b.toUpperCase();if(!(m=v===n.PMDesignator.toUpperCase())&&v!==n.AMDesignator.toUpperCase())return null;break;case"f":if((p=100*parseInt(b,10))<0||p>999)return null;break;case"ff":if((p=10*parseInt(b,10))<0||p>999)return null;break;case"fff":if((p=parseInt(b,10))<0||p>999)return null;break;case"dddd":if((d=r._getDayIndex(b))<0||d>6)return null;break;case"ddd":if((d=r._getAbbrDayIndex(b))<0||d>6)return null;break;case"zzz":var z=b.split(/:/);if(2!==z.length)return null;if((w=parseInt(z[0],10))<-12||w>13)return null;var x=parseInt(z[1],10);if(x<0||x>59)return null;f=60*w+(b.startsWith("-")?-x:x);break;case"z":case"zz":var w=parseInt(b,10);if(w<-12||w>13)return null;f=60*w}}var S=new Date;if(null===a&&(a=S.getFullYear()),null===l&&(l=S.getMonth()),null===c&&(c=S.getDate()),S.setFullYear(a,l,c),S.getDate()!==c)return null;if(null!==d&&S.getDay()!==d)return null;if(m&&h<12&&(h+=12),S.setHours(h,u,y,p),null!==f){var j=S.getMinutes()-(f+S.getTimezoneOffset());S.setHours(S.getHours()+parseInt(j/60,10),j%60)}return S},Date.prototype.format=function(e){return this._toFormattedString(e,_Z_228.InvariantCulture)},Date.prototype._format=function(e){return this._toFormattedString(e,_Z_228.InvariantCulture)},Date.prototype.localeFormat=function(e){return this._toFormattedString(e,_Z_228.CurrentCulture)},Date.prototype._toFormattedString=function(e,t){function r(e){return e<10?"0"+e:e.toString()}function n(e){return e<10?"00"+e:e<100?"0"+e:e.toString()}if(!e||0===e.length||"i"===e)return t&&t.name.length>0?this.toLocaleString():this.toString();var s=t.dateTimeFormat;e=Date._expandFormat(s,e);for(var i,o=new Sys.StringBuilder,a=0,l=Date._getTokenRegExp();;){var c=l.lastIndex,d=l.exec(e),h=e.slice(c,d?d.index:e.length);if(a+=Date._appendPreOrPostMatch(h,o),!d)break;if(a%2!=1)switch(d[0]){case"dddd":o.append(s.DayNames[this.getDay()]);break;case"ddd":o.append(s.AbbreviatedDayNames[this.getDay()]);break;case"dd":o.append(r(this.getDate()));break;case"d":o.append(this.getDate());break;case"MMMM":o.append(s.MonthNames[this.getMonth()]);break;case"MMM":o.append(s.AbbreviatedMonthNames[this.getMonth()]);break;case"MM":o.append(r(this.getMonth()+1));break;case"M":o.append(this.getMonth()+1);break;case"yyyy":o.append(this.getFullYear());break;case"yy":o.append(r(this.getFullYear()%100));break;case"y":o.append(this.getFullYear()%100);break;case"hh":0===(i=this.getHours()%12)&&(i=12),o.append(r(i));break;case"h":0===(i=this.getHours()%12)&&(i=12),o.append(i);break;case"HH":o.append(r(this.getHours()));break;case"H":o.append(this.getHours());break;case"mm":o.append(r(this.getMinutes()));break;case"m":o.append(this.getMinutes());break;case"ss":o.append(r(this.getSeconds()));break;case"s":o.append(this.getSeconds());break;case"tt":o.append(this.getHours()<12?s.AMDesignator:s.PMDesignator);break;case"t":o.append((this.getHours()<12?s.AMDesignator:s.PMDesignator).charAt(0));break;case"f":o.append(n(this.getMilliseconds()).charAt(0));break;case"ff":o.append(n(this.getMilliseconds()).substr(0,2));break;case"fff":o.append(n(this.getMilliseconds()));break;case"z":i=this.getTimezoneOffset()/60,o.append((i>=0?"+":"-")+Math.floor(Math.abs(i)));break;case"zz":i=this.getTimezoneOffset()/60,o.append((i>=0?"+":"-")+r(Math.floor(Math.abs(i))));break;case"zzz":i=this.getTimezoneOffset()/60,o.append((i>=0?"+":"-")+r(Math.floor(Math.abs(i)))+s.TimeSeparator+r(Math.abs(this.getTimezoneOffset()%60)))}else o.append(d[0])}return o.toString()},Date.dateToStr=function(e){return e?e._format("yyyy-MM-dd"):""},Date.getWeekday=function(e){return e?(this._days||(this._days=new Array("星期日","星期一","星期二","星期三","星期四","星期五","星期六")),"String"==typeof e&&(e=Date.strToDate(e)),this._days[e.getDay()]):""},Date.timeToStr=function(e){return e?e._format("HH:mm:ss"):""},Date.dateTimeToStr=function(e){return e?e._format("yyyy-MM-dd HH:mm:ss"):""},Date.toDateTime=function(e,t,r){if(!e)return null;var n=new Date;return"object"==typeof e&&(r=e.getDate(),t=e.getMonth(),e=e.getFullYear()),n.setFullYear(e,t,r),n},Date.strToDate=function(e){return Date.parseLocale(e,"yyyy-MM-dd","yyyy-MM-dd HH:mm:ss","yyyy-MM-ddTHH:mm:ss.fffZ","yyyy/MM/dd","yyyyMMdd","yyyy","yyyy-MM","yyyyMM","MM-dd","dd")},Date.strToTime=function(e){return Date.parseLocale(e,"HH:mm:ss","yyyy-MM-dd HH:mm:ss","yyyy/MM/dd HH:mm:ss","yyyy-MM-ddTHH:mm:ss.fffZ")},Date.strToDateTime=function(e){return Date.parseLocale(e,"yyyy-MM-dd","yyyy-MM-dd HH:mm:ss","yyyy/MM/dd HH:mm:ss","yyyy-MM-ddTHH:mm:ss.fffZ")},Date._date1970=new Date(1970,1,1,0,0,0).getTime(),Date.getDaysBetween=function(e,t){return Math.floor((e.getTime()-this._date1970)/864e5)-Math.floor((t.getTime()-this._date1970)/864e5)},Date.getMonthDays=function(e,t){var r=new Array(31,28,31,30,31,30,31,31,30,31,30,31)[t];return 1==t&&(e%4==0&&e%100!=0||e%400==0)&&r++,r},RegExp.__typeName="RegExp",RegExp.__class=!0,Array.__typeName="Array",Array.__class=!0,Array.add=Array.enqueue=function(e,t){e[e.length]=t},Array.addRange=function(e,t){e.push.apply(e,t)},Array.addByKey=function(e,t,r,n){if(t&&!Object.isUndefinedOrNull(t[r])){if(r){for(var s=-1,i=0,o=e.length;i<o;i++){var a=e[i][r];if(a!==undefined){var l=t[r];if(l!==undefined&&a==l){s=i;break}}}s>-1&&Array.removeAt(e,s)}Array.insert(e,0,t),n&&Array.removeAt(e,n)}},Array.addByContains=function(e,t){Array.contains(e,t)||e.push(t)},Array.clear=function(e){e.length=0},Array.clone=function(e){return 1===e.length?[e[0]]:Array.apply(null,e)},Array.contains=function(e,t){return Array.indexOf(e,t)>=0},Array.dequeue=function(e){return e.shift()},Array.forEach=function(e,t,r){if(e)for(var n=0,s=e.length;n<s;n++){var i=e[n];void 0!==i&&t.call(r,i,n,e)}},Array.indexOf=function(e,t,r){if(void 0===t)return-1;var n=e.length;if(0!==n){r-=0,isNaN(r)?r=0:(isFinite(r)&&(r-=r%1),r<0&&(r=Math.max(0,n+r)));for(var s=r;s<n;s++)if("undefined"!=typeof e[s]&&e[s]===t)return s}return-1},Array.insert=function(e,t,r){e.splice(t,0,r)},Array.parse=function(e){if(!e)return[];var t=evil2(e);if(!Array.isInstanceOfType(t))throw Error.argument("value",Sys.Res.arrayParseBadFormat);return t},Array.remove=function(e,t){var r=Array.indexOf(e,t);return r>=0&&e.splice(r,1),r>=0},Array.removeByKey=function(e,t,r){if(!r||!e||!t||Object.isUndefinedOrNull(t[r]))return!1;for(var n=t[r],s=-1,i=0,o=e.length;i<o;i++){var a=e[i][r];if(a!==undefined&&a==n){s=i;break}}return s>-1&&(Array.removeAt(e,s),!0)},Array.findByKey=function(e,t,r){if(!r||!e||!t)return-1;for(var n=-1,s=0,i=e.length;s<i;s++){var o=e[s][r];if(o!==undefined){var a=t[r];if(a!==undefined&&o==a){n=s;break}}}return n},Array.containsByKey=function(e,t,r){return Array.findByKey(e,t,r)>-1},Array.removeAt=function(e,t){return e.splice(t,1)},Array.getFirst=function(e){if(e.length>0)return e[0]},Array.getLast=function(e){var t=e.length;if(t>0)return e[t-1]},Array.removeRepeatString=function(e){if(!e)return[];for(var t=[],r={},n=0,s=e.length;n<s;n++){var i=e[n];r[i]||(t.push(i),r[i]=!0)}return t},Type.registerNamespace("Sys"),Sys.Res={mdiInner:"MDIPanel找不到InnerBockID={0}的控件!",mdiTabMax:"窗口数量不能超过{0}个，请关掉部分再新开！",frozenTabTips:"最多锁定{0}个页面哦!",argumentTypeName:"值对应的类型名称不存在.",cantSetIdAfterInit:"Id属性不能在该对象初始化后设置.",componentCantSetIdAfterAddedToApp:"不能对一个被添加到应用程序对象的组件再设置ID.",behaviorDuplicateName:"行为已经存在该名称'{0}' 或者在对应的Dom节点已经存在相同的属性.",notATypeName:"值是无效的类型名称.",typeShouldBeTypeOrString:"值是无效的类型或一个有效类型名称.",boolTrueOrFalse:"'{0}' 值必须是 'true' or 'false'.",stringFormatInvalid:"格式字符串无效.",referenceNotFound:"'{0}' 组件不存在.",enumReservedName:"'{0}' .",eventHandlerNotFound:"事件不存在.",circularParentChain:"控件链里不能对父控件有循环引用.",undefinedEvent:"'{0}' 不是一个事件.",notAMethod:"{0} 不是一个方法.",propertyUndefined:"'{0}' 不是一个属性或存在的字段.",propertyNotWritable:"'{0}' 属性为只读.",enumInvalidValueName:"'{0}' 不是一个有效的枚举值名称.",controlAlreadyDefined:"控件已经关联了Dom节点",namespaceContainsObject:"对象{0}已经存在，不是一个有效地名称空间.",cantAddNonFunctionhandler:"非函数类型不能添加事件处理程序",scriptLoaderAlreadyLoading:"脚本加载器正在运行时不能再被调用.",invalidNameSpace:"值不是一个有效的标识符名称空间.",notAnInterface:"值不是一个有效的接口.",eventHandlerNotFunction:"处理程序必须是一个函数.",propertyNotAnArray:"'{0}' 不是一个数组属性.",typeRegisteredTwice:"类型 {0} 已经被注册，这个类型可能被定义了多次或者其他脚本文件里面已经定义，一个可能的原因是局部更新出现的情况.",cantSetNameAfterInit:"不能在对象初始化后设置Name属性.",appDuplicateComponent:"两个或以上的控件存在相同的ID值  '{0}'，因此不能被添加到应用上.",appDuplicateForm:"两个或两个以上的窗体存在相同的ID值 '{0}'，因此不能被添加到应用上.",appComponentMustBeInitialized:"组件被添加到应用程序之前必须先初始化.",baseNotAClass:"值不是一个类.",methodNotFound:"方法 '{0}' 不存在.",arrayParseBadFormat:"值不是一个有效地字符串表达式. 它必须以'['开头, 已']'结尾.",cantSetId:"该对象不支持设置id属性.",stringFormatBraceMismatch:"格式字符串包含一个不匹配的打开或关闭括号.",enumValueNotInteger:"枚举定义只能包含整数的值.",propertyNullOrUndefined:"不能设置“{0}”属性，因为它返回空值.",propertyNull:"不能设置对象的“{0}”属性，因为对象为空",componentCantSetIdTwice:"组件的id属性只能调用一次.",createComponentOnDom:"如果创建Component的值不是控件或行为类型，那传入必须为空.",createNotComponent:"{0}不是_Z_242类型.",createNotControl:"{0}不是Sys.UI.Control类型.",createNotUIControl:"{0}不是Craba.UI.Control类型.",createNoDom:"控件或行为的的值不能为空.",cantAddWithoutId:"不能添加一个没有id属性的组件.",badTypeName:"值类型是没有被注册的名称或名称是保留字.",argumentInteger:"值必须是整数.",invokeCalledTwice:"不能调用多次invoke方法",webServiceFailed:"服务器方法“{0}”调用失败，{1}",webServiceFailedServerError:"{0}",argumentType:"对象不能被转换为所需类型.",argumentNull:"值不能为空.",formatBadFormatSpecifier:"无效的格式符.",webServiceFailedNoMsg:"服务器方法“{0}”调用失败",exceptionNoMsg:"<p class='ExceptionText'>{1}</p><p class='ExceptionNo'>错误号:{0}</p>",webServiceFailedNoResponse:"没有响应，可能是因为无法访问WebService服务“{0}”",webServiceFailedNoResult:"响应节点Response或Result没找到。\n\n响应内容：\n{0}",pageRequestFailedNoMsg:"页面加载失败",pageNotFound:"页面“{0}”不存在",argumentDomElement:"值必须是一个Dom节点.",invalidExecutorType:"不能从“{0}”创建一个有效的_Z_244类型",cannotCallBeforeResponse:"当响应不可用时不能调用{0}.",actualValue:"实际的值是{0}.",enumInvalidValue:"'{0}' 不是有效地枚举值 {1}.",scriptLoadFailed:"不能加载脚本文件 '{0}'.",parameterCount:"参数计数不匹配.",cannotDeserializeEmptyString:"不能对空字符串进行反序列化.",formatInvalidString:"输入字符串的格式不正确.",invalidTimeout:"值必须大于或等于零.",cannotAbortBeforeStart:"执行器尚未开始时无法中止任务.",argument:"值不在预期的范围内.",cannotDeserializeInvalidJson:"不能反序列化。数据不符合有效的JSON.",invalidHttpVerb:"httpverb不能设置为空或空字符串.",nullWebRequest:"webRequest为空对象，不能执行executeRequest方法.",eventHandlerInvalid:"处理程序没有通过_Z_220.addHandler加入方法.",cannotSerializeNonFiniteNumbers:"无法序列化非有限数.",argumentUndefined:"值不能是未定义的.",webServiceInvalidReturnType:"服务器方法返回了无效的类型 '{0}'. 预期的类型是: {1}",servicePathNotSet:"该Web服务的路径没有设置.",argumentTypeWithTypes:"类型 '{0}'不能转换为类型 '{1}'.",cannotCallOnceStarted:"{0} 一旦开始就不能在被调用.",badBaseUrl1:"url没有包含 ://",badBaseUrl2:"url没有包含另一个 /",badBaseUrl3:"url的结尾没有包含 /",setExecutorAfterActive:"当执行器被激活时不能再次调用set方法.",paramName:"参数名: {0}",cannotCallOutsideHandler:"不能调用已完成的事件处理程序之外的方法 {0}.",format:"项目的格式无效.",assertFailedCaller:"断言失败: {0}\\r\\nat {1}",argumentOutOfRange:"参数值超出规定范围",webServiceTimedOut:"网络超时，操作失败。请检查网络连接和服务器是否正常！\r\n{0}",syncError:"同步请求失败。请检查网络连接和服务器是否正常！\r\n{0}",pageRequestTimedOut:"网络超时，页面加载失败。请检查网络连接和服务器是否正常！\r\n{0}",notImplemented:"该方法或操作无法实现.",assertFailed:"断言失败: {0}",invalidOperation:"对象的当前状态操作无效.",breakIntoDebugger:"{0}\\r\\n\\r\\n中断调试器吗?",createNotValidator:"{0}不能从Sys.Validators创建.",cantBeCalledAfterDispose:"不能调用已经释放的对象.",addHandlerCantBeUsedForError:"无法添加使用这种方法的错误事件的处理程序，请用window.onerror代替.",argumentDomNode:"值必须是一个DOM元素或文本节点.",webServiceInvalidJsonWrapper:"服务器方法 '{0}' 返回无效的数据， JSON字符串没有包装属性'd'",cannotSerializeObjectWithCycle:"无法序列化对象，包含循环引用的属性.",browser:{checkBrowserHTML:'<div class="BrowserCheckContent"><div class="Title">您的浏览器该升级了</div><div class="Tips"><p>您正在使用的浏览器已不能满足产品新技术，<span class="TipsText">如果您不升级的话，页面可能会出现内容错乱，且无法正确执行所有的功能，</span>{0}</p></div>',browserList:'请根据下面提供的链接来选择升级您的浏览器吧！给您带来不便敬请谅解！！！</p></div><div class="Lists"><a href="https://browser.360.cn/se/" target="_blank" title="360安全浏览器" class="icon b360"></a><a href="https://ie.sogou.com/" target="_blank" title="搜狗浏览器" class="icon bsougou"></a><a href="https://browser.360.cn/ee/" target="_blank" title="极速浏览器" class="icon bjisu"></a><a href="https://browser.qq.com/" target="_blank" title="qq浏览器" class="icon bqq"></a><a href="https://www.liebao.cn/" target="_blank" title="猎豹浏览器" class="icon bliebao"></a></div><p>温馨提示:如果您已经安装了以上浏览器，依然出现该提示窗口，请务必切换到极速模式<a href="http://crabadoc.mygjp.com/Default.gspx#Pages/Content.gspx?id=778" target="_blank" class="TipsLink">点此查看方法</a>'},messageBoxTitle:"系统提示",checkVersionHTML:"亲，系统有新版本哦，请尽快退出重新登录以使用新版本！",checkVersionTitle:"温馨提示",printTips:{teemoJs1:"TeemoJs插件加载失败，请刷新或稍后再试。",teemoJs2:"缺少配置$settings.ReportConfig.TeemoJsUrl。",noService:'<p class="TipText">云打印服务地址和Token还没初始化，请刷新页面后重试。</p><p>如果重复出现类似问题，请您联系我们客服。</p>',old:'温馨提示：请您先升级Teemo版本的打印管理器才能使用。<a href="{0}" target="_blank">点击下载</a>',manage:"样式管理",quit:"取消退出",autoHide:"自动关闭菜单","export":"导出数据",style:"切换样式",design:"打印设计",preview:"打印预览",print:"直接打印",pdf:"启用PDF",apiError:"打印服务异常"}},Sys._Debug=function(){},Sys._Debug.prototype={_appendConsole:function(e){"undefined"!=typeof Debug&&Debug.writeln&&Debug.writeln(e),this.consoleLog(e),window.debugService&&window.debugService.trace(e)},consoleLog:function(e){window.console&&window.console.log&&window.console.log(e),window.opera&&window.opera.postError(e)},_getTraceElement:function(){if(this._traceElement)$dom.setDisplay(this._traceElement,"block");else{var e=document.createElement("div");e.className="TraceDump",e.tabIndex=0;var t=this._traceContent=document.createElement("div");t.className="TraceContent",e.appendChild(t);var r=document.createElement("div");r.className="btn closeBtn",r.innerText="x",r.title="隐藏面板",$addHandler(r,"click",function(t){$dom.setDisplay(e,"none")}),e.appendChild(r);var n=document.createElement("div");n.className="btn clearBtn",n.innerText="c",n.title="清除内容",$addHandler(n,"click",function(e){t.innerHTML=""}),e.appendChild(n);var s=document.createElement("div");s.className="btn maxBtn",s.innerText="o",s.title="放大/缩小",$addHandler(s,"click",function(t){$dom.hasClass(e,"ShowFull")?$dom.removeCssClass(e,"ShowFull"):$dom.addCssClass(e,"ShowFull")}),e.appendChild(s),document.body||(document.body=document.createElement("body")),document.body.appendChild(e),this._traceElement=e}return this._traceElement},_appendTrace:function(e){var t=(e=null===e?"null":e.toString()).replace(/</g,"&lt;");t=(t=(t=(t=(t=(t=t.replace(/\[b\]/g,"<b>")).replace(/\[\/b\]/g,"</b>")).replace(/\r\n/g,"<br>")).replace(/\n/g,"<br>")).replace(/\s\s/g,"&nbsp;&nbsp;&nbsp;&nbsp;")).replace(/\s/g,"&nbsp;"),this.appendTraceHtml(t)},appendTraceHtml:function(e){var t=this._fragment;t||(t=this._fragment=$common.createFragment());var r=document.createElement("div");r.innerHTML=e||"&nbsp;",t.appendChild(r);var n=this;n.timer||(n.timer=setTimeout(function(){n._showHTML()},10))},_showHTML:function(){this._getTraceElement(),elt=this._traceContent,elt.appendChild(this._fragment),elt.scrollTop=elt.scrollHeight,this.timer=null},clearTrace:function(){this._getTraceElement()&&(this._traceContent.innerHTML="")},assert:function(e,t,r){e||(t=r&&this.assert.caller?String.format(Sys.Res.assertFailedCaller,t,this.assert.caller):String.format(Sys.Res.assertFailed,t),confirm(String.format(Sys.Res.breakIntoDebugger,t))&&this.fail(t))},fail:function(e){this._appendConsole(e),Sys.Browser.hasDebuggerStatement&&evil2("debugger")},trace:function(e){this._appendConsole(e),this._appendTrace(e)},log:function(e,t){(window._testing||t)&&this.traceDump(e,"[[b]"+Date.timeToStr(new Date)+"[/b]] ")},testLog:function(e){window._testing&&this.consoleLog(e)},traceDump:function(e,t,r){this._traceDump(e,t,!0,null,null,r)},_traceDump:function(e,t,r,n,s,i){var o=$createDelegate(this,function(e){i?i.appendLine(e):this.trace(e)});if(t=t||"",n=n||"",t&&t.indexOf("[/")<0&&(t="[b]"+t+"[/b]: "),null!==e)switch(typeof e){case"undefined":o(n+t+"Undefined");break;case"number":case"string":case"boolean":o(n+t+e);break;default:if(Date.isInstanceOfType(e)||RegExp.isInstanceOfType(e)){o(n+t+e.toString());break}if(s){if(Array.contains(s,e))return void o(n+t+"...")}else s=[];if(Array.add(s,e),e==window||e===document||window.HTMLElement&&e instanceof HTMLElement||"string"==typeof e.nodeName){var a=e.tagName?e.tagName:"DomElement";e.id&&(a+=" - "+e.id),o(n+t+" {"+a+"}")}else{var l=Object.getTypeName(e);if(o(n+t+("string"==typeof l?" {"+l+"}":"")),""===n||r){n+="  ";var c,d,h,u;if(Array.isInstanceOfType(e))for(d=e.length,c=0;c<d;c++)this._traceDump(e[c],"["+c+"]",r,n,s,i);else for(h in e)u=e[h],Function.isInstanceOfType(u)||this._traceDump(u,h,r,n,s,i)}}Array.remove(s,e)}else o(n+t+"null")},traceDumpCallStack:function(e,t){for(var r=function(e){if(!e)return"()";for(var t=[],r=0;r<e.length;r++){var n,s=e[r];"string"==typeof s?n='"'+s+'"':s&&"object"==typeof s?(n="["+Object.getTypeName(s),s&&s.get_id&&"function"==typeof s.get_id&&(n+="("+s.get_id()+")"),n+="]"):n=void 0===s?"undefined":null===s?"null":s,t.push(n)}return"("+t.join(", ")+")"},n=e||this.traceDumpCallStack,s="\r\n",i=1;null!==(n=n.caller);){var o=n.toString(),a=o.match(/function\s([\w$]+)([^\{\}]*\))/);if(s+="  _"+i+"_ "+(a?a[1]:o)+r(n.arguments)+"\r\n",i>=20)break;i++}t?this.traceDump(s,"CallStack",t):this.consoleLog(s)},serverLog:function(e){if(!1!==$settings.EnableSaveClientLog&&!$common.gspxParse){var t=location.href;!$settings.EnableSaveMDIPageLocation&&$common._MDIPageLocation&&(t+=$common._MDIPageLocation),$adminService.Log(t+"\r\n  "+e,Function.emptyFunction,Function.emptyFunction)}}},Sys._Debug.registerClass("Sys._Debug");var $debug=Sys.Debug=new Sys._Debug;Sys.Debug.isDebug=!1,window.handleError=function(e,t,r,n,s,i,o){if(e){if(e.showMessage)return void(e.message&&$common.alert(e.message));if(e.isAbort)return void(e.message&&$common.alert(e.message))}var a=window.location.host,l=$settings.EnableSaveMDIPageLocation||!window.$adminService||$settings.development,c=new Sys.StringBuilder;r&&$debug.traceDump(r,"FileName",c),n&&(Sys.Browser.isIE&&n&&n--,$debug.traceDump(n,"LineNumber",c));var d=!1;if(e){var h=e.innerException;if(delete e.innerException,e.message){u=e.message;h&&h.message&&(u+=","+h.message),l?$debug.appendTraceHtml('<font color="red"><b>'+u+"</b></font>"):$debug.traceDump(u,null,c)}e.ErrorMessage||(e.ErrorMessage=e.message),e.stack&&(d=!0,e.ErrorStack=e.stack,delete e.stack),!Sys.Browser.isIE&&h&&h.stack?$debug.traceDump(h.stack,null,c):$debug.traceDump(e,null,c)}else $debug.traceDump(t,"Error",c),i&&(d=!0,$debug.traceDump(i.stack,null,c));d||!Sys.Browser.isIE&&!Sys.Browser.isSafari||$debug.traceDumpCallStack(s||handleError,c);var u=c.toString();if("undefined"!=typeof crabaVersion&&(u=crabaVersion+"\r\n"+crabaDate+"\r\n"+u),l)$debug.trace(u),a&&$debug.serverLog(u);else{var y=Math.round(((new Date).getTime()-new Date(2e3,0,1).getTime())/1e3),p=Math.floor(y/86400)+"."+(y=Math.floor(y%86400/10)),f="错误号: ";if($debug.serverLog(f+p+u+o),$settings&&!$settings.__notInited&&!$settings.DisableErrorAlert){$debug._clientErrorList||($debug._clientErrorList=[]),$debug._clientErrorList.push(u);var m="<span class='jsErrorTitle'>操作失败，请刷新后重试。</span>";m+="<span class='jsErrorTips'>如果重试不能解决问题，请点击下面的错误号数字，将错误详情反馈给我们！</span>",m+="("+(f+="<a href='javascript:;' onclick=\"$debug.trace($debug._clientErrorList);$debug._clientErrorList=null;return false\" style='display:inline;text-decoration:underline' title='查看错误详情'>"+p+"</a>")+")",$settings.CustomHelpHTML&&(m+=$settings.CustomHelpHTML),$app.showError(Sys.ErrorType.javascript,m)}}},window.onerror=_onError,Sys.IDisposable=function(){throw Error.notImplemented()},Sys.IDisposable.prototype={dispose:function(){throw Error.notImplemented()}},Sys.IDisposable.registerInterface("Sys.IDisposable"),Sys.StringBuilder=function(e){this._parts=void 0!==e&&null!==e&&""!==e?[e.toString()]:[],this._value={},this._len=0},Sys.StringBuilder.prototype={append:function(e){return this._parts[this._parts.length]=e,this},appendLine:function(e){return this._parts[this._parts.length]=void 0===e||null===e||""===e?"\r\n":e+"\r\n",this},clear:function(){return this._parts=[],this._value={},this._len=0,this},isEmpty:function(){return 0===this._parts.length||""===this.toString()},toString:function(e){e=e||"";var t=this._parts;this._len!==t.length&&(this._value={},this._len=t.length);var r=this._value;if("undefined"==typeof r[e]){if(""!==e)for(var n=0;n<t.length;)"undefined"==typeof t[n]||""===t[n]||null===t[n]?t.splice(n,1):n++;r[e]=this._parts.join(e)}return r[e]}},Sys.StringBuilder.registerClass("Sys.StringBuilder"),Sys.Hashtable=function(){this.clear()},Sys.Hashtable.prototype={add:function(e,t){this.set_item(e,t)},set:function(e,t){this.set_item(e,t)},"delete":function(e){delete this._data[e]},forEach:function(e){var t=this.get_data();for(var r in t)e(t[r])},get_item:function(e){return this._data[e]},set_item:function(e,t){this._data[e]=t},clear:function(){this._data={}},get_data:function(){return this._data},get_count:function(){var e=this.get_data(),t=0;for(var r in e)t++;return t},isEmpty:function(){return 0==this.get_count()},toString:function(e){e=e||"\n";var t=this.get_data(),r="";for(var n in t)r+=n+" = "+t[n]+e;return r},remove:function(e){delete this._data[e]}},Sys.Hashtable.registerClass("Sys.Hashtable"),$string=Sys.StringUtils=function(){},$string.repeat=function(e,t){for(var r=[],n=0;n<t;n++)Array.add(r,e);return r.join("")},$string.trimChinese=function(e){if(null==e)return e;for(var t="！".charCodeAt(0)-"!".charCodeAt(0),r=[],n=0;n<e.length;n++){var s=e.charAt(n);s>="！"&&s<="～"&&(s=String.fromCharCode(s.charCodeAt(0)-t)),(s.charCodeAt(0)>=12832||s>="0"&&s<="9"||s>="A"&&s<="Z"||s>="a"&&s<="z")&&Array.add(r,s)}return r.join("")},$string.getPinyinCode=function(e,t,r){if(!e)return"";t&&(e=$string.trimChinese(e)),r||(r=e.length);for(var n=[],s=0;s<r;s++){var i=$string._doGetPinyinCode(e.charAt(s),!t);Array.add(n,i.charAt(0))}return n.join("")},$string.getFirstPinyinCode=function(e){return e?0==(e=$string.trimChinese(e)).length?"":$string._doGetPinyinCode(e.charAt(0)):""},$string._doGetPinyinCode=function(e,t){$string._pinyinList||($string._pinyinList="ydyqsxmwzssxjbymgcczqpssqbycdscdqldylybssjgyzzjjfkcclzdhwdwzjljpfyynwjjtmyhzwzhflzppqhgscyyynjqyxxgjhhsdsjnkktmomlcrxypsnqseccqzggllyjlmyzzsecykyyhqwjssggyxyzyjwwkdjhychmyxjtlxjyqbyxzldwrdjrwysrldzjpcbzjjbrcftleczstzfxxzhtrqhybdlyczssymmrfmyqzpwwjjyfcrwfdfzqpyddwyxkyjawjffxypsftzyhhyzyswcjyxsclcxxwzzxnbgnnxbxlzszsbsgpysyzdhmdzbqbzcwdzzyytzhbtsyybzgntnxqywqskbphhlxgybfmjebjhhgqtjcysxstkzhlyckglysmzxyalmeldccxgzyrjxsdltyzcqkcnnjwhjtzzcqljststbnxbtyxceqxgkwjyflzqlyhyxspsfxlmpbysxxxydjczylllsjxfhjxpjbtffyabyxbhzzbjyzlwlczggbtssmdtjzxpthyqtgljscqfzkjzjqnlzwlslhdzbwjncjzyzsqqycqyrzcjjwybrtwpyftwexcskdzctbzhyzzyyjxzcffzzmjyxxsdzzottbzlqwfckszsxfyrlnyjmbdthjxsqqccsbxyytsyfbxdztgbcnslcyzzpsazyzzscjcshzqydxlbpjllmqxtydzxsqjtzpxlcglqtzwjbhctsyjsfxyejjtlbgxsxjmyjqqpfzasyjntydjxkjcdjszcbartdclyjqmwnqnclllkbybzzsyhqqltwlccxtxllzntylnewyzyxczxxgrkrmtcndnjtsyyssdqdghsdbjghrwrqlybglxhlgtgxbqjdzpyjsjyjctmrnymgrzjczgjmzmgxmpryxkjnymsgmzjymkmfxmldtgfbhcjhkylpfmdxlqjjsmtqgzsjlqdldgjycalcmzcsdjllnxdjffffjczfmzffpfkhkgdpsxktacjdhhzddcrrcfqyjkqccwjdxhwjlyllzgcfcqdsmlzpbjjplsbcjggdckkdezsqcckjgcgkdjtjdlzycxklqscgjcltfpcqczgwpjdqyzjjbyjhsjdzwgfsjgzkqcczllpspkjgqjhzzljplgjgjjthjjyjzczmlzlyqbgjwmljkxzdznjqsyzmljlljkywxmkjlhskjgbmclyymkxjqlbmllkmdxxkwyxyslmlpsjqqjqxyxfjtjdxmxxllcxqbsyjbgwymbggbcyxpjygpepfgdjgbhbnsqjyzjkjkhxqfgqzkfhygkhdkllsdjqxpqykybnqsxqnszswhbsxwhxwbzzxdmnsjbsbkbbzklylxgwxdrwyqzmywsjqlcjxxjxkjeqxscyetlzhlyyysdzpaqyzcmtlshtzcfyzyxyljsdcjqagyslcqlyyyshmrqqkldxzscsssydycjysfsjbfrsszqsbxxpxjysdrckgjlgdkzjzbdktcsyqpyhstcldjdhmxmcgxyzhjddtmhltxzxylymohyjcltyfbqqxpfbdfhhtksqhzyywcnxxcrwhowgyjlegwdqcwgfjycsntmytolbygwqwesjpwnmlrydzsztxyqpzgcwxhngpyxshmyqjxztdppbfyhzhtjyfdzwkgkzbldntsxhqeegzzylzmmzyjzgxzxkhkstxnxxwylyapsthxdwhzympxagkydxbhnhxkdpjnmyhylpmgocslnzhkxxlpzzlbmlsfbhhgygyyggbhscyaqtywlxtzqcezydqdqmmhtkllszhlsjzwfyhqswscwlqazynytlsxthaznkzzszzlaxxzwwctgqqtddyztcchyqzflxpslzygpzsznglndqtbdlxgtctajdkywnsyzljhhzzcwnyyzywmhychhyxhjkzwsxhzyxlyskqyspslyzwmyppkbyglkzhtyxaxqsyshxasmchkdscrswjpwxsgzjlwwschsjhsqnhcsegndaqtbaalzzmsstdqjcjktscjaxplggxhhgxxzcxpdmmhldgtybysjmxhmrcpxxjzckzxshmlqxxtthxwzfkhcczdytcjyxqhlxdhypjqxylsyydzozjnyxqezysqyayxwypdgxddxsppyzndltwrhxydxzzjhtcxmczlhpyyyymhzllhnxmylllmdcppxhmxdkycyrdltxjchhzzxzlcclylnzshzjzzlnnrlwhyqsnjhxyntttkyjpychhyegkcttwlgqrlggtgtygyhpyhylqyqgcwyqkpyyyttttlhyhlltyttsplkyzxgzwgpydsszzdqxskcqnmjjzzbxyqmjrtffbtkhzkbxljjkdxjtlbwfzpptkqtztgpdgntpjyfalqmkgxbdclzfhzclllladpmxdjhlcclgyhdzfgyddgcyyfgydxkssebdhykdkdkhnaxxybpbyyhxzqgaffqyjxdmljcsqzllpchbsxgjyndybyqspzwjlzksddtactbxzdyzypjzqsjnkktknjdjgyypgtlfyqkasdntcyhblwdzhbbydwjrygkzyheyyfjmsdtyfzjjhgcxplxhldwxxjkytcyksssmtwcttqzlpbszdzwzxgzagyktywxlhlspbclloqmmzsslcmbjcszzkydczjgqqdsmcytzqqlwzqzxssfpttfqmddzdshdtdwfhtdyzjyqjqkypbdjyyxtljhdrqxxxhaydhrjlklytwhllrllrcxylbwsrszzsymkzzhhkyhxksmdsydycjpbzbsqlfcxxxnxkxwywsdzyqoggqmmyhcdzttfjyybgstttybykjdhkyxbelhtypjqnfxfdykzhqkzbyjtzbxhfdxkdaswtawajldyjsfhbldnntnqjtjnchxfjsrfwhzfmdryjyjwzpdjkzyjympcyznynxfbytfyfwygdbnzzzdnytxzemmqbsqehxfzmbmflzzsrxymjgsxwzjsprydjsjgxhjjgljjynzzjxhgxkymlpyyycxytwqzswhwlyrjlpxslsxmfswwklctnxnynpsjszhdzeptxmyywxyysywlxjqzqxzdcleeelmcpjpclwbxsqhfwwtffjtnqjhjqdxhwlbyznfjlalkyyjldxhhycstyywnrjyxywtrmdrqhwqcmfjdyzmhmyyxjwmyzqzxtlmrspwwchaqbxygzypxyyrrclmpymgksjszysrmyjsnxtplnbappypylxyyzkynldzyjzcznnlmzhharqmpgwqtzmxxmllhgdzxyhxkyxycjmffyyhjfsbssqlxxndycannmtcjcyprrnytyqnyymbmsxndlylysljrlxysxqmllyzlzjjjkyzzcsfbzxxmstbjgnxyzhlxnmcwscyzyfzlxbrnnnylbnrtgzqysatswryhyjzmzdhzgzdwybsscskxsyhytxxgcqgxzzshyxjscrhmkkbxczjyjymkqhzjfnbhmqhysnjnzybknqmclgqhwlznzswxkhljhyybqlbfcdsxdldspfzpskjyzwzxzddxjsmmegjscssmgclxxkyyylnypwwwgydkzjgggzggsycknjwnjpcxbjjtqtjwdsspjxzxnzxumelpxfsxtllxcljxjjljzxctpswxlydhlyqrwhsycsqyybyaywjjjqfwqcqqcjqgxaldbzzyjgkgxpltzyfxjltpadkyqhpmatlcpdckbmtxybhklenxdleegqdymsawhzmljtwygxlyqzljeeyybqqffnlyxrdsctgjgxyynkllyqkcctlhjlqmkkzgcyygllljdzgydhzwxpysjbzkdzgyzzhywyfqytyzszyezzlymhjjhtsmqwyzlkyywzcsrkqytltdxwctyjklwsqzwbdcqyncjsrszjlkcdcdtlzzzacqqzzddxyplxzbqjylzlllqddzqjyjyjzyxnyyynyjxkxdazwyrdljyyyrjlxlldyxjcywywnqcclddnyyynyckczhxxcclgzqjgkwppcqqjysbzzxyjsqpxjpzbsbdsfnsfpzxhdwztdwpptflzzbzdmyypqjrsdzsqzsqxbdgcpzswdwcsqzgmdhzxmwwfybpdgphtmjthzsmmbgzmbzjcfzwfzbbzmqcfmbdmcjxlgpnjbbxgyhyyjgptzgzmqbqtcgyxjxlwzkydpdymgcftpfxyztzxdzxtgkmtybbclbjaskytssqyymszxfjewlxllszbqjjjaklylxlycctsxmcwfkkkbsxlllljyxtyltjyytdpjhnhnnkbyqnfqyyzbyyessessgdyhfhwtcjbsdzztfdmxhcnjzymqwsryjdzjqpdqbbstjggfbkjbxtgqhngwjxjgdllthzhhyyyyyysxwtyyyccbdbpypzycczyjpzywcbdlfwzcwjdxxhyhlhwzzxjtczlcdpxujczzzlyxjjtxphfxwpywxzptdzzbdzcyhjhmlxbqxsbylrdtgjrrcttthytczwmxfytwwzcwjwxjywcskybzscctzqnhxnwxxkhkfhtswoccjybcmpzzykbnnzpbzhhzdlsyddytyfjpxyngfxbyqxcbhxcpsxtyzdmkysnxsxlhkmzxlyhdhkwhxxsskqyhhcjyxglhzxcsnhekdtgzxqypkdhextykcnymyyypkqyyykxzlthjqtbyqhxbmyhsqckwwyllhcyylnneqxqwmcfbdccmljggxdqktlxkgnqcdgzjwyjjlyhhqtttnwchmxcxwhwszjydjccdbqcdgdnyxzthcqrxcbhztqcbxwgqwyybxhmbymyqtyexmqkyaqyrgyzslfykkqhyssqyshjgjcnxkzycxsbxyxhyylstycxqthysmgscpmmgcccccmtztasmgqzjhklosqylswtmxsyqkdzljqqyplsycztcqqpbbqjzclpkhqzyyxxdtddtsjcxffllchqxmjlwcjcxtspycxndtjshjwxdqqjskxyamylsjhmlalykxcyydmnmdqmxmcznncybzkkyflmchcmlhxrcjjhsylnmtjzgzgywjxsrxcwjgjqhqzdqjdcjjzkjkgdzqgjjyjylxzxxcdqhhheytmhlfsbdjsyyshfystczqlpbdrfrztzykywhszyqkwdqzrkmsynbcrxqbjyfazpzzedzcjywbcjwhyjbqszywryszptdkzpfpbnztklqyhbbzpnpptyzzybqnydcpjmmcycqmcyfzzdcmnlfpbplngqjtbttnjzpzbbznjkljqylnbzqhksjznggqszzkyxshpzsnbcgzkddzqanzhjkdrtlzlswjljzlywtjndjzjhxyayncbgtzcssqmnjpjytyswxzfkwjqtkhtzplbhsnjzsyzbwzzzzlsylsbjhdwwqpslmmfbjdwaqyztcjtbnnwzxqxcdslqgdsdpdzhjtqqpswlyyjzlgyxyzlctcbjtktyczjtqkbsjlgmgzdmcsgpynjzyqyyknxrpwszxmtncszzyxybyhyzaxywqcjtllckjjtjhgdxdxyqyzzbywdlwqcglzgjgqrqzczssbcrpcskydznxjsqgxssjmydnstztpbdltkzwxqwqtzexnqczgwezkssbybrtssslccgbpszqszlccglllzxhzqthczmqgyzqznmcocszjmmzsqpjygqljyjppldxrgzyxccsxhshgtznlzwzkjcxtcfcjxlbmqbczzwpqdnhxljcthyzlgylnlszzpcxdscqqhjqksxzpbajyemsmjtzdxlcjyryynwjbngzztmjxltbslyrzpylsscnxphllhyllqqzqlxymrsycxzlmmczltzsdwtjjllnzggqxpfskygyghbfzpdkmwghcxmsgdxjmcjzdycabxjdlnbcdqygskydqtxdjjyxmszqazdzfslqxyjsjzylbtxxwxqqzbjzufbblylwdsljhxjyzjwtdjczfqzqzzdzsxzzqlzcdzfjhyspympqzmlpplffxjjnzzylsjeyqzfpfzksywjjjhrdjzzxtxxglghydxcskyswmmzcwybazbjkshfhjcxmhfqhyxxyzftsjyzfxyxpzlchmzmbxhzzsxyfymncwdabazlxktcshhxkxjjzjsthygxsxyyhhhjwxkzxssbzzwhhhcwtzzzpjxsnxqqjgzyzywllcwxzfxxyxyhxmkyyswsqmnlnaycyspmjkhwcqhylajjmzxhmmcnzhbhxclxtjpltxyjhdyylttxfszhyxxsjbjyayrsmxyplckduyhlxrlnllstyzyyqygyhhsccsmzctzqxkyqfpyyrpfflkquntszllzmwwtcqqyzwtllmlmpwmbzsstzrbpddtlqjjbxzcsrzqqygwcsxfwzlxccrszdzmcyggdzqsgtjswljmymmzyhfbjdgyxccpshxnzcsbsjyjgjmppwaffyfnxhyzxzylremzgzcyzsszdlljcsqfnxzkptxzgxjjgfmyyysnbtylbnlhpfzdcyfbmgqrrssszxysgtzrnydzzcdgpjafjfzknzblczszpsgcycjszlmlrszbzzldlsllysxsqzqlyxzlskkbrxbrbzcycxzzzeeyfgklzlyyhgzsgzlfjhgtgwkraajyzkzqtsshjjxdcyzuyjlzyrzdqqhgjzxsszbykjpbfrtjxllfqwjhylqtymblpzdxtzygbdhzzrbgxhwnjtjxlkscfsmwlsdqysjtxkzscfwjlbxftzlljzllqblsqmqqcgczfpbphzczjlpyyggdtgwdcfczqyyyqyssclxzsklzzzgffcqnwglhqyzjjczlqzzyjpjzzbpdccmhjgxdqdgdlzqmfgpsytsdyfwwdjzjysxyyczcyhzwpbykxrylybhkjksfxtzjmmckhlltnyymsyxyzpyjqycsycwmtjjkqyrhllqxpsgtlyycljscpxjyzfnmlrgjjtyzbxyzmsjyjhhfzqmsyxrszcwtlrtqzsstkxgqkgsptgcznjsjcqcxhmxggztqydjkzdlbzsxjlhyqgggthqszpyhjhhgyygkggcwjzzylczlxqsftgzslllmljskctbllzzszmmnytpzsxqhjcjyqxyzxzqzcpshkzzysxcdfgmwqrllqxrfztlystctmjcxjjxhjnxtnrztzfqyhqgllgcxszsjdjljcydsjtlnyxhszxcgjzyqpylfhdjsbpcczhjjjqzjqdybssllcmyttmqtbhjqnnygkyrqyqmzgcjkpdcgmyzhqllsllclmholzgdyyfzsljcqzlylzqjeshnylljxgjxlysyyyxnbzljsszcqqcjyllzltjyllzllbnylgqchxyyxoxcxqkyjxxxyklxsxxyqxcykqxqcsgyxxyqxygytqohxhxpyxxxulcyeychzzcbwqbbwjqzscszsslzylkdesjzwmymcytsdsxxscjpqqsqylyyzycmdjdzywcbtjsydjkcyddjlbdjjsodzysyxqqyxdhhgqqyqhdyxwgmmmajdybbbppbcmuupljzsmtxerxjmhqnutpjdcbssmssstkjtssmmtrcplzszmlqdsdmjmqpnqdxcfynbfsdqxyxhyaykqyddlqyyysszbydslntfqtzqpzmchdhczcwfdxtmyqsphqyyxsrgjcwtjtzzqmgwjjtjhtqjbbhwzpxxhyqfxxqywyyhyscdydhhqmnmtmwcpbszppzzglmzfollcfwhmmsjzttdhzzyffytzzgzyskyjxqyjzqbhmbzzlyghgfmshpzfzsnclpbqsnjxzslxxfpmtyjygbxlldlxpzjyzjyhhzcywhjylsjexfszzywxkzjluydtmlymqjpwxyhxsktqjezrpxxzhhmhwqpwqlyjjqjjzszcphjlchhnxjlqwzjhbmzyxbdhhypzlhlhlgfwlchyytlhjxcjmscpxstkpnhqxsrtyxxtesyjctlsslstdlllwwyhdhrjzsfgxtsyczynyhtdhwjslhtzdqdjzxxqhgyltzphcsqfclnjtclzpfstpdynylgmjllycqhysshchylhqyqtmzypbywrfqykqsyslzdqjmpxyyssrhzjnywtqdfzbwwtwwrxcwhgyhxmkmyyyqmsmzhngcepmlqqmtcwctmmpxjpjjhfxyyzsxzhtybmstsyjttqqqyylhynpyqzlcyzhzwsmylkfjxlwgxypjytysyxymzckttwlksmzsylmpwlzwxwqzssaqsyxyrhssntsrapxcpwcmgdxhxzdzyfjhgzttsbjhgyzszysmyclllxbtyxhbbzjkssdmalxhycfygmqypjycqxjllljgslzgqlycjcczotyxmtmttllwtgpxymzmklpszzzxhkqysxctyjzyhxshyxzkxlzwpsqpyhjwpjpwxqqylxsdhmrslzzyzwttcyxyszzshbsccstplwsscjchnlcgchssphylhfhhxjsxyllnylszdhzxylsxlwzykcldyaxzcmddyspjtqjzlnwqpssswctstszlblnxsmnyymjqbqhrzwtyydchqlxkpzwbgqybkfcmzwpzllyylszydwhxpsbcmljbscgbhxlqhyrljxyswxwxzsldfhlslynjlzyflyjycdrjlfsyzfsllcqyqfgjyhyxzlylmstdjcyhbzllnwlxxygyyhsmgdhxxhhlzzjzxczzzcyqzfngwpylcpkpyypmclqkdgxzggwqbdxzzkzfbxxlzxjtpjpttbytszzdwslchzhsltyxhqlhyxxxyyzyswtxzkhlxzxzpyhgchkcfsyhutjrlxfjxptztwhplyxfcrhxshxkyxxyhzqdxqwulhyhmjtbflkhtxcwhjfwjcfpqryqxcyyyqygrpywsgsungwchkzdxyflxxhjjbyzwtsxxncyjjymswzjqrmhxzwfqsylzjzgbhynslbgttcsybyxxwxyhxyyxnsqyxmqywrgyqlxbbzljsylpsytjzyhyzawlrorjmksczjxxxyxchdyxryxxjdtsqfxlyltsffyxlmtyjmjuyyyxltzcsxqzqhzxlyyxzhdnbrxxxjctyhlbrlmbrllaxkyllljlyxxlycrylcjtgjcmtlzllcyzzpzpcyawhjjfybdyyzsmpckzdqyqpbpcjpdcyzmdpbcyydycnnplmtmlrmfmmgwyzbsjgygsmzqqqztxmkqwgxllpjgzbqcdjjjfpkjkcxbljmswmdtqjxldlppbxcwrcqfbfqjczahzgmykphyyhzykndkzmbpjyxpxyhlfpnyygxjdbkxnxhjmzjxstrstldxskzysybzxjlxyslbzyslhxjpfxpqnbylljqkygzmcyzzymccslclhzfwfwyxzmwsxtynxjhpyymcyspmhysmydyshqyzchmjjmzcaagcfjbbhplyzylxxsdjgxdhkxxtxxnbhrmlyjsltxmrhnlxqjxyzllyswqgdlbjhdcgjyqycmhwfmjybmbyjyjwymdpwhxqldygpdfxxbcgjspckrssyzjmslbzzjfljjjlgxzgyxyxlszqyxbexyxhgcxbpldyhwettwwcjmbtxchxyqxllxflyxlljlssfwdpzsmyjclmwytczpchqekcqbwlcqydplqppqzqfjqdjhymmcxtxdrmjwrhxcjzylqxdyynhyyhrslsrsywwzjymtltllgtqcjzyabtckzcjyccqljzqxalmzyhywlwdxzxqdllqshgpjfjljhjabcqzdjgtkhsstcyjlpswzlxzxrwgldlzrlzxtgsllllzlyxxwgdzygbdphzpbrlwsxqbpfdwofmwhlypcbjccldmbzpbzzlcyqxldomzblzwpdwyygdstthcsqsccrsssyslfybfntyjszdfndpdhdzzmbblslcmyffgtjjqwftmtpjwfnlbzcmmjtgbdzlqlpyfhyymjylsdchdzjwjcctljcldtljjcpddsqdsszybndbjlggjzxsxnlycybjxqycbylzcfzppgkcxzdzfztjjfjsjxzbnzyjqttyjyhtyczhymdjxttmpxsplzcdwslshxypzgtfmlcjtycbpmgdkwycyzcdszzyhflyctygwhkjyylsjcxgywjcbllcsnddbtzbsclyzczzssqdllmqyyhfslqllxftyhabxgwnywyypllsdldllbjcyxjzmlhljdxyyqytdlllbugbfdfbbqjzzmdpjhgclgmjjpgaehhbwcqxaxhhhzchxyphjaxhlphjpgpzjqcqzgjjzzuzdmqyybzzphyhybwhazyjhykfgdpfqsdlzmljxkxgalxzdaglmdgxmwzqyxxdxxpfdmmssympfmdmmkxksyzyshdzkxsysmmzzzmsydnzzczxfplstmzdnmxckjmztyymzmzzmsxhhdczjemxxkljstlwlsqlyjzllzjssdppmhnlzjczyhmxxhgzcjmdhxtkgrmxfwmcgmwkdtksxqmmmfzzydkmsclcmpcgmhspxqpzdsslcxkyxtwlwjyahzjgzqmcsnxyymmpmlkjxmhlmlqmxctkzmjqyszjsyszhsyjzjcdajzybsdqjzgwzqqxfkdmsdjlfwehkzqkjpeypzyszcdwyjffmzzylttdzzefmzlbnpplplpepszalltylkckqzkgenqlwagyxydpxlhsxqqwqcqxqclhyxxmlyccwlymqyskgchlcjnszkpyzkcqzqljpdmdzhlasxlbydwqlwdnbqcryddztjybkbwszdxdtnpjdtctqdfxqqmgnxeclttbkpwslctyqlpwyzzklpygzcqqpllkccylpqmzczqcljslqzdjxlddhpzqdljjxzqdxyzqkzljcyqdyjppypqykjyrmpcbymcxkllzllfqpylllmbsglcysslrsysqtmxyxzqzfdzuysyztffmzzsmzqhzssccmlyxwtpzgxzjgzgsjsgkddhtqggzllbjdzlcbchyxyzhzfywxyzymsdbzzyjgtsmtfxqyxqstdgslnxdlryzzlryylxqhtxsrtzngzxbnqqzfmykmzjbzymkbpnlyzpblmcnqyzzzsjzhjctzkhyzzjrdyzhnpxglfztlkgjtctssyllgzrzbbqzzklpklczyssuyxbjfpnjzzxcdwxzyjxzzdjjkggrsrjkmsmzjlsjywqskyhqjsxpjzzzlsnshrnypztwchklpsrzlzxyjqxqkysjycztlqzybbybwzpqdwwyzcytjcjxckcwdkkzxsgkdzxwwyyjqyytcytdllxwkczkklcclzcqqdzlqlcsfqchqhsfsmqzzlnbjjzbsjhtszdysjqjpdlzcdcwjkjzzlpycgmzwdjjbsjqzsyzyhhxjpbjydssxdzncglqmbtsfsbpdzdlznfgfjgfsmpxjqlmblgqcyyxbqkdjjqyrfkztjdhczklbsdzcfjtplljgxhyxzcsszzxstjygkgckgyoqxjplzpbpgtgyjzghzqzzlbjlsqfzgkqqjzgyczbzqtldxrjxbsxxpzxhyzyclwdxjjhxmfdzpfzhqhqmqgkslyhtycgfrzgnqxclpdlbzcsczqlljblhbzcypzzppdymzzsgyhckcpzjgsljlnscdsldlxbmstlddfjmkdjdhzlzxlszqpqpgjllybdszgqlbzlslkyyhzttntjyqtzzpszqztlljtyyllqllqyzqlbdzlslyyzymdfszsnhlxznczqzpbwskrfbsyzmthblgjpmczzlstlxshtcsyzlzblfeqhlxflcjlyljqcbzlzjhhsstbrmhxzhjzclxfnbgxgtqjcztmsfzkjmssnxljkbhsjxntnlzdntlmsjxgzjyjczxyjyjwrwwqnztnfjszpzshzjfyrdjsfszjzbjfzqzzhzlxfysbzqlzsgyftzdcszxzjbqmszkjrhyjzckmjkhchgtxkxqglxpxfxtrtylxjxhdtsjxhjzjxzwzlcqsbtxwxgxtxxhxftsdkfjhzyjfjxrzsdllltqsqqzqwzxsyqtwgwbzcgzllyzbclmqqtzhzxzxljfrmyzflxysqxxjkxrmqdzdmmyybsqbhgzmwfwxgmxlzpyytgzyccdxyzxywgsyjyznbhpzjsqsyxsxrtfyzgrhztxszzthcbfclsyxzlzqmzlmplmxzjxsflbyzmyqhxjsxrxsqzzzsslyfrczjrcrxhhzxqydyhxsjjhzcxzbtynsysxjbqlpxzqpymlxzkyxlxcjlcysxxzzlxdllljjyhzxgyjwkjrwyhcpsgnrzlfzwfzznsxgxflzsxzzzbfcsyjdbrjkrdhhgxjljjtgxjxxstjtjxlyxqfcsgswmsbctlqzzwlzzkxjmltmjyhsddbxgzhdlbmyjfrzfsgclyjbpmlysmsxlszjqqhjzfxgfqfqbpxzgyyqxgztcqwyltlgwsgwhrlfsfgzjmgmgbgtjfsyzzgzyzaflsspmlpflcwbjzcljjmzlpjjlymqdmyyyfbgygyzmlyzdxqyxrqqqhsyyyqxyljtyxfsfsllgnqcyhycwfhcccfxpylypllzyxxxxxkqhhxshjzcfzsczjxcpzwhhhhhapylqalpqafyhxdylukmzqgggddesrnnzltzgchyppysqjjhclljtolnjpzljlhymheydydsqycddhgzundzclzyzllzntnyzgslhslpjjbdgwxpcdutjcklkclwkllcasstkzzdnqnttlyyzssysszzryljqkcqdhhcrxrzydgrgcwcgzqfffppjfzynakrgywyqpqxxfkjtszzxswzddfbbxtbgtzkznpzzpzxzpjszbmqhkcyxyldkljnypkyghgdzjxxeahpnzkztzcmxcxmmjxnkszqnmnlwbwwxjkyhcpstmcsqtzjyxtpctpdtnnpglllzsjlspblplqhdtnjnlyyrszffjfqwdphzdwmrzcclodaxnssnyzrestyjwjyjdbcfxnmwttbylwstszgybljpxglboclhpcbjltmxzljylzxcltpnclckxtpzjswcyxsfyszdkntlbyjcyjllstgqcbxryzxbxklylhzlqzlnzcxwjzljzjncjhxmnzzgjzzxtzjxycyycxxjyyxjjxsssjstssttppgqtcsxwzdcsyfptfbfhfbblzjclzzdbxgcxlqpxkfzflsyltuwbmqjhszbmddbcysccldxycddqlyjjwmqllcsgljjsyfpyyccyltjantjjpwycmmgqyysxdxqmzhszxpftwwzqswqrfkjlzjqqyfbrxjhhfwjjzyqazmyfrhcyybyqwlpexcczstyrlttdmqlykmbbgmyyjprkznpbsxyxbhyzdjdnghpmfsgmwfzmfqmmbcmzzcjjlcnuxyqlmlrygqzcyxzlwjgcjcggmcjnfyzzjhycprrcmtzqzxhfqgtjxccjeaqcrjyhplqlszdjrbcqhqdyrhylyxjsymhzydwldfryhbpydtsscnwbxglpzmlzztqsscpjmxxycsjytycghycjwyrxxlfemwjnmkllswtxhyyyncmmcwjdqdjzglljwjrkhpzggflccsczmcbltbhbqjxqdspdjzzgkglfqywbzyzjltstdhqhctcbchflqmpwdshyytqwcnzzjtlbymbpdyyyxsqkxwyyflxxncwcxypmaelykkjmzzzbrxyyqjfljpfhhhytzzxsgqqmhspgdzqwbwpjhzjdyscqwzktxxsqlzyymysdzgrxckkujlwpysyscsyzlrmlqsyljxbcxtlwdqzpcycykpppnsxfyzjjrcemhszmsxlxglrwgcstlrsxbzgbzgztcplujlslylymtxmtzpalzxpxjtjwtcyyzlblxbzlqmylxpghdslssdmxmbdzzsxwhamlczcpjmcnhjysnsygchskqmzzqdllkablwjxsfmocdxjrrlyqzkjmybyqlyhetfjzfrfksryxfjtwdsxxsysqjyslyxwjhsnlxyyxhbhawhhjzxwmyljcsslkydztxbzsyfdxgxzjkhsxxybssxdpynzwrptqzczenygcxqfjykjbzmljcmqqxuoxslyxxlylljdzbtymhpfsttqqwlhokyblzzalzxqlhzwrrqhlstmypyxjjxmqsjfnbxyxyjxxyqylthylqyfmlkljtmllhszwkzhljmlhljkljstlqxylmbhhlnlzxqjhxcfxxlhyhjjgbyzzkbxscqdjqdsujzyyhzhhmgsxcsymxfebcqwwrbpyyjqtyzcyqyqqzyhmwffhgzfrjfcdpxntqyzpdykhjlfrzxppxzdbbgzqstlgdgylcqmlchhmfywlzyxkjlypqhsywmqqgqzmlzjnsqxjqsyjycbehsxfszpxzwfllbcyyjdytdthwzsfjmqqyjlmqxxlldttkhhybfpwtyysqqwnqwlgwdebzwcmygculkjxtmxmyjsxhybrwfymwfrxyqmxysztzztfykmldhqdxwyynlcryjblpsxcxywlsprrjwxhqyphtydnxhhmmywytzcsqmtssccdalwztcpqpyjllqzyjswxmzzmmylmxclmxczmxmzsqtzppqqblpgxqzhfljjhytjsrxwzxsccdlxtyjdcqjxslqyclzxlzzxmxqrjmhrhzjbhmfljlmlclqnldxzlllpypsyjysxcqqdcmqjzzxhnpnxzmekmxhykyqlxsxtxjyyhwdcwdzhqyybgybcyscfgpsjnzdyzzjzxrzrqjjymcanyrjtldppyzbstjkxxzypfdwfgzzrpymtngxzqbyxnbufnqkrjqzmjegrzgyclkxzdskknsxkcljspjyyzlqqjybzssqlllkjxtbktylccddblsppfylgydtzjyqggkqttfzxbdktyyhybbfytyybclpdytgdhryrnjsptcsnyjqhklllzslydxxwbcjqspxbpjzjcjdzffxxbrmlazhcsndlbjdszblprztswsbxbcllxxlzdjzsjpylyxxyftfffbhjjxgbyxjpmmmpssjzjmtlyzjxswxtyledqpjmygqzjgdjlqjwjqllsjgjgygmscljjxdtygjqjqjcjzcjgdzzsxqgsjggcxhqxsnqlzzbxhsgzxcxyljxyxyydfqqjhjfxdhctxjyrxysqtjxyefyyssyyjxncyzxfxmsyszxyyschshxzzzgzzzgfjdltylnpzgyjyzyyqzpbxqbdztzczyxxyhhsqxshdhgqhjhgywsztmzmlhyxgebtylzkqwytjzrclekystdbcykqqsayxcjxwwgsbhjyzydhcsjkqcxswxfltynyzpzcczjqtzwjqdzzzqzljjxlsbhpyxxpsxshheztxfptlqyzzxhytxncfzyyhxgnxmywxtzsjpthhgymxmxqzxtsbczyjyxxtyyzypcqlmmszmjzzllzxgxzaajzyxjmzxwdxzsxzdzxleyjjzqbhzwzzzqtzpsxztdsxjjjznyazphxyysrnqdthzhyykyjhdzxzlswclybzyecwcycrylcxnhzydzydyjdfrjjhtrsqtxyxjrjhojynxelxsfsfjzghpzsxzszdzcqzbyyklsgsjhczshdgqgxyzgxchxzjwyqwgyhksseqzzndzfkwysstclzstsymcdhjxxyweyxczaydmpxmdsxybsqmjmzjmtzqlpjyqzcgqhxjhhlxxhlhdldjqcldwbsxfzzyyschtytyybhecxhykgjpxhhyzjfxhwhbdzfyzbcapnpgnydmsxhmmmmamynbyjtmpxyymcthjbzyfcgtyhwphftwzzezsbzegpfmtskftycmhfllhgpzjxzjgzjyxzsbbqsczzlzccstpgxmjsftcczjzdjxcybzlfcjsyzfgszlybcwzzbyzdzypswyjzxzbdsyuxlzzbzfygczxbzhzftpbgzgejbstgkdmfhyzzjhzllzzgjqzlsfdjsscbzgpdlfzfzszyzyzsygcxsnxxchczxtzzljfzgqsqyxzjqdccztqcdxzjyqjqchxztdlgscxzsyqjqtzwlqdqztqchqqjzyezzzpbwkdjfcjpztypqyqttynlmbdktjzpqzqzzfpzsbnjlgyjdxjdzzkzgqkxdlpzjtcjdqbxdjqjstcknxbxzmslyjcqmtjqwwcjqnjnlllhjcwqtbzqydzczpzzdzyddcyzzzccjttjfzdprrtztjdcqtqzdtjnplzbcllctzsxkjzqzpzlbzrbtjdcxfczdbccjjltqqpldcgzdbbzjcqdcjwynllzyzccdwllxwzlxrxntqqczxkqlsgdfqtddglrlajjtkuymkqlltzytdyyczgjwyxdxfrskstqtenqmrkqzhhqkdldazfkypbggpzrebzzykzzspegjxgykqzzzslysyyyzwfqzylzzlzhwchkypqgnpgblplrrjyxccsyyhsfzfybzyytgzxylxczwxxzjzblfflgskhyjzeyjhlpllllczgxdrzelrhgklzzyhzlyqszzjzqljzflnbhgwlczcfjyspyxzlzlxgccpzbllcybbbbubbcbpcrnnzczyrbfsrldcgqyyqxygmqzwtzytyjxyfwtehzzjywlccntzyjjzdedpzdztsyqjhdymbjnyjzlxtsstphndjxxbyxqtzqddtjtdyytgwscszqflshlglbczphdlyzjyckwtytylbnytsdsycctyszyyebhexhqdtwnygyclxtszystqmygzazccszzdslzclzrqxyyeljsbymxsxztembbllyyllytdqyshymrqwkfkbfxnxsbychxbwjyhtqbpbsbwdzylkgzskyhxqzjxhxjxgnljkzlyycdxlfyfghljgjybxqlybxqpqgztzplncypxdjyqydymrbesjyyhkxxstmxrczzywxyqybmcllyzhqyzwqxdbxbzwzmslpdmyskfmzklzcyqyczlqxfzzydqzpzygyjyzmzxdzfyfyttqtzhgspczmlccytzxjcytjmkslpzhysnzllytpzctzzcktxdhxxtqcyfksmqccyyazhtjpcylzlyjbjxtpnyljyynrxsylmmnxjsmybcsysylzylxjjqyldzlpqbfzzblfndxqkczfywhgqmrdsxycytxnqqjzyypfzxdyzfprxejdgyqbxrcnfyyqpghyjdyzxgrhtkylnwdzntsmpklbthbpyszbztjzszzjtyyxzphsszzbzczptqfzmyflypybbjqxzmxxdjmtsyskkbjzxhjcklpsmkyjzcxtmljyxrzzqslxxqpyzxmkyxxxjcljprmyygadyskqlsndhyzkqxzyztcghztlmlwzybwsyctbhjhjfcwztxwytkzlxqshlyjzjxtmplpycgltbzztlzjcyjgdtclklpllqpjmzpapxyzlkktkdzczzbnzdydyqzjyjgmctxltgxszlmlhbglkfwnwzhdxuhlfmkyslgxdtwwfrjejztzhydxykshwfzcqshktmqqhtzhymjdjskhxzjzbzzxympagqmstpxlsklzynwrtsqlszbpspsgzwyhtlkssswhzzlyytnxjgmjszsufwnlsoztxgxlsammlbwldszylakqcqctmycfjbslxclzzclxxksbzqclhjpsqplsxxckslnhpsfqqytxyjzlqldxzqjzdyydjnzptuzdskjfsljhylzsqzlbtxydgtqfdbyazxdzhzjnhhqbyknxjjqczmlljzkspldyclbblxklelxjlbqycxjxgcnlcqplzlzyjtzljgyzdzpltqcsxfdmnycxgbtjdcznbgbqyqjwgkfhtnpyqzqgbkpbbyzmtjdytblsqmpsxtbnpdxklemyycjynzctldykzzxddxhqshdgmzsjycctayrzlpyltlkxslzcggexclfxlkjrtlqjaqzncmbydkkcxglczjzxjhptdjjmzqykqsecqzdshhadmlzfmmzbgntjnnlgbyjbrbtmlbyjdzxlcjlpldlpcqdhlxzlycblcxzzjadjlnzmmsssmybhbsqkbhrsxxjmxsdznzpxlgbrhwggfcxgmsklltsjyycqltskywyyhywxbxqywpywykqlsqptntkhqcwdqktwpxxhcpthtwumssyhbwcrwxhjmkmzngwtmlkfghkjylsyycxwhyeclqhkqhttqkhfzldxqwyzyydesbpkyrzpjfyyzjceqdzzdlatzbbfjllcxdlmjssxegygsjqxcwbxsszpdyzcxdnyxppzydlyjczpltxlsxyzyrxcyyydylwwnzsahjsyqyhgywwaxtjzdaxysrltdpssyyfnejdxyzhlxlllzqzsjnyqyqqxyjghzgzcyjchzlycdshwshjzyjxcllnxzjjyyxnfxmwfpylcyllabwddhwdxjmcxztzpmlqzhsfhzynztlldywlslxhymmylmbwwkyxyadtxylldjpybpwuxjmwmllsafdllyflbhhhbqqltzjcqjldjtffkmmmbythygdcqrddwrqjxnbysnwzdbyytbjhpybyttjxaahgqdqtmystqxkbtzpkjlzrbeqqssmjjbdjotgtbxpgbktlhqxjjjcthxqdwjlwrfwqgwshckryswgftgygbxsdwdwrfhwytjjxxxjyzyslpyyypayxhydqkxshxyxgskqhywfdddpplcjlqqeewxksyykdypltjthkjltcyyhhjttpltzzcdlthqkzxqysteeywyyzyxxyysttjkllpzmcyhqgxyhsrmbxpllnqydqhxsxxwgdqbshyllpjjjthyjkyppthyyktyezyenmdshlcrpqfdgfxzpsftljxxjbswyysksflxlpplbbblbsfxfyzbsjssylpbbffffsscjdstzsxzryysyffsyzyzbjtbctsbsdhrtjjbytcxyjeylxcbnebjdsyxykgsjzbxbytfzwgenyhhthzhhxfwgcstbgxklsxywmtmbyxjstzscdyqrcytwxzfhmymcxlznsdjtttxrycfyjsbsdyerxjljxbbdeynjghxgckgscymblxjmsznskgxfbnbpthfjaafxyxfpxmypqdtzcxzzpxrsywzdlybbktyqpqjpzypzjznjpzjlzzfysbttslmptzrtdxqsjehbzylzdhljsqmlhtxtjecxslzzspktlzkqqyfsygywpcpqfhqhytqxzkrsgttsqczlptxcdyyzxsqzslxlzmycpcqbzyxhbsxlzdltcdxtylzjyyzpzyzltxjsjxhlpmytxcqrblzssfjzztnjytxmyjhlhpplcyxqjqqkzzscpzkswalqsblcczjsxgwwwygyktjbbztdkhxhkgtgpbkqyslpxpjckbmllxdzstbklggqkqlsbkktfxrmdkbftpzfrtbbrferqgxyjpzsstlbztpszqzsjdhljqlzbpmsmmsxlqqnhknblrddnxxdhddjcyygylxgzlxsygmqqgkhbpmxyxlytqwlwgcpbmqxcyzydrjbhtdjyhqshtmjsbyplwhlzffnypmhxxhpltbqpfbjwqdbygpnztpfzjgsddtqshzeawzzylltyybwjkxxghlfkxdjtmszsqynzggswqsphtlsskmclzxyszqzxncjdqgzdlfnykljcjllzlmzznhydsshthzzlzzbbhqzwwycrzhlyqqjbeyfxxxwhsrxwqhwpslmsskzttygyqqwrslalhmjtqjsmxqbjjzjxzyzkxbyqxbjxshztsfjlxmxzxfghkzszggylclsarjyhslllmzxelglxydjytlfbhbpnlyzfbbhptgjkwetzhkjjxzxxglljlstgshjjyqlqzfkcgnndjsszfdbctwwseqfhqjbsaqtgypqlbxbmmywxgslzhglzgqyflzbyfzjfrysfmbyzhqgfwzsyfyjjphzbyyzffwodgrlmftwlbzgycqxcdjygzyyyytytydwegazyhxjlzyyhlrmgrxxzclhneljjtjtpwjybjjbxjjtjteekhwsljplpsfyzpqqbdlqjjtyyqlyzkdksqjyyqzldqtgjqyzjsucmryqthtejmfctyhypkmhyzwjdqfhyyxwshctxrljhqxhccyyyjltkttytmxgtcjtzayyoczlylbszywjytsjyhbyshfjlygjxxtmzyyltxxypzlxyjzyzyypnhmymdyylblhlsyyqqllnjjymsoyqbzgdlyxylcqyxtszegxhzglhwbljheyxtwqmakbpqcgyshhegqcmwyywljyjhyyzlljjylhzyhmgsljljxcjjyclycjpcpzjzjmmylcqlnqljqjsxyjmlszljqlycmmhcfmmfpqqmfylqmcffqmmmmhmznfhhjgtthhkhslnchhyqdxtmmqdcyzyxyqmyqyltdcyyyzazzcymzydlzfffmmycqzwzzmabtbyztdmnzzggdftypcgqyttssffwfdtzqssystwxjhxytsxxylbyqhwwkxhzxwznnzzjzjjqjccchyyxbzxzcyztllcqxynjycyycynzzqyyyewyczdcjycchyjlbtzyycqwmpwpymlgkdldlgkqqbgychjxy"),$string._pinyinMap||($string._pinyinMap={19969:"dz",19975:"wm",19988:"qj",20048:"ly",20056:"cs",20060:"mn",20094:"qg",20127:"qj",20167:"cq",20193:"yg",20250:"hk",20256:"cz",20282:"cs",20285:"jgq",20291:"dt",20314:"yd",20340:"ne",20375:"dt",20389:"jy",20391:"cz",20415:"bp",20446:"ys",20447:"sq",20504:"tc",20608:"kg",20854:"qj",20857:"zc",20911:"fp",20504:"tc",20608:"kg",20854:"qj",20857:"zc",20985:"aw",21032:"pb",21048:"qx",21049:"cs",21089:"ys",21119:"jc",21242:"sb",21273:"sc",21305:"py",21306:"qo",21330:"zc",21333:"dcs",21345:"kq",21378:"ca",21397:"cs",21414:"sx",21442:"cs",21477:"jg",21480:"dt",21484:"zs",21494:"yx",21505:"yx",21512:"hg",21523:"xh",21537:"pb",21542:"fp",21549:"kh",21574:"da",21588:"td",21618:"zc",21621:"kha",21632:"jz",21654:"gk",21679:"lkg",21683:"kh",21719:"hy",21734:"woe",21780:"wn",21804:"hx",21899:"dz",21903:"nr",21908:"wo",21939:"zc",21956:"sa",21964:"ya",21970:"td",22031:"jg",22040:"xs",22060:"zc",22066:"cz",22079:"hm",22129:"xj",22179:"xa",22237:"nj",22244:"td",22280:"qj",22300:"yh",22313:"xw",22331:"yq",22343:"jy",22351:"hp",22395:"dc",22412:"td",22484:"pb",22500:"pb",22534:"dz",22549:"dh",22561:"bp",22612:"td",22771:"kq",22831:"hb",22841:"jg",22855:"qj",22865:"qx",23013:"lm",23081:"mw",23487:"sx",23558:"jq",23561:"wy",23586:"yw",23614:"wy",23615:"ns",23631:"pb",23646:"sz",23663:"tz",23673:"yg",23762:"dt",23769:"zs",23780:"qj",23884:"qk",24055:"xh",24113:"dc",24162:"cz",24191:"ga",24273:"qj",24324:"nl",24377:"td",24378:"qj",24439:"pf",24554:"zs",24683:"td",24694:"ew",24733:"lk",24925:"tn",25094:"zg",25100:"xq",25103:"xh",25153:"bp",25170:"bp",25179:"kg",25203:"bp",25240:"zs",25282:"fb",25303:"na",25324:"kg",25341:"zy",25373:"wz",25375:"xj",25528:"sd",25530:"cs",25552:"td",25774:"cz",25874:"zc",26044:"yw",26080:"wm",26292:"bp",26333:"pb",26355:"zy",26366:"cz",26397:"cz",26399:"qj",26415:"sz",26451:"sb",26526:"cz",26552:"jg",26561:"td",26588:"gj",26597:"cz",26629:"zs",26638:"ly",26646:"qx",26653:"kg",26657:"xj",26727:"gh",26894:"zc",26937:"zs",26946:"zc",26999:"kj",27099:"kj",27449:"yq",27481:"xs",27542:"zs",27663:"zs",27748:"ts",27784:"sc",27788:"zd",27795:"td",27850:"bp",27852:"mb",27895:"ls",27898:"lp",27973:"qj",27981:"kh",27986:"hx",27994:"xj",28044:"yc",28065:"wg",28177:"sm",28267:"qj",28291:"kh",28337:"zq",28463:"tl",28548:"dc",28601:"td",28689:"pb",28805:"jg",28820:"qg",28846:"pb",28952:"td",28975:"zc",29325:"qj",29575:"sl",29602:"fb",30010:"td",30044:"cx",30058:"pf",30091:"ysp",30111:"yn",30229:"xj",30427:"sc",30465:"sx",30631:"qy",30655:"qj",30684:"qjg",30707:"sd",30729:"xh",30796:"lg",30917:"bp",31074:"mn",31085:"jz",31109:"cs",31181:"zc",31192:"mlb",31293:"jq",31400:"yx",31584:"jy",31896:"zn",31909:"zy",31995:"xj",32321:"fp",32327:"yz",32418:"hg",32420:"xq",32421:"hg",32438:"lg",32473:"gj",32488:"dt",32521:"jq",32527:"pb",32562:"zsq",32564:"jz",32735:"zd",32793:"pb",33071:"pf",33098:"lx",33100:"ya",33152:"bp",33261:"cx",33324:"bp",33333:"dt",33406:"ay",33426:"mw",33432:"pb",33445:"jg",33486:"zn",33493:"st",33507:"jq",33540:"qj",33544:"zc",33564:"qx",33617:"yt",33632:"jq",33636:"hx",33637:"yx",33694:"gw",33705:"fp",33728:"wy",33882:"sr",34067:"mw",34074:"wy",34121:"jq",34255:"cz",34259:"xl",34425:"hj",34430:"xh",34485:"kh",34503:"sy",34532:"gh",34552:"sx",34558:"ey",34593:"lz",34660:"qy",34892:"hx",34928:"sc",34999:"jq",35048:"bp",35059:"sc",35098:"cz",35203:"tq",35265:"jx",35299:"jx",35782:"sz",35828:"sy",35843:"td",35895:"gy",35977:"hm",36158:"jg",36228:"qj",36426:"qx",36466:"dc",36710:"cj",36711:"zyg",36767:"bp",36866:"sk",36951:"yw",37034:"xy",37063:"hx",37218:"cz",37325:"zc",38063:"bp",38079:"dt",38085:"qy",38107:"dc",38116:"td",38123:"yd",38224:"hg",38241:"xtc",38271:"cz",38415:"ye",38426:"kh",38461:"yd",38463:"ae",38466:"pb",38477:"jx",38518:"ty",38551:"wk",38585:"zc",38704:"xs",38739:"lj",38761:"gj",38808:"qs",39048:"jg",39049:"jx",39052:"hg",39076:"cz",39271:"xt",39534:"td",39552:"td",39584:"bp",39647:"sb",39730:"lg",39748:"pbt",40109:"zq",40479:"nd",40516:"hg",40536:"hg",40583:"qj",40765:"yq",40784:"qj",40840:"yk",40863:"gjq"});var r=e.charCodeAt(0);if(r<19968||r>40869)return t?e:e.toLowerCase();var n=(n=$string._pinyinMap[r])||$string._pinyinList.charAt(r-19968);return t?n.toUpperCase():n},Sys.WebStorageCache=function(){this._isSupported=!1,this._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),this._defaultExpire=this._maxExpireDate,this._data={},this.initialize()},Sys.WebStorageCache.prototype={initialize:function(){this._storage=this._getStorageInstance("localStorage"),this._isSupported=this._isStorageSupported(this._storage);var e={set:function(e,t,r){if(e=this._checkAndWrapKeyAsString(e),r=this._extend({force:!0},r),t===undefined)return this.deleteCache(e);var n=this.serialize(t),s=this._toCacheItem(n,r);try{this._storage.setItem(e,this.serialize(s))}catch(i){this._isQuotaExceeded(i)?this.quotaExceedHandler(e,n,r,i):console.error(i)}return t},get:function(e,t){t=this._extend({defaultValue:null},t),e=this._checkAndWrapKeyAsString(e);var r=null;try{if(r=this.deserialize(this._storage.getItem(e)),t&&t.vs&&t.vs!=r.vs)return t.defaultValue}catch(n){return t.defaultValue}if(this._isCacheItem(r)){if(this._checkCacheItemIfEffective(r))return this.deserialize(r.v);this.deleteCache(e)}return t.defaultValue},deleteCache:function(e,t){return e=this._checkAndWrapKeyAsString(e),t&&t.group?this.deleteGroup(t.group):(this._storage.removeItem(e),e)},deleteGroup:function(e){for(var t=this._storage.length,r=[],n=0;n<t;n++){var s=this._storage.key(n),i=null;try{i=this.deserialize(this._storage.getItem(s))}catch(a){}null!==i&&i.e!==undefined&&i.g!==undefined&&i.g==e&&r.push(s)}for(var n=0,o=r.length;n<o;n++)this.deleteCache(r[n]);return r},deleteAllExpires:function(){for(var e=this._storage.length,t=[],r=0;r<e;r++){var n=this._storage.key(r),s=null;try{s=this.deserialize(this._storage.getItem(n))}catch(o){}if(null!==s&&s.e!==undefined){(new Date).getTime()>=s.e&&t.push(n)}}for(var r=0,i=t.length;r<i;r++)this.deleteCache(t[r]);return t},clear:function(){this._storage.clear()},add:function(e,t,r){e=this._checkAndWrapKeyAsString(e),r=this._extend({force:!0},r);try{var n=this.deserialize(this._storage.getItem(e));if(!this._isCacheItem(n)||!this._checkCacheItemIfEffective(n))return this.set(e,t,r),!0}catch(s){return this.set(e,t,r),!0}return!1},replace:function(e,t,r){e=this._checkAndWrapKeyAsString(e);var n=null;try{n=this.deserialize(this._storage.getItem(e))}catch(s){return!1}if(this._isCacheItem(n)){if(this._checkCacheItemIfEffective(n))return this.set(e,t,r),!0;this.deleteCache(e)}return!1},touch:function(e,t){e=this._checkAndWrapKeyAsString(e);var r=null;try{r=this.deserialize(this._storage.getItem(e))}catch(n){return!1}if(this._isCacheItem(r)){if(this._checkCacheItemIfEffective(r))return this.set(e,this.get(e),{exp:t}),!0;this.deleteCache(e)}return!1}};this._isSupported?this._extend(this,e):this._extend(this,{set:function(e,t,r){this._data[e]=t},get:function(e){return this._data[e]},deleteCache:function(e){delete this._data[e]},deleteAllExpires:function(){},clear:function(){this._data={}},add:function(e,t){},replace:function(e,t,r){},touch:function(e,t){}})},isSupported:function(){return this._isSupported},serialize:function(e){return $crabaJSON.serialize(e)},deserialize:function(e){return e&&$crabaJSON.deserialize(e,!0)},_extend:function(e,t){for(var r in t)e[r]=t[r];return e},_isStorageSupported:function(e){var t=!1;if(e&&e.setItem){t=!0;var r="__"+Math.round(1e7*Math.random());try{e.setItem(r,r),e.removeItem(r)}catch(n){t=!1}}return t},_getStorageInstance:function(e){try{return"string"===typeof e&&window[e]?window[e]:e}catch(t){return null}},_isValidDate:function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},_getExpiresDate:function(e,t){if(t=t||new Date,"number"==typeof e?e=e===Infinity?this._maxExpireDate:new Date(t.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!this._isValidDate(e))throw new Error("`expires` 参数不能转为有效的日期类型");return e},_isQuotaExceeded:function(e){var t=!1;if(!e)return!1;if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else-2147024882===e.number&&(t=!0);return t},_toCacheItem:function(e,t){var r=t.exp,n={};n.c=(new Date).getTime(),r=r||this._defaultExpire;var s=this._getExpiresDate(r);return n.e=s.getTime(),n.v=e,t.group&&(n.g=t.group),t.vs&&(n.vs=t.vs),n},_isCacheItem:function(e){return"object"==typeof e&&!!(e&&"c"in e&&"e"in e&&"v"in e)},_checkCacheItemIfEffective:function(e){return(new Date).getTime()<e.e},_checkAndWrapKeyAsString:function(e){return"string"!=typeof e&&(console.warn(e+" 使用了key,但不是字符串格式."),e=String(e)),e}},Type.registerNamespace("Sys.UI"),$dom=$Dom=Sys.UI.DomElement=function(){throw Error.notImplemented()},$dom.registerClass("Sys.UI.DomElement");var $get=$dom.getElementById=function(e,t){if(!t)return document.getElementById(e);if(t.getElementById)return t.getElementById(e);for(var r=[],n=t.childNodes,s=0;s<n.length;s++){var i=n[s];1==i.nodeType&&(r[r.length]=i)}for(;r.length;){if((i=r.shift()).id==e)return i;for(n=i.childNodes,s=0;s<n.length;s++)1==(i=n[s]).nodeType&&(r[r.length]=i)}return null},$$get=$dom.getElementsByTagName=function(e,t){return t?t.getElementsByTagName(e):document.getElementsByTagName(e)};$dom.getBounds=function(e){var t=$dom.getLocation(e);return new _Z_217(t.x,t.y,e.offsetWidth||0,e.offsetHeight||0)};var $removeNode=$dom.removeNode=Sys.Browser.isIE?function(){var e;return function(t,r){t&&"BODY"!=t.tagName&&((e=e||document.createElement("div")).appendChild(t),!1!==r&&(e.innerHTML=""),e=null)}}():function(e){e&&e.parentNode&&"BODY"!=e.tagName&&e.parentNode.removeChild(e)},$disposeNode=function(e){if(e){var t=$common.getElementChildControls(e);Array.forEach(t,function(e){e.dispose()}),$removeNode(e)}};switch(Sys.Browser.agent){case Sys.Browser.InternetExplorer:$dom.getLocation=function(e){try{if(e.self||9===e.nodeType)return new _Z_218(0,0);var t=e.getBoundingClientRect();if(!t)return new _Z_218(0,0);var r=e.ownerDocument.documentElement,n=t.left-window.__bodyXOffset+r.scrollLeft,s=t.top-window.__bodyYOffset+r.scrollTop,i=e.ownerDocument.parentWindow.frameElement||null;if(i){var o="0"===i.frameBorder||"no"===i.frameBorder?window.__bodyXOffset:0;n+=o,s+=o}}catch(a){}return new _Z_218(n,s)};break;case Sys.Browser.Safari:$dom.getLocation=function(e){if(e.window&&e.window===e||9===e.nodeType)return new _Z_218(0,0);for(var t,r=0,n=0,s=null,i=e;i;i,s=t,i=i.offsetParent){t=$dom._getCurrentStyle(i);var o=i.tagName;!i.offsetLeft&&!i.offsetTop||"BODY"===o&&s&&"absolute"===s.position||(r+=i.offsetLeft+(parseInt(t.borderLeftWidth)||0),n+=i.offsetTop+(parseInt(t.borderTopWidth)||0))}var a=(t=$dom._getCurrentStyle(e))?t.position:null;if(!a||"absolute"!==a)for(i=e.parentNode;i;i=i.parentNode){"BODY"!==(o=i.tagName)&&"HTML"!==o&&(i.scrollLeft||i.scrollTop)&&(r-=i.scrollLeft||0,n-=i.scrollTop||0);var l=(t=$dom._getCurrentStyle(i))?t.position:null;if(l&&"absolute"===l)break}return new _Z_218(r,n)};break;case Sys.Browser.Opera:$dom.getLocation=function(e){if(e.window&&e.window===e||9===e.nodeType)return new _Z_218(0,0);for(var t=0,r=0,n=e;n;n,n=n.offsetParent){var s=n.tagName;t+=n.offsetLeft||0,r+=n.offsetTop||0}for(var i=e.style.position,o=i&&"static"!==i,n=e.parentNode;n;n=n.parentNode){"BODY"===(s=n.tagName)||"HTML"===s||!n.scrollLeft&&!n.scrollTop||!o||"scroll"!==n.style.overflow&&"auto"!==n.style.overflow||(t-=n.scrollLeft||0,r-=n.scrollTop||0);var a=n&&n.style?n.style.position:null;o=o||a&&"static"!==a}return new _Z_218(t,r)};break;default:$dom.getLocation=function(e){if(e.window&&e.window===e||9===e.nodeType)return new _Z_218(0,0);for(var t=0,r=0,n=null,s=null,i=null,o=e;o;n=o,s=i,o=o.offsetParent){var a=o.tagName;i=$dom._getCurrentStyle(o),(o.offsetLeft||o.offsetTop)&&("BODY"!==a||s&&"absolute"===s.position)&&(t+=o.offsetLeft,r+=o.offsetTop),null!==n&&i&&("TABLE"!==a&&"TD"!==a&&"HTML"!==a&&(t+=parseInt(i.borderLeftWidth)||0,r+=parseInt(i.borderTopWidth)||0),"TABLE"===a&&("relative"===i.position||i.position))}var l=(i=$dom._getCurrentStyle(e))?i.position:null;if(!l||"absolute"!==l)for(o=e.parentNode;o;o=o.parentNode)"BODY"!==(a=o.tagName)&&"HTML"!==a&&(o.scrollLeft||o.scrollTop)&&(t-=o.scrollLeft||0,r-=o.scrollTop||0,(i=$dom._getCurrentStyle(o))&&(t+=parseInt(i.borderLeftWidth)||0,r+=parseInt(i.borderTopWidth)||0));return new _Z_218(t,r)}}$dom.setLocation=function(e,t,r){var n=e.style;n.position="absolute",n.left=t+"px",n.top=r+"px"},$dom.setAttribute=function(e,t,r,n){t&&r&&(e?t.setAttribute(r,n):t.removeAttribute(r))},$dom.addCssClass=function(e,t){t&&e&&($dom.hasClass(e,t)||(""===e.className?e.className=t:e.className+=" "+t))},$dom.setCssClass=function(e,t,r){e?$dom.addCssClass(t,r):$dom.removeCssClass(t,r)},$dom.containsCssClass=function(e,t){return $dom.hasClass(e,t)},$dom.hasClass=function(e,t){if(!e||!e.className||!t)return!1;return(" "+e.className+" ").indexOf(" "+t+" ")>-1},$dom.removeCssClass=function(e,t){if(t&&e){var r=" "+e.className+" ",n=r.indexOf(" "+t+" ");n>=0&&(e.className=(r.substr(0,n)+" "+r.substring(n+t.length+1,r.length)).trim())}},$dom.toggleCssClass=function(e,t){$dom.hasClass(e,t)?$dom.removeCssClass(e,t):$dom.addCssClass(e,t)},$dom.getVisibilityMode=function(e){return e._visibilityMode===_Z_57.hide?_Z_57.hide:_Z_57.collapse},$dom.setVisibilityMode=function(e,t){$dom._ensureOldDisplayMode(e),e._visibilityMode!==t&&(e._visibilityMode=t,!1===$dom.getVisible(e)&&(e._visibilityMode===_Z_57.hide?e.style.display=e._oldDisplayMode:e.style.display="none"),e._visibilityMode=t)},$dom._getWindow=function(e){var t=e.ownerDocument||e.document||e;return t.defaultView||t.parentWindow},$dom._getCurrentStyle=function(e){if(3===e.nodeType)return null;var t=$dom._getWindow(e);e.documentElement&&(e=e.documentElement);var r=t&&e!==t&&t.getComputedStyle?t.getComputedStyle(e,null):e.currentStyle||e.style;if(!r&&Sys.Browser.agent===Sys.Browser.Safari&&e.style){var n=e.style.display,s=e.style.position;e.style.position="absolute",e.style.display="block";var i=t.getComputedStyle(e,null);e.style.display=n,e.style.position=s,r={};for(var o in i)r[o]=i[o];r.display="none"}return r},$dom.getVisible=function(e){var t=e.currentStyle||$dom._getCurrentStyle(e);return!t||"hidden"!==t.visibility&&"none"!==t.display},$dom.setVisible=function(e,t,r){e&&($dom._ensureOldDisplayMode(e),e.style.visibility=t?"":"hidden",t||e._visibilityMode===_Z_57.hide?e.style.display=r!==undefined?r:e._oldDisplayMode:e.style.display="none")},$dom.setDisplay=function(e,t){e.style.display=t},$dom.setVisibleByPosition=function(e,t){e.tagName||(e=e.get_element()),t?(e._savePosition!=undefined?e.style.position=e._savePosition:e.style.position="",e.style.left="",e.style.top=""):(e._savePosition=e.style.position,e.style.position="absolute",e.style.left="-10000px",e.style.top="-10000px",e.style.right="auto",e.style.bottom="auto")},$dom.getVisibleByPosition=function(e){return"absolute"!=e.style.position||"-10000px"!=e.style.left||"-10000px"!=e.style.top},$dom.isAbsolute=function(e){return"absolute"!=e.style.position},$dom._ensureOldDisplayMode=function(e){if(!e._oldDisplayMode){var t=e.currentStyle||$dom._getCurrentStyle(e);if(e._oldDisplayMode=t?t.display:null,!e._oldDisplayMode||"none"===e._oldDisplayMode)switch(e.tagName.toUpperCase()){case"DIV":case"P":case"ADDRESS":case"BLOCKQUOTE":case"BODY":case"COL":case"COLGROUP":case"DD":case"DL":case"DT":case"FIELDSET":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HR":case"IFRAME":case"LEGEND":case"OL":case"PRE":case"TABLE":case"TH":case"UL":e._oldDisplayMode="block";break;case"TR":e._oldDisplayMode=Sys.Browser.isIE&&Sys.Browser.version<10?"block":"table-row";break;case"TD":e._oldDisplayMode="";break;case"LI":e._oldDisplayMode="list-item";break;default:e._oldDisplayMode="inline"}}},$dom.setEnabled=function(e,t){e&&(t?e.removeAttribute("disabled"):e.setAttribute("disabled","true"),t?e.className=e.className.replace(/(?:^|\s)disabled(?!\S)/gi,""):this.addCssClass(e,"disabled"))},$dom.getEnabled=function(e){return!e.getAttribute("disabled")},$dom.setOpacity=function(e,t){if(t<100){e.style.filter="alpha(opacity="+t+")";var r=t/100;e.style.opacity=r,e.style.MozOpacity=r}else e.style.filter="",e.style.opacity="",e.style.MozOpacity=""},$dom.setStyle=function(e,t){if(e&&t)for(var r in t)e.style[r]=t[r]},_Z_237=function(){this._list={}},_Z_237.prototype={addHandler:function(e,t,r){return r&&(t=$createDelegate(r,t)),Array.add(this._getEvent(e,!0),t),t},removeHandler:function(e,t){var r=this._getEvent(e);r&&Array.remove(r,t)},clearHandlers:function(e){delete this._list[e]},clear:function(){this._list=[]},getHandler:function(e){var t=this._getEvent(e);return t&&0!==t.length?(t=Array.clone(t),function(e,r){for(var n=0,s=t.length;n<s;n++)t[n](e,r)}):null},hasEvent:function(e){return!!this._getEvent(e)},_getEvent:function(e,t){if(!this._list[e]){if(!t)return null;this._list[e]=[]}return this._list[e]}},_Z_237.registerClass("_Z_237"),Sys.EventArgs=function(){},Sys.EventArgs.registerClass("Sys.EventArgs"),Sys.EventArgs.Empty=new Sys.EventArgs,_Z_162=function(e){_Z_162.initializeBase(this),this._cancel=!1,this.event=e},_Z_162.prototype={get_cancel:function(){return this._cancel},set_cancel:function(e){this._cancel=e},get_event:function(){return this.event},cancel:function(e){this._cancel=e}},_Z_162.registerClass("_Z_162",Sys.EventArgs),_Z_163=function(e,t){_Z_163.initializeBase(this),this._source=t,this._target=e,this._dragDatas=null},_Z_163.prototype={get_source:function(){return this._source},get_target:function(){return this._target},get_dragData:function(){return this._source.getDragData()},get_dragIndex:function(){return this._source._getDragIndex()},get_dropData:function(){return this._target.getDragData(!0)},get_dropIndex:function(){return this._target._getDragIndex(!0)}},_Z_163.registerClass("_Z_163",_Z_162),_Z_238=function(){},_Z_238.dragMove=function(e,t){var r=_Z_238.getEventDropTarget(e,t);if(r){var n=_Z_238._prevDropTarget;n&&_Z_238._prevDropTarget!=r&&(n.get_isDisposed()||(n._dragClass(!1,"DropStyle"),n._emitDragLeave(e,t))),r._dragClass(!0,"DropStyle"),r._emitDragMove(e,t),_Z_238._prevDropTarget=r}},_Z_238.endDrag=function(e,t){var r=_Z_238.getEventDropTarget(e,t);if(r||(r=_Z_238._prevDropTarget),r){r._dragClass(!1,"DropStyle"),r!=t&&r._emitDragEnd(e,t);var n=r.get_events().getHandler("_drop");if(n){var s=new _Z_163(r,t);n(r,s),s.get_cancel()?t.cancelDrag():t.okDrag&&t.okDrag()}}else t.cancelDrag();_Z_238._prevDropTarget=null},_Z_238.getEventDropTarget=function(e,t){for(var r=null,n=e.target;n&&"BODY"!=n.tagName;){if(n.control&&n.control.get_allowDrop&&n.control.get_allowDrop()){r=n.control;break}n=n.parentNode}return r||t},_Z_239=function(){throw Error.notImplemented()},_Z_239.prototype={add_propertyChanged:function(e){throw Error.notImplemented()},remove_propertyChanged:function(e){throw Error.notImplemented()}},_Z_239.registerInterface("_Z_239"),_Z_164=function(e){_Z_164.initializeBase(this),this._propertyName=e},_Z_164.prototype={get_propertyName:function(){return this._propertyName}},_Z_164.registerClass("_Z_164",Sys.EventArgs),_Z_240=function(){throw Error.notImplemented()},_Z_240.prototype={add_disposing:function(e){throw Error.notImplemented()},remove_disposing:function(e){throw Error.notImplemented()}},_Z_240.registerInterface("_Z_240"),Sys.Position=function(){throw Error.notImplemented()},Sys.Position.prototype={left:0,leftTop:1,top:2,rightTop:3,right:4,rightBottom:5,bottom:6,leftBottom:7},Sys.Position.registerEnum("Sys.Position"),_Z_241=function(){throw Error.notImplemented()},_Z_241.prototype={all:0,width:1,height:2,auto:3,none:4},_Z_241.registerEnum("_Z_241"),Sys.ErrorType=function(){throw Error.notImplemented()},Sys.ErrorType.prototype={ocxPrint:0,servicePrint:1,posPrint:2,barcodePrint:3,expressPrint:4,ajax:5,page:6,javascript:7,other:8,cloudPrint:9},Sys.ErrorType.registerEnum("Sys.ErrorType"),Sys.LayoutMode=function(){throw Error.notImplemented()},Sys.LayoutMode.prototype={normal:0,tree:1,treeOnly:2},Sys.LayoutMode.registerEnum("Sys.LayoutMode"),_Z_165=function(e,t,r){_Z_165.initializeBase(this),this._type=e,this._message=t,this._form=r,this._messageChanged=!1,this._callBack=null},_Z_165.prototype={get_type:function(){return this._type},get_message:function(){return this._message},set_message:function(e){this._message=e,this._messageChanged=!0},get_callBack:function(){return this._callBack},set_callBack:function(e){this._callBack=e},get_form:function(){return this._form},set_form:function(e){this._form=e}},_Z_165.registerClass("_Z_165",_Z_162),Sys.ReqeustCompletedEventArgs=function(e){Sys.ReqeustCompletedEventArgs.initializeBase(this),this._responseInfo=e},Sys.ReqeustCompletedEventArgs.prototype={get_responseInfo:function(){return this._responseInfo}},Sys.ReqeustCompletedEventArgs.registerClass("Sys.ReqeustCompletedEventArgs",_Z_162),_Z_166=function(e,t){_Z_166.initializeBase(this),this._obj=e,this._form=t},_Z_166.prototype={get_obj:function(){return this._obj},set_obj:function(e){this._obj=e},get_form:function(){return this._form},set_form:function(e){this._form=e}},_Z_166.registerClass("_Z_166",_Z_162),_Z_216=function(){this._times=100},_Z_216.prototype={initialize:function(){Sys.Browser.isIE&&(this._times=5),this._moveHandler=$common.addMouseMoveHandler(document,this._mouseMove,this)},dispose:function(){this._moveHandler&&($common.removeMouseMoveHandler(document,this._moveHandler),this._moveHandler=null)},_mouseMove:function(e){if(!_Z_216._isCustomTips&&!_Z_216._wait){var t=e.target;t.tagName&&($dom.hasClass(t,"HintBox")||$dom.hasClass(t,"hinticon")||("GridHeaderCaptionText"==t.className?"SortOrder"==(t=t.parentNode).className&&(t=t.parentNode):"FlowLabel "==t.className&&!t._title&&t.scrollWidth>t.offsetWidth+2&&(t.title=t.innerText),t.title&&(t._title=t.title,t.removeAttribute("title")),t._title?this._curT!=t&&(this._curT=t,$craba.asyncFun(this,$createDelegate(this,this._showHint),200)):this._hided(),_Z_216._wait=!0,setTimeout(function(){_Z_216._wait=!1},this._times)))}},_showHint:function(){var e=this._curT;e&&$common.showHint(e._title,e,0,Sys.Position.top,"INPUT"!=e.tagName,"TitleHint")},_hided:function(){if(!_Z_216._isCustomTips)return!!this._curT&&(this._curT=null,$common.hideHintBox(),!0)}},_Z_216.bind=function(){this.Instance||!1===$settings.EnableGlobalTitle||8==Sys.Browser.version&&Sys.Browser.isIE||(this.Instance=new _Z_216,this.Instance.initialize())},_Z_216.registerClass("_Z_216"),_Z_242=function(){},_Z_242.prototype={_id:null,_idPart:"",_langId:null,_idSet:!1,_initialized:!1,_disposed:!1,_updating:!1,initialize:function(){this._initialized=!0},set_business:function(){},get_business:function(){},dispose:function(){if(this._events){var e=this._events.getHandler("disposing");e&&e(this,Sys.EventArgs.Empty)}delete this._events,this.__form=null,this._disposed=!0},focusNextControl:function(){var e=this.get_form(),t=e.get_controls(),r=t.length,n=Array.indexOf(t,this)+1;if(n==r){if(e.control)return void e.control.focusNextControl();n=0}for(;n<r;n++){var s=t[n];if(Sys.UI.Control.canFocus(s)){if(!1===s.focus())continue;$craba.activeTab(s);break}}n==r&&(e.control&&e.control.focusNextControl(),this.blur&&this.blur())},get_events:function(){return this._events||(this._events=new _Z_237),this._events},get_id:function(){return this._id},set_id:function(e){if(this._idSet)throw Error.invalidOperation(Sys.Res.componentCantSetIdTwice);this._idSet=!0;var t=this.get_id();if(t&&$app.findComponent(t))throw Error.invalidOperation(Sys.Res.componentCantSetIdAfterAddedToApp);this._id=e},get_panelConfigID:function(){return this._panelConfigID},set_panelConfigID:function(e){this._panelConfigID=e},get_langId:function(){return this._langId},set_langId:function(e){this._langId=e},get_langText:function(){return this._langId&&"undefined"!=typeof CrabaLanguage?$craba.getLang(CrabaLanguage,this._langId):null},set_helpInfo:function(e){this._helpInfo=e},get_idPart:function(){return this._idPart},set_idPart:function(e){this._idPart=e},get_isInitialized:function(){return this._initialized&&!this._disposed},get_isDisposed:function(){return this._disposed},get_isUpdating:function(){return this._updating},add_disposing:function(e){this.get_events().addHandler("disposing",e)},remove_disposing:function(e){this.get_events().removeHandler("disposing",e)},beginUpdate:function(){this._updating=!0},endUpdate:function(){this._updating=!1,this._initialized||this.initialize(),this.updated();var e=this.findForm();!this.doFormLoaded||e&&!e._loaded||(this.doFormLoaded(),this.__loaded=!0)},updated:function(){},add_propertyChanged:function(e){this.get_events().addHandler("propertyChanged",e)},remove_propertyChanged:function(e){this.get_events().removeHandler("propertyChanged",e)},raisePropertyChanged:function(e){if(this._events){var t=this._events.getHandler("propertyChanged");t&&t(this,new _Z_164(e))}},findForm:function(){return this.get_form(!0)},get_form:function(e){if(this.get_isDisposed())return null;var t=this.get_owner?this.get_owner():null;if(t)return t.get_form();if(!this.__form&&!e)throw Error.invalidOperation("取不到控件所在表单");return this.__form},get_rootForm:function(e){var t=this.get_form(e);if(!t)return null;var r=t.get_action(e);if(!r)return null;var n=r.get_root();return n?n.get_form():t},set_form:function(e){this.__form=e},_getOverlayDom:function(){return this.get_element()}},_Z_242.registerClass("_Z_242",null,Sys.IDisposable,_Z_239,_Z_240);var $create=_Z_242.create=function(e,t,r,n,s,i,o){if(!e.inheritsFrom(_Z_242))throw Error.argument("type",String.format(Sys.Res.createNotComponent,e.getName()));if("string"==typeof r&&(r=$get(r)),e.inheritsFrom(_Z_221)||e.inheritsFrom(Sys.UI.Control)){if(!r)throw s&&!s.get_isDisposed()&&s.dispose(),Error.abort()}else if(r)throw Error.argument("element",Sys.Res.createComponentOnDom);var a=r?new e(r):new e;try{if(a.beginUpdate(),t&&_Z_242$_setProperties(a,t),n)for(var l in n){if(!(a["add_"+l]instanceof Function))throw new Error.invalidOperation(String.format(Sys.Res.undefinedEvent,l));if(!(n[l]instanceof Function))throw new Error.invalidOperation(Sys.Res.eventHandlerNotFunction);a["add_"+l](n[l])}s&&(i?(a.set_form(s),s._initControlId(a,!1)):s.addControl(a),o&&o.push(a)),a.endUpdate()}catch(c){throw Error.create("创建控件"+(r?" "+r.id+" ":"")+"失败"+(c.message?"":": "+c),c)}return a},$typeCaches={},$createType=function(e,t){var r;if("string"==typeof e){if(void 0===(r=$typeCaches[e]))try{r=evil2(e),$typeCaches[e]=r}catch(n){if(t)return null;throw Error.argument("Type类","类“"+e+"”有语法错误（"+(n&&n.message?n.message:n)+"）")}}else $typeCaches[(r=e).getName()]=r;return r},$createFromParams=function(e,t,r,n){return $create(e.type,e.properties,t,e.events,r,n)};_Z_243=function(){throw Error.notImplemented()},_Z_243.prototype={findComponent:function(e){throw Error.notImplemented()}},_Z_243.registerInterface("_Z_243"),Sys.UI.MouseButton=function(){throw Error.notImplemented()},Sys.UI.MouseButton.prototype={leftButton:0,middleButton:1,rightButton:2},Sys.UI.MouseButton.registerEnum("Sys.UI.MouseButton"),Sys.UI.Key=function(){throw Error.notImplemented()},Sys.UI.Key.prototype={backspace:8,tab:9,enter:13,esc:27,shift:16,alt:18,caps:20,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,del:127,ime:229,f1:112,f12:123},Sys.UI.Key.registerEnum("Sys.UI.Key"),_Z_218=function(e,t){this.x=e,this.y=t},_Z_218.registerClass("_Z_218"),_Z_217=function(e,t,r,n){this.x=e,this.y=t,this.width=r,this.height=n},_Z_217.registerClass("_Z_217"),_Z_220=function(e){var t=e;if(this.rawEvent=t,this.altKey=t.altKey,"undefined"!=typeof t.button&&(this.button="undefined"!=typeof t.which?t.button:4===t.button?Sys.UI.MouseButton.middleButton:2===t.button?Sys.UI.MouseButton.rightButton:Sys.UI.MouseButton.leftButton),"keypress"===t.type?this.charCode=t.charCode||t.keyCode:"mousewheel"===t.type?(this.wheelType=t.wheelDelta>0?-1:1,this.wheelDelta=t.wheelDelta):"DOMMouseScroll"===t.type?(this.wheelType=t.detail>0?1:-1,this.wheelDelta=t.detail):t.keyCode&&46===t.keyCode?this.keyCode=127:this.keyCode=t.keyCode,this.clientX=t.clientX,this.clientY=t.clientY,this.ctrlKey=t.ctrlKey,this.target=t.target?t.target:t.srcElement,"undefined"!=typeof t.offsetX&&"undefined"!=typeof t.offsetY)this.offsetX=t.offsetX,this.offsetY=t.offsetY;else if(this.target&&3!==this.target.nodeType&&"number"==typeof t.clientX&&this.target.parentNode){var r=$dom.getLocation(this.target),n=$dom._getWindow(this.target);this.offsetX=(n.pageXOffset||0)+t.clientX-r.x,this.offsetY=(n.pageYOffset||0)+t.clientY-r.y}this.screenX=t.screenX,this.screenY=t.screenY,this.shiftKey=t.shiftKey,this.type=t.type},_Z_220.prototype={preventDefault:function(){this.rawEvent.preventDefault?this.rawEvent.preventDefault():window.event&&(this.rawEvent.returnValue=!1),this.isPreventDefault=!0},stopPropagation:function(){this.rawEvent.stopPropagation?this.rawEvent.stopPropagation():window.event&&(this.rawEvent.cancelBubble=!0),this.isStopPropagation=!0},over:function(){this.rawEvent.__over=!0},next:function(){this.rawEvent.__next=!0},isNext:function(){return this.rawEvent.__next},cancel:function(){this.hasCancel=!0,this.preventDefault(),this.stopPropagation()}},_Z_220.registerClass("_Z_220"),_Z_220._ensureDomNode=function(e){if(!e.tagName||"SCRIPT"!==e.tagName){var t=e.ownerDocument||e.document||e;if("object"!=typeof e.document&&e!=t&&"number"!=typeof e.nodeType)throw Error.argument("element",Sys.Res.argumentDomNode)}};var $addHandler=_Z_220.addHandler=function(e,t,r){e._events||(e._events={});var n=e._events[t];n||(e._events[t]=n=[]);var s;e.addEventListener?(s=function(t){if(!t.__over)return r.call(e,new _Z_220(t))},e.addEventListener(t,s,!1)):e.attachEvent&&(s=function(){var t={};try{t=$dom._getWindow(e).event}catch(n){}return r.call(e,new _Z_220(t))},e.attachEvent("on"+t,s)),n[n.length]={handler:r,browserHandler:s}},$addHandlers=_Z_220.addHandlers=function(e,t,r){for(var n in t){var s=t[n];if("function"!=typeof s)throw Error.invalidOperation(Sys.Res.cantAddNonFunctionhandler);r&&(s=$createDelegate(r,s)),$addHandler(e,n,s)}},$clearHandlers=_Z_220.clearHandlers=function(e){if(e&&e._events){var t=e._events;for(var r in t)for(var n=t[r],s=n.length-1;s>=0;s--)$removeHandler(e,r,n[s].handler);e._events=null}},$removeHandler=_Z_220.removeHandler=function(e,t,r){var n=null;if("object"==typeof e._events&&null!=e._events){var s=e._events[t];if(s instanceof Array){for(var i=0,o=s.length;i<o;i++)if(s[i].handler===r){n=s[i].browserHandler;break}"function"==typeof n&&(e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n),s.splice(i,1))}}};_Z_220.shortcutToHotkey=function(e){if(!(e>0))return null;var t={};t.keyCode=65535&e;var r=e>>16;return 1&r&&(t.shiftKey=!0),2&r&&(t.ctrlKey=!0),4&r&&(t.altKey=!0),t},_Z_220.matchHotkey=function(e,t){if(!e)return!1;var r=e.keyCode==t.keyCode;if(!r)return!1;if(e.shiftKey)r=t.shiftKey;else if(t.shiftKey)return!1;if(e.ctrlKey)r=t.ctrlKey;else if(t.ctrlKey)return!1;if(e.altKey)r=t.altKey;else if(t.altKey)return!1;return r},_Z_221=function(e){_Z_221.initializeBase(this),this._element=e;var t=e._behaviors;t?t[t.length]=this:e._behaviors=[this]},_Z_221.prototype={_name:null,initialize:function(){_Z_221.callBaseMethod(this,"initialize");var e=this.get_name();e&&(this._element[e]=this)},dispose:function(){if(_Z_221.callBaseMethod(this,"dispose"),this._element){var e=this.get_name();e&&(this._element[e]=null),Array.remove(this._element._behaviors,this),delete this._element}},get_element:function(){return this._element},get_id:function(){var e=_Z_221.callBaseMethod(this,"get_id");return e||(this._element&&this._element.id?this._element.id+"$"+this.get_name():"")},get_name:function(){if(this._name)return this._name;var e=Object.getTypeName(this),t=e.lastIndexOf(".");return-1!=t&&(e=e.substr(t+1)),this.get_isInitialized()||(this._name=e),e},set_name:function(e){if(""===e||" "===e.charAt(0)||" "===e.charAt(e.length-1))throw Error.argument("value",Sys.Res.invalidId);if("undefined"!=typeof this._element[e])throw Error.invalidOperation(String.format(Sys.Res.behaviorDuplicateName,e));if(this.get_isInitialized())throw Error.invalidOperation(Sys.Res.cantSetNameAfterInit);this._name=e}},_Z_221.registerClass("_Z_221",_Z_242),_Z_57=function(){throw Error.notImplemented()},_Z_57.prototype={hide:0,collapse:1},_Z_57.registerEnum("_Z_57"),Sys.UI.Control=function(e){if("undefined"!=typeof e.control)throw Error.invalidOperation(Sys.Res.controlAlreadyDefined);Sys.UI.Control.initializeBase(this),this._element=e,this._label=null,this._tag=null,this._defaultEnabled=null,this._parentId=null,this._resizeMode=_Z_241.none,this._uiTag=null,this._showLabel=!0,e.control=this},Sys.UI.Control.prototype={_parent:null,dispose:function(){Sys.UI.Control.callBaseMethod(this,"dispose"),this._element&&($clearHandlers(this._element),this._element.control=undefined,delete this._element),this._parent&&delete this._parent},get_showLabel:function(){return this._showLabel},set_showLabel:function(e){this._showLabel=e},get_height:function(){return this._element.offsetHeight},set_height:function(e){return e-=$common._getDomCachePadding(this._element,!0),$common.setHeight(this._element,e),this.__isLayout&&$dom.addCssClass(this._element,"Flex0"),e},get_width:function(){return this._element.offsetWidth},set_width:function(e){return e-=$common._getDomCachePadding(this._element),$common.setWidth(this._element,e),this.__isLayout&&$dom.addCssClass(this._element,"Flex0"),e},get_element:function(){return this._element},get_outerElement:function(){return this._element},get_resizeMode:function(){return this._resizeMode},set_resizeMode:function(e){this._resizeMode=e},get_requiredLabel:function(){return this._requiredLabel},set_requiredLabel:function(e){this._requiredLabel=e},set_required:function(e){if(this._required=e,this._dataField){var t=this.get_form(!0);if(t){var r=!0;e&&((r={})[this._dataField]=[$createValidator(Sys.Validators.NotEmptyValidator)],r._name=this._dataField),t.addValidationNode(this._dataField,r)}}},get_required:function(){return this._required},get_label:function(){return this._label},set_label:function(e){if(this._label=e,this.get_isInitialized()){this._labelChanged=!0;var t=this.get_labelElement();t&&(t.innerHTML=e)}},set_labelStyle:function(e){this._labelStyle=e},get_labelStyle:function(){return this._labelStyle},set_labelCssClass:function(e){if(this._labelCssClass=e,this.get_isInitialized()){var t=this.get_labelElement();t&&$dom.addCssClass(t,e)}},remove_labelCssClass:function(e){var t=this.get_labelElement();t&&$dom.removeCssClass(t,e)},get_labelCssClass:function(){return this._labelCssClass},createLabel:function(e,t){var r=this._label;if(r||!(t<1)){var n=this.get_id(),s=e.parentNode,i=this._labelElement=document.createElement("label");i.id=n+"_label",this._labelCssClass?i.className="FlowLabel "+this._labelCssClass:i.className="FlowLabel",this._labelStyle&&(i.style.cssText=this._labelStyle),e.offsetHeight>0?i.style.lineHeight=e.offsetHeight+"px":i.style.lineHeight="24px",i.setAttribute("for",n),i.innerHTML=r||"",t>0&&(i.style.width=t+"px",this.refreshLabelTitle()),s.insertBefore(i,e),this._bindLabelClick&&this._bindLabelClick()}},refreshLabelTitle:function(){var e=this.get_labelElement();e&&e.scrollWidth>e.offsetWidth+2&&(e.title=e.innerHTML)},_getFlowItem:function(){var e=this._flowItemDom;if(!e){var t=this.get_outerElement&&this.get_outerElement()?this.get_outerElement().parentNode:this._element.parentNode;$dom.hasClass(t,"FlowItem")&&(e=this._flowItemDom=t)}return e},_refreshItemVisible:function(e,t){var r=this._getFlowItem();r&&(r.style.display=t?"":"none")},get_labelElement:function(){if(this._labelElement)return this._labelElement;var e=this.get_id();return e?$get(e+"_label"):null},get_tag:function(){return this._tag},set_tag:function(e){this._tag=e},get_uiTag:function(){return this._uiTag},set_uiTag:function(e){this._uiTag=e},get_id:function(){return this._element?this._element.id:""},set_id:function(e){throw Error.invalidOperation(Sys.Res.cantSetId)},get_parent:function(){if(this._parent)return this._parent;if(!this._element)return null;for(var e=this.get_outerElement().parentNode;e;){if(e.control)return e.control;e=e.parentNode}return null},set_parent:function(e){for(var t=[this],r=e;r;){if(Array.contains(t,r))throw Error.invalidOperation(Sys.Res.circularParentChain);t[t.length]=r,r=r.get_parent()}this._parent=e},get_visibilityMode:function(){return $dom.getVisibilityMode(this._element)},set_visibilityMode:function(e){$dom.setVisibilityMode(this._element,e)},_getElementForVisible:function(){var e=null;return this.get_outerElement&&(e=this.get_outerElement()),e||this._element},get_visible:function(e){var t=this._element;if(!t)return!1;if(0==t.offsetWidth)return!!e&&(!this.checkVisibleWithCss(t)&&!this.checkVisibleWithCss(this._getFlowItem()));var r=t.parentNode;return(!r||$dom.getVisible(r))&&$dom.getVisible(this._getElementForVisible())},checkVisibleWithCss:function(e){return!!e&&e.style.cssText.indexOf("display: none")>-1},set_visible:function(e,t){var r=this._getElementForVisible();this._setParentVisible(r,e),this._refreshItemVisible(null,e),$dom.setVisible(r,e,t);var n=this.findForm();n&&n._loaded&&n.raiseControlVisible(e)},_setParentVisible:function(e,t){var r=e.parentNode;if(r&&"TD"==r.tagName)if(t)$dom.setVisible(r,t);else{for(var n=0,s=r.childNodes,i=0,o=s.length;i<o&&!(n>1);i++){var a=s[i];if(a){$dom.getVisible(a)&&n++}}n<2&&$dom.setVisible(r,t)}},_setControlAndLabelVisible:function(e,t,r){var n=!1,s=e.parentNode;if(s&&(n=s.getAttribute("_vert"))){var i=s.parentNode;i&&"TR"==i.tagName&&$dom.setVisible(i,t)}var o=this.get_labelElement();if(!o&&this.get_textElement&&(o=this.get_textElement()),o){var a=o.parentNode;"DIV"==a.tagName&&(a=a.parentNode),n||this._setLayoutItemTdVisible(a,t),$dom.setVisible(o,t)}n||this._setLayoutItemTdVisible(s,t)},_setLayoutItemTdVisible:function(e,t){e&&"TD"==e.tagName&&$dom.setVisible(e,t)},setStyle:function(e){$dom.setStyle(this._element,e)},addCssClass:function(e){var t=this.get_outerElement();$dom.addCssClass(t,e)},removeCssClass:function(e){var t=this.get_outerElement();$dom.removeCssClass(t,e)},toggleCssClass:function(e){$dom.toggleCssClass(this._element,e)},onBubbleEvent:function(e,t){return!1},raiseBubbleEvent:function(e,t){for(var r=this.get_parent();r;){if(r.onBubbleEvent(e,t))return;r=r.get_parent()}},get_bounds:function(){return $dom.getBounds(this._element)},canFocus:function(){return!1},focusPrevControl:function(){for(var e=this.get_form().get_controls(),t=-1,r=0;r<e.length;r++)if(e[r]==this){t=r-1;break}for(r=t;r>0;r--){var n=e[r];if(Sys.UI.Control.canFocus(n)){n.focus();break}}},add_dataBind:function(e){this.get_events().addHandler("dataBind",e)},remove_dataBind:function(e){this.get_events().removeHandler("dataBind",e)},doDataBind:function(){var e=this.get_events().getHandler("dataBind");e&&e(this)},fadeIn:function(e){if(!$common.supportFlexBrowsers())return!1;var t=this._showUp?"DrpFadeIn DrpUp":"DrpFadeIn DrpOrange";return $dom.addCssClass(e,t),setTimeout(function(){e&&$dom.removeCssClass(e,t),e&&$dom.setOpacity(e,100)},300),!0},fadeOut:function(e){if(!$common.supportFlexBrowsers())return e&&$dom.setVisible(e,!1),!1;var t=this._showUp?"DrpFadeOut DrpUp":"DrpFadeOut DrpOrange";return $dom.addCssClass(e,t),setTimeout(function(){e&&$dom.setVisible(e,!1),e&&$dom.removeCssClass(e,t),e&&$dom.setOpacity(e,0)},300),!0}},Sys.UI.Control.registerClass("Sys.UI.Control",_Z_242),Sys.UI.Control.canFocus=function(e){var t=e.get_visible;return t&&(t=e.get_visible()),t&&e.get_enabled&&(t=e.get_enabled()),t&&e.canFocus&&(t=e.canFocus()),t},_Z_167=function(e,t,r,n){_Z_167.initializeBase(this),this._width=e,this._height=t,this._changeWidth=r,this._changeHeight=n,this._resizeControls=null},_Z_167.prototype={get_width:function(){return this._width},get_height:function(){return this._height},get_changeWidth:function(){return this._changeWidth},get_changeHeight:function(){return this._changeHeight},set_resizeControls:function(e){this._resizeControls=e},get_resizeControls:function(){return this._resizeControls}},_Z_167.registerClass("_Z_167",_Z_162),Sys.UI.CustomForm=function(e){Sys.UI.CustomForm.initializeBase(this),this._pageTimeout=0,this._zIndex=0,this._configId=0,this._enabled=!0,this._minWidth=300,this._minHeight=250,this._contexts={},this._showCloseButton=!0,this._useEsc=$settings.DefaultUseEscClose,this._allowResize=$settings.DefaultAllowResizeMDI,this._initOwner(e)},Sys.UI.CustomForm.prototype={_initOwner:function(e){e&&(this._parentForm=$common.getSenderForm(e),this.set_isChildForm(!0),!this._isModal&&_Z_97.isInstanceOfType(e)&&e.get_icon()&&this.set_icon(e.get_icon()))},dispose:function(){window.focusedControl=null,$common.hideHint("disposed"),$step.removeStep();var e=null;try{this.doClosed()}catch(r){e=r}if(this._noErrorAbort=!0,this.removeControlsSession(),this.destroyContent(),this._contentElement=null,this._isRepeat||$app.removeForm(this),this._request&&(this._request.abort(),this._request=null),this._validationManager&&(this._validationManager.dispose(),this._validationManager=null),this._validationNodes){for(var t in this._validationNodes)delete this._validationNodes[t];delete this._validationNodes}if(this._errorBox&&(this._errorBox.dispose(),this._errorBox=null),this._printIframe&&($removeNode(this._printIframe),this._printIframe=null),this._closeHandler=null,this._activeHandler=null,this._deactiveHandler=null,this._changeHandler=null,this._loadedHandler=null,this._service&&(this._service._disposed=!0,this._service=null),Sys.UI.CustomForm.callBaseMethod(this,"dispose"),$common&&$common.setTestState("formDisposed"),e)throw e},set_closePosition:function(e){this._closePosition=e},get_closePosition:function(){return this._closePosition},addRemoveSessionControls:function(e){$settings.DisableRemoveSessionCache||(this._removeSessionIds||(this._removeSessionIds=[]),this._removeSessionIds.push(e.get_id()))},removeControlsSession:function(){if(!(!this._removeSessionIds||$app._disposing&&this.get_isActive())){Craba.Web.Script.DataServiceBase.create(this).RemoveSessionData(this._removeSessionIds,Function.emptyMethod,Function.emptyMethod),this._removeSessionIds=null}},_addMDI:function(e,t){this._mdis||(this._mdis=[]),t?this._mdis.push(e):Array.remove(this._mdis,e)},destroyContent:function(){var e=this.get_action(!0);if(e&&(e._dynamicId?delete window[e._dynamicId]:delete window[e.get_id()]),this._disposing=!0,this._resizeControls=null,this._focusedControl){var t=this._focusedControl.get_element();if(t&&t.select)try{$common.setCaretPosition(t,0)}catch(l){}this._focusedControl=null}var r=this._mdis;if(r){for(o=(i=r.length)-1;o>=0;o--){r[o].dispose()}delete this._mdis}var n=this._childForms;if(n){for(o=(i=n.length)-1;o>=0;o--){n[o].dispose()}delete this._childForms}this._hotkeys&&(Array.clear(this._hotkeys),delete this._hotkeys);var s=this._controls;if(s){for(var i=s.length,o=i-1;o>=0;o--){var a=s[o];this.removeControl(a)}delete this._controls}this._disposing=!1,this._dataController&&(this._dataController.dispose(),this._dataController=null)},get_form:function(){return this},removeControl:function(e,t){t&&e.removeChilds&&e.removeChilds(this);var r=e._element;e.dispose(t);var n=e.get_idPart();n&&delete this[n],t&&(Array.remove(this._controls,e),r&&$removeNode(r)),e=null},removeControlById:function(e){var t=this[e];if(!t)throw Error.invalidOperation(e+"控件不存在");this.removeControl(t,!0),this.get_dataController().clear()},removeChildForm:function(e){if("string"==typeof e&&(e=this[e]),e){var t=e.get_idPart();t&&(delete this[t],delete this[t+"Action"]),Array.remove(this._childForms,e),$removeNode(e.get_element()),e.dispose(),e=null}},addControl:function(e){var t=this._controls;t||(t=this._controls=[]),this._initControlId(e,!0),e.set_form(this),Array.add(t,e)},_initControlId:function(e,t){var r=e.get_id();if(r){var n=r.split("$");if(n[1]!=this.get_id())throw Error.invalidOperation("控件 "+r+"不应加入表单 "+this.get_id());var s=n[2];if(s&&(this._checkId(t,s),this[s]=e,e.set_idPart(s)),e._panelConfigID){this["config_"+e._panelConfigID]=e}}},_checkId:function(e,t){if(e){var r=this[t],n=typeof r;if("undefined"!==n){if("function"===n){if(r.get_isDisposed())return;throw Error.invalidOperation("控件ID和窗体的函数名称重复，请更换ID名称："+t)}throw Error.invalidOperation(String.format(Sys.Res.appDuplicateComponent,id))}}},_addChilds:function(e){if(e){this._childForms||(this._childForms=[]);for(var t=0,r=e.length;t<r;t++){var n=e[t],s=$app.getForm(n);Array.add(this._childForms,s),s.set_isChildForm(!0),s.set_parentForm(this),$settings.GspxResolveCache||(s._contentElement=$get(n));var i=this.get_action(!0),o=s.get_action(!0);o&&(o._parentAction=i,o._copyFormToAction&&o._copyFormToAction(s));var a=s.get_idPart(),l=this[a];l&&(s.control=l,l.customForm=s,l.__form=this),this[a]=s,i[a]=s,i[a+"Action"]=o}}},setActionInfo:function(e,t){var r=this.get_action(!0);r&&(r.properties=e,r.events=t)},set_icon:function(e){},get_icon:function(){},get_childForms:function(){var e=this._childForms;return e||[]},raiseControlVisible:function(e){},get_contentElement:function(){return this._contentElement},get_isDisposing:function(){return this._disposing},get_isLoading:function(){return this._loading},get_isChildForm:function(){return this._isChildForm},set_isChildForm:function(e){this._isChildForm=e},get_isModal:function(){return this._isModal},set_isModal:function(e){this._isModal=e},get_isMDI:function(){return this._isMDI},set_isMDI:function(e){this._isMDI=e},get_parentForm:function(){return this._parentForm},set_parentForm:function(e){this._parentForm=e},get_url:function(){return this._url},set_url:function(e){this._url=e},get_rootUrl:function(){return this._rootUrl},set_rootUrl:function(e){this._rootUrl=e},get_baseUrl:function(){return this._baseUrl},set_baseUrl:function(e){this._baseUrl=e},get_resourcePath:function(){return this._resourcePath},set_resourcePath:function(e){this._resourcePath=e},get_scriptPath:function(){var e=this._scriptPath;return e||$app.get_scriptPath()},set_scriptPath:function(e){this._scriptPath=e},get_closeButton:function(){return this._closeButton},set_closeButton:function(e){this._closeButton=e},convertUrl:function(e){if(!e)return e;e=e.trim();var t=__pathMapName,r=this.get_rootUrl(),n=$getRootURI();if(r=r||$getRootURI(),"~/"==e.substr(0,2))return e=e.substr(2),t&&e.startsWith(t)?(e=e.trimStart(t+"/"),n+e):r+e;if(e.toLowerCase().startsWith("http"))return e;var s=this.get_baseUrl();return s&&!e.startsWith("/")?e=s+e:e.startsWith(n)?t&&e.startsWith("/"+t)&&(e=n+(e=e.trimStart("/"+t+"/"))):"/"!==n&&(e=e.substr(1),e=n+(e=this._convertToPathUrl(e))),this._corsHost&&(e=this._corsHost+(e.startsWith("/")?e:"/"+e)),e},_convertToPathUrl:function(e){var t=__pathMapName;return t&&e.startsWith(t)&&(e=e.trimStart(t+"/")),e},get_params:function(){return null==this._params&&(this._params={}),this._params},set_params:function(e){e&&e.__Params&&(e.__Params=$crabaJSON.deserialize(e.__Params,!0)),this._params=e},get_controls:function(){return this._controls},getControlsByClassName:function(e){return $common.getControlsByClassName(this,e)},get_action:function(e){if(this._action)return this._action;var t=this.get_controls();if(t&&t.length>0){var r=t[0];if(Sys.UI.PageAction.isInstanceOfType(r))return r}if(e)return null;throw Error.invalidOperation("“"+this.get_caption()+"”找不到 PageAction")},get_dataController:function(){return this._dataController||(this._dataController=new _Z_222,this._dataController.initialize()),this._dataController},get_dataSource:function(e){var t=this.get_dataController().get_dataSource();return e?Object.clone(t):t},setValidationNode:function(e,t){this._validationNodes||(this._validationNodes={}),this._validationNodes[e]=t},get_rootValidationNode:function(){var e=this._validationNodes;return e?e[""]:null},addValidationNode:function(e,t){var r=this._validationNodes;r||(r={},this._validationNodes=r);var n=this.get_rootValidationNode();n||(n={},r[""]=n);var s=n.childNodes;s||(s=[],n.childNodes=s);for(var i=s.length,o=0;o<i;o++){var a=s[o];for(var l in a)l==e&&Array.removeAt(s,o)}"boolean"!=typeof t&&Array.add(s,t)},setValidationControl:function(e){var t=this.get_validationManager(),r=null;if(this._validationNodes){var n=e?e.get_id():"";if(!(r=this._validationNodes[n])&&e&&e.get_dataField){e.get_dataField()&&(r=this._validationNodes[""])}}t.set_validationNode(r),t.clearResults()},get_validationManager:function(){return this._validationManager||(this._validationManager=new _Z_231(this),this._validationManager.initialize()),this._validationManager},dataBind:function(e,t,r){if(r||(e=Object.clone(e)),this._dataBinding)this._dataBind();else if(this.get_parentForm()||(this.isBind=!0),this.get_dataController()._setData(e),this._controls){if(!1===t){if(!e)return;this._bindData(function(t){return t.dataBind&&!t.__isPanel&&e[t._dataField]!==undefined})}else this._bindData(function(e){return e.dataBind&&!e.__isPanel});this._bindChild(t)}},_bindData:function(e){for(var t=0;t<this._controls.length;t++){var r=this._controls[t];e(r)&&(r._dataBinding=!0,r.dataBind(),r._dataBinding=!1)}},_bindChild:function(e){var t=this._childForms;if($settings.GspxResolveCache&&t)for(var r=t.length,n=0;n<r;n++){var s=t[n];if(s._dataField)if(s.isBind)delete s.isBind;else{var i=this.get_dataController();s.dataBind(i.getValue(s._dataField),e),delete s.isBind}}},saveTags:function(){var e=[],t=this._controls;if(!t)return e;for(var r=0;r<t.length;r++){var n=t[r];$craba._pushControlTag(n,e)}return e},saveData:function(e){var t=this.get_validationManager();this.setValidationControl(null);var r=!0,n=e;"object"==typeof e&&(n=e.ignore,r=e.visible);var s=this._controls;if(!s)return{};var i=this.get_dataController();delete i._panelData;for(c=0;c<s.length;c++){var o=s[c];if(o.doSaveData){(!r||o.get_visible&&o.get_visible())&&o.doSaveData(n)}}var a=this._childForms;if($settings.GspxResolveCache&&a)for(var l=a.length,c=0;c<l;c++){var d=a[c];if(d._dataField){h=d.saveData(e);i.setValue(d._dataField,h)}}t.checkResults();var h;return h=i.get_dataSource()},_dataBind:function(){if(this._dataField){var e=this.get_parentForm().get_dataController();this._dataBinding=!1,this.dataBind(e.getValue(this._dataField))}},doSaveData:function(e){if(this._dataField){var t=this.saveData(e);this.get_parentForm().get_dataController().setValue(this._dataField,t)}},cloneData:function(e){var t=this.saveData(e);return Object.clone(t)},_checkFocusControl:function(e){if(Sys.UI.Control.canFocus(e)){var t=this;return asyncCall(function(){t.get_isDisposed()||e.focus()}),!0}return!1},get_focusedControl:function(){return this._focusedControl},set_focusedControl:function(e){if(this._focusedControl=e,e){var t=$app.getLastPopup();if(t&&t.get_isModal()&&!t.popupAt){var r=e.findForm();r&&r!=t&&r.get_parentForm()!=t&&asyncCall(function(){try{t.focus()}catch(e){}})}}},focus:function(){if(this._hasMDI)return!1;var e=this.focusActiveControl(),t=this._controls;if(!t)return!1;for(var r=0;r<t.length;r++){var n=t[r];n.doFormActivate&&n.doFormActivate()}return e},blur:function(){var e=this.get_events().getHandler("deactive");e&&e(this);var t=this._controls;if(t)for(var r=0;r<t.length;r++){var n=t[r];n.doFormDeactivate&&n.doFormDeactivate()}},set_activeControl:function(e){this._activeControl=e},focusActiveControl:function(e){var t=this._controls;if(t){var r=!1;e&&(this._activeControl=e);var n=this._activeControl;if(n)if("object"==typeof n)r=this._checkFocusControl(n);else for(var s=n.split(","),i=0,o=s.length;i<o;i++){var a=s[i].trim();if(!(l=this[a])&&1==o){r=!0;break}if(a&&this._checkFocusControl(l)){r=!0;break}}if(!r)for(var i=0,o=t.length;i<o;i++){var l=t[i];if(this._checkFocusControl(l))return!0}return r}},get_pageTimeout:function(){return this._pageTimeout},set_pageTimeout:function(e){this._pageTimeout=e},get_clientSize:function(){return this._clientSize},set_clientSize:function(e){this._clientSize=e},get_pageParams:function(){return this._pageParams},addChildPage:function(e,t,r){var n=new Sys.UI.CustomForm;n.add_loaded(function(e){this._addChilds([e.get_id()])},this),e=n.convertUrl(e),e=$common.encodeUrlParams(e,r),n.set_clientSize(this.get_clientSize()),n.showPage(e,t,r)},showPage:function(e,t,r){this._url=e,this._pageParams=r,t&&(this._contentElement=t),this._load()},_getRequest:function(){var e=this.get_url();if(this._isCORS=e.toLowerCase().startsWith("http"),this._isCORS)this._corsHost=$common.getUrlHost(e);else{var t=this.get_parentForm();t&&t._corsHost&&(this._isCORS=!0,this._corsHost=t._corsHost)}var r=null;if(this._isCORS){$settings.HostMap&&(r=$settings.HostMap[this._curHost]);var n=$common.getHostUrl();this._corsHost==n&&(this._isCORS=!1,this._corsHost=null,this._url=e.replace(n,""))}return Sys.Net.PageRequestEx&&$settings.GspxResolveCache||this._isCORS||"gspx"==r?new Sys.Net.PageRequestEx(this._isChildRefresh,this._isCORS,this._corsHost):new Sys.Net.PageRequest(this)},_load:function(){var e=this._url,t=this._contentElement;if(e){this.doStartLoad();var r=this._request=this._getRequest(),n=this._url;r.set_timeout(this._pageTimeout),r.set_clientSize(this._clientSize),e=this._parentForm&&n==e?this._parentForm.convertUrl(e):n,window.event&&window.event.shiftKey&&window.event.ctrlKey&&window.event.altKey&&window.open(e),r._form=this,r.invoke(e,$createDelegate(this,this._pageSuccess),$createDelegate(this,this._pageFailure))}else t.innerHTML="(空白)"},get_isAsync:function(){return this._isAsync||null!=this._contentElement},refresh:function(e,t,r){if(this.__saveData&&(this.saveData=this.__saveData),this._loading||!1===this._loaded)return!1;this._loading=!0,this._loaded=!1,this._isChildRefresh=this.get_isChildForm();var n=this.get_events().getHandler("refresh");n&&n(this),e&&(e=this.convertUrl(e),this._url=e=$common.addUrlTickParam(e),t&&(this._url=$common.encodeUrlParams(e,t),this._pageParams=t)),this._contentElement?($common.hideHint("disposed"),$step.removeStep(),this.destroyContent(),this.removeControlsSession(),this._contentElement.innerHTML="",this._closeHandler&&this.remove_close(this._closeHandler),this._activeHandler&&this.remove_active(this._activeHandler),this._deactiveHandler&&this.remove_deactive(this._deactiveHandler),this._changeHandler&&this.remove_change(this._changeHandler),this._loadedHandler&&this.remove_loaded(this._loadedHandler),this._initHandler&&this.remove_init(this._initHandler),r&&this.get_events().clear(),this._load()):$common.refresh(this._url)},doStartLoad:function(){this._loading=!0,this._loaded=!1,$app._loadingPage=!0,this._isMDIForm&&$dom.addCssClass(this._contentElement,"PageLoading"),this.doShowProgressor()},rebuildSettings:function(){this._isCORS&&window.$corsSettings&&(window.$settings=window.$oldSettings)},doEndLoad:function(e){this.doHideProgressor(),this.doBeforeEndLoaded(),this.reloadScript(),this.rebuildSettings(),this._logTime(),this._loading=!1,$app._loadingPage=!1;var t=this;setTimeout(function(){t.doAsyncEndLoad(e)},10)},doAsyncEndLoad:function(e){if(!this.get_isDisposed()&&!this._loading){this._initChilds(),this.doLoadedControls(this._controls),this._loaded=!0;try{this._initAction()}finally{this._allLoaded=!0,this.doEndLoaded(),e&&(this.doLoaded(),this.focusActiveControl())}this._isMDIForm&&$dom.removeCssClass(this._contentElement,"PageLoading")}},_initChilds:function(){if($settings.GspxResolveCache&&this._childForms){for(var e=0,t=this._childForms.length;e<t;e++){(r=this._childForms[e])._isInited||(r._doInit(r._service),r.doInitControls(r._controls),r.doLoadedControls(r._controls),r._contentElement=$get(r.get_id()),r._contentElement.control=r,r.customForm=r,r.__form=this)}for(var e=0,t=this._childForms.length;e<t;e++){var r=this._childForms[e];r._allLoaded||r.doAsyncEndLoad()}}},doInit:function(e){this._doInit(e)&&this._doNext()},_doInit:function(e){this._isInited=!0,this._service=e,this._service&&(this._service._disposed=!1),this._useEsc&&this.doCancel&&!this._isMessageBox&&this.addHotkey({keyCode:Sys.UI.Key.esc},this.doCancel,this);var t=this.get_events().getHandler("init");if(!t)return!0;var r=new _Z_162;return r.callback=$createDelegate(this,this._doNext),t(this,r),!0!==r.get_cancel()},_doNext:function(){this.doInitControls(this._controls),this.get_isAsync()&&!this._isMessageBox||(this.doLoadedControls(this._controls),this.doAsyncEndLoad())},doInitControls:function(e,t){if(e)for(var r=0;r<e.length;r++){var n=e[r];n.doFormInit&&!n.__inited&&(n.doFormInit(this),n.__inited=!0),t&&(n._required&&n.set_required&&n.set_required(!0),n.doFormLoaded&&n.doFormLoaded())}},doLoadedControls:function(e){if(e){for(t=0;t<e.length;t++){(n=e[t]).doFormLoaded&&!n.__loaded&&(n.doFormLoaded(this),n.__loaded=!0)}for(var t=0,r=e.length;t<r;t++){var n=e[t];n.doPageLoaded&&!n.__pageLoaded&&(n.doPageLoaded(this),n.__pageLoaded=!0)}}},_initAction:function(){if(!this.isCustomModal){var e=this.get_action(!0);if(e&&e.initialize(),!this._isChildForm&&!this.get_isModal()&&!this._hasPageControl&&!this._hasGrid&&this.get_contentElement()){var t=this.get_contentElement().firstChild;$dom.addCssClass(t,"oauto")}}},get_element:function(){return this._contentElement||(this._contentElement=$get(this.get_id())),this._contentElement},set_width:function(e){return $common.setWidth(this.get_element(),e)},get_width:function(){return this.get_element().offsetWidth},set_height:function(e){return $common.setHeight(this.get_element(),e)},get_height:function(){return this.get_element().offsetHeight},set_useEsc:function(e){this._useEsc=e},get_useEsc:function(){return this._useEsc},get_showCloseButton:function(){return this._showCloseButton},set_showCloseButton:function(e){this._showCloseButton=e,this.get_isInitialized()&&this._buttonClose&&$dom.setVisible(this._buttonClose,e)},doBeforeEndLoaded:function(){},doEndLoaded:function(){},_logTime:function(){var e=this._request;if(e){var t=e.get_elapsedTime(),r=(new Date).getTime()-e._createdTime,n=this.get_url(),s=n.indexOf("?");n=s>=0?n.substring(0,s):n;var i=this._request.get_requestID();i&&r>0&&(t<=0&&(t=r),$adminService.LogCrabaClientSpeed({requestguid:i,networkelapsed:t,clientelapsed:r})),$debug.log(this.get_caption()+"："+n+"\n加载总时间: "+r+"，网络费时: "+t+"，其它费时："+(r-t))}},reloadScript:function(){if(this._contentElement)for(var e=this._contentElement.getElementsByTagName("script"),t=0,r=e.length;t<r;t++){var n=e[t];if(""!=n.src){var s=n.parentNode;s.removeChild(n);var i=document.createElement("script");i.charset=n.charset,i.src=n.src,i.type=n.type,n=null,s.appendChild(i)}}},doShowProgressor:function(){this.internalShowProgressor()},internalShowProgressor:function(){var e=this;this._waitTimer=setTimeout(function(){e._showWaitingForTimer()},$settings.PageWaitingTimerValue)},_showWaitingForTimer:function(){if(!this._progressorVisible){var e=null,t=this._loadingElement?this._loadingElement:this._contentElement;t&&(e=t.offsetHeight>=60?t:null),$common.showLoading(e),this._progressorVisible=!0}},internalHideProgressor:function(){this._waitTimer&&clearTimeout(this._waitTimer),this._progressorVisible&&($common.hideLoading(),this._progressorVisible=!1)},doHideProgressor:function(){this.internalHideProgressor()},doActive:function(){var e=this.get_events().getHandler("active");e&&e(this)},add_active:function(e,t){return!0===t&&(this._activeHandler=e,t=null),this.get_events().addHandler("active",e,t)},remove_active:function(e){this.get_events().removeHandler("active",e)},add_deactive:function(e,t){return!0===t&&(this._deactiveHandler=e,t=null),this.get_events().addHandler("deactive",e,t)},remove_deactive:function(e){this.get_events().removeHandler("deactive",e)},add_close:function(e,t){return!0===t&&(this._closeHandler=e,t=null),this.get_events().addHandler("close",e,t)},remove_close:function(e){this.get_events().removeHandler("close",e)},add_resize:function(e,t){this.get_events().addHandler("resize",e,t)},remove_resize:function(e){this.get_events().removeHandler("resize",e)},set_minWidth:function(e){this._minWidth=e,this._isSetWidth=!0},get_minWidth:function(){return this._minWidth},set_minHeight:function(e){this._minHeight=e,this._isSetHeight=!0},get_minHeight:function(){return this._minHeight},_initResizer:function(){},set_allowResize:function(e){this._allowResize=e,this._loading||this._initResizer()},get_allowResize:function(){return this._allowResize},set_fullWindow:function(e){this._fullWindow=e},get_fullWindow:function(){return this._fullWindow},_doResizeHandler:function(e,t,r,n){if(!this._loading){var s=new _Z_167(e,t,r,n),i=this.get_events().getHandler("resize");i&&i(this,s),this.raiseResize()}},doFormResized:function(){this.raiseResize()},raiseResize:function(e,t){var r=this,n=e||r._controls;if(n){asyncCall(function(){if(!r.get_isDisposed()){for(var e=0,s=n.length;e<s;e++){var i=n[e];if(i.doFormResized&&($craba.checkControlInPopup(i,r),!i.__inPopup)){var o=i.get_element();o&&(0!=o.offsetWidth?i.doFormResized():i._hasResized=!0)}}if(!t)for(var a=r.get_childForms(),e=0,s=a.length;e<s;e++)a[e].raiseResize()}})}},close:function(){},doClose:function(e){var t=this.get_events().getHandler("close");if(t){if(this.get_isActive()){var r=this.get_focusedControl();if(r&&r.doFormClose){this._noErrorAbort=!0;try{r.doFormClose()}finally{this._noErrorAbort=!1}}}else this.set_isActive(!0);t(this,e)}},add_change:function(e,t){return!0===t&&(this._changeHandler=e,t=null),this.get_events().addHandler("change",e,t)},remove_change:function(e){this.get_events().removeHandler("change",e)},add_refresh:function(e,t){return this.get_events().addHandler("refresh",e,t)},remove_refresh:function(e){this.get_events().removeHandler("refresh",e)},doChange:function(e){handler=this.get_events().getHandler("change"),handler&&handler(this,e);var t=this.get_parentForm();t&&t.doChange()},get_caption:function(){var e=this._caption;return e||document.title},set_caption:function(e){this._caption=e,1==$app.get_forms().length&&(document.title=e)},_pageSuccess:function(e){if(e.redirect)location=e.redirect;else{this.Context=e,e.clientContext&&this.setContexts(e.clientContext);this.get_id()?($app.removeForm(this),this._id=e.pageId):this.set_id(e.pageId),$app.addForm(this),e.pageTitle&&this.set_caption(e.pageTitle),e.pageSubTitle&&this.set_subCaption&&this.set_subCaption(e.pageSubTitle);var t=e.styleBlock;t&&this._setStyleBlock(t),this._showVersionTips=e.showVersionTips,this._contentElement.innerHTML=e.html,this._activeControl=e.activeControl;var r=e.scriptIncludes,n=e.styleIncludes,s=e.scriptBlock,i=this,o=function(){if(s||r){var e=$jsLoader.getInstance();i._loadScriptTryCount=0,i._loadScript(e,r,s)}else i.doEndLoad()};n?$skin.loadCss(n,this.get_id(),o):o()}},serverResolvePageLoaded:function(e){if(e.redirect)location=e.redirect;else{this._isAsync=!0;this.get_id()?($app.removeForm(this),this._id=e.pageId):this.set_id(e.pageId),$app.addForm(this),e.pageTitle&&this.set_caption(e.pageTitle),e.clientContext&&this.setContexts(e.clientContext);var t=e.styleBlock;t&&this._setStyleBlock(t);var r=document.createElement("div");r.innerHTML=e.html;for(var n=document.getElementById("LoadingFirst"),s=r.childNodes,i=0,o=s.length;i<o;i++)document.body.insertBefore(s[0],n);$removeNode(r),$removeNode(n),this._activeControl=e.activeControl;var a=e.scriptIncludes,l=e.scriptBlock;if(l||a){var c=$jsLoader.getInstance();this._loadScriptTryCount=0,this._loadScript(c,a,l)}else this.doEndLoad()}},setContexts:function(e){this._contexts=e||{}},getContexts:function(){return this._contexts},get_context:function(e){return this._contexts[e]},set_context:function(e,t){this._contexts||(this._contexts={}),this._contexts[e]=t},_setStyleBlock:function(e){var t=this.get_id()+"_style";$skin.appendStyle(e,t)},_loadScript:function(e,t,r){if(e.get_isLoading()){if(this._loadScriptTryCount++,this._loadScriptTryCount>300)return this._pageFailure(new _Z_227(!1,"网络忙，请关闭窗口后重试")),void(window.status="");window.status="网络忙，100毫秒后重试第 "+this._loadScriptTryCount+" 次",setTimeout($createDelegate(this,function(){this._loadScript(e,t,r)}),100)}else this._loadScriptTryCount>0&&(window.status=""),this._doLoadScript(e,t,r)},_doLoadScript:function(e,t,r){if(t){this._hasNewcrabaJs=!1;try{for(var n=t.length,s=0;s<n;s++){var i=t[s];this._isCORS&&(i.toLowerCase().startsWith("http")||(i=this._corsHost+(i.startsWith("/")?i:"/"+i))),$jsLoader.isScriptLoaded(i)||($jsLoader._isNewcrabaJs(i)?this._hasNewcrabaJs=!0:e.queueScriptReference(i))}}catch(o){throw this._isError=!0,this.doEndLoad(),o}}r&&e.queueScriptBlock(r),e.loadScripts(0,$createDelegate(this,this._scriptsLoadComplete),$createDelegate(this,this._scriptsLoadFailed),$createDelegate(this,this._scriptsLoadTimeout))},_pageFailure:function(e){if(this._isError=!0,this.doEndLoad(),this._contentElement)if(e&&(e.get_message||e.message)){var t=e.message?e.message:e.get_message();e._requestId&&$settings.DefaultShowExceptionNo&&(t=String.format(Sys.Res.exceptionNoMsg,e._requestId,t)),$app.showError(Sys.ErrorType.page,t),this.close()}else!1!==e?(this._contentElement.innerHTML=e?"<div class='ErrBody'>"+e+"</div>":"未知错误",this.doHideProgressor()):this.close()},_scriptsLoadComplete:function(){try{this.doEndLoad(!0),this._isCORS||!this._hasNewcrabaJs||"false"==this._showVersionTips||$settings.AgencyConfig||$common.showHint(Sys.Res.checkVersionHTML,5,null,Sys.Res.checkVersionTitle)}catch(e){throw this._isError=!0,this.doEndLoad(),e}},_scriptsLoadFailed:function(e,t,r){throw this._isError=!0,this.doEndLoad(),$jsLoader._errorScriptLoadFailed(t,r)},_scriptsLoadTimeout:function(e){this._isError=!0,this.doEndLoad()},add_init:function(e,t){t&&(this._initHandler=e,t=null),this.get_events().addHandler("init",e)},remove_init:function(e){this.get_events().removeHandler("init",e)},get_service:function(){var e=this._service;if(!e||"object"!=typeof e){var t=this.get_caption()+" 没有WebMethod服务";throw this.get_isDisposed()&&(t=this.get_caption()+"已经关闭, WebMethod服务不能使用"),Error.abort(t)}return e.set_form(this),e},add_loaded:function(e,t){!0===t&&(this._loadedHandler=e,t=null),this.get_events().addHandler("loaded",e,t)},remove_loaded:function(e){this.get_events().removeHandler("loaded",e)},doLoaded:function(e){var t=this.get_events().getHandler("loaded");t&&t(this,e),$common.setTestState("formId",this.get_id())},add_closed:function(e,t){this.get_events().addHandler("closed",e,t)},remove_closed:function(e){this.get_events().removeHandler("closed",e)},doClosed:function(e){var t=this.get_events().getHandler("closed");t&&t(this,e)},add_notifyClose:function(e,t){this.get_events().addHandler("notifyClose",e,t)},remove_notifyClose:function(e){this.get_events().removeHandler("notifyClose",e)},notifyClose:function(e){var t=this.get_events().getHandler("notifyClose");t&&t(this,e)},get_hasCloseNotifier:function(){return null!=this.get_events().getHandler("notifyClose")},get_bounds:function(){var e=this.get_element();return e?$dom.getBounds(e):getClientBounds()},set_bounds:function(e){},resize:function(){},getControl:function(e){var t=null;if(e){var r=e.split("$");3==r.length&&(e=r[2]),t=this[e]}if(!t)throw Error.invalidOperation("控件 "+e+" 不存在");return t},getElement:function(e,t){var r=$get("$"+this.get_id()+"$"+e);if(!r&&!t)throw Error.invalidOperation("标签 "+e+" 不存在");return r},errorAbort:function(e,t){if(!this._noErrorAbort){var r=this._errorBox;if(!this.get_isActive())return r&&r.hide(),void(t&&(this._activeControl=t));if(r||(r=this._errorBox=new _Z_102),r.absoluteHide)throw r.absoluteHide=!1,r.hide(),Error.abort();if(r.get_visible()){var n=r.get_control();t==n?(r.hide(),r.show(e,t)):t=n}else r.show(e,t);throw t&&t.focus&&asyncCall(function(){t.focus()}),Error.abort()}},get_hasErrors:function(){return!!this._errorBox&&this._errorBox.get_visible()},clearErrors:function(e){if(this._errorBox){var t=this._errorBox.get_control();t&&t!=e||this._errorBox.hide()}},addHotkey:function(e,t,r){r&&(t=$createDelegate(r,t)),this._hotkeys||(this._hotkeys=[]);var n=new Object;return n.hotkey=e,n.handler=t,n.control=r,Array.add(this._hotkeys,n),t},removeHotkey:function(e){var t=this._hotkeys;if(t)for(var r=0,n=t.length;r<n;r++)if(this._hotkeyEquals(t[r].hotkey,e)){Array.removeAt(t,r);break}},_hotkeyEquals:function(e,t){return e.keyCode==t.keyCode&&e.shiftKey==t.shiftKey&&e.ctrlKey==t.ctrlKey&&e.altKey==t.altKey},addShortcut:function(e,t,r){var n=_Z_220.shortcutToHotkey(e);n&&this.addHotkey(n,t,r)},removeShortcut:function(e){var t=_Z_220.shortcutToHotkey(e);t&&this.removeHotkey(t)},_internalProcessHotkey:function(e){var t=this._hotkeys;if(!t||0==t.length)return!1;for(var r=0,n=t.length;r<n;r++){var s=t[r],i=s.hotkey;if(_Z_220.matchHotkey(i,e)){if(s.control){var o=$craba.findInTab(s.control);if(o&&!o.get_selected())continue}return s.handler(e),!(this.get_isChildForm()&&!this.get_isDisposed())}}return!1},get_isActive:function(){var e=!$app.get_hasModalPopup();if(this.get_isChildForm()){var t=this.get_parentForm();if(t._hasMDI)return!1;if(e=t?t.get_isActive():e,this._contentElement){var r=this._contentElement.parentNode;$dom.hasClass(r,"TabPage")&&(e=e&&"absolute"!=r.style.position)}}return $step._stepShow?$step._stepForm==this:e},set_isActive:function(e){},get_enabled:function(){return this._enabled},set_enabled:function(e,t){this._enabled=e;if(t instanceof Array){for(var r=this.get_controls(),n=0,s=r.length;n<s;n++){var i=r[n];if(i.set_enabled&&(!_Z_41.isInstanceOfType(i)&&!(Sys.UI.Controls.PopupBlock.isInstanceOfType(i)||Sys.UI.Controls.Popup.isInstanceOfType(i)||Sys.UI.Controls.Menu.isInstanceOfType(i)||Sys.UI.Controls.MenuItem.isInstanceOfType(i)))){l=i.get_idPart();if(!Array.contains(t,l)){var o=i.get_dataField?i.get_dataField():"";o&&Array.contains(t,o)||i.set_enabled(e)}}}if(this._childForms)for(var s=this._childForms.length,n=0;n<s;n++){var a=this._childForms[n],l=a.get_idPart();Array.contains(t,l)||a.set_enabled(e,t)}}else $craba._initEnabledlay(this)},get_zIndex:function(){return this._zIndex},get_configId:function(){return this._configId},set_configId:function(e){this._configId=e},get_configGUID:function(){return this._configGUID},set_configGUID:function(e){this._configGUID=e},get_internalId:function(){return this._internalId},set_internalId:function(e){this._internalId=e},set_configData:function(e){this._configData=e},_saveConfig:function(){Object.isEmpty(this._configData)&&(this._configData=null);var e=this.get_configGUID(),t=this._configData;if(!$craba.checkConfig("form",e,t)){Craba.Web.Script.DataServiceBase.create(this).SaveFormConfig(e,t,Function.emptyMethod,Function.emptyMethod)}},_internalGetControlConfig:function(e){if(!this._configData)return null;var t=$craba.FormConfigName+e;return this._configData[t]},_internalSaveControlConfig:function(e,t){this._configData||(this._configData={});var r=$craba.FormConfigName+e;null==t?delete this._configData[r]:this._configData[r]=t,this._saveConfig()},get_controlID:function(e){var t,r=this.controlIds;r||(r=this.controlIds={});var n=r[e];t=n?parseInt(n)+1:1,r[e]=t;var s=e+t;return"undefined"!=typeof this[s]?this.get_controlID(e):s},get_visible:function(){return!!this._contentElement&&"none"!=this._contentElement.style.display},set_visible:function(e){this._contentElement&&$dom.setVisible(this._contentElement,e)}},Sys.UI.CustomForm.registerClass("Sys.UI.CustomForm",_Z_242),Sys.UI.ChildForm=function(){Sys.UI.ChildForm.initializeBase(this)},Sys.UI.ChildForm.prototype={set_caption:function(e){this._caption=e}},Sys.UI.ChildForm.registerClass("Sys.UI.ChildForm",Sys.UI.CustomForm),_Z_222=function(e){this._dataSource=e,this._supportsObjProp=!0},_Z_222.prototype={initialize:function(){},dispose:function(){delete this._dataSource},_setData:function(e){e&&"string"==typeof e&&(e=$crabaJSON.deserialize(e)),this._dataSource=e||{}},hasDataSource:function(){return this._panelData||this._dataSource},get_dataSource:function(){return this._panelData||this._dataSource},clear:function(){this._dataSource={}},getValue:function(e){var t=this._panelData||this._dataSource;return t?this._doGetObjProp(t,e):null},getText:function(e){var t=this.getValue(e);return null!=t?t:""},getValueDisplayText:function(e,t){return displayValue=e?this._doGetObjProp(e,t):null,null!=displayValue?displayValue:""},setValue:function(e,t){this._panelData?this._doSetObjProp(this._panelData,e,t):(this._dataSource||(this._dataSource={}),this._doSetObjProp(this._dataSource,e,t))},get_supportsObjProp:function(){return this._supportsObjProp},set_supportsObjProp:function(e){this._supportsObjProp=e},_doGetObjProp:function(e,t){return this._supportsObjProp?$craba.getPropValue(e,t):e[t]},_doSetObjProp:function(e,t,r){var n=t.indexOf(".");if(n>0){var s=t.substring(0,n);t=t.substr(n+1);var i=e[s];i||(i={},e[s]=i),this._doSetObjProp(i,t,r)}else e[t]=r}},_Z_222.registerClass("_Z_222"),Sys.UI.PageAction=function(){Sys.UI.PageAction.initializeBase(this),this.events={},this.properties={}},Sys.UI.PageAction.prototype={get_service:function(){return this.get_form().get_service()},injectMembers:function(e){Object.getType(this).injectMembers(e)},_copyFormToAction:function(e){for(var t=e._controls,r=0;r<t.length;r++){var n=t[r];this[n.get_idPart()]=n}},get_element:function(){return $get(this.get_form().get_id())},hasEvent:function(e){return!!this.events[e]},event:function(e){var t=this.events[e];if(t&&this._parentAction){var r=this._parentAction[t];if(r){for(var n=[],s=1;s<arguments.length;s++)n.push(arguments[s]);r.apply(this._parentAction,n)}}},queryString:function(e){var t=this.get_form();return t?$common.getPathParam(t.get_url(),e):null},queryForm:function(e){var t=this.get_form();if(!t)return null;var r=t.get_pageParams();return r&&"object"==typeof r?r[e]:null},get_root:function(){var e=this._parentAction;if(!e)return null;for(;e._parentAction;)e=e._parentAction;return e},get_parent:function(){return this._parentAction},get_property:function(e,t){var r=this.properties[e];if(Object.isUndefinedOrNull(r))return t;if(""===r)return t;var n=typeof t;return"boolean"==n?r=Boolean.convert(r):"number"==n&&(r=$express.toNumber(r)),r},get_context:function(e){var t=this.get_form();return t?t.get_context(e):null},set_context:function(e,t){var r=this.get_form();return r?(r.set_context(e,t),t):null},getPageSize:function(e,t){if(!this.pageTag)return t;var r=this.pageTag.findTag(e);if(!r)return t;var n=r.get_configData();return n?n.PageSize||t:r.xmlNode.Attributes.PagerPageSize||t},_addHandler:function(e,t){this.get_events().addHandler(e,t)},_doHandler:function(e,t){var r=this.get_events().getHandler(e);r&&r.apply(this,t)}},Sys.UI.PageAction.registerClass("Sys.UI.PageAction",_Z_242);var $createAction=Sys.UI.PageAction.create=function(e,t,r,n){var s=$createType(e);if(!s)throw Error.argumentNull("Action类");if(n||(n=new s),!Sys.UI.PageAction.isInstanceOfType(n))throw Error.invalidOperation(Object.getTypeName(n)+" 没有从 Sys.UI.PageAction 继承");if(n.set_id(t),!r)throw Error.argumentNull("form");return r.addControl(n),window[t]=n,n};$jsLoader=_Z_223=function(){this._scriptsToLoad=null,this._scriptLoadedDelegate=$createDelegate(this,this._scriptLoadedHandler),this._log=new Sys.StringBuilder},$jsLoader.prototype={dispose:function(){this._stopLoading(),this._events&&delete this._events,this._scriptLoadedDelegate=null,this._log=null},get_isLoading:function(){return this._loading},loadScripts:function(e,t,r,n){if(this._loading)throw Error.invalidOperation(Sys.Res.scriptLoaderAlreadyLoading);this._loading=!0,this._log.clear(),this._allScriptsLoadedCallback=t,this._scriptLoadFailedCallback=r,this._scriptLoadTimeoutCallback=n,this._loadScriptsInternal()},_trace:function(e,t){var r=this._log;r&&(r.appendLine(Date.dateTimeToStr(new Date)+" "+e),t&&$debug.serverLog(r.toString()))},notifyScriptLoaded:function(){this._loading?this._currentTask&&(this._currentTask._notified++,this._trace("["+this._currentTask._notified+"] "+this._currentTask.get_scriptSrc())):this._trace("[NotLoading]")},queueCustomScriptTag:function(e){this._scriptsToLoad||(this._scriptsToLoad=[]),Array.add(this._scriptsToLoad,e)},queueScriptBlock:function(e){this._scriptsToLoad||(this._scriptsToLoad=[]),Array.add(this._scriptsToLoad,{text:e})},queueScriptReference:function(e){this._scriptsToLoad||(this._scriptsToLoad=[]),Array.add(this._scriptsToLoad,{src:e})},_addSrcScriptElement:function(e){var t=document.createElement("SCRIPT");t.type="text/javascript",t.src=e;var r=$createDelegate(this,this._scriptSrcLoaded);return t.onload=t.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(r(e),t.onload=t.onreadystatechange=t.onerror=null)},t.onerror=function(){r(e),t.onload=t.onreadystatechange=t.onerror=null},document.getElementsByTagName("HEAD")[0].appendChild(t),t},_scriptSrcLoaded:function(e){$jsLoader.push(e),this._loadScriptsInternal()},_loadScriptsInternal:function(){if(this._scriptsToLoad&&this._scriptsToLoad.length>0){var e=Array.dequeue(this._scriptsToLoad);"string"==typeof e.src?e.src.startsWith("http")?this._addSrcScriptElement(e.src):(this._currentTask=new _Z_223Task(e.src,this._scriptLoadedDelegate),this._currentTask.execute()):this.addScriptElement(e.text)}else{var t=this._allScriptsLoadedCallback;this._stopLoading(),t&&t(this)}},addScriptElement:function(e,t){var r=$app.addScriptElement(e),n=this;setTimeout(function(){$jsLoader._clearScript(r),t||n._loadScriptsInternal()},0)},_raiseError:function(e){var t="";this._currentTask&&(t=this._currentTask.get_scriptSrc());var r=this._scriptLoadFailedCallback;if(this._stopLoading(),this._trace("[Error] "+e,!0),!r)throw $jsLoader._errorScriptLoadFailed(t,e);r(this,t,e)},_scriptLoadedHandler:function(e,t,r){this._trace("[End]"),t?($jsLoader.push(e),this._currentTask.dispose(),this._currentTask=null,this._loadScriptsInternal()):this._raiseError(r)},_scriptLoadTimeoutHandler:function(){var e=this._scriptLoadTimeoutCallback;this._stopLoading(),e&&e(this)},_stopLoading:function(){this._timeoutCookie&&(clearTimeout(this._timeoutCookie),this._timeoutCookie=null),this._currentTask&&(this._currentTask.dispose(),this._currentTask=null),this._scriptsToLoad=null,this._loading=null,this._allScriptsLoadedCallback=null,this._scriptLoadFailedCallback=null,this._scriptLoadTimeoutCallback=null}},$jsLoader.registerClass("_Z_223",null,Sys.IDisposable),$jsLoader.getInstance=function(){var e=$jsLoader._activeInstance;return e||(e=$jsLoader._activeInstance=new $jsLoader),e},$jsLoader.isScriptLoaded=function(e){var t=$jsLoader._getLoadedScripts();return e=$jsLoader.convetScriptSrc(e),Array.contains(t,e)},$jsLoader.push=function(e){e=$jsLoader.convetScriptSrc(e),$jsLoader.isScriptLoaded(e)||Array.add($jsLoader._getLoadedScripts(),e)},$jsLoader.convetScriptSrc=function(e){if(e.indexOf("R.axd")>-1)return e;if(!e)return"";var t=location.protocol+"//"+location.host+"/";return e.startsWith("http")||(e=t+e.trimStart("/")),$common.removeUrlParams(e)},$jsLoader._clearScript=function(e){Sys.Debug.isDebug||$removeNode(e)},$jsLoader._errorScriptLoadFailed=function(e,t){var r="脚本加载失败: "+t,n=Error.create(r,{name:"Sys.ScriptLoadFailedException",scriptUrl:e});return n.popStackFrame(),n},$jsLoader._getLoadedScripts=function(){if(!$jsLoader._referencedScripts){var e=$jsLoader._referencedScripts=[],t=document.getElementsByTagName("SCRIPT");for(i=t.length-1;i>=0;i--){var r=t[i].src;if(r.length){var n=r.startsWith("https://")?"https://":"http://";if(r.startsWith(n)){var s=(r=r.substr(n.length)).indexOf("/");if(s<=0)throw Error.invalidOperation("错误的地址："+r);r=r.substr(s)}Array.contains(e,r)||Array.add(e,r)}}}return $jsLoader._referencedScripts},$jsLoader._parseScriptUrl=function(e){var t={version:0,path:e};if(!e)return t;var r=e.match(/v=(\d+)&r=(.+)/);if(r&&r[2])t.version=parseInt(r[1]),t.path=r[2];else if(e.indexOf("?v=")>-1){var n=e.split("?v=");t.version=parseInt(n[1]),t.path=n[0]}return t},$jsLoader._isNewcrabaJs=function(e){var t=$jsLoader._parseScriptUrl(e),r=t.version;if(0==r)return!1;for(var n=t.path,s=$jsLoader._getLoadedScripts(),i=0,o=s.length;i<o;i++)if((t=$jsLoader._parseScriptUrl(s[i])).version!=r&&t.path==n)return!0;return!1},_Z_223Task=function(e,t){this._scriptSrc=e,this._completedCallback=t,this._notified=0,this._timer=null,this._tryCount=0,this._maxTryCount=5,this._jsTagCookieKey="__jsTag"},_Z_223Task.prototype={dispose:function(){this._disposed||(this._disposed=!0,this._scriptSrc=null,this._clearTimer())},_clearTimer:function(){null!=this._timer&&(clearTimeout(this._timer),this._timer=null,this._tryCount=0,window.status="")},get_scriptSrc:function(){return this._scriptSrc},_trace:function(e,t){$jsLoader.getInstance()._trace(e,t)},execute:function _Z_223Task$execute(custom,sync){function onComplete(response,eventArgs){if(!$jsLoader.isScriptLoaded(url)){var scriptRequestFailedNoMsg="网络异常";if(response.get_responseAvailable()){var statusCode=response.get_statusCode(),result=null,ex=null;try{result=response.get_responseData()}catch(e){ex=e}result||(ex=scriptRequestFailedNoMsg);var error=null;if(statusCode<200||statusCode>=300||null!=ex)ex?error=ex.toString():result?404==statusCode&&(error=String.format("“{0}”不存在",url)):error=scriptRequestFailedNoMsg,404!=statusCode&&(error+="，错误码 "+statusCode),0==statusCode?(this._error=error,this._reExecute(jsTag)):this._scriptErrorHandler(error);else{var fuckISP=!1,ex=null,isResource=url.indexOf(".axd")>0;try{if(isResource&&url.indexOf("echarts")<0&&/document\.write/gi.test(result))ex="正在执行的javascript包含不允许的脚本document.write语句，可能是被网络运营商强制改写",fuckISP=!0;else if(isResource&&!$common.gspxParse&&result.indexOf("Sys.Application.notifyScriptLoaded()")<0)ex="正在执行的javascript不是嵌入资源的文件，可能是被网络运营商强制植入",fuckISP=!0;else{if($settings.GspxResolveCache){var newUrl=$common.removeUrlParam(url,$settings.StaticVersionName);result=result+"\r\n//# sourceURL="+newUrl}1==$common.getUrlParam("debugJs")?evil(result):eval(result),$common.gspxParse&&$app.notifyScriptLoaded()}}catch(e){ex=e;var testScriptDom=$app.addScriptElement(result);throw $jsLoader._clearScript(testScriptDom),ex.fileName="发生异常的脚本文件:"+url,ex}ex?error="语法错误，"+(ex&&ex.message?ex.message:ex):1==this._notified||!isResource||custom?this._scriptLoadHandler(sync):error="通知次数("+this._notified+")不对",error&&(this._error=error,this._trace("[Error] "+error+"。"+this._copyScriptPart(result,fuckISP)),this._maxTryCount=8,this._trace("[Timer] 创建为内容错"),this._reExecute(jsTag))}}else response.get_timedOut()?(this._trace("[Timer] 创建"),this._timer=setTimeout($createDelegate(this,this._onTimeout),5e3)):this._scriptErrorHandler(scriptRequestFailedNoMsg)}}var url=this._scriptSrc,jsTag=this._getJsTagCookie();jsTag>0&&(url+=url.indexOf("?")>0?"&":"?",url+="tag="+jsTag),this._trace("[Begin] "+url);var request=new Sys.Net.WebRequest;request.set_async(!sync),request.set_url(url),request.add_completed($createDelegate(this,onComplete)),request.invoke()},_reExecute:function(e){this._setJsTagCookie(e+1),this._timer=setTimeout($createDelegate(this,this._onTimeout),10)},_getJsTagCookie:function(){var e=0,t=document.cookie;if(t.length>0){var r=this._jsTagCookieKey+"=",n=t.indexOf(r);if(-1!=n){n+=r.length;var s=t.indexOf(";",n);-1==s&&(s=t.length);var i=unescape(t.substring(n,s));e=parseInt(i)}}return e},_setJsTagCookie:function(e){var t=new Date((new Date).getTime()+864e7);t="; expires="+t.toGMTString(),document.cookie=this._jsTagCookieKey+"="+escape(e)+t+";path=/"},_copyScriptPart:function(e,t){if(!(e=e?e.toString():null))return null;var r=e.length;return(e=t?e:e.substr(Math.max(0,r-200))).replace(/\n/g," ").replace(/\r/g," ")},_scriptErrorHandler:function(e){if(!this._disposed){var t=this.get_scriptSrc();this._completedCallback(t,!1,e)}},_scriptLoadHandler:function(e){if(!this._disposed){var t=this.get_scriptSrc();if(e)this._completedCallback(t,!0);else{var r=this;setTimeout(function(){r._completedCallback(t,!0)},0)}}},_onTimeout:function(e){if(!this._disposed&&this._timer){var t=this.get_scriptSrc();if(this._tryCount++,this._tryCount>this._maxTryCount)this._trace("[Timer] "+this._maxTryCount+"次尝试"),this._completedCallback(t,!1,this._error?this._error:"网络超时"),window.status="";else{var r="加载重试第 "+this._tryCount+" 次";this._trace("[Timer] "+r),window.status=r,this.execute()}}}},_Z_223Task.registerClass("_Z_223Task",null,Sys.IDisposable),_Z_224=function(){_Z_224.initializeBase(this),this._formMap={},this._forms=[],this._popups=[],this._blockPopups=[],this._unloadHandlerDelegate=$createDelegate(this,this._unloadHandler),this._loadHandlerDelegate=$createDelegate(this,this._loadHandler),$addHandler(window,"unload",this._unloadHandlerDelegate),$addHandler(window,"load",this._loadHandlerDelegate),$addHandler(window,"mousewheel",this._onMouseWheel),this.IsDraging=!1,this.IsPopup=!1,this._scriptPath=null,this._timeoutHandler=null,this.PopupMaxIndex=9998,this.MenuMaxIndex=9999,this.StepIndex=10001},_Z_224.prototype={_creatingComponents:!1,_disposing:!1,_hotkeyHandler:null,initialize:function(e){this.initSettings(e),this._initialized||this._initializing||(this._initializing=!0,setTimeout($createDelegate(this,this._doInitialize),0),$settings.AllPrintUseService||Craba.Web.Script.DataServiceBase.initCloudInfo(),this.rewriteMath()),e&&this.checkBrowser()},_onMouseWheel:function(e){$craba.moveDropPopup()},isLocal:function(){var e=window.location.host;return e.startsWith("localhost")||e.startsWith("127.0.0.1")},initSettings:function(e){if("object"==typeof e){Object.copyTo(e,window.$settings),$settings.EnableSaveMDIPageLocation||($settings.EnableSaveMDIPageLocation=this.isLocal()),window.$settings.__notInited=!1;var t=e.DefaultWebRequestTimeout;if(t>0&&$webManager.set_defaultTimeout(t),e.AntiHijack&&window.parent!=window){var r=window.frameElement;if(r&&"IFRAME"==r.tagName)return e.AntiHijackHint&&$common.showWaiting(null,e.AntiHijackHint),window.__allowRefresh=!0,void(window.parent.location=window.location)}}},initCache:function(){window.WebStorageCache=window.$cache=new Sys.WebStorageCache,window.$userCache={get:function(e){if($user.loginUserIdKey){e=$user[$user.loginUserIdKey]+"_"+e}return $cache.get(e)},set:function(e,t){if($user.loginUserIdKey){e=$user[$user.loginUserIdKey]+"_"+e}return $cache.set(e,t)},deleteCache:function(e){if($user.loginUserIdKey){e=$user[$user.loginUserIdKey]+"_"+e}$cache.deleteCache(e)}}},rewriteMath:function(){if("undefined"!=typeof math&&(Sys.Browser.isEdge||Sys.Browser.isIE)){console.log("平台重写math.round函数");var e=math.round;math.round=function(){var t=e.apply(math,arguments);return"object"==typeof t?t.valueOf():t}}},dispose:function(e){if(!this._disposing){this._disposing=!0,_Z_216.Instance&&_Z_216.Instance.dispose(),this._hotkeyHandler&&($common.removeKeyDownHandler(document,this._hotkeyHandler),this._hotkeyHandler=null),window.pageUnload&&window.pageUnload(this,Sys.EventArgs.Empty);var t=this.get_events().getHandler("unload");if(t&&t(this,Sys.EventArgs.Empty),this._forms){for(var r=this._forms.length-1;r>=0;r--){var n=this._forms[r];n&&n.dispose()}delete this._forms,delete this._formMap}this._timeoutHandler=null,_Z_220.removeHandler(window,"unload",this._unloadHandlerDelegate),this._loadHandlerDelegate&&(_Z_220.removeHandler(window,"load",this._loadHandlerDelegate),this._loadHandlerDelegate=null);var s=$jsLoader.getInstance();s&&s.dispose(),_Z_224.callBaseMethod(this,"dispose")}},set_timeoutProcesser:function(e){this._timeoutHandler=e},get_scriptPath:function(){return this._scriptPath},set_scriptPath:function(e){this._scriptPath=e},add_load:function(e){this.get_events().addHandler("load",e)},remove_load:function(e){this.get_events().removeHandler("load",e)},add_error:function(e,t){if(this._isErrord)throw Error.abort("Sys.Application.add_error全局只能绑定一次.");this._isErrord=!0,this.get_events().addHandler("_error",e,t)},remove_error:function(e){this.get_events().removeHandler("_error",e)},showError:function(e,t,r,n,s){if($common.hideWaiting(),n&&n.get_action(!0)){var i=n.get_action(!0);if(i.onError){if(!0!==i.onError(e,t,r,s))return}}var o=this.get_events().getHandler("_error"),a=new _Z_165(e,t,n);if(o){if(o(a),a.get_cancel())return;a._messageChanged&&(t=a.get_message())}if(s||(s={}),a.get_callBack()&&(s.handler=a.get_callBack()),r)throw Error.abort(t,s);$msg.alert(t,s)},add_requestCompleted:function(e,t){if(this._requestCompleted)throw Error.abort("Sys.Application.add_requestCompleted全局只能绑定一次.");this._requestCompleted=!0,this.get_events().addHandler("_requestCompleted",e,t)},_doRequestComplated:function(e){var t=this.get_events().getHandler("_requestCompleted");if(t){var r=new Sys.ReqeustCompletedEventArgs(e);return t(r),r.get_cancel()}return!1},add_netdatahandler:function(e,t){if(this._netDataHandler)throw Error.abort("Sys.Application.add_netdatahandler全局只能绑定一次.");this._netDataHandler=!0,this.get_events().addHandler("_netdatahandler",e,t)},remove_netdatahandler:function(e){this.get_events().removeHandler("_netdatahandler",e)},netDataHandler:function(e,t){$common.hideWaiting();var r=this.get_events().getHandler("_netdatahandler");if(r){var n=new _Z_166(e,t);return r(n),n.get_cancel()}return!1},add_init:function(e){this._initialized?e(this,Sys.EventArgs.Empty):this.get_events().addHandler("init",e)},remove_init:function(e){this.get_events().removeHandler("init",e)},add_inits:function(e){for(var t=0;t<e.length;t++)this.add_init(e[t])},add_unload:function(e){this.get_events().addHandler("unload",e)},remove_unload:function(e){this.get_events().removeHandler("unload",e)},findComponent:function(e,t){return t?_Z_243.isInstanceOfType(t)?t.findComponent(e):t[e]||null:this._doFindComponent(e)},_doFindComponent:function(e){var t=e.split("$"),r=t[1];if(r){var n=this.findForm(r);if(!n)throw Error.invalidOperation("找不到控件 "+e+" 所在的表单");var s=t[2];if(s)return n[s]}return null},_initHotkey:function(){!this._hotkeyHandler&&$common&&(this._hotkeyHandler=$common.addKeyDownHandler(document,this._doHotkey,this))},_doHotkey:function(e){if(e.ctrlKey&&e.shiftKey&&e.altKey&&84==e.keyCode&&$debug&&(window._testing=!window._testing,$debug.log((window._testing?"进入":"退出")+"测试状态",!0),window._testing&&($debug.log(navigator.platform),$debug.log(navigator.userAgent))),!window.isTeemoPrinting){if(e.keyCode==Sys.UI.Key.esc){if($craba.hideDropPopup())return;if($craba.hidePopupMenu())return;if($common.hideHint("esc"))return;if($step._stepShow)return void $step.hideStepPopup(!0)}for(var t=this._forms,r=t.length-1;r>=0;r--){var n=t[r];if(n&&!n.get_isDisposed()&&(n.get_isActive()&&n._internalProcessHotkey(e))){if(e.isNext())break;e.over(),e.cancel();break}}}},get_forms:function(){return this._forms},addForm:function(e){var t=e.get_id();if(!t)throw Error.invalidOperation(Sys.Res.cantAddWithoutId);if("undefined"!=typeof this._formMap[t]){e._isRepeat=!0;var r=String.format(Sys.Res.appDuplicateForm,t)+"\r\n"+e.get_url();throw Error.invalidOperation(r)}this._formMap[t]=e,Array.add(this._forms,e),this._formLoaded&&e.add_loaded&&(e.add_loaded(this._formLoaded),delete this._formLoaded)},removeForm:function(e){var t=e.get_id();t&&delete this._formMap[t],Array.remove(this._forms,e)},findForm:function(e){return this._formMap[e]||null},findFormByUrl:function(e){for(var t=this._forms,r="~/"==e.substr(0,2),n=0,s=t.length;n<s;n++){var i=t[n];if(r){var o=e.substr(2);__pathMapName&&o.startsWith(__pathMapName)&&(e="~"+o.trimStart(__pathMapName))}if(i.get_url()==e)return i}return null},getForm:function(e,t){var r=this.findForm(e);if(!r){if(t)throw Error.abort();(r=new Sys.UI.CustomForm).set_id(e),r.Context={pageId:e},this.addForm(r)}return r},notifyScriptLoaded:function(){var e=$jsLoader.getInstance();e&&e.notifyScriptLoaded()},notifyFormResize:function(e){for(var t=this._forms,r=0,n=t.length;r<n;r++){t[r].raiseResize()}},raiseLoad:function(){var e=this.get_events().getHandler("load");e&&e(this),window.pageLoad&&window.pageLoad(this,args),_Z_216.bind()},_doInitialize:function(){if(_Z_224.callBaseMethod(this,"initialize"),Sys.Browser.isIE){var e=document.body.getBoundingClientRect(),t=document.documentElement;window.__bodyXOffset=e.left+t.scrollLeft,window.__bodyYOffset=e.top+t.scrollTop}if(window.__testing){var r=document.createElement("input");r.id="__testState",r.type="hidden",document.body.appendChild(r)}var n=this.get_events().getHandler("init");n&&n(this,Sys.EventArgs.Empty),this.raiseLoad(),this._initHotkey(),this._initializing=!1},checkBrowser:function(){($settings.DefaultCheckBrowser&&!$common.supportFlexBrowsers()||!$settings.DisabledFetch&&!$settings.CrabaServer&&"undefined"==typeof fetch)&&$msg.alert(String.format(Sys.Res.browser.checkBrowserHTML,Sys.Res.browser.browserList),{iconVisible:!1,onLoad:function(e){e._screenOverlay.style.opacity="1",e._screenOverlay.style.backgroundColor="#aaa",e._screenOverlay.style.zIndex=99999999,e.get_element().style.zIndex=1e8}})},_loadHandler:function(){this._loadHandlerDelegate&&(_Z_220.removeHandler(window,"load",this._loadHandlerDelegate),this._loadHandlerDelegate=null),this.initialize()},_unloadHandler:function(e){this.dispose()},addPopup:function(e){Array.add(this._popups,e)},addBlockPopup:function(e){this.removeBlockPopup(e),this.addPopup(e),Array.add(this._blockPopups,e)},removePopup:function(e){Array.remove(this._popups,e)},removeBlockPopup:function(e){this.removePopup(e),Array.remove(this._blockPopups,e)},hideBlockPopups:function(){for(var e=0,t=this._blockPopups.length;e<t;e++)this._blockPopups[e]._fromHide(!1)},getLastPopup:function(){return Array.getLast(this._popups)},get_hasModalPopup:function(){var e=this._popups,t=e.length;if(0==t)return!1;for(var r=t-1;r>=0;r--){var n=e[r];if(n&&(n.get_isModal()&&!n.popupAt&&n.get_visible())){if(n.get_isMDI())continue;return!0}}return!1},getActiveFormZIndex:function(){var e=this.getLastPopup();return e?e.get_zIndex():10},getActiveForm:function(){if(this.get_hasModalPopup())return this.getLastPopup();for(var e=this._forms.length-1;e>=0;e--){var t=this._forms[e];if(t.get_isActive())return t}return null},getPopupElementZIndex:function(){var e=this.getLastPopup();return e?e.get_zIndex()+1:11},waitFormLoaded:function(e){this._formLoaded=e},addScriptElement:function(e){$app._startScript=!0;var t=document.createElement("SCRIPT");return t.type="text/javascript",Sys.Browser.agent!=Sys.Browser.Safari?t.text=e:t.innerHTML=e,document.getElementsByTagName("HEAD")[0].appendChild(t),$app._startScript=!1,t},closeAlert:function(){for(var e=this._forms.length-1;e>=0;e--){var t=this._forms[e];t._isMessageBox&&t.close(!0)}}},_Z_224.registerClass("_Z_224",_Z_242,_Z_243),$app=Sys.Application=new _Z_224,$app.initCache();var $find=$createDelegate(Sys.Application,Sys.Application.findComponent);Type.registerNamespace("Sys.Net"),Sys.Net.WebRequest=function(){this._url="",this._headers={},this._body=null,this._userContext=null,this._httpVerb=null,this._executor=null,this._invokeCalled=!1,this._timeout=0,this._async=!0,this._createdTime=(new Date).getTime(),this._withCredentials=!0},Sys.Net.WebRequest.prototype={doBeforeRequest:function(){if(this._checkCache){var e=this.get_url(),t=$common.removeUrlParams(e);if($app.gspxCache[t])return this.completedByCache(),!1}return!0},add_completed:function(e){this.getEvList().addHandler("completed",e)},remove_completed:function(e){this.getEvList().removeHandler("completed",e)},completed:function(e){this._doCompleted(e)},_doCompleted:function(e){var t=$webManager.getEvList().getHandler("completedRequest");t&&t(this._executor,e),(t=this.getEvList().getHandler("completed"))&&t(this._executor,e);var r=(new Date).getTime();if(window._testing){var n=r-this._startTime;$debug.log("WebRequestURL:"+this.get_url()+"，耗时:"+n)}},completedByCache:function(){var e=this.get_executor();e._responseAvailable=!0,e._xmlHttpRequest={status:200,responseText:"cache"},console.log("已使用缓存:"+this._url);var t=this;asyncCall(function(){t.completed(Sys.EventArgs.Empty)})},getEvList:function(){return this._events||(this._events=new _Z_237),this._events},get_url:function(){return this._url},set_url:function(e,t){this._url=e,this._checkCache=t},get_headers:function(){return this._headers},get_httpVerb:function(){return null===this._httpVerb?null===this._body?"GET":"POST":this._httpVerb},set_httpVerb:function(e){if(0===e.length)throw Error.argument("value",Sys.Res.invalidHttpVerb);this._httpVerb=e},set_withCredentials:function(e){this._withCredentials=e},get_withCredentials:function(){return this._withCredentials},get_body:function(){return this._body},set_body:function(e){this._body=e},get_userContext:function(){return this._userContext},set_userContext:function(e){this._userContext=e},get_executor:function(){return this._executor},set_executor:function(e){if(null!==this._executor&&this._executor.get_started())throw Error.invalidOperation(Sys.Res.setExecutorAfterActive);this._executor=e,this._executor._set_webRequest(this)},get_timeout:function(){return 0===this._timeout?$webManager.get_defaultTimeout():this._timeout},set_timeout:function(e){this._timeout=e},get_async:function(){return this._async},set_async:function(e){this._async=e},set_notThrowError:function(e){this._notThrowError=e},get_notThrowError:function(){return this._notThrowError},getResolvedUrl:function(){return Sys.Net.WebRequest._resolveUrl(this._url)},abort:function(){this._abort=!0,null!==this._executor&&this._executor.get_started()&&this._executor.abort()},set_reponseType:function(e){this._responseType=e},invoke:function(){if(this._invokeCalled)throw Error.invalidOperation(Sys.Res.invokeCalledTwice);this._startTime=(new Date).getTime(),$webManager.executeRequest(this),this._invokeCalled=!0}},Sys.Net.WebRequest._resolveUrl=function(e,t){if(e&&(-1!==e.indexOf("://")||e.startsWith("//")))return e;if(!t||0===t.length){var r=document.getElementsByTagName("base")[0];t=r&&r.href&&r.href.length>0?r.href:document.URL}var n=t.indexOf("?");if(-1!==n&&(t=t.substr(0,n)),-1!==(n=t.indexOf("#"))&&(t=t.substr(0,n)),t=t.substr(0,t.lastIndexOf("/")+1),!e||0===e.length)return t;if("/"===e.charAt(0)){var s=t.indexOf("://");if(-1===s)throw Error.argument("baseUrl",Sys.Res.badBaseUrl1);var i=t.indexOf("/",s+3);if(-1===i)throw Error.argument("baseUrl",Sys.Res.badBaseUrl2);return t.substr(0,i)+e}var o=t.lastIndexOf("/");if(-1===o)throw Error.argument("baseUrl",Sys.Res.badBaseUrl3);return t.substr(0,o+1)+e},Sys.Net.WebRequest._createQueryString=function(e,t){t||(t=encodeURIComponent);var r=new Sys.StringBuilder,n=0;for(var s in e){var i=e[s];if("function"!=typeof i){var o=$crabaJSON.serialize(i);0!==n&&r.append("&"),r.append(s),r.append("="),r.append(t(o)),n++}}return r.toString()},Sys.Net.WebRequest._createUrl=function(e,t){if(!t)return e;var r=Sys.Net.WebRequest._createQueryString(t);if(r.length>0){var n="?";return e&&-1!==e.indexOf("?")&&(n="&"),e+n+r}return e},Sys.Net.WebRequest.registerClass("Sys.Net.WebRequest"),_Z_168=function(e){_Z_168.initializeBase(this),this._webRequest=e},_Z_168.prototype={get_webRequest:function(){return this._webRequest}},_Z_168.registerClass("_Z_168",_Z_162),_Z_244=function(){this._webRequest=null,this._resultObject=null},_Z_244.prototype={get_webRequest:function(){return this._webRequest},_set_webRequest:function(e){if(this.get_started())throw Error.invalidOperation(String.format(Sys.Res.cannotCallOnceStarted,"set_webRequest"));this._webRequest=e},get_started:function(){throw Error.notImplemented()},get_responseAvailable:function(){throw Error.notImplemented()},get_timedOut:function(){throw Error.notImplemented()},get_aborted:function(){throw Error.notImplemented()},get_responseData:function(){throw Error.notImplemented()},get_statusCode:function(){throw Error.notImplemented()},get_statusText:function(){throw Error.notImplemented()},get_xml:function(){throw Error.notImplemented()},get_object:function(){if(!this._resultObject){var e=this.get_responseData();this._resultObject=e?$crabaJSON.deserialize(e):null}return this._resultObject},executeRequest:function(){throw Error.notImplemented()},abort:function(){throw Error.notImplemented()},getResponseHeader:function(e){throw Error.notImplemented()},getAllResponseHeaders:function(){throw Error.notImplemented()}},_Z_244.registerClass("_Z_244"),_Z_245=function(e){if(window.DOMParser)try{return(new window.DOMParser).parseFromString(e,"text/xml")}catch(i){}else for(var t=["Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"],r=0,n=t.length;r<n;r++)try{var s=new ActiveXObject(t[r]);return s.async=!1,s.loadXML(e),s.setProperty("SelectionLanguage","XPath"),s}catch(i){}return null},_Z_246=function(){_Z_246.initializeBase(this);var e=this;this._xmlHttpRequest=null,this._webRequest=null,this._responseAvailable=!1,this._timedOut=!1,this._timer=null,this._aborted=!1,this._started=!1,this._onReadyStateChange=function(){if(4===e._xmlHttpRequest.readyState){try{if("undefined"==typeof e._xmlHttpRequest.status)return}catch(t){return}e._clearTimer(),e._responseAvailable=!0,e._webRequest.completed(Sys.EventArgs.Empty),null!=e._xmlHttpRequest&&(e._xmlHttpRequest.onreadystatechange=Function.emptyMethod,e._xmlHttpRequest=null)}},this._clearTimer=function(){null!=e._timer&&(clearTimeout(e._timer),e._timer=null)},this._onTimeout=function(){e._responseAvailable||(e._clearTimer(),e._timedOut=!0,e._xmlHttpRequest&&(e._xmlHttpRequest.onreadystatechange=Function.emptyMethod,e._xmlHttpRequest.abort(),e._webRequest.completed(Sys.EventArgs.Empty),e._xmlHttpRequest=null))}},_Z_246.prototype={get_timedOut:function(){return this._timedOut},get_started:function(){return this._started},get_responseAvailable:function(){return this._responseAvailable},get_aborted:function(){return this._aborted},executeRequest:function(){var e=this._webRequest=this.get_webRequest();if(e.doBeforeRequest()){if(this._started)throw Error.invalidOperation(String.format(Sys.Res.cannotCallOnceStarted,"executeRequest"));if(null===e)throw Error.invalidOperation(Sys.Res.nullWebRequest);var t=e.get_body(),r=e.get_headers(),n=e.getResolvedUrl();this._xmlHttpRequest=new XMLHttpRequest,this._xmlHttpRequest.onreadystatechange=this._onReadyStateChange;var s=e.get_httpVerb();if(this._xmlHttpRequest.open(s,n,e.get_async()),e.get_withCredentials()&&!n.toLowerCase().startsWith($common.getHostUrl())&&(this._xmlHttpRequest.withCredentials=!0),e._responseType&&(this._xmlHttpRequest.responseType=e._responseType),r)for(var i in r){var o=r[i];"function"!=typeof o&&this._xmlHttpRequest.setRequestHeader(i,o)}"post"===s.toLowerCase()&&(t instanceof FormData||null!==r&&r["Content-Type"]||this._xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t||(t=""));var a=e.get_timeout();if(a>0&&(this._timer=setTimeout($createDelegate(this,this._onTimeout),1e3*a)),e.get_async()||e.get_notThrowError())this._xmlHttpRequest.send(t),this._started=!0;else try{this._started=!0,this._xmlHttpRequest.send(t)}catch(c){var l=String.format(Sys.Res.syncError,n);throw Error.abort(l)}}},_checkHasResponse:function(e){if(!this._responseAvailable)throw Error.invalidOperation(String.format(Sys.Res.cannotCallBeforeResponse,e));if(!this._xmlHttpRequest)throw Error.invalidOperation(String.format(Sys.Res.cannotCallOutsideHandler,e))},getResponseHeader:function(e){this._checkHasResponse("getResponseHeader");var t;try{t=this._xmlHttpRequest.getResponseHeader(e)}catch(r){}return t||(t=""),t},getAllResponseHeaders:function(){return this._checkHasResponse("getAllResponseHeaders"),this._xmlHttpRequest.getAllResponseHeaders()},get_responseData:function(){return this._checkHasResponse("get_responseData"),this._xmlHttpRequest.responseText},get_response:function(){return this._xmlHttpRequest.response},get_statusCode:function(){this._checkHasResponse("get_statusCode");var e=0;try{e=this._xmlHttpRequest.status}catch(t){}return e},get_statusText:function(){return this._checkHasResponse("get_statusText"),this._xmlHttpRequest.statusText},get_xml:function(){this._checkHasResponse("get_xml");var e=this._xmlHttpRequest.responseXML;if(e&&e.documentElement)-1!==navigator.userAgent.indexOf("MSIE")&&e.setProperty("SelectionLanguage","XPath");else if(!(e=_Z_245(this._xmlHttpRequest.responseText))||!e.documentElement)return null;return"http://www.mozilla.org/newlayout/xml/parsererror.xml"===e.documentElement.namespaceURI&&"parsererror"===e.documentElement.tagName?null:e.documentElement.firstChild&&"parsererror"===e.documentElement.firstChild.tagName?null:e},abort:function(){if(!this._started)throw Error.invalidOperation(Sys.Res.cannotAbortBeforeStart);this._aborted||this._responseAvailable||this._timedOut||(this._aborted=!0,this._clearTimer(),this._xmlHttpRequest&&!this._responseAvailable&&(this._webRequest.completed(Sys.EventArgs.Empty),this._xmlHttpRequest.onreadystatechange=Function.emptyMethod,this._xmlHttpRequest.abort(),this._xmlHttpRequest=null))}},_Z_246.registerClass("_Z_246",_Z_244),_Z_226=function(){this._this=this,this._defaultTimeout=60,this._defaultExecutorType="_Z_246"},_Z_226.prototype={add_invokingRequest:function(e){this.getEvList().addHandler("invokingRequest",e)},remove_invokingRequest:function(e){this.getEvList().removeHandler("invokingRequest",e)},add_completedRequest:function(e){this.getEvList().addHandler("completedRequest",e)},remove_completedRequest:function(e){this.getEvList().removeHandler("completedRequest",e)},getEvList:function(){return this._events||(this._events=new _Z_237),this._events},get_defaultTimeout:function(){return this._defaultTimeout},set_defaultTimeout:function(e){if(e<0)throw Error.argumentOutOfRange("value",e,Sys.Res.invalidTimeout);this._defaultTimeout=e},get_defaultExecutorType:function(){return this._defaultExecutorType},set_defaultExecutorType:function(e){this._defaultExecutorType=e},executeRequest:function(e){var t=e.get_executor();if(!t){var r=!1;try{t=new(evil2(this._defaultExecutorType))}catch(i){r=!0}if(r||!_Z_244.isInstanceOfType(t)||!t)throw Error.argument("defaultExecutorType",String.format(Sys.Res.invalidExecutorType,this._defaultExecutorType));e.set_executor(t)}if(!t.get_aborted()){var n=new _Z_168(e),s=this.getEvList().getHandler("invokingRequest");s&&s(this,n),n.get_cancel()||t.executeRequest()}}},_Z_226.registerClass("_Z_226"),$webManager=Sys.Net.WebRequestManager=new _Z_226,_Z_227=function(e,t,r,n,s){this._timedOut=e,this._message=t,this._stackTrace=r,this._exceptionType=n,this._statusCode=-1,this._returnValue=s},_Z_227.prototype={get_timedOut:function(){return this._timedOut},get_statusCode:function(){return this._statusCode},get_message:function(){return this._message},get_stackTrace:function(){return this._stackTrace},get_exceptionType:function(){return this._exceptionType},toString:function(){return this._message},get_returnValue:function(){return this._returnValue},get_requestID:function(){return this._requestId}},_Z_227.registerClass("_Z_227"),_Z_56=function(){throw Error.notImplemented()},_Z_56.prototype={dotNetJson:0,dotNetXML:1},_Z_56.registerEnum("_Z_56"),Sys.Net.WebServiceProxy=function(){this._timeout=0,this._succeeded=null,this._failed=null,this._userContext=null,this._serviceType=_Z_56.dotNetJson,this._namespace="http://tempuri.org/",this._serviceName=null,this._waitCounter=0,this._owner=null,this._enableShowWaiting=!0,this._serverAsync=!1,this._disposed=!1,this._clientSize=null,this._waitingMethodNames=[],this._enableClientLog=!0,this._enableUnsafeHeader=$settings.CrabaServer,this._form=null},Sys.Net.WebServiceProxy.prototype={_getPath:function(e){return this._form&&this._form._corsHost?e:$getRootURI()+e},get_path:function(){return this._path},set_path:function(e){this._path=e},set_clientSize:function(e){this._clientSize=e},get_clientSize:function(){return this._clientSize},set_form:function(e){this._form=e},get_form:function(){return this._form},get_timeout:function(){return this._timeout},set_timeout:function(e){this._timeout=e},get_defaultSucceededCallback:function(){return this._succeeded},set_defaultSucceededCallback:function(e){this._succeeded=e},get_defaultFailedCallback:function(){return this._failed},set_defaultFailedCallback:function(e){this._failed=e},get_defaultUserContext:function(){return this._userContext},set_defaultUserContext:function(e){this._userContext=e},get_serviceType:function(){return this._serviceType},set_serviceType:function(e){this._serviceType=e},get_namespace:function(){return this._namespace},set_namespace:function(e){e&&!e.endsWith("/")&&(e+="/"),this._namespace=e},get_serviceName:function(){return this._serviceName},set_serviceName:function(e){this._serviceName=e},_jsonSerialize:function(e){var t=$crabaJSON.serialize(e);return"{}"===t?"":t},_XMLSerialize:function(e,t,r){var n=new Sys.StringBuilder;n.append('<?xml version="1.0"?>').append("<SOAP-ENV:Envelope").append(' xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"').append(' xmlns:xsd="http://www.w3.org/2001/XMLSchema"').append(' xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"').append(' xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/"'),n.append(' xmlns:HNS="'+this.get_namespace()+'">'),n.append("<SOAP-ENV:Body").append(' SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">'),n.append("<"+t+" "+r+">");for(var s in e)n.append("<"+s+">").append(this._jsonSerialize(e[s])).append("</"+s+">");return n.append("</"+t+">").append("</SOAP-ENV:Body>").append("</SOAP-ENV:Envelope>"),n.toString()},_getXMLResult:function(e,t){var r=e.get_xml();if(!r)throw new _Z_227(!1,"网络错误","","");var n=null,s=r.getElementsByTagName(t+"Response");if(s.length>0&&(n=s[0]),n){var i=n.childNodes.length;if(i>0){if(1==i)return n.firstChild.text;result=new Object;for(var o=0;o<i;o++)result[n.childNodes[o].nodeName]=n.childNodes[o].text;return result}return null}var a,l=r.selectSingleNode("//faultstring");if(l){if((a=l.firstChild.text).indexOf(".SoapException:")>0){var c=a.indexOf(":");if(c>=0){var d=a.indexOf(":",c+1);d>=0&&(c=d),(d=(a=a.substr(c+1).trimStart()).indexOf(" "))>0&&(a=a.substr(0,d-1).trim())}}a=Sys.Net.WebServiceProxy.formatWebServiceFailedServerError(a)}else{var h=e.get_responseData();a=h?String.format(Sys.Res.webServiceFailedNoResult,h):String.format(Sys.Res.webServiceFailedNoResponse,this._proxy._get_path())}throw new _Z_227(!1,a,"","")},get_owner:function(){return this._owner},set_owner:function(e){this._owner=e},get_enableShowWaiting:function(){return this._enableShowWaiting},set_enableShowWaiting:function(e){this._enableShowWaiting=e},get_serverAsync:function(){return this._serverAsync},set_serverAsync:function(e){this._serverAsync=e},get_isBusy:function(){return this._busy},_setOwnerEnabled:function(e){this._busy=!e;var t=this._owner;t&&t.set_enabled&&t.get_isDisposed&&!t.get_isDisposed()&&(t.set_enabled(e),e&&(this._owner=null))},showWaiting:function(e,t){if(0==this._waitCounter){var r=null;if(e==window)r=window;else if(void 0!==e){if(Sys.UI.CustomForm.isInstanceOfType(e)&&e.get_isDisposed())return;this.set_owner(e)}$common.showWaiting(r,t)}this._waitCounter++},_showWaitingForTimer:function(e){!e||e&&-1==Array.indexOf(this._waitingMethodNames,e)||this.showWaiting()},_hideWaiting:function(e){e&&e._waitTimer&&(clearTimeout(e._waitTimer),delete e._waitTimer),this.get_enableShowWaiting()&&this._waitCounter>0&&(this._waitCounter--,0==this._waitCounter&&$common.hideWaiting(!0)),this._setOwnerEnabled(!0)},_createUrl:function(e,t,r){var n=Sys.Net.WebRequest._createUrl(e+"/"+encodeURIComponent(t),r);return this._form&&this._form._corsHost&&(n=this._form._corsHost+(n.startsWith("/")?n:"/"+n)),n},set_httpVerb:function(e){},set_isCallBackOnDisposed:function(e){this._isCallBackOnDisposed=e},set_enableClientLog:function(e){this._enableClientLog=e},get_enableClientLog:function(){return this._enableClientLog},_invoke:function(e,t,r,n,s,i){t||(t={});var o=!0;if("boolean"==typeof r&&(o=r,r=null),"boolean"==typeof n)o=n,n=null;else if("object"==typeof n&&r){r=$createDelegate(n,r),n=null}null!==r&&void 0!==r||(r=this.get_defaultSucceededCallback()),null!==n&&void 0!==n||(n=this.get_defaultFailedCallback()),"boolean"==typeof s&&(o=s,s=null),null!==s&&void 0!==s||(s=this.get_defaultUserContext()),null!==i&&void 0!==i||(i=this.get_timeout()),this._setOwnerEnabled(!1);var a=new Sys.Net.WebRequest;if(this._enableShowWaiting&&window.$common&&!$common.isWaiting()){var l=this;a._waitTimer=setTimeout(function(){l._showWaitingForTimer(e)},$settings.WaitingTimerValue),Array.add(this._waitingMethodNames,e)}var c=a.get_headers(),d=this.get_path(e),h=d,u=null,y=this._clientSize;if(y){var p="Delta=true";p+=","+y,c["X-CrabaAjax"]=p}var f=this._jsonSerialize(t);switch(this.get_serviceType()){case _Z_56.dotNetJson:c["Content-Type"]="application/json; charset=utf-8",this.get_serverAsync()&&(c["X-ServerAsync"]="true");var m=t;m={},h=this._createUrl(d,e,m),u=this._jsonSerialize(t);break;case _Z_56.dotNetXML:c["Content-Type"]="text/xml",c.SOAPAction=this.get_namespace()+e,a._soapMethodTag=e,u=this._XMLSerialize(t,a._soapMethodTag,'xmlns="'+this.get_namespace()+'"')}this.set_httpVerb(a),a.set_url(h),a.set_body(u);var g=$createDelegate(this,function(t,i){if($app._disposing){if(this._hideWaiting(a),a.get_async())return;throw Error.abort()}var o=t.get_webRequest()._createdTime,l=(new Date).getTime()-o;if(t.get_responseAvailable()){var c=t.get_statusCode();if(0==c)return void this._hideWaiting(a);var d=this._enableUnsafeHeader?t.getResponseHeader("CrabaRequestID"):null,u=this._enableUnsafeHeader?t.getResponseHeader("RequestID"):null,y=null,p=null;try{var m=t.getResponseHeader("Content-Type");y=m&&m.startsWith("application/json")?t.get_object():m&&m.startsWith("text/xml")?this._getXMLResult(t,t.get_webRequest()._soapMethodTag):t.get_responseData()}catch(x){p=x}var g="true"===(v=this._enableUnsafeHeader?t.getResponseHeader("jsonerror"):null);if(g&&(y=new _Z_227(!1,y.Message,y.StackTrace,y.ExceptionType,y.ReturnValue)),this._hideWaiting(a),c<200||c>=300||g||null!=p)if(n)p?y=p:y&&g||(y=new _Z_227(!1,y||String.format(Sys.Res.webServiceFailedNoMsg,e),"","")),y._statusCode=c,y._requestId=u,n(y,s,e);else{var v;p?v=p.toString():(v=y&&g?y.get_message():t.get_responseData(),v=Sys.Net.WebServiceProxy.formatWebServiceFailedServerError(v)),200!=c&&$settings.DefaultShowExceptionNo&&(v=String.format(Sys.Res.exceptionNoMsg,u,v)),a.get_async()?$app.showError(Sys.ErrorType.ajax,v,!1,this._form):b=v}else if(r){try{if($app.netDataHandler&&$app.netDataHandler(y,this._form),this._form&&this._form.get_isDisposed()&&(!$settings.IsCallbackOnDispose&&!0!==this._isCallBackOnDisposed||!1===this._isCallBackOnDisposed))return;r(y,s,e)}catch(x){if(!this._disposed)throw this._doPostServiceLog(d,e,o,l),x}$common&&$common.setTestState("webCallSucceed")}else a.get_async()||(_=y);this._doPostServiceLog(d,e,o,l)}else{if(this._hideWaiting(a),a._abort)return;var z;t.get_timedOut()?(z=String.format(Sys.Res.webServiceTimedOut,e),this._doPostServiceLog(1e6,e,o,l,"客户端超时",h,f)):z=String.format(Sys.Res.webServiceFailedNoMsg,e),n?n(new _Z_227(t.get_timedOut(),z,"",""),s,e):a.get_async()?$common.alert(z):b=z}Array.remove(this._waitingMethodNames,e)});a.add_completed(g),i&&a.set_timeout(i),a.set_async(o);var _=null,b=null;if(a.invoke(),!o){if(Sys.Browser.isFirefox&&Sys.Browser.version<15){var v=a.get_executor();v._responseAvailable=!0,g(v)}return b&&($common.hideWaiting(),$app.showError(Sys.ErrorType.ajax,b,!0,this._form)),_}return a},_doPostServiceLog:function(e,t,r,n,s,i,o){if(!this._isPrintService&&e&&this._enableClientLog){var a=(new Date).getTime()-r;if(a<=0)return;n<=0&&(n=a);var s=s==undefined?"":s,i=i==undefined?"":i,o=o==undefined?"":o;$adminService.LogCrabaClientSpeed({requestguid:e,networkelapsed:n,clientelapsed:a,msg:s,url:i,params:o})}},_invoke2:function(e,t,r,n,s,i){return this._invoke(e,!1,t,r,n,s,i)}},Sys.Net.WebServiceProxy.registerClass("Sys.Net.WebServiceProxy"),Sys.Net.WebServiceProxy._generateTypedConstructor=function(e){return function(t){if(t)for(var r in t)this[r]=t[r];this.__type=e}},Sys.Net.WebServiceProxy.formatWebServiceFailedServerError=function(e){return e?String.format(Sys.Res.webServiceFailedServerError,e):"未连接网络，操作失败"},Sys.Net.WebServiceProxy._createFailedError=function(e,t){var r="Sys.Net.WebServiceFailedException: "+t,n=Error.create(r,{name:"Sys.Net.WebServiceFailedException",methodName:e});return n.popStackFrame(),n},Sys.Net.WebServiceProxy._defaultFailedCallback=function(e,t){var r=e.get_exceptionType()+"-- "+e.get_message();throw Sys.Net.WebServiceProxy._createFailedError(t,String.format(Sys.Res.webServiceFailed,t,r))},Sys.Net.PageRequest=function(e){this._timeout=0,this._succeeded=null,this._failed=null,this._userContext=null,this._url=null,this._request=null,this._clientSize=null,this._form=e,this._createdTime=(new Date).getTime(),this._enableUnsafeHeader=!$settings.GspxResolveCache},Sys.Net.PageRequest.prototype={get_url:function(){return this._url},get_webRequest:function(){return this._request},get_timeout:function(){return this._timeout},set_timeout:function(e){this._timeout=e},get_elapsedTime:function(){return this._elapsedTime},get_requestID:function(){return this._requestID},get_clientSize:function(){return this._clientSize},set_clientSize:function(e){this._clientSize=e},get_defaultSucceededCallback:function(){return this._succeeded},set_defaultSucceededCallback:function(e){this._succeeded=e},get_defaultFailedCallback:function(){return this._failed},set_defaultFailedCallback:function(e){this._failed=e},get_defaultUserContext:function(){return this._userContext},set_defaultUserContext:function(e){this._userContext=e},abort:function(){this._request&&this._request.abort()},_getRequestInfo:function(e){var t={body:null,url:e,oldUrl:e},r=t.url.indexOf("__Params=");if(r>0&&(t.body=t.url.substring(r),t.url=t.url.substr(0,r-1)),(r=t.url.indexOf("?"))<0)return t;var n=t.url.substr(r+1).split("&");t.url=t.url.substr(0,r+1);for(var s=!0,i=Sys.Browser.Charset&&"utf-8"==Sys.Browser.Charset.toLowerCase()?encodeURIComponent:escape,o=0,a=n.length;o<a;o++){var l,c,d=n[o],h=d.split("=");if(2==h.length)l=h[0],c=h[1];else{var u=d.indexOf("=");if(u<0)continue;l=d.substr(0,u),c=d.substr(u+1)}s?s=!1:t.url+="&";try{t.url+=l+"="+i(decodeURIComponent(c))}catch(y){t.url+=l+"="+i(unescape(c))}}return t},invoke:function(e,t,r,n,s){null!==t&&void 0!==t||(t=this.get_defaultSucceededCallback()),null!==r&&void 0!==r||(r=this.get_defaultFailedCallback()),null!==n&&void 0!==n||(n=this.get_defaultUserContext()),null!==s&&void 0!==s||(s=this.get_timeout());var i=this._request=new Sys.Net.WebRequest;this._initHeader(i);var o=this._getRequestInfo(e),a=o.body;e=o.url,!a&&$settings.AntiHijack&&(a=""),$common.gspxParse&&(a=null),i.set_url(e,$settings.CacheGspx),i.set_body(a),i.add_completed($createDelegate(this,function(s,l){if(s.get_responseAvailable()){var c=s.get_statusCode();if($app._doRequestComplated({statusCode:c,responseText:s._xmlHttpRequest.responseText,type:"gspx",form:this._form,url:e}))return;this._requestID=this._enableUnsafeHeader?s.getResponseHeader("CrabaRequestID"):null;var d=this._enableUnsafeHeader?s.getResponseHeader("RequestID"):null;this._elapsedTime=(new Date).getTime()-i._createdTime;var h=null,u=null;try{h=s.get_responseData()}catch(m){u=m}if(null!=h&&"string"!=typeof h&&($debug.serverLog("错误页面内容 "+typeof h+","+h.toString()),h=null),h||(u=Sys.Res.pageRequestFailedNoMsg),c<200||c>=300||null!=u)r?(u?h=u:h?404==c&&(h=new _Z_227(!1,String.format(Sys.Res.pageNotFound,e))):h=new _Z_227(!1,String.format(Sys.Res.pageRequestFailedNoMsg,e)),h._requestId=d,h._statusCode=c,r(h,n)):(p=u?u.toString():Sys.Net.WebServiceProxy.formatWebServiceFailedServerError(h),$settings.DefaultShowExceptionNo&&(p=String.format(Sys.Res.exceptionNoMsg,d,p)),$app.showError(Sys.ErrorType.ajax,p,!1,this._form));else if(t){var y=this._parseReply($common.gspxParse?$common.gspxParse(o.oldUrl,h,a):h);if(y.error){var p=Sys.Net.WebServiceProxy.formatWebServiceFailedServerError(y.error);r?((h=new _Z_227(!1,p))._requestId=d,r(h,n)):($settings.DefaultShowExceptionNo&&(p=String.format(Sys.Res.exceptionNoMsg,d,p)),$common.alert(p))}else this._doSuccess(t,y,n,r)}}else{var f;if(s.get_timedOut()){if(f=String.format(Sys.Res.pageRequestTimedOut,e),$app._timeoutHandler)return void $app._timeoutHandler(e,f)}else f=String.format(Sys.Res.pageRequestFailedNoMsg,e);r?r(new _Z_227(s.get_timedOut(),f),n):$common.alert(f)}})),s&&s>0&&i.set_timeout(s),i.invoke()},_initHeader:function(e){var t="Delta=true",r=this._clientSize;if(r){var n=getClientBounds();t+=","+r,t+=",WindowWidth="+n.width,t+=",WindowHeight="+n.height}e.get_headers()["X-CrabaAjax"]=t,$settings.GspxResolveCache||(e.get_headers()["Cache-Control"]="no-cache",e.get_headers().ContentType="text/html; charset=gb2312")},_doSuccess:function(e,t,r,n){e(t,r)},_findText:function(e,t){if(0==t)return e;var r=Math.max(0,t-20),n=Math.min(e.length,t+20);return e.substring(r,n)},_parseReply:function(e,t){t&&(e=$crabaJSON.deserialize(e));var r=new Object;r.showVersionTips=!0,r.html="",r.scriptBlock="",r.styleBlock="",r.error="";for(var n,s,i,o=0;o<e.length;){var a;if(-1===(a=e.indexOf("|",o))){r.error="(页面错误 "+this._request.get_url()+")"+this._findText(e,o);break}if((n=parseInt(e.substring(o,a),10))%1!=0){r.error="(块没有长度)"+this._findText(e,o);break}if(o=a+1,-1===(a=e.indexOf("|",o))){r.error="(块没有类型)"+this._findText(e,o);break}if(s=e.substring(o,a),(o=a+1)+n>=e.length){r.error="(块长度不对)"+this._findText(e,e.length);break}if(i=e.substr(o,n),o+=n,"|"!==e.charAt(o)){r.error="(块没有结束)"+this._findText(e,o);break}switch(o++,s){case"showVersionTips":r.showVersionTips=i;break;case"html":r.html+=i;break;case"styleBlock":r.styleBlock+=i;break;case"scriptBlock":r.scriptBlock+=i;break;case"scriptInclude":r.scriptIncludes||(r.scriptIncludes=[]),Array.add(r.scriptIncludes,i);break;case"styleInclude":r.styleIncludes||(r.styleIncludes=[]),Array.add(r.styleIncludes,i);break;case"pageId":r.pageId=i;case"pageTitle":r.pageTitle=i;break;case"pageSubTitle":r.pageSubTitle=i;break;case"hAlign":r.hAlign=parseInt(i);break;case"activeControl":r.activeControl=i;break;case"error":r.error&&(r.error+="<br>"),r.error+=i;break;case"redirect":r.redirect=i;break;default:r.error&&(r.error+="<br>"),r.error+="(块类型"+s+"错)"+i}}return r}},Sys.Net.PageRequest.registerClass("Sys.Net.PageRequest"),Type.registerNamespace("Sys.Serialization");var $crabaJSON=Sys.Serialization.JavaScriptSerializer=function(){};Sys.Serialization.JavaScriptSerializer.registerClass("Sys.Serialization.JavaScriptSerializer"),$crabaJSON._serverTypeFieldName="__type",$crabaJSON._stringRegEx=new RegExp('["\\b\\f\\n\\r\\t\\\\\\x00-\\x1F]',"i"),$crabaJSON._dateRegEx=new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',"g"),$crabaJSON._jsonRegEx=new RegExp("[^,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]","g"),$crabaJSON._jsonStringRegEx=new RegExp('"(\\\\.|[^"\\\\])*"',"g"),$crabaJSON._serializeBooleanWithBuilder=function(e,t){t.append(e.toString())},$crabaJSON._serializeNumberWithBuilder=function(e,t,r){if(!isFinite(e))throw Error.invalidOperation(String.format("{0} 对应JSON对象Key:{1}={2}",Sys.Res.cannotSerializeNonFiniteNumbers,r,e));t.append(String(e))},$crabaJSON._serializeStringWithBuilder=function(e,t){if(t.append('"'),$crabaJSON._stringRegEx.test(e)){var r=e.length;for(i=0;i<r;++i){var n=e.charAt(i);if(n>=" ")"\\"!==n&&'"'!==n||t.append("\\"),t.append(n);else switch(n){case"\b":t.append("\\b");break;case"\f":t.append("\\f");break;case"\n":t.append("\\n");break;case"\r":t.append("\\r");break;case"\t":t.append("\\t");break;default:t.append("\\u00"),n.charCodeAt()<16&&t.append("0"),t.append(n.charCodeAt().toString(16))}}}else t.append(e);t.append('"')},$crabaJSON._serializeWithBuilder=function(e,t,r,n,s,i){var o;switch(typeof e){case"object":if(e){if(n){for(var a=0;a<n.length;a++)if(n[a]===e)throw Error.invalidOperation(Sys.Res.cannotSerializeObjectWithCycle)}else n=new Array;try{if(Array.add(n,e),Number.isInstanceOfType(e))$crabaJSON._serializeNumberWithBuilder(e,t,i);else if(Boolean.isInstanceOfType(e))$crabaJSON._serializeBooleanWithBuilder(e,t);else if(String.isInstanceOfType(e))$crabaJSON._serializeStringWithBuilder(e,t);else if(Array.isInstanceOfType(e)){for(t.append("["),o=0;o<e.length;++o)o>0&&t.append(","),$crabaJSON._serializeWithBuilder(e[o],t,!1,n,s,i);t.append("]")}else if(Sys.RawText.isInstanceOfType(e))t.append(String(e.get_value()));else{if(Date.isInstanceOfType(e)){if(s){t.append("new Date("),t.append(e.getTime()),t.append(")");break}t.append('"\\/Date('),t.append(e.getTime()),t.append(')\\/"');break}var l=[],c=0;for(var d in e)d.startsWith("$")||(d===$crabaJSON._serverTypeFieldName&&0!==c?(l[c++]=l[0],l[0]=d):l[c++]=d);r&&l.sort(),t.append("{");var h=!1;for(o=0;o<c;o++){var u=e[d=l[o]];void 0!==u&&"function"!=typeof u&&(h?t.append(","):h=!0,$crabaJSON._serializeWithBuilder(d,t,r,n,s,d),t.append(":"),$crabaJSON._serializeWithBuilder(u,t,r,n,s,d))}t.append("}")}}catch(y){throw y}finally{Array.removeAt(n,n.length-1)}}else t.append("null");break;case"number":$crabaJSON._serializeNumberWithBuilder(e,t,i);break;case"string":$crabaJSON._serializeStringWithBuilder(e,t);break;case"boolean":$crabaJSON._serializeBooleanWithBuilder(e,t);break;default:t.append("null")}},$crabaJSON.serialize=function(e,t){var r=new Sys.StringBuilder;return $crabaJSON._serializeWithBuilder(e,r,!1,null,t,null),r.toString()},$crabaJSON.deserialize=function(e,t){if(0===e.length)throw Error.argument("data",Sys.Res.cannotDeserializeEmptyString);try{return t&&(e=e.replace($crabaJSON._dateRegEx,"$1new Date($2)")),evil2("("+e+")")}catch(r){throw console.log(e),Error.argument("data",Sys.Res.cannotDeserializeInvalidJson+r.message)}},Sys.Timer=function(){Sys.Timer.initializeBase(this),this._interval=1e3,this._enabled=!1,this._timer=null},Sys.Timer.prototype={get_interval:function(){return this._interval},set_interval:function(e){this._interval!==e&&(this._interval=e,this.raisePropertyChanged("interval"),this.get_isUpdating()||null===this._timer||this.restartTimer())},get_enabled:function(){return this._enabled},set_enabled:function(e){e!==this.get_enabled()&&(this._enabled=e,this.raisePropertyChanged("enabled"),this.get_isUpdating()||(e?this._startTimer():this._stopTimer()))},add_tick:function(e){this.get_events().addHandler("tick",e)},remove_tick:function(e){this.get_events().removeHandler("tick",e)},dispose:function(){this.set_enabled(!1),this._stopTimer(),Sys.Timer.callBaseMethod(this,"dispose")},updated:function(){Sys.Timer.callBaseMethod(this,"updated"),this._enabled&&this.restartTimer()},_timerCallback:function(){var e=this.get_events().getHandler("tick");e&&e(this,Sys.EventArgs.Empty)},restartTimer:function(){this._stopTimer(),this._startTimer()},_startTimer:function(){this._timer=setInterval($createDelegate(this,this._timerCallback),this._interval)},_stopTimer:function(){clearInterval(this._timer),this._timer=null}},Sys.Timer.registerClass("Sys.Timer",_Z_242),_Z_228=function(e,t,r){this.name=e,this.numberFormat=t,this.dateTimeFormat=r},_Z_228.prototype={_getDateTimeFormats:function(){if(!this._dateTimeFormats){var e=this.dateTimeFormat;this._dateTimeFormats=[e.MonthDayPattern,e.YearMonthPattern,e.ShortDatePattern,e.ShortTimePattern,e.LongDatePattern,e.LongTimePattern,e.FullDateTimePattern,e.RFC1123Pattern,e.SortableDateTimePattern,e.UniversalSortableDateTimePattern]}return this._dateTimeFormats},_getMonthIndex:function(e){return this._upperMonths||(this._upperMonths=this._toUpperArray(this.dateTimeFormat.MonthNames)),Array.indexOf(this._upperMonths,this._toUpper(e))},_getAbbrMonthIndex:function(e){return this._upperAbbrMonths||(this._upperAbbrMonths=this._toUpperArray(this.dateTimeFormat.AbbreviatedMonthNames)),Array.indexOf(this._upperAbbrMonths,this._toUpper(e))},_getDayIndex:function(e){return this._upperDays||(this._upperDays=this._toUpperArray(this.dateTimeFormat.DayNames)),Array.indexOf(this._upperDays,this._toUpper(e))},_getAbbrDayIndex:function(e){return this._upperAbbrDays||(this._upperAbbrDays=this._toUpperArray(this.dateTimeFormat.AbbreviatedDayNames)),Array.indexOf(this._upperAbbrDays,this._toUpper(e))},_toUpperArray:function(e){for(var t=[],r=0,n=e.length;r<n;r++)t[r]=this._toUpper(e[r]);return t},_toUpper:function(e){return e.split(" ").join(" ").toUpperCase()}},_Z_228.registerClass("_Z_228"),_Z_228.InvariantCulture={name:"",numberFormat:{CurrencyDecimalDigits:2,CurrencyDecimalSeparator:".",IsReadOnly:!0,CurrencyGroupSizes:[3],NumberGroupSizes:[3],PercentGroupSizes:[3],CurrencyGroupSeparator:",",CurrencySymbol:"¤",NaNSymbol:"NaN",CurrencyNegativePattern:0,NumberNegativePattern:1,PercentPositivePattern:0,PercentNegativePattern:0,NegativeInfinitySymbol:"-Infinity",NegativeSign:"-",NumberDecimalDigits:2,NumberDecimalSeparator:".",NumberGroupSeparator:",",CurrencyPositivePattern:0,PositiveInfinitySymbol:"Infinity",PositiveSign:"+",PercentDecimalDigits:2,PercentDecimalSeparator:".",PercentGroupSeparator:",",PercentSymbol:"%",PerMilleSymbol:"‰",NativeDigits:["0","1","2","3","4","5","6","7","8","9"],DigitSubstitution:1},dateTimeFormat:{AMDesignator:"AM",Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,IsReadOnly:!0},DateSeparator:"/",FirstDayOfWeek:0,CalendarWeekRule:0,FullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",LongDatePattern:"dddd, dd MMMM yyyy",LongTimePattern:"HH:mm:ss",MonthDayPattern:"MMMM dd",PMDesignator:"PM",RFC1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",ShortDatePattern:"MM/dd/yyyy",ShortTimePattern:"HH:mm",SortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",TimeSeparator:":",UniversalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",YearMonthPattern:"yyyy MMMM",AbbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ShortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],DayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],AbbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],MonthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],IsReadOnly:!0,NativeCalendarName:"Gregorian Calendar",AbbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],MonthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""]}},_Z_228.CurrentCulture={name:"zh-CN",numberFormat:{CurrencyDecimalDigits:2,CurrencyDecimalSeparator:".",IsReadOnly:!1,CurrencyGroupSizes:[3],NumberGroupSizes:[3],PercentGroupSizes:[3],CurrencyGroupSeparator:",",CurrencySymbol:"￥",NaNSymbol:"非数字",CurrencyNegativePattern:2,NumberNegativePattern:1,PercentPositivePattern:1,PercentNegativePattern:1,NegativeInfinitySymbol:"负无穷大",NegativeSign:"-",NumberDecimalDigits:2,NumberDecimalSeparator:".",NumberGroupSeparator:",",CurrencyPositivePattern:0,PositiveInfinitySymbol:"正无穷大",PositiveSign:"+",PercentDecimalDigits:2,PercentDecimalSeparator:".",PercentGroupSeparator:",",PercentSymbol:"%",PerMilleSymbol:"‰",NativeDigits:["0","1","2","3","4","5","6","7","8","9"],DigitSubstitution:1},dateTimeFormat:{AMDesignator:"上午",Calendar:{MinSupportedDateTime:"\\/Date(-62135568000000)\\/",MaxSupportedDateTime:"\\/Date(253402300799999)\\/",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,IsReadOnly:!1},DateSeparator:"/",FirstDayOfWeek:0,CalendarWeekRule:0,FullDateTimePattern:"yyyy'年'M'月'd'日' H:mm:ss",LongDatePattern:"yyyy'年'M'月'd'日'",LongTimePattern:"H:mm:ss",MonthDayPattern:"M'月'd'日'",PMDesignator:"下午",RFC1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",ShortDatePattern:"yyyy/M/d",ShortTimePattern:"H:mm",SortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",TimeSeparator:":",UniversalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",YearMonthPattern:"yyyy'年'M'月'",AbbreviatedDayNames:["日","一","二","三","四","五","六"],ShortestDayNames:["日","一","二","三","四","五","六"],DayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],AbbreviatedMonthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月",""],MonthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月",""],IsReadOnly:!1,NativeCalendarName:"公历",AbbreviatedMonthGenitiveNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月",""],MonthGenitiveNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月",""]}},Type.registerNamespace("Craba.Web.Admin"),Craba.Web.Admin.AdminService=function(){Craba.Web.Admin.AdminService.initializeBase(this),this._enableClientLog=!1},Craba.Web.Admin.AdminService.prototype={get_path:function(){return this._getPath("Craba.Web/Craba.Web.Admin.AdminService.ajax")},GetServerStatus:function(e,t,r){return this._invoke("GetServerStatus",{},e,t,r)},Log:function(e,t,r,n){return this._invoke("Log",{message:e},t,function(){},n)},LogCrabaClientSpeed:function(e,t,r,n){return this._invoke("_LogCrabaClientSpeed",{item:e},t,function(){},n,1800)},CutImage:function(e,t,r,n){return this._invoke("CutImage",{imageCutInfo:e},t,r,n)}},Craba.Web.Admin.AdminService.registerClass("Craba.Web.Admin.AdminService",Sys.Net.WebServiceProxy);var $adminService=new Craba.Web.Admin.AdminService;$adminService.set_enableShowWaiting(!1),Type.registerNamespace("Craba.Web.Script"),Craba.Web.Script.DataServiceBase=function(){Craba.Web.Script.DataServiceBase.initializeBase(this),this._enableClientLog=!1,this._isCallBackOnDisposed=!1},Craba.Web.Script.DataServiceBase.prototype={get_path:function(){return this._getPath("Craba.Web/Craba.Web.Script.DataService.ajax")},SaveCustomConfig:function(e,t,r,n,s){return this._invoke("SaveCustomConfig",{key:e,data:t},r,n,s)},GetCustomConfig:function(e,t,r,n){return this._invoke("GetCustomConfig",{key:e},t,r,n)},RemoveSessionData:function(e,t,r,n){if(!$settings.DisableRemoveSessionCache)return this._invoke("RemoveSessionData",{controlIds:e},t,r,n)},SaveFormConfig:function(e,t,r,n,s){return this._invoke("SaveFormConfig",{formId:e,data:t},r,n,s)},SavePanelConfig:function(e,t,r,n,s){return this._invoke("SavePanelConfig",{panelId:e,data:t},r,n,s)},GetCloundPrintInfo:function(e,t,r,n){return this._invoke("GetCloundPrintInfo",{reportName:e},t,r,n)},GetCloudPrinterInfo:function(e,t,r){return this._invoke("GetCloudPrinterInfo",null,e,t,r)},GetPrintClients:function(e,t,r){return this._invoke("GetPrintClients",null,e,t,r)},GetAccessCode:function(e,t,r){return this._invoke("GetAccessCode",null,e,t,r)}},Craba.Web.Script.DataServiceBase.registerClass("Craba.Web.Script.DataServiceBase",Sys.Net.WebServiceProxy),Craba.Web.Script.DataServiceBase.create=function(e){var t=new Craba.Web.Script.DataServiceBase;return t.set_enableShowWaiting(!1),t.set_form(e),t},Craba.Web.Script.DataServiceBase.initCloudInfo=function(e){if(window.LoadCloudInfo)window.LoadCloudInfo();else if(!window.__isInitLoading){window.__isInitLoading=!0;var t=Craba.Web.Script.DataServiceBase.create(e);t._isPrintService=!0,t.GetCloudPrinterInfo(function(e){$common.__cloudPrintServiceUrl=e.ServiceUrl,$common.__cloudPrintAccessToken=e.AccessToken},function(e){window.__isInitLoading=!1,console.log("GetCloudPrinterInfo初始化失败，"+e)})}},Sys.RawText=function(e){this._value=e},Sys.RawText.prototype={get_value:function(){return this._value?this._value:"null"}},_Z_60=function(){},_Z_60.prototype={addHandler:function(e,t,r,n){return n&&(r=$createDelegate(n,r)),$addHandler(e,t,r),r},addLoadHandler:function(e,t,r){return this.addHandler(e,"load",t,r)},removeLoadHandler:function(e,t){$removeHandler(e,"load",t)},addReadyStateChangeHandler:function(e,t,r){return this.addHandler(e,"readystatechange",t,r)},removeReadyStateChangeHandler:function(e,t){$removeHandler(e,"readystatechange",t)},addMouseOverHandler:function(e,t,r){return this.addHandler(e,"mouseover",t,r)},removeMouseOverHandler:function(e,t){$removeHandler(e,"mouseover",t)},addMouseEnterHandler:function(e,t,r){return this.addHandler(e,"mouseenter",t,r)},removeMouseEnterHandler:function(e,t){$removeHandler(e,"mouseenter",t)},addMouseLeaveHandler:function(e,t,r){return this.addHandler(e,"mouseleave",t,r)},removeMouseLeaveHandler:function(e,t){$removeHandler(e,"mouseleave",t)},addMouseOutHandler:function(e,t,r){return this.addHandler(e,"mouseout",t,r)},removeMouseOutHandler:function(e,t){$removeHandler(e,"mouseout",t)},addMouseDownHandler:function(e,t,r){return this.addHandler(e,"mousedown",t,r)},removeMouseDownHandler:function(e,t){$removeHandler(e,"mousedown",t)},addMouseMoveHandler:function(e,t,r){return this.addHandler(e,"mousemove",t,r)},removeMouseMoveHandler:function(e,t){$removeHandler(e,"mousemove",t)},addMouseUpHandler:function(e,t,r){return this.addHandler(e,"mouseup",t,r)},removeMouseUpHandler:function(e,t){$removeHandler(e,"mouseup",t)},addTouchStartHandler:function(e,t,r){return this.addHandler(e,"touchstart",t,r)},removeTouchStartHandler:function(e,t){$removeHandler(e,"touchstart",t)},addTouchMoveHandler:function(e,t,r){return this.addHandler(e,"touchmove",t,r)},removeTouchMoveHandler:function(e,t){$removeHandler(e,"touchmove",t)},addTouchEndHandler:function(e,t,r){return this.addHandler(e,"touchend",t,r)},removeTouchEndHandler:function(e,t){$removeHandler(e,"touchend",t)},addMouseWheelHandler:function(e,t,r){return Sys.Browser.isFirefox?this.addHandler(e,"DOMMouseScroll",t,r):this.addHandler(e,"mousewheel",t,r)},removeMouseWheelHandler:function(e,t){Sys.Browser.isFirefox?$removeHandler(e,"DOMMouseScroll",t):$removeHandler(e,"mousewheel",t)},addClickHandler:function(e,t,r){return this.addHandler(e,"click",t,r)},removeClickHandler:function(e,t){$removeHandler(e,"click",t)},addDblClickHandler:function(e,t,r){return this.addHandler(e,"dblclick",t,r)},removeDblClickHandler:function(e,t){$removeHandler(e,"dblclick",t)},addKeyDownHandler:function(e,t,r){return this.addHandler(e,"keydown",t,r)},removeKeyDownHandler:function(e,t){$removeHandler(e,"keydown",t)},addKeyUpHandler:function(e,t,r){return this.addHandler(e,"keyup",t,r)},removeKeyUpHandler:function(e,t){$removeHandler(e,"keyup",t)},addKeyPressHandler:function(e,t,r){return this.addHandler(e,"keypress",t,r)},removeKeyPressHandler:function(e,t){$removeHandler(e,"keypress",t)},addFocusHandler:function(e,t,r){return this.addHandler(e,"focus",t,r)},removeFocusHandler:function(e,t){$removeHandler(e,"focus",t)},addBlurHandler:function(e,t,r){return this.addHandler(e,"blur",t,r)},removeBlurHandler:function(e,t){$removeHandler(e,"blur",t)},addChangeHandler:function(e,t,r){return this.addHandler(e,"change",t,r)},removeChangeHandler:function(e,t){$removeHandler(e,"change",t)},addSelectStartHandler:function(e,t,r){return this.addHandler(e,"selectstart",t,r)},removeSelectStartHandler:function(e,t){$removeHandler(e,"selectstart",t)},addContextMenuHandler:function(e,t,r){return this.addHandler(e,"contextmenu",t,r)},removeContextMenuHandler:function(e,t){$removeHandler(e,"contextmenu",t)},addResizeHandler:function(e,t,r){return this.addHandler(e,"resize",t,r)},removeResizeHandler:function(e,t){$removeHandler(e,"resize",t)},addScrollHandler:function(e,t,r){return this.addHandler(e,"scroll",t,r)},removeScrollHandler:function(e,t){$removeHandler(e,"scroll",t)},addPasteHandler:function(e,t,r){return this.addHandler(e,"paste",t,r)},removePasteHandler:function(e,t){$removeHandler(e,"paste",t)},addDragStartHandler:function(e,t,r){return this.addHandler(e,"dragstart",t,r)},removeDragStartHandler:function(e,t){$removeHandler(e,"dragstart",t)},addDropHandler:function(e,t,r){return this.addHandler(e,"drop",t,r)},removeDropHandler:function(e,t){$removeHandler(e,"drop",t)},addCutHandler:function(e,t,r){return this.addHandler(e,"cut",t,r)},removeCutHandler:function(e,t){$removeHandler(e,"cut",t)},createSpan:function(){return document.createElement("span")},createClassSpan:function(e){var t=document.createElement("span");return t.className=e,t},createTBody:function(e){var t=document.createElement("tbody");return e&&e.appendChild(t),t},createTr:function(e){var t=document.createElement("tr");return e&&e.appendChild(t),t},createTd:function(){return document.createElement("td")},createDom:function(e,t,r){var n=document.createElement(e);return t&&(n.style.cssText=this.styleToCssText(t)),r&&r.appendChild(n),n},pix:function(e){return e+"px"},styleToCssText:function(e){if("object"==typeof e){var t="";for(var r in e){var n=e[r];Object.isUndefinedOrNull(n)||(t=t+r+":"+n+";")}return t}return e},createFragment:function(){return document.createDocumentFragment()},createDiv:function(){return document.createElement("div")},createClassDiv:function(e){var t=document.createElement("div");return t.className=e,t},createHiddenDiv:function(){var e=this.createDiv();return e.style.display="none",document.body.appendChild(e),e},createInput:function(){return document.createElement("input")},createCheckBox:function(){var e=this.createInput();return e.type="checkbox",e},createClassCheckBox:function(e){var t=this.createInput();return t.type="checkbox",t.className=e,t},createRadioButton:function(e){var t=null;if(Sys.Browser.isIE&&Sys.Browser.version<=7)try{t=document.createElement("<input name='"+e+"'/>")}catch(r){}return t||((t=this.createInput()).name=e),t.type="radio",t},createInlineDiv:function(){var e=this.createDiv();return e.style.display="inline",e},createGlyphDiv:function(e){var t=this.createDiv();return e||(t.style.cursor="default"),Sys.Browser.isIE&&(t.unselectable="on"),t},createImg:function(){return document.createElement("img")},createBlankImg:function(e,t){var r=this.createImg();return r.border=0,r.src=$skin.getBlankImageSrc(),e&&t&&this.setBounds(r,e,t),r},setDisplay:function(e,t){e.style.display=t?"":"none"},setBounds:function(e,t,r){return t>-1&&(e.style.width=t+"px"),r<=14&&(e.style.fontSize=0,e.style.lineHeight=0),r>-1&&(e.style.height=r+"px"),e},setWidth:function(e,t){if(!(t<=0))return e.style.width=t+"px",e},setMinWidth:function(e,t){if(!(t<=0))return e.style.minWidth=t+"px",e},setLineHeight:function(e,t){if(!(t<=0))return e.style.lineHeight=t+"px",e},setHeight:function(e,t){if(!(t<=0))return e.style.height=t+"px",e},setMinHeight:function(e,t){if(!(t<=0))return e.style.minHeight=t+"px",e},setAutoWidth:function(e){e.style.minWidth=e.style.width,e.style.width="auto"},setAutoHeight:function(e){e.style.minHeight=e.style.height,e.style.height="auto"},setAutoWidthHeight:function(e){this.setAutoWidth(e),this.setAutoHeight(e)},setStyleFloat:function(e,t){e&&(Sys.Browser.isIE?e.style.styleFloat=t:e.style.cssFloat=t)},setPosition:function(e,t,r,n,s){return $dom.setLocation(e,t,r),this.setBounds(e,n,s)},getLocation:function(e){return $dom.getLocation(e)},setLocation:function(e,t){$dom.setLocation(e,t.x,t.y)},getBounds:function(e){var t=$dom.getBounds(e);return 0==t.height&&e==document.body&&(t.height=window.getClientBounds().height),t},getChildrenByTagName:function(e,t){if(!e)return[];for(var r=[],n=e.firstChild;n;){var s=n.tagName;s&&s.toLowerCase()==t&&r.push(n),n=this.getNextSibling(n)}return r},getChildByTagName:function(e,t,r){var n=$$get(t,e);return Object.isUndefinedOrNull(r)&&(r=0),0==n.length?null:n[r]},getFirstChildByTagName:function(e,t){return this.getChildByTagName(e,t)},getFirstParentByTagName:function(e,t){for(var r=e.parentNode;r&&(!r.tagName||"BODY"!=r.tagName);){if(r.tagName.toLowerCase()==t)return r;r=r.parentNode}return null},getFirstParentByClassLevel:function(e,t,r){r=r==undefined?100:r;for(var n=e;n&&r>0;){if($dom.hasClass(n,t))return n;n=n.parentNode,r--}return null},getFirstParentByClassName:function(e,t,r){for(var n=e;n&&(!n.tagName||"BODY"!=n.tagName);){if($dom.hasClass(n,r))return null;if($dom.hasClass(n,t))return n;n=n.parentNode}return null},getLastChildByTagName:function(e,t){for(var r=e.lastChild;r;){var n=r.tagName;if(n&&n.toLowerCase()==t)return r;r=this.getPreviousSibling(r)}return null},getFirstChildByClassName:function(e,t,r){for(var n=e.firstChild;n;){if($dom.hasClass(n,t))return n;n=this.getNextSibling(n)}if(!r)return null;var s=this.getElementsByClassName(e,t,!0);return s.length>0?s[0]:void 0},getControlsByClassName:function(e,t){o=document;e&&(o=e.get_element());for(var r=[],n=this.getElementsByClassName(o,t),s=0,i=n.length;s<i;s++){var o;(o=n[s]).control&&r.push(o.control)}return r},getElementsByClassName:function(e,t,r){if(e.getElementsByClassName)return e.getElementsByClassName(t);for(var n=e.getElementsByTagName("*"),s=[],i=0,o=n.length;i<o;i++){var a=n[i];if(a.tagName&&a.className){var l=a.className.split(" ");if(Array.contains(l,t)&&(s.push(a),r))break}}return s},createBoundedDiv:function(e,t,r){return this.setBounds(this.createGlyphDiv(r),e,t)},createPositionedDiv:function(e,t,r,n){return this.setPosition(this.createGlyphDiv(),e,t,r,n)},setProperties:function(e,t){for(var r in t){var n=t[r];e.setAttribute(r,n)}},createTable:function(e,t,r){var n=document.createElement("table");return n.cellSpacing=e||"0",n.cellPadding=t||"0",n.border=r||"0",n},createPopupTable:function(e,t,r){var n=this.createTable(e,t);return n.rules="none",Sys.Browser.isIE&&(n.style.borderCollapse="collapse"),n},createFlatButton:function(e,t,r){var n=document.createElement("button");return n.className="FlatButton",n.style.width=e+"px",n.style.height=t+"px",n.innerHTML=r,n},_setGradient:function(e,t,r){e.style.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType=0,StartColorStr="+t+",EndColorStr="+r+")"},setBackground:function(e,t,r){if(Sys.Browser.isIE)if(Sys.Browser.version>9)try{e.style.background="linear-gradient("+t.start+","+t.end+")"}catch(n){e.style.backgroundColor=t.middle}else r?this._setGradient(e,t.end,t.start):this._setGradient(e,t.start,t.end);else Sys.Browser.isChrome?e.style.background="-webkit-linear-gradient("+t.start+","+t.end+")":Sys.Browser.isFirefox?e.style.background="-moz-linear-gradient("+t.start+","+t.end+")":e.style.backgroundColor=t.middle},clearBackground:function(e){e.style.filter="",e.style.backgroundColor="",(Sys.Browser.isIE&&Sys.Browser.version>9||!Sys.Browser.isIE)&&(e.style.background="")},getSelectionText:function(e){if(this._hasSelection(e)){var t=e.value;return t?t.substring(e.selectionStart,e.selectionEnd):""}if(window.getSelection){return window.getSelection().toString()}if(document.selection){var r=$common.getSelectionRange();if(!r)return;return r.text}return""},_hasSelection:function(e){try{return("text"==e.type||"TEXTAREA"==e.tagName)&&(e.selectionStart||"0"==e.selectionStart)}catch(t){}},getCaretPosition:function(e){if(e){if(document.selection){var t=$common.getSelectionRange();if(!t)return 0;if("text"==e.type)return t.moveStart("word",-e.value.length),t.text.length;if(e.tagName&&"textarea"==e.tagName.toLowerCase()&&e.createTextRange){var r=e.createTextRange(),n=r.duplicate();return r.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",r),n.text.length}}else if(this._hasSelection(e))return e.selectionStart;return 0}},setCaretPosition:function(e,t){try{if(document.selection){var r=$common.getSelectionRange();if(!r)return;"text"==e.type?(r.moveStart("character",-e.value.length),r.moveEnd("character",-e.value.length),r.moveStart("character",t),r.select()):(r.collapse(!1),r.move("character",t-e.value.length+e.value.split("\n").length-1),r.select())}else this._hasSelection(e)&&e.setSelectionRange(t,t)}catch(n){}},_doShowWaiting:function(e,t){var r=this._loadingDiv;this._loadingDiv||(r=this._loadingDiv=this.createClassDiv("Loading"),document.body.appendChild(r),$dom.setOpacity(r,90)),r.innerHTML=t,$dom.setVisible(r,!0);var n=r.offsetWidth,s=r.offsetHeight,i=rw=getClientBounds(),o=getClientScrollPosition(),a=(i.width-n)/2+o.x,l=(i.height-s)/2+o.y-50;e&&(e==window&&(e=document.body),(i=$dom.getBounds(e)).width>n&&i.width<rw.width&&i.x>=0&&(a=i.x+(i.width-n)/2),i.height>s&&i.height<rw.height&&i.y>=0&&(l=i.y+(i.height-s)/2),(e._isForm||e==document.body)&&this.disableScreen("FormEnabled")),r.style.zIndex=$app.getPopupElementZIndex()+2,$dom.setLocation(r,a,l),this._waiting=!0},_resetRadioGroupChecked:function(e){for(var t=e.getAttribute("name"),r=document.getElementsByName(t),n=0,s=r.length;n<s;n++){var i=r[n];$common._changeCheckedStyle(i.parentNode,i.checked)}},_changeCheckedStyle:function(e,t){$dom.setCssClass(t,e,"checked")},_changeCheckedHalfStyle:function(e,t,r){r?$dom.addCssClass(e,"half"):($dom.removeCssClass(e,"half"),$dom.setCssClass(t,e,"checked"))},showWaiting:function(e,t){this._doShowWaiting(e,$common.getWaitingHTML(t))},showLoading:function(e){this._doShowWaiting(e,$common.getLoadingHTML())},showUploading:function(e){this._doShowWaiting(e,$common.getUploadingHTML())},hideWaiting:function(){var e=this._loadingDiv;e&&$dom.setVisible(e,!1),this.enableScreen(),this._waiting=!1},isWaiting:function(){return this._waiting},hideLoading:function(){this.hideWaiting()},disableScreen:function(e,t){var r=e;"object"==typeof e?r=e.className:e={};var n=this._screenOverlay;n||(n=this._screenOverlay=$common.createGlyphDiv(),document.body.appendChild(n)),e.noClick?$clearHandlers(n):$common.addClickHandler(n,function(e){e.cancel()}),n.className=r?"FormOverlay "+r:"FormOverlay",$dom.setVisible(n,!0);var s=e.zIndex||$app.getPopupElementZIndex()+1;this.renderOverlay(n,s,t||$settings.FormOverlayOpacity)},enableScreen:function(){this._screenOverlay&&!this._progressing&&$dom.setVisible(this._screenOverlay,!1)},getMouseEventPos:function(e){var t=getClientScrollPosition();return{x:e.clientX+t.x,y:e.clientY+t.y}},showOnly:function(e){this._onlyDivs||(this._onlyDivs=[]);var t=e.className||"";t=t.replace("TextTips","");var r=$common.createClassDiv($skin.joinCssClass("OnlyTextTips",t));if(r.innerHTML=e.html,e.target){var n=e.target.tagName?e.target:e.target.get_element();$dom.addCssClass(r,"HasTarget"),n.appendChild(r)}else{document.body.appendChild(r);var s=(r.offsetHeight+10)*this._onlyDivs.length+24;r.style.top=s+"px",r.style.marginLeft=r.offsetWidth/-2+"px",this._onlyDivs.push(r)}$common.addClickHandler(r,function(e){var t=e.target;t&&$dom.hasClass(t,"OnlyTextTips")&&e.offsetX+25>t.offsetWidth&&e.offsetY>10&&i(t)});var i=function(e){var t=Array.indexOf($common._onlyDivs,e);$clearHandlers(e),$removeNode(e),t<0||(Array.removeAt($common._onlyDivs,t),Array.forEach($common._onlyDivs,function(e,r){r<t||(e.style.top=(e.offsetHeight+10)*r+20+"px")}))};if(0===e.timer)return r;var o=e.timer?e.timer:3e3;return setTimeout(function(){i(r)},o),r},showTips:function(e,t,r,n,s,i,o,a,l){if(e){var c=e,d=!1;if("string"!=typeof e){if(!e.html)throw Error.invalidOperation("业务showTips参数不正确，业务必须修正");c=e.html,e.only&&(d=!0),e.className&&(i=e.className),e.timer&&(t=e.timer),!1===e.dispose&&(this.disposeTips=!0),e.zIndex&&(o=e.zIndex),e.control&&(r=e.control)}else i||(i="Info aicon-tishi5");if(d)return this.showOnly(e);if(a||(_Z_216._isCustomTips=!0),"number"!=typeof t&&(r=t,t=null),r||n||s||(s=24),r&&r.get_element){var h=$common.getBounds(r.get_element());n=h.x,s=h.y+h.height+3}var u=this._tipsDiv;u||(u=this._tipsDiv=this.createClassDiv("TextTips"),$common.addClickHandler(u,this.hideTips,this),document.body.appendChild(u));var y=!0;l&&"object"==typeof l&&"INPUT"==l.tagName&&(y=!1),u.className=$skin.joinCssClass("TextTips",i),u.innerHTML=c&&(c.indexOf("</")>=0||c.indexOf("/>")>=0)&&y?c:this.textToHtml(c),$common.hideTips(),u.style.zIndex=o>0?o:$app.getPopupElementZIndex()+2,u.style.left=n?$common.pix(n):"50%",u.style.marginLeft=$common.pix(u.offsetWidth/-2),setTimeout(function(){u.style.top=$common.pix(s)},50),r&&!r.tagName&&r.focus&&r.focus(),window._tipsTimer&&clearTimeout(window._tipsTimer),0!==t&&(t=t||1e3*$settings.DefaultTipsTimer,window._tipsTimer=setTimeout(function(){$common.hideTips(),window._tipsTimer=null},t))}},showInfo:function(e,t){this.showTips(Object.copyTo(t,{html:e,className:"Info aicon-tishi5"}))},showOk:function(e,t){this.showTips(Object.copyTo(t,{html:e,className:"Ok aicon-radio-checked"}))},showWarn:function(e,t){this.showTips(Object.copyTo(t,{html:e,className:"Warn aicon-tishi3"}))},showError:function(e,t){this.showTips(Object.copyTo(t,{html:e,className:"Error aicon-shanchu3"}))},alert:function(e,t){$msg.alert(e,t)},alertInfo:function(e,t){this.alert(e,Object.copyTo(t,{className:"Alert Info",iconName:"aicon-tishikong"}))},alertOk:function(e,t){this.alert(e,Object.copyTo(t,{className:"Alert Ok",title:"系统消息",iconName:"aicon-check-circle-fill"}))},alertWarn:function(e,t){this.alert(e,Object.copyTo(t,{className:"Alert Warn",title:"系统警告",iconName:"aicon-tishi3"}))},alertError:function(e,t){this.alert(e,Object.copyTo(t,{className:"Alert Error",title:"系统错误",iconName:"aicon-close-circle-fill"}))},checkAlert:function(e,t){return e&&this.alert(t),e},checkError:function(e,t,r){if(e)throw t?Error.abort(t,r):Error.abort()},checkTips:function(e,t,r,n){if(e)throw t||(t="系统提示"),r&&r.get_id?$common.showHint(t,r,n):r?this.showTips(Object.copyTo(r,{html:t,className:"Info"})):$common.showError(t),Error.abort()},confirm:function(e,t,r){return $msg.confirm(e,t,r)},showToolTip:function(e,t,r,n,s){if($common._absHideTips)$common._absHideTips--;else{var i=this._toolTipDiv;this._toolTipDiv||(i=this._toolTipDiv=this.createDiv(),$common.addClickHandler(i,this.hideToolTip,this),document.body.appendChild(i)),i.className=n||"ToolTip",i.innerHTML=r&&(r.indexOf("</")>=0||r.indexOf("/>")>=0)?r:this.textToHtml(r),this.setElementScreenCenterPos(i,e,t,s)}},hideTips:function(e){if("disposed"===e&&this.disposeTips)delete this.disposeTips;else{if(this._tipsDiv){this._tipsDiv.style.width="auto";var t=this._tipsDiv.offsetHeight+20;this._tipsDiv.style.top=$common.pix(-1*t)}_Z_216._isCustomTips=!1}},hideToolTip:function(e){$common._absHideTips=e,this._toolTipDiv&&(this._toolTipDiv.style.width="auto",$dom.setVisible(this._toolTipDiv,!1))},toolTipVisible:function(){return!!this._toolTipDiv&&$dom.getVisible(this._toolTipDiv)},setElementScreenCenterPos:function(e,t,r,n,s,i){e.style.zIndex=n>0?n:$app.getPopupElementZIndex()+2,$dom.setLocation(e,-1e4,-1e4),$dom.setVisible(e,!0);var o=getClientScrollPosition(),a=getClientBounds(),l=e.offsetWidth,c=e.offsetHeight,d=0;"object"==typeof t&&(d=t.offset||0,t=t.x+d),l>a.width-10&&(l=a.width-50,t!=undefined&&(t=20),e.style.width=l+"px"),t===undefined&&(t=(a.width-l)/2+o.x),r===undefined&&(r=(a.height-c)/2+o.y);var h=t;t+l-o.x>a.width&&(h=window.event&&window.event.clientX?window.event.clientX-l-5:Math.max(5,t-l-2*d));var u=r;if(r+c-o.y>a.height){if(i){var y=c+c;u=a.height+o.y-y,u=Math.max(u,0)}else u=Math.max(5,r-c);if(s&&s.tagName){u-=$dom.getBounds(s).height}}$dom.setLocation(e,h,u)},getElementScreenCenterPos:function(e){var t=getClientScrollPosition(),r=getClientBounds(),n=e.offsetWidth,s=e.offsetHeight;return{x:(r.width-n)/2+t.x,y:(r.height-s)/2+t.y}},showProgress:function(e){var t={};if(Object.copyTo(e,t),this._progressing=!0,this.disableScreen("ProgressOverlay",e?e.opacity:0),!this._bar){(r=$common.createClassDiv("ProgressBar Modal")).style.cssText="position:absolute;width:300px",document.body.appendChild(r),this._bar=$create(Sys.UI.Controls.ProgressBar,null,r,{},this.getMainForm())}if(t.className){var r=this._bar.get_element();r.className="ProgressBar Modal",$dom.addCssClass(r,t.className)}return $common.setElementScreenCenterPos(this._bar.get_element()),this._bar},hideProgress:function(){this._progressing=!1,this._bar&&(this._bar.set_value(0),this._bar._text="",this._bar.set_showValue(!0),this.enableScreen(),$dom.setLocation(this._bar.get_element(),-1e4,-1e4))},isProgress:function(){return this._progressing},initPopupElement:function(e,t,r){t&&(e.className="Border"),e.style.position="absolute",e.style.zIndex=$app.getPopupElementZIndex()+1},calcPopupPosition:function(e,t,r,n,s,i){var o=getClientScrollPosition(),a=getClientBounds(),l=e;e+r-o.x>a.width&&(l=e+s-r),l<5&&(l=5);var c=t;return t+n-o.y>a.height&&(c=a.height-i-n),{x:l,y:c}},getTableHeader:function(e){return this.getFirstChildByTagName(e,"thead")},getTableBody:function(e){return this.getFirstChildByTagName(e,"tbody")},getTableFirstRow:function(e){return this.getTableRow(e,0)},getTableRow:function(e,t){var r=this.getTableBody(e);return r?this.getChildByTagName(r,"tr",t):null},overlaps:function(e,t){return e.x<t.x+t.width&&t.x<e.x+e.width&&e.y<t.y+t.height&&t.y<e.y+e.height},ptInRect:function(e,t){return e.x>=t.x&&e.x<t.x+t.width&&e.y>=t.y&&e.y<t.y+t.height},getGlyphDivHTML:function(e,t){return'<div class="'+(e+" iconfont index"+t)+'"></div>'},showHint:function(e,t,r,n,s,i){if("object"==typeof t)return null==this._hintBox&&(this._hintBox=new _Z_102),void this._hintBox.show(e,t,r===undefined?$settings.DefaultTipsTimer:r,n,s,i);this._hideHintForm();var o=this._hintForm=$common.createClassDiv("HintForm transition3"),a=$common.createClassDiv("HintCaption");o.appendChild(a);var l=this._hintClose=$common.createClassDiv("HintClose aicon-close");$common.addClickHandler(l,this._hideHintForm,this),o.appendChild(l);var c=$common.createClassDiv("HintContent");o.appendChild(c),document.body.appendChild(o),n=n||"消息提醒",a.innerHTML=n,c.innerHTML=e,setTimeout(function(){o.style.right="1px"},1);var d=t;this._hintFormCloseTimer=setTimeout($createDelegate(this,function(){this._hideHintForm()}),d?1e3*d:5e3)},_hideHintForm:function(){if(this._hintForm){clearTimeout(this._hintFormCloseTimer),$clearHandlers(this._hintClose);var e=this._hintForm;e.style.right=-1*e.offsetWidth+"px",setTimeout(function(){$removeNode(e)},300),this._hintForm=null}},hideHintBox:function(e){this._hintBox&&this._hintBox.hide("tabChanged"==e||"esc"==e)},hideHint:function(e){return this.hideHintBox(e),this.hideToolTip(),this.hideEditEx(),this.hidePopup(e)},hidePopup:function(e){var t=$app.getLastPopup();return!!(t&&t.popupAt&&t.get_isActive())&&(t._fromHide(e),!0)},hideEditEx:function(){window.__craba_editEx&&window.__craba_editEx.fastHide()},_doEditHint:function(e,t,r){if(e&&(!t||e._setTitle)){var n="INPUT"==e.tagName?e.value:e.innerText,s=e.scrollWidth>e.clientWidth+3;Sys.Browser.isIE&&n&&(s=12*n.length>e.clientWidth+3),s?(r||$dom.addCssClass(e,"ellipsis"),e.title=n,e._title=n):(e.title="",e._title=""),e._setTitle=!0}},showModalForm:function(e,t,r,n,s,i,o){var a=new Sys.UI.Form(e,r,n);return s&&a.add_loaded(s),i&&a.add_ok(i),o&&a.add_close(o),a.showModal(t),a},refresh:function(e){e?window.location=e:window.location.reload()},showModalDialog:function(e,t,r,n){return this.showDialog(e,t,r,!0,n)},showDialog:function(e,t,r,n,s){t+=n?12:0,r+=n?32:0;getClientBounds();var i=(screen.width-t)/2,o=(screen.height-r)/2-20;try{if(n){a="dialogLeft:"+i+"px;dialogTop:"+o+"px;dialogWidth:"+t+"px;dialogHeight:"+r+"px;help:no; resizable:no; status:no;";return window.showModalDialog(e,s||window,a)}var a="left="+i+",top="+o+",width="+t+",height="+r+",menubar=no,location=no,status=no,scrollbars=no,resizable=no";return window.open(e,"",a)}catch(c){window.__allowRefresh=!0;var l="请关闭浏览器弹出窗口阻止程序后重试！\r\n"+(c.message?"出错："+c.message:"\r\n");$common.alert(l)}},hAlignToString:function(e){switch(e){case _Z_250.left:return"left";case _Z_250.center:return"center";case _Z_250.right:return"right"}return""},getCookie:function(e){var t="",r=document.cookie;if(r.length>0){var n=e+"=",s=r.indexOf(n);if(-1!=s){s+=n.length;var i=r.indexOf(";",s);-1==i&&(i=r.length),t=unescape(r.substring(s,i))}}return t},setCookie:function(e,t,r,n){var s="";r&&(s="; expires="+(s=new Date((new Date).getTime()+36e5*r)).toGMTString());var i=e+"="+escape(t)+s+";path=/";n&&(i+=";domain="+n),document.cookie=i},removeCookie:function(e){this.setCookie(e,"",-1)},getSysUIPath:function(e){return"_Sys/UI/"},getSysUIBaseURI:function(e){return e&&e._corsHost?e.convertUrl("/"+this.getSysUIPath(e)):$getRootURI()+this.getSysUIPath(e)},getHostUrl:function(){return window.location.protocol+"//"+window.location.host},getUrlHost:function(e){if(!e)return null;var t=document.createElement("a");t.href=e;var r={source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port},n=r.protocol+"://"+r.host;return r.port&&(n+=":"+r.port),n},getResourceUrl:function(e,t){return(t.get_form?t.get_form().get_resourcePath():__webResourceURI)+e},navigateUrl:function(e,t,r){var n=document.createElement("form");e.indexOf(".htm")>-1&&(r="GET"),r=r||"GET",n.method=r,void 0===t&&(t="_blank"),n.action=e,n.target=t;var s=e.indexOf("?");if(s>0){n.action=e.substr(0,s);var i=(e=e.substr(s+1)).split("&");Array.forEach(i,function(e,t){var r=e.split("="),s=document.createElement("input");s.type="hidden",s.name=r[0],s.value=r[1],n.appendChild(s)})}document.body.appendChild(n),n.submit(),$removeNode(n)},openLink:function(e){var t=screen.width-12,r=screen.height-68;(Sys.Browser.isFirefox||Sys.Browser.isChrome)&&(t+=4);var n="resizable=1,left=0,top=0,width="+t+",height="+r,s="_link"+(new Date).getTime();return e.target=s,window.open(e.href,s,n),!1},openwin:function(e){var t=document.getElementById("openwin");t||((t=document.createElement("a")).setAttribute("target","_blank"),t.setAttribute("id","openwin"),t.setAttribute("style","display:none"),document.body.appendChild(t)),t.setAttribute("href",e),t.click()},getSenderForm:function(e){if(Sys.UI.CustomForm.isInstanceOfType(e))return e;if(!_Z_242.isInstanceOfType(e))throw Error.invalidOperation("创建表单的 owner 必须是一个 Component");return e.get_form()},loadScript:function(e,t,r,n,s){var i="string"==typeof e?e.split(","):e;if(i.length<1)"function"==typeof t&&t(e);else{var o=function(a){if(0!=i.length||a){if(!a)return o(i.shift());if(a=a.trim(),$jsLoader.isScriptLoaded(a))return o(i.shift());if($settings.CrabaServer||s){var l=document.createElement("script");l.type="text/javascript",l.src=a,l.onload=l.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||($jsLoader.push(a),o(i.shift()),l.onload=l.onreadystatechange=l.onerror=null)},l.onerror=function(){o(i.shift()),"function"==typeof r&&r(a),l.onload=l.onreadystatechange=l.onerror=null},document.getElementsByTagName("HEAD")[0].appendChild(l)}else{new _Z_223Task(a,function(e,t,n){if(!1===t)return"function"==typeof r&&r(a,n),void o(i.shift());$jsLoader.push(a),o(i.shift())}).execute(!0,n)}}else"function"==typeof t&&t(e)};o(i.shift())}},_doLoadPageScript:function(e,t,r,n){var s=$jsLoader.getInstance(),i=t.Context.scriptIncludes;i&&0!=i.length?s.get_isLoading()?setTimeout(function(){$common._doLoadPageScript(e,t,r)},50):(s._loading=!0,i=Object.clone(i),$common.loadScript(i,function(n){s._loading=!1,r.apply(e,[t])},function(e){if(!e.startsWith("http")){void 0!==n&&n(!1);var t=e+"加载失败，请刷新重试或检查路径拼写是否正确。";throw console.log(t),new Error.abort(t)}})):r.apply(e,[t])},showMDI:function(e){return this.checkError(!e.sender,"showMDI必须传sender参数"),this.checkError(!e.url,"showMDI必须传url参数"),this.showPage(e.sender,e.url,e.caption,e.closeType,e.pageTimeout)},showPage:function(e,t,r,n,s){var i=this.getSenderForm(e),o=this.getMainForm(i);o!=i&&(t=i.convertUrl(t)),n||(n=$common.getPathParam(t,"closeType"))&&(t=$common.removeUrlParam(t,"closeType"));var a=t,l=null;"object"==typeof r&&(Object.isEmpty(r)||(l=r,a=this.encodeUrlParams(a,l)),r=null);var c=this._getMainPanel(o);return n==SysConsts.TargetBlank?a=this.addUrlTickParam(a):n==SysConsts.CloseAll?this.closeFormsByUrl(e,t):n&&c.closePage(a),c.showPage(a,r,l,s)},addUrlTickParam:function(e){var t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate()),n=t.getTime()-r.getTime();return this.addUrlParam(e,"__Tick",n)},showIFrameUrl:function(e,t,r){var n=this.getSysUIBaseURI()+"IFrame.gspx",s={Title:t,Url:r};return this.showPage(e,n,s)},showIFrameModal:function(e,t,r){var n=t,s=0,i=0,o=!1,a=$settings.DefaultAllowResizeForm;"string"!=typeof t&&(n=t.caption,r=t.url,s=t.width,i=t.height,o=t.fullWindow,a=t.allowResize);var l=this.getSysUIBaseURI()+"IFrame.gspx",c={Title:n,Url:r},d=new Sys.UI.Form(e,s,i);return o&&d.set_fullWindow(!0),d._allowResize=a,d.showModal(l,c),d},getMDIPageCount:function(e){return this._getMainPanelFromSender(e).get_pageCount()},getMDIForms:function(e){return this._getMainPanelFromSender(e).get_forms()},getMDITabs:function(e){return this._getMainPanelFromSender(e).get_tabs()},closeAllMDIForms:function(e,t,r){var n=this.getMDIForms(e),s=this.getMDITabs(e),i=n.length,o=function(){var e=i-1,a=n[e];i--;var l=function(){i>0?o():(n=null,r&&r())};if(!a)return s[e].close(),void l();var c=!0;t&&(c=t(a));var d=function(e,t){t?a.close(!0):(a.remove_closed(l),a.remove_notifyClose(d))};c?(a.add_closed(l),a.add_notifyClose(d),a.close(a.absClose)||l()):l()};i>0&&o()},closePage:function(e,t){var r=this.getSenderForm(e),n=this.getMainForm(r);n!=r&&(t=r.convertUrl(t));this._getMainPanel(n).closePage(t)},closeFormsByUrl:function(e,t){var r=this.getSenderForm(e),n=this.getMainForm(r);t=n.convertUrl(t),t=$common.removeUrlParams(t),this.closeAllMDIForms(e,function(e){var r=e.get_url();return r=n.convertUrl(r),(r=$common.removeUrlParams(r)).indexOf(t)>-1||t.indexOf(r)>-1})},removeUrlParams:function(e){var t=e.indexOf("?");return t>1&&(e=e.substring(0,t)),e},setActiveMDIForm:function(e){this._getMainPanelFromSender(e).set_activeForm(e)},_getMainPanelFromSender:function(e){var t=this.getSenderForm(e),r=this.getMainForm(t);return this._getMainPanel(r)},encodeUrlParam:function(e,t){if(!e)return e;t||(t=escape);e=t(e).replace(/\+/g,"%2B");return t!==escape?e:e.replace(/%B7/g,"%u00B7").replace(/%D7/g,"%u00D7").replace(/%B0/g,"%u00B0")},removeUrlParam:function(e,t){var r=new RegExp(t+"=([^&]*)(&|$)");return e=e.replace(r,"").trim("&").trim("\\?")},addUrlParam:function(e,t,r,n){return e+=e.indexOf("?")>0?"&":"?",e+=t+"="+this.encodeUrlParam(r,n)},encodeUrlParams:function(e,t){if(t){t=$crabaJSON.serialize(t);e=this.addUrlParam(e,"__Params",t)}return e},getMainForm:function(e){if(!e){var t=$app.get_forms();if(t&&t.length>=1)return t[0];throw Error.invalidOperation("找不到主界面")}for(var r,n=e;;){if(!(r=n.get_parentForm()))break;n=r}return n},_getMainPanel:function(e,t){var r=e.__mainPanel;if(!r&&t==undefined)throw Error.invalidOperation("没有 SDIPanel 或 MDIPanel 的页面不能用 showPage");return r},getMainPanel:function(e,t){var r=this.getMainForm(e);return this._getMainPanel(r,t)},getMainPanelSize:function(e){var t=this.getMainPanel(e);if(!t)return null;var r=t._childsElement;return{width:r.offsetWidth-28,height:r.offsetHeight-28}},getFirstScrollParent:function(e){for(var t=e.parentNode;"BODY"!=t.tagName&&!(t.scrollHeight>t.offsetHeight+5);)t=t.parentNode;return t.scrollHeight>t.offsetHeight?t:null},scrollToView:function(e,t,r){var n=e.offsetTop,s=t.scrollTop;if(n<s)n>0&&n--,t.scrollTop=n;else{var i=n+e.offsetHeight,o=t.clientHeight;if(o>0&&i>s+o+3)s=i-o+1,t.scrollTop=s;else if(r){if(r.offsetParent!=r.parentNode)return;var a=this.getFirstScrollParent(r);if(!a)return;var l=r.offsetTop,c=a.scrollTop;if((i=l+i+45)<c)a.scrollTop=0,i<o&&(t.scrollTop=0);else{var d=a.clientHeight;d>0&&i>c+d&&(c=i-d+1,t.scrollHeight>t.offsetHeight+5&&t.scrollTop<t.scrollHeight-o?t.scrollTop=c:a.scrollTop=c)}}}},setEnabled:function(e,t){e&&e.set_enabled&&e.set_enabled(t)},exportServiceToExcel:function(){$print.LastPrint&&$print.LastPrint._internalExportXls()},exportXls:function(e,t,r,n){if(e){this.setEnabled(e,!1);try{var s=e.get_form(),i={};if(i.reportName=s.get_caption(),i.masterFields=[],$export.initMasterFields(s,t,i.masterFields),t){i.detailFields=[],$export.initDetailFields(t,i.detailFields);t.findPager()?i.detailPagerId=t.get_pagerClientId():i.detailData=$export.getGridsData([t],r,n)}this._internalExportXls(i)}finally{this.setEnabled(e,!0)}}},_internalExportXls:function(e){this.exportFile($getRootURI()+$settings.PrintExportAPI,e)},textToHtml:function(e){return e?e.replace(/</g,"&lt;").replace(/\n/g,"<br>").replace(/\s/g,"&nbsp;"):e},_formatNumberWithThousandSeperator:function(e,t){for(var r=e.format("n"+t,!0),n=r.length-1,s=n;s>0;s--){var i=r.charAt(s);if("0"!=i){s!=n&&("."!=i&&s++,r=r.substring(0,s));break}}return r},formatNumber:function(e,t,r,n,s,i,o){if(Object.isUndefinedOrNull(e)||""===e)return"";var a=!1;if("object"==typeof e&&(t=e.decimalDigits,r=e.decimalScale,n=e.displayThousandSeperator,s=e.displayEmptyForZero,i=e.displayZeroToDigits,o=e.isRound,a=e.isPrint,e=e.value,Object.isUndefinedOrNull(e)||""===e))return"";var l=e.toString();if("number"!=typeof e){if("undefined"!=typeof math){var c=t;if(c<=0&&(c=r),l=math.round(l,c).toString(),c>0&&l){var d=l.indexOf(".");if(d<0){l+=u=(u=".").padRight(c+1,"0")}else{var h=l.substr(d+1);if(c>h.length){var u="";l+=u.padRight(c-h.length,"0")}}}}if(!n)return l;for(var y=l.split("."),p=y[0],f=y.length>1?"."+y[1]:"",m=/(\d+)(\d{3})/;m.test(p);)p=p.replace(m,"$1,$2");return p+f}return 0!=e?(t>0?l=Math.roundTo(e,t,o).format("n"+t,n):r>=0?(e=Math.roundTo(e,r,o),l=n?this._formatNumberWithThousandSeperator(e,r):e.toString()):n&&(l=this._formatNumberWithThousandSeperator(e,8)),l=this._checkENumber(l),a&&!n&&(l=Number(l))):s?l="":i?t>0&&(l=Math.roundTo(0,t,o).format("n"+t)):a&&(l=0),l},_checkENumber:function(e){var t=e.split(/e/i);if(t.length<2)return e;var r=parseInt(t[1]);if(r<0){var n=(i=t[0].trim(",").replace(".","")).startsWith("-");n&&(i=i.substr(1));e=(n?"-":"")+"0."+$string.repeat("0",-1*r-1)+i}else if(r>0){i=t[0].split(".");e=i.join("");var s=i.length>1?i[1].length:0;if(s<r)e+=$string.repeat("0",r-s);else if(s>r){var i;e=(i=e.substring(0,r+1))+"."+e.substring(r+1,e.length)}}return e},findFocusedGrid:function(e){var t=e.get_focusedControl();if(t){if(Sys.UI.Controls.Grid.isInstanceOfType(t))return t;if(t.get_column){var r=t.get_column();return r?r.get_grid():null}}return null},setTestState:function(e,t){if(window.__testing){var r=$get("__testState");if(!r)throw Error.invalidOperation("__testState 没有初始化");void 0===t&&(t="true"),r.value=r.value+","+e+"="+t}},htmlEncode:function(e){var t="";return 0==e.length?"":(t=e.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"))},htmlDecode:function(e){var t="";return 0==e.length?"":(t=e.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t=t.replace(/&amp;/g,"&"),t=t.replace(/&nbsp;/g," "),t=t.replace(/&#39;/g,"'"),t=t.replace(/&quot;/g,'"'))},clearHTMLTag:function(e){return Object.isUndefinedOrNull(e)?"":(e=e.toString().replace(/<\/?[^>]+>/g,""),e=$common.htmlEncode(e))},deleteHTMLTag:function(e){return e?e.toString().replace(/<[^>]*>.*<\/[^>]*>/gm,""):""},copyText:function(e){if(window.clipboardData)return window.clipboardData.clearData(),window.clipboardData.setData("Text",e),void $common.showTips("复制成功!");var t=$common.createDom("textarea","position:absolute;top:-1000px;left:-1000px;border:none;width:10px;",document.body);t.innerHTML=e,setTimeout(function(){t.select();try{succeeded=document.execCommand("copy"),$removeNode(t)}catch(n){succeeded=!1}if(succeeded)$common.showTips("复制成功！");else{var r="<p style='font-weight:bold;'><font style='color:red'>您的浏览器不支持剪贴板读写功能</font>";r+="，请按<font color='#0000ff'>Ctrl+C</font>手动复制以下内容到剪贴板:</p>",r+="<textarea id='__copyEdit' readOnly='true' style='border:none;width:380px;'>",r+=e,r+="</textarea>",$common.alert(r),(t=document.getElementById("__copyEdit")).style.height=t.scrollHeight+"px",setTimeout(function(){t.select()},200)}},10)},getSelectionRange:function(){var e=null;try{e=document.selection.createRange()}catch(t){}return e},_downloadFeedback:function(e,t,r){t||(t="您目前使用的功能需要安装“管家婆工具箱插件”\n\n请点击【确定】下载并安装"),$msg.confirm(t,function(t){t&&window.open("http://trd.mygjp.com/feedback/管家婆工具箱插件.exe","_blank",""),r&&r(t),$removeNode(e)},this,160)},getDeviceId:function(e,t){var r=null;try{return(r=this._createFeedbackObj()).getDeviceID()}catch(n){return this._downloadFeedback(r,e,t),""}},_createFeedbackObj:function(e){var t=e||document.body,r=document.getElementById("FeedbackObj");return r||(r=document.createElement("object"),r.id="FeedbackObj",r.name="FeedbackObj",Sys.Browser.isIE?(r.classid="clsid:07DC6410-D375-4448-A536-10F5B89D069E",$common.setDisplay(r,!1)):(r.type="application/npgraspdevice",r.width=0,r.height=0),t.appendChild(r),r)},createArrow:function(e,t){var r=t||this.createSpan("span");return r.className=e,r},showPopup:function(e,t,r,n,s,i){if(!t)throw Error.abort("url不能为空");o=e._popup;if(n||!e._popup){e._popup&&(e._popup.pForm.dispose(),e._popup.dispose(),e._popup=null);var o,a=(o=new Sys.UI.Controls.Popup(e,!0)).render();e._popup=o;var l=new Sys.UI.Form(e);l.add_loaded(function(t){t._initialized=!0,o._init(),s&&s(o),o.popupAt(e,i)}),l._contentElement=a,l.refresh(t,r),l.PopupBlock=o,o.pForm=l}else o.popupAt(e,i);return o},renderOverlay:function(e,t,r){e.style.zIndex=t,$dom.setOpacity(e,r||50)},setDomEnabled:function(e,t,r,n){if(e){var s=e.control;if($common.beginEnabled=!0,!r&&s){var i=Object.getTypeName(s);if("Sys.Content.Controls.HintMenu"==i)return;if("Sys.UI.Controls.LayoutGroup"!=i&&s.set_enabled&&($common.beginEnabled=!0,null===s._defaultEnabled||n?s.set_enabled(t):s.set_enabled(s._defaultEnabled)),"Sys.UI.Controls.Grid"==i)return}else $dom.setEnabled(e,t);for(var o=e.firstChild;o;)o.tagName&&$common.setDomEnabled(o,t,!1,n),o=$common.getNextSibling(o);$common.beginEnabled=!1}},setContainerEnabled:function(e,t,r,n){if(e){$common.beginEnabled=!0;for(var s=e.getElementsByTagName("*"),i=0,o=s.length;i<o;i++){var a=s[i];a.control&&this._setControlEnabled(a.control,t,n)}$common.beginEnabled=!1}},_setControlEnabled:function(e,t,r){var n=Object.getTypeName(e);"Sys.Content.Controls.HintMenu"!=n&&"Sys.UI.Controls.LayoutGroup"!=n&&e.set_enabled&&($common.beginEnabled=!0,null===e._defaultEnabled||r?e.set_enabled(t):e.set_enabled(e._defaultEnabled))},addElementsCssClass:function(e,t){for(var r=e.childNodes,n=0,s=r.length;n<s;n++){var i=r[n];i.tagName&&$dom.addCssClass(i,t)}},getElementChildControls:function(e){for(var t=[],r=e.getElementsByTagName("*"),n=0,s=r.length;n<s;n++){var i=r[n];if(i.control&&!i.control.tagName){var o=i.control,a=t[0];if(a&&o.__form!=a.__form)continue;t.push(o)}}return t},setDomRelative:function(e){if(e.style.position="relative",Sys.Browser.isIE&&Sys.Browser.version<8)for(var t=e.parentNode;t&&"BODY"!=t.tagName&&""==t.style.position;)t.style.position="relative",t=t.parentNode},preview:function(e){var t=window.open("","_blank","");t.document.open("text/html","replace"),t.opener=null,t.document.writeln(e),t.document.close()},getNextSibling:function(e){return e.nextElementSibling||e.nextSibling},getPreviousSibling:function(e){return e.previousElementSibling||e.previousSibling},supportCss3Browsers:function(){return!(!Sys.Browser.isIE9&&Sys.Browser.isIE)},supportFlexBrowsers:function(){return this._supportFlexBrowsers!==undefined?this._supportFlexBrowsers:(this._supportFlexBrowsers=!(Sys.Browser.isIE&&!(Sys.Browser.isIE&&Sys.Browser.version>9)),this._supportFlexBrowsers)},scrollTop:function(e,t){var r=e||document.body;r.timer&&clearTimeout(r.timer),t=t||50;var n=function(){r.scrollTop-=r.scrollHeight/10,r.scrollTop<=0?delete r.timer:r.timer=setTimeout(n,t)};n()},scrollBottom:function(e,t){var r=e||document.body;r.timer&&clearTimeout(r.timer),t=t||50;var n=function(){var e=r.scrollTop;r.scrollTop+=r.scrollHeight/10;e!=r.scrollTop?r.timer=setTimeout(n,t):delete r.timer};n()},getUrlParam:function(e){var t=window.location.search;try{t=decodeURIComponent(t)}catch(s){t=unescape(t)}var r=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=t.substr(1).match(r);return null!=n?unescape(n[2]):null},getPathParam:function(e,t){if(!e)return null;var r=e.indexOf("?");if(r<0)return null;e=e.substr(r);var n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),s=e.substr(1).match(n);return null!=s?unescape(s[2]):null},ajax:function(e){var t=(e=Object.copyTo(e,{type:"POST",async:!0,data:"",crossDomain:!1})).data,r=e.url;$common.checkAlert(!r,"$common.ajax必须传url参数");var n=e.headers,s=e.type,i=e.timeout,o=e.form;!t||t instanceof FormData||(n||(n={}),n["Content-Type"]?"object"==typeof t&&(t=Sys.Net.WebRequest._createQueryString(t)):(n["Content-Type"]="application/json;charset=utf-8","object"==typeof t&&(t=JSON.stringify(t))));var a=new Sys.Net.WebRequest;Object.copyTo(n,a.get_headers(),e.ignoreHeader),a.set_url(r),a.set_body(t),a.set_httpVerb(s),a.set_withCredentials(e.crossDomain),i&&i>0&&a.set_timeout(i),e.async||a.set_async(!1),e.responseType&&a.set_reponseType(e.responseType);var l=!1;e.waiting&&($common.showWaiting(null,e.waiting),l=!0);var c=function(e,t){e&&e.set_enabled&&e.get_isDisposed&&!e.get_isDisposed()&&e.set_enabled(t)};c(e.owner,!1);var d=null;return a.add_completed(function(t){if(l&&$common.hideWaiting(),e.complete&&e.complete(t),!o||!o.get_isDisposed()||e.dispose)if(c(e.owner,!0),t.get_responseAvailable()&&0!=t.get_statusCode()){if("blob"===e.responseType||!$app._doRequestComplated({statusCode:t.get_statusCode(),responseText:t._xmlHttpRequest.response,type:"ajax",form:o,url:r})){try{var n=t.getResponseHeader("Content-Type");if(n){if(n.startsWith("application/json"))d=t.get_responseData(),d=$settings.CrabaServer?$crabaJSON.deserialize(d):JSON.parse(d);else if("blob"==e.responseType){var s=t.getResponseHeader("Content-Disposition");(!s||s.indexOf("filename=")<0)&&(s=e.fileName?"filename="+e.fileName:"filename="+e.url.substr(e.url.lastIndexOf("/")+1)),$common.downloadBlob(t.get_response(),s)}}else d=t.get_responseData()}catch(i){}e.responseInterceptor&&(d=e.responseInterceptor(d)),t.get_statusCode()<200||t.get_statusCode()>=300?e.error&&e.error(d,t):e.success&&e.success(d,t)}}else e.error&&e.error(null,t)}),a.invoke(),e.async?a:d},ajaxSync:function(e){return e.async=!1,this.ajax(e)},downloadBlob:function(e,t){var r=URL.createObjectURL(e),n=["",""];t&&(n=t.split("filename=")[1].split("."));var s=document.createElement("a");s.href=r,s.download=decodeURI(n[0])+"."+n[1],document.body.appendChild(s),s.click(),setTimeout(function(){document.body.removeChild(s)},300),URL.revokeObjectURL(r)},download:function(e){t=this._downloadIframe;if(!t){var t;(t=this._downloadIframe=document.createElement("iframe")).className="dnone",document.body.appendChild(t)}t.src=e},exportFile:function(e,t){var r=$get("__crabaExportData");if(!r){var n=document.createElement("form");n.method="post",n.className="ExportForm",n.target="_blank",(r=this.createInput()).id="__crabaExportData",r.type="hidden",r.name="data",n.appendChild(r),document.body.appendChild(n)}r.value=escape($crabaJSON.serialize(t));var s=r.form;s.action=e,s.submit()},_getDomCachePadding:function(e,t){if(e._vBorderSize===undefined){var r=$dom._getCurrentStyle(e);e._vBorderSize=this._parseInt(r.paddingTop)+this._parseInt(r.paddingBottom)+this._parseInt(r.borderTopWidth)+this._parseInt(r.borderBottomWidth),e._hBorderSize=this._parseInt(r.paddingLeft)+this._parseInt(r.paddingRight)+this._parseInt(r.borderLeftWidth)+this._parseInt(r.borderRightWidth)}return t?e._vBorderSize:e._hBorderSize},_parseInt:function(e){var t=parseInt(e);return isNaN(t)?0:t},disableIme:function(e){e&&(e.style.imeMode="disabled")},get_baseURI:function(){return __skinPath},getLoadingHTML:function(){return this.getWaitingHTML("正在加载")},getUploadingHTML:function(){return this.getWaitingHTML("正在上传")},getWaitingHTML:function(e){return"<div class='iconfont LoadingIcon'></div>"+(e?e+"...":"")},toMinDate:function(e){var t=new Date;t.setHours(0,0,0);var r=parseInt(e);return r<0?(t.setDate(1),t.setMonth(t.getMonth()+1+r)):r<400?0==r?t.setHours(0,0,0,0):t.setDate(t.getDate()-r):t="string"==typeof e?Date.strToDate(e):e,t},_hideCount:0,_hideScrollBar:function(){if(!this._oldBodyOverflowStyle){var e=$dom._getCurrentStyle(document.body);this._oldBodyOverflowStyle={ox:e.overflowX,oy:e.overflowY}}this._hideCount++,this._hideCount>1||(document.body.style.overflow="hidden")},_restoreBar:function(){this._oldBodyOverflowStyle&&(this._hideCount--,this._hideCount>0||(document.body.style.overflow="",document.body.style.overflowX=this._oldBodyOverflowStyle.ox,document.body.style.overflowY=this._oldBodyOverflowStyle.oy))},getFileUrl:function(e){var t=null;if(!e)return t;var r=e.files[0];return r?(window.createObjcectURL!=undefined?t=window.createOjcectURL(r):window.URL!=undefined?t=window.URL.createObjectURL(r):window.webkitURL!=undefined&&(t=window.webkitURL.createObjectURL(r)),t):t},addStep:function(e,t,r,n){$step.addStep(e,t,r,n)},addSteps:function(e,t,r){$step.addSteps(e,t,r)},clearStepCache:function(){$step.clearStepCache()},clearGroupCache:function(e){$step.clearGroupCache(e)},hideStepPopup:function(){$step.hideStepPopup()},formatDateTime:function(e,t){var r={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in r)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?r[n]:("00"+r[n]).substr((""+r[n]).length)));return t},isMobile:function(){if(this._isMobile!==undefined)return this._isMobile;var e=new Array("iphone","ipod","ipad","android","mobile","blackberry","webos","incognito","webmate","bada","nokia","lg","ucweb","skyfire"),t=navigator.userAgent.toLowerCase();this._isMobile=!1;for(var r=0;r<e.length;r++)if(-1!=t.indexOf(e[r])){this._isMobile=!0;break}return this._isMobile},getBigMath:function(e){if(!$settings.UseBigNumber||"undefined"==typeof math)return null;var t=30;e&&(t=e);var r="bigKey"+t;if(this[r])return this[r];var n=math.create({number:"BigNumber",precision:t});return this[r]=n,n},toTreeData:function(e,t,r,n,s){var i=new TreeDataSource(e,n,s),o=i.getNode(t,r);return i.get_nodeScriptData(o,o)},toNodeData:function(e,t){return{_text:e[t],_data:e}},saveImage:function(e,t){var r=function(r,s){var i,o;s?(i=r,o=t||"blob"):(i=URL.createObjectURL(n.response),o=t||e.substr(e.lastIndexOf("/")));var a=document.createElement("a");a.href=i,a.download=o,a.click()};if(e.startsWith("data:image/"))return r(e,!0);var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.onload=r,n.send()},getLocalUtc:function(){return-1*(new Date).getTimezoneOffset()},toggleFullScreen:function(){var e,t;e=document.body;($dom.hasClass(e,"fullscreen")?(t=document).exitFullscreen||t.mozCancelFullScreen||t.webkitCancelFullScreen||t.msExitFullscreen:(t=document.documentElement).requestFullscreen||t.webkitRequestFullScreen||t.mozRequestFullScreen||t.msRequestFullscreen).apply(t)},isFullScreen:function(){return document.body.scrollHeight+5>window.screen.height&&document.body.scrollWidth+5>window.screen.width}};var $common=new _Z_60;SysConsts=function(){},SysConsts.RowIndex="__rowIndex",SysConsts.TargetBlank="_blank",SysConsts.CloseAll="closeAll",window.$user={},window.__sogou_secure_input={},window.__sogou_secure_input.check=function(){};var bodyCssName="Browser"+Sys.Browser.name+" v"+Sys.Browser.version;$common.isMobile()&&(bodyCssName+=" MobilePage"),$dom.addCssClass(document.body,bodyCssName),$settings.GridDefaultScrollBarWidth=Sys.Browser.isChrome?14:17,function(){function e(t,r,n,s,i){var o=t[i];if(o){delete t[i];for(var a=0;a<o.length;a++){var l=o[a],c={Data:l,Text:l[n],ChildNodes:[]};e(t,c,n,s,l[s]),r.ChildNodes.push(c)}return r}}window.TreeDataSource=function(e,t,r){this._data=function(e,t){for(var r={},n=0;n<e.length;n++){var s=e[n],i=s[t],o=r[i];o||(o=[],r[i]=o),o.push(s)}return r}(e,t),this._rootId=r},TreeDataSource.prototype={getNode:function(t,r){var n={ChildNodes:[]};return this._data[this._rootId]?e(this._data,n,t,r,this._rootId):n},get_nodeScriptData:function(e,t){var r=[],n=function(e,t){return e==t?null:{_text:e.Text,_data:e.Data}}(e,t);n&&r.push(n);for(var s=0,i=e.ChildNodes.length;s<i;s++){var o=e.ChildNodes[s];r.push(this.get_nodeScriptData(o))}return r}}}(),function(){window.$notify=new function(){function e(e,r){if(!t[e]){if(!r)return null;t[e]=[]}return t[e]}var t={};this.bind=function(t,r,n){return"function"==typeof n&&(r=$createDelegate(n,r)),e(t,!0).push(r),r},this.bindOnce=function(e,t,r){return t=this.bind.apply(this,arguments),t.once=!0,t},this.remove=function(e){if("string"==typeof e)return delete t[e];for(var r in t)for(var n=t[r],s=0,i=n.length;s<i;s++){var o=n[s];if(o===e)return void Array.remove(n,o)}},this.clear=function(){t={}},this.emit=function(t,r){var n=e(t);if(!n)return console.log(t+"事件不存在"),!1;if(0==n.length)return console.log(t+"事件为空"),!1;for(var s=0;s<n.length;s++){var i=n[s];i(r),!0===i.once&&(Array.remove(n,i),s--)}return!0},this.emitOnce=function(e,t){var r=this.emit.apply(this,arguments);return this.remove(e),r}}}();﻿_Z_247=function(){this._stepList=[],this._stepIds=[],this._hideList=[],this._curList=null},_Z_247.prototype={addStep:function(t,e,i,s){if($settings.DefaultEnableStep&&(this._loadStepConfig(),e&&window.$cache&&window.$cache.isSupported()&&(!t.get_visible||t.get_visible()))){var o;!0===e?(e=t.html,i=i||t.times,s=t.form,o=t.tipsId?t:t.control):o=t,i=i||1;var n=o,r=null;if("object"!=typeof o||o.tagName)if("string"==typeof o){if(!s)return;if(!(n=s[o]))return;r=n.get_id()}else{if(!o)return;r=o.id+o.tagName}else if(o.tipsId!=undefined){if(!(n=o.control))return;r=o.tipsId}else{if(!n)return;n.get_id||(n=n.control),r=n.get_id()}if(!r)return $common.showTips("addStep对象必须先设置id属性");if(i<2){if(Array.contains(this._stepIds,r))return;this._stepIds.push(r)}var a={id:r,control:n,html:e,times:i,data:t};this._stepList.push(a),this.popStep()}},addSteps:function(t,e,i){for(var s=0;s<t.length;s++){var o=t[s];o.form=e,this.addStep(o,!0,i)}},clearStepCache:function(){$cache.clear(),this._stepIds=[],this._stepList=[],this._hideList=[]},clearStepConfig:function(){this.userStep=[],this.doSaveStep()},clearGroupCache:function(t){$cache.deleteGroup(t)},removeStep:function(){for(var t=0,e=this._hideList.length;t<e;t++){var i=this._hideList[t];Array.remove(this._stepIds,i.id)}this._hideList=[]},popHideStep:function(){this._stepShow||0==this._hideList.length||(this._showStep(Array.clone(this._hideList),600),this._hideList=[])},popStep:function(t){if(this._stepShow||0==this._stepList.length)return this._curList&&Array.addRange(this._curList,this._stepList),void(this._stepList=[]);this._showStep(Array.clone(this._stepList),t),this._stepList=[]},hideStepPopup:function(t){this._stepShow&&this._StepPopup&&this._StepPopup.isShow()&&(this._doIgnoreHandler(t),t&&this._curList.length>0&&(this._ignoreSteps(this._curList),this._ignoreSteps(this._hideList)),this._stepShow=!1,this._StepPopup.hide(),"完成(esc)"!==this._StepCancelBtn.innerText&&(this._hideList=[]),this._stepList=[],this._curList=[],this._stepIds=[])},_doIgnoreHandler:function(t){if(t){var e=this._curStep,i=e.data;if(i.onCancel){var s=i.form;if(!s&&e.control&&e.control.get_form&&(s=e.control.get_form()),s)for(var o=s.get_action(),n=i.onCancel.split(","),r=0,a=n.length;r<a;r++){o[n[r]].apply(o,e.control)}}}},_ignoreSteps:function(t){if(t)for(var e=0;e<t.length;e++){var i=t[e];this.userStep&&Array.addByContains(this.userStep,i.id);var s=$cache.get(i.id,{vs:i.data.vs,defaultValue:0});$cache.set(i.id,s+1,{group:i.data.group,vs:i.data.vs})}},_showStep:function(t,e){this._stepShow=!0;var i=this;i._curList=t,i._loading=!0;setTimeout(function(){var e=i._getNextStep(t,!0);if(!e)return i._StepPopup&&i._StepPopup.hide(),i._stepShow=!1,void(i._loading=!1);var s=e.control,o=i._getStepPopup();o._contentDiv.innerHTML=e.html;for(var n=i._getNextStep(t,!1);n&&!i.checkStepVisible(n);)n=t.shift(),i._saveHideStep(n),n=i._getNextStep(t,!1);n||e.data.onNext?($Dom.setVisible(i._stepBtn,!0),i._StepCancelBtn.innerHTML="跳过(esc)"):($Dom.setVisible(i._stepBtn,!1),i._StepCancelBtn.innerHTML="完成(esc)"),o._isStep=!0,i._curStep=e,i._loading=!1,o.popupAt(s,!0)?i.userStep&&Array.addByContains(i.userStep,e.id):(i._saveHideStep(e),i._nextStepClick(null,t)),setTimeout(function(){i._stepBtn.focus()},500)},e||500)},checkStepVisible:function(t){var e=t.control;if(!e)return!1;var i=null,s=null,o=getClientBounds();if(e.tagName)s=e,i="BODY"==e.tagName?o:$Dom.getBounds(s);else{if(!(s=e._element))return!1;s._outerElement&&(s=s._outerElement),i=$Dom.getBounds(s)}return!(i.x<0||i.y<0||0==i.width||0==i.height)},_saveHideStep:function(t){$cache.set(t.id,0,{group:t.data.group,vs:t.data.vs}),this._hideList.push(t)},_getStepPopup:function(){t=this._StepPopup;if(t)return this._StepPopup;var t;(t=this._StepPopup=new Sys.UI.Controls.Popup(null,!0,!0)).add_hide($createDelegate(this,this.doSaveStep));var e=t.render();$Dom.addCssClass(e,"Step");var i=$common.createClassDiv("Content");e.appendChild(i),t._contentDiv=i;var s=$common.createClassDiv("Bottom"),o=this._StepCancelBtn=$common.createSpan();o.className="Label CancelBtn",o.innerHTML="跳过(esc)",s.appendChild(o);var n=this._stepBtn=document.createElement("button");n.className="Label NextBtn",n.innerHTML="下一步",s.appendChild(n),e.appendChild(s);var r=this._stepForm=$common.getMainForm();return r.addShortcut(13,this._nextStepClick,this),r.addShortcut(39,this._nextStepClick,this),r.addShortcut(40,this._nextStepClick,this),r.addShortcut(32,this._nextStepClick,this),$common.addClickHandler(n,this._nextStepClick,this),$common.addClickHandler(o,this.hideStepPopup,this),t},_getNextStep:function(t,e){var i=t.shift();if(!i)return null;var s=t.length>0;if(!$settings.StepSaveClient)return this.userStep?i.times<2&&Array.contains(this.userStep,i.id)?s?this._getNextStep(t,e):null:(e||t.unshift(i),i):null;var o=$cache.get(i.id,{vs:i.data.vs});return o?o>=i.times?s?this._getNextStep(t,e):null:(e?$cache.set(i.id,o+1,{group:i.data.group,vs:i.data.vs}):t.unshift(i),i):(e?$cache.set(i.id,1,{group:i.data.group,vs:i.data.vs}):t.unshift(i),i)},_nextStepClick:function(t,e){if(this._stepShow&&!this._loading){if(t&&!$Dom.getVisible(this._stepBtn))return this.hideStepPopup(t),void t.over();this._doNextHandler(t);var i=null;i=e!=undefined?e:this._curList,this._stepShow=!1,0==i.length?this._StepPopup.hide():(this._showStep(Array.clone(i),20),i=[])}else t.next()},doSaveStep:function(){if(!Object.isUndefinedOrNull(this.userStep)){var t=this.userStep.join(";");if(!$craba.checkConfig("form","globalStep",t)&&this._dataService){this._dataService.SaveCustomConfig("globalStep",t)}}},_doNextHandler:function(t){if(t){t.over();var e=this._curStep,i=e.data;if(i.onNext){var s=i.form;if(!s&&e.control&&e.control.get_form&&(s=e.control.get_form()),s)for(var o=s.get_action(),n=i.onNext.split(","),r=0,a=n.length;r<a;r++){o[n[r]].apply(o,e.control)}}}},_loadStepConfig:function(){if(!($settings.StepSaveClient||this._loading||this._stepLoaded)){this._curList=[],this._loading=!0,this._stepShow=!0;var t=this;if("function"!=typeof window.GetConfigData){(this._dataService=Craba.Web.Script.DataServiceBase.create()).GetCustomConfig("globalStep",function(e){t.userStep=e?e.split(";"):[],t._stepLoaded=!0,t._showStep(t._curList)},function(e){console.log("Step数据加载失败"+e),t._stepShow=!1})}else window.GetConfigData("globalStep",function(e){t.userStep=e?e.split(";"):[],t._showStep(t._curList)},function(e){console.log("Step数据加载失败"+e),t._stepShow=!1})}}},$step=new _Z_247,Sys.UI.CrabaTool=function(){this.editorButtonWidth=23,this.FormConfigName="__Config_",this.frozenTabCacheName="__frozenTab_"},Sys.UI.CrabaTool.prototype={trimLabel:function(t){return t&&(t.endsWith("*")||t.endsWith(":")||t.endsWith("："))&&(t=t.substr(0,t.length-1)),t},_toElt:function(t){var e=t;if(!e)throw Error.argument("_getElt",Sys.Res.createNoDom);if(!e.tagName){if(!t||!t.get_element)throw Error.argument("control",String.format(Sys.Res.createNotControl,t.getName()));e=t.get_outerElement?t.get_outerElement():t.get_element()}return e},contains:function(t,e){if(!t)return!1;if(!e||0==e.length||!e[0])return!1;for(var i=0,s=e.length;i<s;i++){var o=e[i];if(o){if(o===t)return!0;if(o.compareDocumentPosition){if(n=o===t||!!(16&o.compareDocumentPosition(t)))return!0}else if(o.contains&&1===t.nodeType){var n=o.contains(t);if(n)return!0}else for(;t=t.parentNode;)if(t===o)return!0}}return!1},resolveGspx:function(t,e,i,s,o){s||(s=[]);return Array.forEach(t,function(t,n){if("parsererror"!=t.Name){if(o)for(var r in t.Attributes){var a=t.Attributes[r];r.startsWith("On")&&a&&("function"==typeof o[a]?t.Attributes[r]=$createDelegate(o,o[a]):(console.log("resolveGspx的eventTarget参数对象没有提供"+a+"的事件"),delete t.Attributes[r]))}var l=$createControl("Craba.UI."+t.Name,t.Attributes,i,e);e||s.push(l),t.Childs&&this.resolveGspx(t.Childs,l,i,s,o)}else $common.showTips("前端动态解析gspx内容格式不正确，请检查")},this),s},_checkTabFrozen:function(t){var e=$userCache.get($craba.frozenTabCacheName);e||(e=[]);for(var i=!1,s=0,o=e.length;s<o;s++){if(e[s].url==t){i=!0;break}}return i},getDecimalDigits:function(t){if(!t)return 0;var e=t.toString(),i=e.indexOf(".");return i<0?0:e.substr(i+1).length},cloneStyle:function(t,e,i){t&&e&&Array.forEach(i,function(i){e.style[i]=t.style[i],t.style.removeProperty(i)})},replaceEmoji:function(t){return t?t.replace($craba.regEmoji,""):t},findInTab:function(t){if(!t||!t.get_form)return null;var e=t.get_form();if(!e||!e._hasPageControl||!t.get_parent)return null;for(var i=t.get_parent();i&&!Sys.UI.Controls.TabPage.isInstanceOfType(i);){if(!i.get_parent)return null;i=i.get_parent()}return i},activeTab:function(t){if(t){var e=t.get_form();if(!e.get_isDisposed()){var i=e.get_focusedControl();if(i){var s=$Dom.getLocation(i.get_element());if(!(s.x>0&&s.y>0)){var o=$craba.findInTab(i);o?o.get_pageControl().set_selectedTab(o):i.focusNextControl&&(i.focusNextControl(),asyncCall(function(){$craba.activeTab(e.get_focusedControl())}))}}}}},bindControl:function(t,e){var i=t._dataField;if(i){var s=t.get_form().get_dataController(),o=e?e[i]:s.getText(i);t.set_text(o),t.doDataBind()}},gspxToJson:function(t){var e=_Z_245(t);return this._xmlToJson(e)},_xmlToJson:function(t,e){for(var i={},s=t.childNodes,o=0;o<s.length;o++){var n=s[o],r=n.attributes;if(r){var a={Name:n.tagName,Attributes:{},Childs:[]};"Style"==n.tagName&&(a.Value=n.innerHTML||n.textContent);for(var l=0;l<r.length;l++){var h=r[l];a.Attributes[h.name]=h.value}var d=this._xmlToJson(n,a.Childs);0==Object.keys(d).length&&delete a.Childs,e&&e.push(a),i=a}}return i},_changeDataToList:function(t,e){if(!t||!t.dataType||1!=t.dataType)return t;var i=t.fields,s=i.length,o=e._columnsParams;if(o&&i.length>0){for(var n=o.length,r=0;r<n;r++){(d=(h=o[r].properties).dataField)&&Array.indexOf(i,d)<0&&(h.dataField=d.toLowerCase())}var a=t.fieldSizes;if(a){for(var l={},r=0;r<s;r++)l[i[r]]=a[r];for(r=0;r<n;r++){var h=o[r].properties,d=h.dataField;if(d){var _=l[d];_>0&&(h.dataSize=_)}}}}for(var c=t.rows,u=c.length,p=new Array(u),r=0;r<u;r++){for(var g=c[r],m={},f=0;f<s;f++)m[i[f]]=g[f];p[r]=m}return p},getHashCode:function(t){for(var e=0,i=t.length,s=0;s<i;s++)(e=31*e+t.charCodeAt(s))>2147483647&&(e%=2147483648);return e.toString()},getImage:function(t,e,i){if(!t)return"";var s="",o="";return e&&(s="width='"+e+"'"),i&&(o=" height='"+i+"'"),"<image "+s+o+' src="'+t+'" />'},shortcutToString:function(t){for(var e=["Ctrl","Shift","Alt"],i=0;i<e.length;i++){var s=e[i];rex=new RegExp(s,"i"),t=t.replace(rex,s+"+")}return t},findControl:function(t,e){var i=e[t];if(i)return i;if(t.indexOf(".")<1)return null;var s=t.split("."),o=s.shift(),n=e[o];if(!n)if("parent"==o)n=e.get_action().get_parent().get_form();else if("root"==o)n=e.get_action().get_root().get_form();else{var r=e.get_action().get_parent();if(!r)return null;n=r.get_form()}return n?this.findControl(s.join("."),n):null},getPropValue:function(t,e){var i=e.indexOf(".");if(i>0){var s=e.substring(0,i);return e=e.substr(i+1),void 0!==(t=t[s])?t?this.getPropValue(t,e):null:undefined}return t[e]},getLang:function(t,e){var i=null;if(e.indexOf(".")>-1){var s=e.split("."),o=s[0];i=Object.clone(t[o]);for(var n=1,r=s.length;n<r&&(o=s[n],i);n++)i=i[o]}else i=t[e];return i},getForm:function(t){for(;t;){if(t.control&&Sys.UI.CustomForm.isInstanceOfType(t.control))return t.control;t=t.parentNode}return null},_getItemValue:function(t,e){var i=t.get_items(!0)[e];return"object"==typeof i&&t._dataValueField?i[t._dataValueField]:i},_getItemText:function(t,e){var i=t.get_items(!0)[e];return"object"==typeof i?i[t._dataTextField]:i},_getItemImg:function(t,e){var i=t.get_items(!0)[e];return"object"==typeof i?i[t._imgField]:""},_getItemSelected:function(t,e){var i=t.get_items(!0)[e];return!("object"!=typeof i||!t._selectedField)&&i[t._selectedField]},_getItemIcon:function(t,e){var i=t.get_items(!0)[e];return"object"==typeof i&&t._iconField?i[t._iconField]:""},_getItemCssClass:function(t,e){var i=t.get_items(!0)[e];return"object"==typeof i&&t._cssClassField?i[t._cssClassField]:""},_pushControlTag:function(t,e){if(t.get_tag&&t.get_dataField){var i=t.get_tag();if(!i)return;var s=t.get_dataField();if(!s)return;e.push({dataField:s,tag:i})}},_initMinMaxDateValue:function(t){var e=t._minValue,i=t._maxValue;if(e&&(t._minValue=$common.toMinDate(e)),i){var s=new Date;s.setHours(23,59,59);var o=parseInt(i);o<0?(s.setDate(1),s.setMonth(s.getMonth()-o),s.setDate(0),t._maxValue=s):o<400?0!==o&&s.setDate(s.getDate()+o):s="string"==typeof i?Date.strToDate(i):i,t._maxValue=s}},_checkDateValue:function(t,e){return t._minValue&&t._maxValue?e-t._minValue>=0&&t._maxValue-e>=0:t._minValue?e-t._minValue>=0:!t._maxValue||t._maxValue-e>=0},getItemIndexByValue:function(t,e,i,s){if(!t||null==i)return-1;for(var o=function(t){if(e)return s?t[e]===i:t[e]==i;for(var o in i)return s?t[o]===i[o]:t[o]==i[o];return!1},n=0,r=t.length;n<r;n++){if(o(t[n]))return n}return-1},getItemIndexByText:function(t,e,i,s){if(!t||null==i)return-1;for(var o=function(t){if(e)return s?t[e]===i:t[e]==i},n=0,r=t.length;n<r;n++){if(o(t[n]))return n}return-1},getItemTextByValue:function(t,e,i,s){var o=$craba.getItemIndexByValue(t,e,s);return o>=0?t[o][i]:""},isIconfont:function(t){return t&&t.indexOf("icon-")>-1},createIcon:function(t,e,i){var s;return e&&(s=e.firstChild),!t||s&&"IMG"==s.tagName||(s=$common.createImg(),e&&e.appendChild(s)),i&&t&&(t=t.indexOf("R.axd")>-1?t:$common.getResourceUrl(t,i)),s&&(s.src=t||__skinBaseURI+"ui/icons/blank.gif"),s},makeHost:function(t,e){return e.startsWith("http")?e:t&&t._corsHost?t._corsHost+e:e},_checkFastClick:function(t){if(t._clickTag)return!1;t._clickTag=!0;return setTimeout(function(){t._clickTag=!1},300),!0},checkControlInPopup:function(t,e){if(t.__inPopup===undefined&&t.get_element){for(var i=e.get_element(),s=t.get_element();s&&s!=i;)(s=s.parentNode)&&s.control&&(Sys.UI.Controls.Popup.isInstanceOfType(s.control)||Sys.UI.Controls.PopupBlock.isInstanceOfType(s.control))&&(t.__inPopup=!0);!0!==t.__inPopup&&(t.__inPopup=!1)}},raiseMouseDown:function(t){Sys.UI.Controls.Menu&&(this._checkHideOtherBar(),this._checkHideOtherPopup())},hideDropPopup:function(){return!!$common._lastDropDownEdit&&($common._lastDropDownEdit.closeUp(!0),$common._lastDropDownEdit=null,!0)},hidePopupMenu:function(t){var e=window.__lastMenu;return window.__lastMenu=t,!(!e||e==t||!e.get_element())&&(e.hide(!0),!0)},moveDropPopup:function(){var t=$common._lastDropDownEdit;t&&t.doInitPopup&&this.asyncFun(this,function(){t.doInitPopup(!0)})},_checkHideOtherPopup:function(t){this.hidePopupMenu(t),this.hideDropPopup()},_checkHideOtherBar:function(t){var e=window.__lastMenuBar;e&&e!=t&&this._checkHideOtherPopup(null),window.__lastMenuBar=t},asyncFun:function(t,e,i,s){s||(s="timer"),t[s]&&clearTimeout(t[s]),t[s]=setTimeout(e,i||50)},checkConfig:function(t,e,i){if("function"!=typeof window.SaveConfigData)return!$settings.CrabaServer&&(console.log("纯客户端框架，产品必须自己实现配置的存和取功能。参考文档：http://crabadoc.mygjp.com/Default.gspx#Pages/Content.gspx?id=825"),!0);var s={kind:t,id:e,data:i};return window.SaveConfigData(s),window.userConfigData||(window.userConfigData={}),window.userConfigData[e]=i,!0},_hideOverlay:function(t){t._overlay&&$Dom.setVisible(t._overlay,!1)},_showOverlay:function(t,e,i){var s=t._overlay;if(!s){s=t._overlay=$common.createClassDiv("DisabledOverlay"),e.appendChild(s);var o=$Dom._getCurrentStyle(e);"relative"!==o.position&&"absolute"!=o.position&&"fixed"!=o.position&&(e.style.position="relative")}$Dom.setVisible(s,!0);var n=t.get_form().get_zIndex()+1;$common.renderOverlay(s,n,i)},_initEnabledlay:function(t){t._enabled?this._hideOverlay(t):(this._showOverlay(t,t._getOverlayDom(!0),20),this._initOverlaySize(t),t.get_element().removeAttribute("disabled"))},_initOverlaySize:function(t){t._overlay&&($common.setWidth(t._overlay,t.get_element().clientWidth),$common.setHeight(t._overlay,t._getOverlayDom(!0).scrollHeight))}},$craba=new Sys.UI.CrabaTool,_Z_62=function(){},_Z_62.prototype={joinCssClass:function(){for(var t="",e=0,i=arguments.length;e<i;e++){var s=arguments[e];s&&(t.length>0&&(t+=" "),t+=s)}return t},getBlankImageSrc:function(){return __skinBaseURI+"ui/icons/blank.gif"},loadCss:function(t,e,i,s,o){e===undefined&&(e="style");var n=t;"string"==typeof t&&(n=t.split(","));var r=-1,a=function(l){if(0!=n.length||l){if(r++,!l)return a(n.shift());l=l.trim();var h=e+"_index"+r;if(!$settings.CrabaServer)return $skin._checkStyle(h,l)?a(n.shift()):void $common.ajax({url:l,type:"GET",async:!o,complete:function(t){if(!t.get_responseAvailable())return a(n.shift());var e=t.get_statusCode();if(e>=200&&e<300){var i=t.get_responseData();$skin._appendStyle(i,h,l)}else"function"==typeof s&&s(l);a(n.shift())}});$skin.linkCss(l,h,function(){a(n.shift())},s)}else"function"==typeof i&&i(t)};a(n.shift())},linkCss:function(t,e,i,s){for(var o=$$get("HEAD")[0],n=$$get("LINK",o),r=n.length-1;r>0;r--){var a=n[r];if(a.id==e||a.href==t)return void i(t)}var l=document.createElement("link");l.type="text/css",l.id=e,l.rel="stylesheet",l.href=t,o.appendChild(l),l.onload=l.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(l.onload=l.onreadystatechange=l.onerror=null,"function"==typeof i&&i(t))},l.onerror=function(){"function"==typeof s&&s(t),l.onload=l.onreadystatechange=l.onerror=null}},_checkStyle:function(t,e){for(var i=$$get("HEAD")[0],s=$$get("STYLE",i),o=s.length-1;o>-1;o--){var n=s[o];if(n.id==t||n.getAttribute("href")===e)return!0}return!1},appendStyle:function(t,e){this._checkStyle(e)||t&&this._appendStyle(t,e)},_appendStyle:function(t,e,i){var s=document.createElement("style");if(s.type="text/css",s.id=e,i){if(s.setAttribute("href",i),i.indexOf("R.axd")<0){var o=i.substr(0,i.lastIndexOf("/"));t=this._convertUrl(t,o)}}else $settings.CrabaServer&&t.indexOf("R.axd")<0&&(t=this._convertUrl(t,__webResourceURI));if(s.styleSheet)s.styleSheet.cssText=t;else{var n=document.createTextNode(t);s.appendChild(n)}$$get("HEAD")[0].appendChild(s)},_convertUrl:function(t,e){return t=t.replace(/url\((\")/g,"$&"+e+"/")},removeCss:function(t,e){t===undefined&&(t="style"),e===undefined&&(e=0),this.removeCssById(t+"_index"+e)},removeCssById:function(t){var e=$get(t);$removeNode(e)},toColor:function(t,e){if(!t)return"";if(/^(rgb|RGB)/.test(t)){for(var i=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),s="#",o=0;o<i.length;o++){var n=Number(i[o]).toString(16);"0"===n&&(n+=n),1==n.length&&(n="0"+n),s+=n}return 7!==s.length&&(s=t),e?s.toUpperCase():s}if(/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(t)){var r=t.replace(/#/,"").split("");if(6===r.length)return e?t.toUpperCase():t;if(3===r.length){for(var a="#",o=0;o<r.length;o+=1)a+=r[o]+r[o];return e?a.toUpperCase():a}}return e?t.toUpperCase():t},hexToRgb:function(t){if(!t)return null;t=t.toUpperCase();if(!/^\#?[0-9A-F]{6}$/.test(t))return null;for(var e=(t=t.replace("#","")).match(/../g),i=0;i<3;i++)e[i]=parseInt(e[i],16);return e},rgbToHex:function(t,e,i){var s=/^\d{1,3}$/;if(!s.test(t)||!s.test(e)||!s.test(i))return null;for(var o=[t.toString(16),e.toString(16),i.toString(16)],n=0;n<3;n++)1==o[n].length&&(o[n]="0"+o[n]);return"#"+o.join("")},getDarkColor:function(t,e){if(!t)return null;t=t.toUpperCase();if(!/^\#?[0-9A-F]{6}$/.test(t))return null;for(var i=this.hexToRgb(t),s=0;s<3;s++)i[s]=Math.floor(i[s]*(1-e));return this.rgbToHex(i[0],i[1],i[2])},getLightColor:function(t,e){if(!t)return null;t=t.toUpperCase();if(!/^\#?[0-9A-F]{6}$/.test(t))return null;for(var i=this.hexToRgb(t),s=0;s<3;s++)i[s]=Math.floor((255-i[s])*e+i[s]);return this.rgbToHex(i[0],i[1],i[2])},createColorItems:function(t,e){Array.forEach(e,function(e,i){e=e.toUpperCase();var s=$common.createClassDiv("ColorItem");s.title=e,s.setAttribute("color",e),s.style.backgroundColor=e,t.appendChild(s)})},_clearUserStyle:function(){for(var t=$$get("HEAD")[0],e=$$get("STYLE",t),i=e.length-1;i>-1;i--){var s=e[i];s.id&&!s.id.startsWith("skin_")||$removeNode(s)}},getElement:function(t,e){if("undefined"!=typeof __skinData){var i=__skinData[t];if(i)return i[e]}return null},saveUIConfig:function(t){if(this._configChange=!0,t&&(this._cacheData=t),!this._cacheData)return!1;this._saveUIData()},getItem:function(t,e){for(var i=this.getElement(t,"items"),s=0;s<i.length;s++){var o=i[s];if(o.dataField==e)return o}return null},resetUIConfig:function(t){this._defaultData&&this._cacheData&&(this._cacheData=null,this._configChange=!0,this._clearUserStyle(),this._saveUIData())},_saveUIData:function(){if(!$craba.checkConfig("form","globalSkin",t)&&(this._dataService||(this._dataService=Craba.Web.Script.DataServiceBase.create()),this._configChange)){this._configChange=!1;var t={};t.cssText=this.skinToCss(),this._dataService.SaveCustomConfig("globalSkin",t)}},skinToCss:function(){var t=this._cacheData;if(!t)return"";var e=this._defaultData,i="";for(var s in t){var o=t[s];for(var n in o){var r=o[n],a=e[s][n];if("string"==typeof r){if(r.toLowerCase()==a.toLowerCase())continue}else if("number"==typeof r&&r==a)continue;var l=this.getItem(s,n);l.pixe&&(r+=l.pixe),i+=l.className+"{"+l.name+":"+r+";",l.name2&&(i+=l.name2+":"+r+";"),i+="}"}}return i},showUIConfig:function(t){$common.checkAlert(!$settings.EnableGlobalUIConfig,"产品没有开启自定义皮肤功能");var e=new Sys.UI.Form($common.getMainForm());return e.showModal($common.getSysUIBaseURI()+"SkinConfig.gspx"),e}},$skin=new _Z_62;var $export=Sys.UI._Exporter=function(){};$export.findMasterField=function(t,e){for(var i=0,s=t.length;i<s;i++){var o=t[i];if(o.dataField==e)return o}return null},$export.initMasterFields=function(t,e,i,s,o,n){n||((n={}).isFooter=!1);var r=t.get_controls();if(!o&&s&&s.get_tab()){r=[];var a=s.get_tab().split(",");Array.forEach(a,function(e){var i=$common.getElementChildControls(t[e].get_element());Array.addRange(r,i)})}for(var l=[],h=null,d=0,_=r.length;d<_;d++){var c=r[d];if(c.customForm){var u=c.customForm;$export.initMasterFields(u,e,i,s,!0,n)}else if(n.isFooter||c!=e)if(o&&_Z_103.isInstanceOfType(c)&&c._onlyReport)h=c;else{var p=s&&s.get_isGetAll()||c.get_visible&&c.get_visible();if(c&&p&&c.get_dataField&&c.get_label&&c.get_reportField&&c.get_text){if(c.get_reportVisible&&!c.get_reportVisible())continue;var g=c.get_reportField(),m=c.get_dataField(),f=c.get_label();if(f&&(f=f.replace(/&nbsp;/g," ")),g&&(f=g),f&&!m&&(m=f),!m||!f)continue;x={};o?l.push(x):(x=$export.findMasterField(i,m))||(x={},Array.add(i,x)),x.section=c.get_reportSection(),x.dataField=m,x.name=f,x.value=c.get_reportText?c.get_reportText():c.get_text(),x.hasValue=!0,x.isFooter=n.isFooter}}else n.isFooter=!0}if(o){if(h&&!h._getMasterData(l))return;Array.addRange(i,l)}if(e&&!o){var C=e.get_columnExpands();if(C)for(var y=0,v=C.length;y<v;y++){var S=C[y],I=S.reportFields,D=S.captions;if(I&&!D)for(var d=0,_=I.length;d<_;d++){var g=I[d],w=D[d];if(g&&!w){g="_"+g;var x;(x=$export.findMasterField(i,g))||(x={},Array.add(i,x)),x.name=g,x.dataField=g,x.value=w,x.hidden=!0}}}}},$export.initColumnExpands=function(t,e){var i=t.get_columnExpands();if(i){for(var s=null,o=0,n=i.length;o<n;o++){var r=i[o],a=r?r.name:null;if(a){var l=t._findBand(a);if(l){var h=l.columns;if(h){for(var d=[],_=0,c=h.length;_<c;_++){var u=h[_],p={};p.caption=u.get_designCaption(),$export._initDetailField(u,p),Array.add(d,p)}s||(s={}),s[a]=d}}}}s&&(e.columnExpands=s)}},$export.normalizeReportField=function(t){return t.replace(/(#|@|`|\^|!|~|\*|\/|\\|\|)/g,"_")},$export.initDetailFields=function(t,e,i,s,o){for(var n=t.get_columnCount(),r={},a=0;a<n;a++){m=(g=t.getColumnByIndex(a)).get_dataField();if(g.get_visible()&&m){var l=g.get_dataSize();l>0&&(r[m]=l)}}for(var h={},d=e.length,a=0;a<d;a++){h[m=(f=e[a]).dataField]=f;var _=r[m];_>0&&(f.size=_)}if(t.get_showRowNo()&&t.get_reportRowNo()&&!h["行号"]){(f={}).name="行号",f.caption=t.get_rowNoColumnCaption(),f.dataField=f.name,f.size=0,f.columnWidth=t.get_rowNoColumnWidth(),f.headerAlign="center",f.textAlign="center",Array.insert(e,0,f)}for(var c=1,u=!1,p=o&&o.get_isGetAll(),a=0;a<n;a++){var g=t.getColumnByIndex(a),m=g.get_dataField();if(g.get_reportVisible(p)&&m){var f=h[m];f||(f={},Array.insert(e,c,f),c++);var C=$export.get_reportFieldName(g);f.name=$export.normalizeReportField(C);var y=g.get_reportCaption();if(s)if(f.name!=C){v={name:"_"+f.name,value:C,hidden:!0};Array.add(s,v)}else if(f.name!=y&&!g.get_groupName()&&g.get_bandIndex()<0){var v={name:"_"+f.name,value:y,hidden:!0};Array.add(s,v)}f.caption=y,f.dataField=m,f.size=g.get_dataSize();var S=g.get_width();t._dressGrid&&m&&m.startsWith(t._qtyExpandName)&&(u?S+=1:u=!0),f.columnWidth=S,f.mergeSameRow=g.get_mergeSameRow(),f.headerAlign=g.get_headerAlign(),f.textAlign=g.get_textAlign(),g.get_showImage()&&(f.dataType=_Z_44.image),i&&g.get_reportShowFooter()&&t.get_showPrintSummaryText()&&(f.footer=g.get_footer(!0)),g.get_isReportFooterField&&g.get_isReportFooterField()&&(f.isFooter=!0),$export._initDetailField(g,f),"Number"==f.columnType&&g.get_preFlagDataField()&&(f.dataField=g._reportField?g._reportField:m,f.summarySpliteChar=g.get_summarySpliteChar());var I=g.get_groupName();f.groupName=I||""}}},$export.get_reportFieldName=function(t){var e=t.get_reportCaption(),i=t.get_band();if(i){var s=i.caption;s&&(e=s+"_"+t.get_reportCaption())}return e},$export.get_reportField=function(t){var e=t.get_reportField(),i=t.get_band();if(i){var s=i.caption;s&&(e=s+"_"+t.get_caption())}return e},$export._initDetailField=function(t,e){var i=!1;t instanceof Sys.UI.Controls.PercentColumn?(e.columnType="Percent",i=!0):t instanceof Sys.UI.Controls.NumberColumn?(e.columnType="Number",i=!0):Sys.UI.Controls.DropDownColumn.isInstanceOfType(t)||Sys.UI.Controls.SwitchButtonColumn.isInstanceOfType(t)?(e.columnType="DropDown",e.itemData=t.get_itemData()):Sys.UI.Controls.DateTimeColumn.isInstanceOfType(t)?e.columnType="DateTime":Sys.UI.Controls.DateColumn.isInstanceOfType(t)?e.columnType="Date":Sys.UI.Controls.CheckBoxColumn.isInstanceOfType(t)?e.columnType="Boolean":Sys.UI.Controls.ExpandColumn.isInstanceOfType(t)?e.dataField=t.get_sortField():Sys.UI.Controls.ImageColumn.isInstanceOfType(t)?e.columnType="Image":Sys.UI.Controls.ImageDropDownColumn.isInstanceOfType(t)&&(e.columnType="DropImage",e.itemData=t.get_itemData()),i&&(e.decimalDigits=t.get_decimalDigits(),e.decimalScale=t.get_decimalScale(),e.formatNumber=t.get_formatNumber());var s=t.get_replaceText();e.replaceText=s||""},$export.getGridsData=function(t,e,i,s,o){for(var n=t.length,r=n>=2,a=0;a<n;a++){(y=t[a]).endEdit()}var l=[],h=1==n,d=null;if(!h){for(var _={},a=0,c=o.length;a<c;a++){var u=o[a];u.hidden&&(_[u.dataField]=!0)}d={};for(f=0;f<n;f++)for(var p=(y=t[f]).get_columnCount(),g=0;g<p;g++){if(w=(x=y.getColumnByIndex(g)).get_dataField()){var m=x.get_visible();!m&&_[w]?d[w]=!0:"undefined"==typeof d[w]?d[w]=m:d[w]=d[w]&&m}}}for(var f=0,C=0;f<n;f++){for(var y=t[f],v=y.get_recordCount(),p=y.get_columnCount(),a=0;a<v;a++,C++)if(!y.isEmptyRow(a)){for(var S={},g=0;g<p;g++){w=(x=y.getColumnByIndex(g)).get_dataField();if(x.get_reportVisible()&&w){var I=x.getCellText(a,!0);("boolean"==typeof I||Sys.UI.Controls.CheckBoxColumn.isInstanceOfType(x))&&(I=x.get_reportText(I)),S[w]=I}}var D=y.getRowData(a);for(var w in D)"undefined"==typeof S[w]&&(h||d[w]||"undefined"==typeof d[w])&&(S[w]=D[w]);if(e){e(s,B=new $export.InitDetailDataEventArgs(y,S)),S=B.get_data()}i&&(S.__grid=y.get_idPart()),l.push(S),y._breakGroupDatas(l,S)}if(r&&y.get_showFooter()&&y.get_showPrintSummaryText()){for(var S={},a=0;a<p;a++){var x=y.getColumnByIndex(a),w=x.get_dataField();x.get_reportVisible()&&w&&(S[w]=x.get_footer())}l.push(S)}}if(i){var B=new $export.InitDetailListEventArgs(y,l,o);i(s,B),l=B.get_list()}var b={};return b.itemCount=l.length,b.itemList=l,b},$export.InitDetailDataEventArgs=function(t,e){$export.InitDetailDataEventArgs.initializeBase(this),this._grid=t,this._data=e},$export.InitDetailDataEventArgs.prototype={get_grid:function(){return this._grid},set_grid:function(t){this._grid=t},get_data:function(){return this._data},set_data:function(t){this._data=t}},$export.InitDetailDataEventArgs.registerClass("$export.InitDetailDataEventArgs",Sys.EventArgs),$export.InitDetailListEventArgs=function(t,e,i){$export.InitDetailListEventArgs.initializeBase(this),this._grid=t,this._list=e,this._detailFields=i},$export.InitDetailListEventArgs.prototype={get_list:function(){return this._list},set_list:function(t){this._list=t},get_grid:function(){return this._grid},set_grid:function(t){this._grid=t},get_detailFields:function(){return this._detailFields},clearDetailFields:function(){Array.clear(this._detailFields)},removeDetailField:function(t){for(var e=this._detailFields,i=0,s=e.length;i<s;i++){var o=e[i];if(o.name==t||o.dataField==t){Array.removeAt(e,i);break}}},addDetailField:function(t,e,i){var s={name:t,dataField:e};return i||(s.hidden=!0),Array.add(this._detailFields,s),s},insertDetailField:function(t,e,i,s){var o={name:e,dataField:i};return s||(o.hidden=!0),Array.insert(this._detailFields,t,o),o}},$export.InitDetailListEventArgs.registerClass("$export.InitDetailListEventArgs",Sys.EventArgs),Type.registerNamespace("Sys.UI.Controls"),Sys.UI.Controls.LayoutDirection=function(){throw Error.notImplemented()},Sys.UI.Controls.LayoutDirection.prototype={horz:0,vert:1},Sys.UI.Controls.LayoutDirection.registerEnum("Sys.UI.Controls.LayoutDirection"),Sys.UI.Controls.Container=function(t){Sys.UI.Controls.Container.initializeBase(this,[t]),this._requireFocus=!0,this._requireBlur=!0,this._enabled=!0,this._tabOnEnter=!0,this._tabIndex=0,this._reportVisible=!0},Sys.UI.Controls.Container.prototype={initialize:function(){Sys.UI.Controls.Container.callBaseMethod(this,"initialize");var t=this.get_element();this._requireMouseEnter&&$common.addMouseEnterHandler(t,this._onMouseEnter,this),this._requireMouseOver&&$common.addMouseOverHandler(t,this._onMouseOver,this),this._requireMouseOut&&$common.addMouseOutHandler(t,this._onMouseOut,this),this._requireMouseLeave&&$common.addMouseLeaveHandler(t,this._onMouseLeave,this),this._requireMouseDown&&this.add_mouseDown(this._onMouseDown,this),this._requireMouseUp&&this.add_mouseUp(this._onMouseUp,this),this._requireKeyDown&&this.add_keyDown(this.doKeyDown,this),this._requireKeyUp&&this.add_keyUp(this.doKeyUp,this),this._requireKeyPress&&this.add_keyPress(this.doKeyPress,this),this._requireFocus&&$common.addFocusHandler(t,this.doFocus,this),this._requireBlur&&$common.addBlurHandler(t,this.doBlur,this),this._requireClick&&$common.addClickHandler(t,this._onClick,this),this._requireDblClick&&$common.addDblClickHandler(t,this._onDblClick,this)},dispose:function(){this._removeLabelClick(),Sys.UI.Controls.Container.callBaseMethod(this,"dispose")},_removeLabelClick:function(){if(this._labelClickHandler){var t=this.get_labelElement();t&&($common.removeClickHandler(t,this._labelClickHandler),this._labelClickHandler=null)}},get_isDataBinding:function(){return this._dataBinding},get_accessKey:function(){return this._accessKey},set_accessKey:function(t){this._accessKey=t},get_enabled:function(){return this._enabled},set_enabled:function(t){$common.beginEnabled||(this._defaultEnabled=t),this._enabled!=t&&(this._enabled=t,this.get_isInitialized()?($Dom.setEnabled(this.get_element(),t),this.doSetEnabled(t),this.raisePropertyChanged("enabled")):t||this.addCssClass("disabled"))},doSetEnabled:function(t){},get_hint:function(){return this.get_element().title},set_hint:function(t){this._hint=t,this.get_element().title=t,this.get_element()._title=t},get_textColor:function(){return this.get_element().style.color},set_textColor:function(t){this.get_element().style.color=t,this._textColor=t},get_tabOnEnter:function(){return this._tabOnEnter},set_tabOnEnter:function(t){this._tabOnEnter=t},get_tabIndex:function(){return this._tabIndex},set_tabIndex:function(t){this._tabIndex=t,this.get_element().tabIndex=t},get_reportField:function(){return this._reportField},set_reportField:function(t){this._reportField=t},get_reportSection:function(){return this._reportSection},set_reportSection:function(t){this._reportSection=t},get_reportVisible:function(){return this._reportVisible},set_reportVisible:function(t){this._reportVisible=t,this._reportVisibleSet=!0},set_visible:function(t,e){var i=this.get_outerElement();i&&(this._setControlAndLabelVisible(i,t,e),Sys.UI.Controls.Container.callBaseMethod(this,"set_visible",[t,e]))},canTabOnEnter:function(){return this.get_tabOnEnter()},canFocus:function(){return this._tabIndex>=0},focus:function(t){var e=this.get_element();if(this._getCanFocus(e))try{e.focus(),void 0===t&&(t=!0),t&&e.select?e.select():0==t&&asyncCall(function(){var t=e.value?e.value.length:0;$common.setCaretPosition(e,t)}),this._notifyFormFocusControl(this)}catch(i){}},asyncFocus:function(t){var e=this;setTimeout(function(){e.get_isDisposed()||e.focus()},t||50)},_getCanFocus:function(t){return t&&t.parentNode&&$Dom.getVisible(t)},blur:function(){var t=this.get_element();this._getCanFocus(t)&&(t.blur(),Sys.Browser.isIE&&this._blurHandler&&this._blurHandler(this))},add_mouseOver:function(t,e){return $common.addMouseOverHandler(this.get_element(),t,e)},remove_mouseOver:function(t){$common.removeMouseOverHandler(this.get_element(),t)},add_mouseOut:function(t,e){return $common.addMouseOutHandler(this.get_element(),t,e)},remove_mouseOut:function(t){$common.removeMouseOutHandler(this.get_element(),t)},add_mouseDown:function(t,e){return $common.addMouseDownHandler(this.get_element(),t,e)},remove_mouseDown:function(t){$common.removeMouseDownHandler(this.get_element(),t)},add_mouseUp:function(t,e){return $common.addMouseUpHandler(this.get_element(),t,e)},remove_mouseUp:function(t){$common.removeMouseUpHandler(this.get_element(),t)},add_click:function(t,e){return this.get_events().addHandler("_click",t,e)},remove_click:function(t){this.get_events().removeHandler("_click",t)},add_keyDown:function(t,e){return $common.addKeyDownHandler(this.get_element(),t,e)},remove_keyDown:function(t){$common.removeKeyDownHandler(this.get_element(),t)},add_keyUp:function(t,e){return $common.addKeyUpHandler(this.get_element(),t,e)},remove_keyUp:function(t){$common.removeKeyUpHandler(this.get_element(),t)},add_keyPress:function(t,e){return $common.addKeyPressHandler(this.get_element(),t,e)},remove_keyPress:function(t){$common.removeKeyPressHandler(this.get_element(),t)},add_focus:function(t,e){return this.get_events().addHandler("_focus",t,e)},remove_focus:function(t){this.get_events().removeHandler("_focus",t)},add_blur:function(t,e){return this.get_events().addHandler("_blur",t,e)},remove_blur:function(t){this.get_events().removeHandler("_blur",t)},add_dblClick:function(t,e){return this._requireDblClick=!0,this.get_events().addHandler("_dblClick",t,e)},remove_dblClick:function(t){this.get_events().removeHandler("_dblClick",t)},add_selectStart:function(t,e){return $common.addSelectStartHandler(this.get_element(),t,e)},remove_selectStart:function(t){$common.removeSelectStartHandler(this.get_element(),t)},add_contextMenu:function(t,e){return $common.addContextMenuHandler(this.get_element(),t,e)},remove_contextMenu:function(t){$common.removeContextMenuHandler(this.get_element(),t)},add_labelClick:function(t,e){return this._hasLabelBindClick=!0,this._bindLabelClick(),this.get_events().addHandler("_labelClick",t,e)},remove_labelClick:function(t){this._labelClickHandler=null,this._hasLabelBindClick=!1,this.get_events().removeHandler("_labelClick",t)},_bindLabelClick:function(){if(!this._hasLabelBindClick||this._labelClickHandler)return!1;var t=this.get_labelElement();return!!t&&($Dom.addCssClass(t,"LinkLabel"),this._labelClickHandler=$common.addClickHandler(t,this._onLabelClick,this),!0)},_onLabelClick:function(t){var e=this.get_events().getHandler("_labelClick");e&&e(this),t.cancel()},_onMouseOver:function(t){this.get_enabled()&&this.doMouseOver(t)},_onMouseEnter:function(t){this.get_enabled()&&this.doMouseEnter(t)},_onMouseOut:function(t){this.get_enabled()&&this.doMouseOut(t)},_onMouseLeave:function(t){this.get_enabled()&&this.doMouseLeave(t)},doMouseOver:function(t){},doMouseOut:function(t){},doMouseEnter:function(t){},doMouseLeave:function(t){},doMouseDown:function(t){},doMouseUp:function(t){},_onMouseDown:function(t){this.get_enabled()&&this.doMouseDown(t)},_onMouseUp:function(t){this.get_enabled()&&this.doMouseUp(t)},_onClick:function(t){this.get_enabled()&&this.get_visible()&&this._checkDoClick(t)},_onDblClick:function(t){this.get_enabled()&&this.doDblClick(t)},click:function(t){this.get_enabled()&&(this._thenClick=!0,this._checkDoClick(t))},_checkDoClick:function(t){this._isActiveForm()&&this.doClick(t)},_isActiveForm:function(){if(this.get_id()){var t=this.get_form();if(!$app.IsPopup&&!$app.PopupGrid&&(!t||!t.get_isActive()||t.get_isLoading()))return!1}return!0},doClick:function(t){if(!this.get_isDisposed()){var e=this.get_events().getHandler("_click");if(e)if(Sys.Browser.isIE)e(this,t);else try{e(this,t)}catch(t){asyncCall(function(){throw window._lastError=t,t})}}},doKeyDown:function(t){t.keyCode==Sys.UI.Key.enter&&this._isActiveForm()&&this.doEnterPress(t)},tabOnEnter:function(){this.canTabOnEnter()&&this.focusNextControl()},add_enterPress:function(t){this.get_events().addHandler("enterPress",t)},remove_enterPress:function(t){this.get_events().removeHandler("enterPress",t)},doEnterPress:function(t){var e=this.raiseEnterPress(t);this.get_form(!0)?(this.canTabOnEnter()&&(this.focusNextControl(),e=!0),e&&t.cancel()):t.cancel()},raiseEnterPress:function(t){var e=this.get_events().getHandler("enterPress");return!!e&&(e(this,t),!0)},doKeyUp:function(t){},doKeyPress:function(t){},_notifyFormFocusControl:function(t){if(this.get_id()){var e=this.get_form();e&&e.set_focusedControl(t)}},doFocus:function(t){this.get_isInitialized()&&this._notifyFormFocusControl(this);var e=this.get_events().getHandler("_focus");e&&e(this,t)},doBlur:function(t){this._notifyFormFocusControl(null);var e=this.get_events().getHandler("_blur");e&&e(this,t)},doDblClick:function(t){var e=this.get_events().getHandler("_dblClick");e&&e(this,t)}},Sys.UI.Controls.Container.registerClass("Sys.UI.Controls.Container",Sys.UI.Control),_Z_249=function(t){_Z_249.initializeBase(this,[t]),this._requireFocus=!1,this._requireBlur=!1},_Z_249.prototype={canFocus:function(){return!1},get_outerElement:function(){return this._element}},_Z_249.registerClass("_Z_249",Sys.UI.Controls.Container),Sys.UI.Controls.Label=function(t){Sys.UI.Controls.Label.initializeBase(this,[t]),this._requireClick=!0,this._requireDblClick=!0,this._dataField=null,this._isMemo=!1,this._text=null,this._replaceText=null},Sys.UI.Controls.Label.prototype={updated:function(){var t=this.get_langText();null!==t&&(this._labelLang?this.set_label(t):this._element.innerText=t)},doPageLoaded:function(){this._refreshEditHint()},set_labelLang:function(t){this._labelLang=t},get_labelLang:function(){return this._labelLang},get_outerElement:function(){return this._element._oldDisplayMode="inline-block",this._element},get_text:function(){var t=this._text;return t||this.get_element().innerText},get_html:function(){return this.get_element().innerHTML},set_text:function(t){var e=t;if(this._replaceText&&(e=this._replaceText),this._replaceText!=t&&(this._text=t),this.get_isInitialized()){var i="";this._isMemo?e&&(i=e.indexOf("</")>0?e:$common.textToHtml(e)):i=null!=e?e.toString().replace(/\s/g,"&nbsp;"):"",this.get_element().innerHTML=i,this._refreshEditHint()}},_refreshEditHint:function(){if($dom.hasClass(this.get_element(),"ellipsis")){var t=this;asyncCall(function(){t.get_isDisposed()||$common._doEditHint(t.get_element(),t._hint)})}},set_replaceText:function(t){this._replaceText=t,this.get_isInitialized()&&this.set_text(t)},get_replaceText:function(){return this._replaceText},get_isMemo:function(){return this._isMemo},set_isMemo:function(t){this._isMemo=t},get_dataField:function(){return this._dataField},set_dataField:function(t){this._dataField=t},dataBind:function(t){$craba.bindControl(this,t)},doSaveData:function(){var t=this._dataField;if(t){t.indexOf(".")>-1&&(t=(t=t.split("."))[t.length-1]);this.get_form().get_dataController().setValue(t,this.get_text())}}},Sys.UI.Controls.Label.registerClass("Sys.UI.Controls.Label",_Z_249),Sys.UI.Controls.Image=function(t){Sys.UI.Controls.Image.initializeBase(this,[t]),this._requireClick=!0,this._requireDblClick=!0,this._src=null},Sys.UI.Controls.Image.prototype={get_src:function(){return this._src},set_src:function(t){this._src=t,this.get_isInitialized()&&(t?((t=t.trim()).startsWith("data:image/")||t.startsWith("blob:")||t.toLowerCase().startsWith("http")||(t=this.get_form().convertUrl(t)),this.get_element().src=t):this.get_element().src=$skin.getBlankImageSrc())},set_text:function(t){this.set_src(t)},get_url:function(){return this._url},set_url:function(t){this._url=t,this.set_src($common.getResourceUrl(t,this))},get_dataField:function(){return this._dataField},set_dataField:function(t){this._dataField=t},dataBind:function(t){$craba.bindControl(this,t)}},Sys.UI.Controls.Image.registerClass("Sys.UI.Controls.Image",_Z_249),_Z_23=function(t,e,i){var s=this._createElement(t,e);_Z_23.initializeBase(this,[i?t:s]),this._requireClick=!0,this._requireMouseDown=!0,this._requireMouseUp=!0},_Z_23.prototype={_createElement:function(t,e){var i=$common.createClassDiv("SkinButton "+e);return t?t.appendChild(i):(i.style.zIndex=$app.getActiveFormZIndex(),document.body.appendChild(i),this._removeElement=i),i},dispose:function(){this._removeElement&&($removeNode(this._removeElement),this._removeElement=null),_Z_23.callBaseMethod(this,"dispose")}},_Z_23.registerClass("_Z_23",Sys.UI.Controls.Container),_Z_63=function(t,e){this._control=t,this.__form=t.__form,this._initOuterBlock(t),_Z_63.initializeBase(this,[t._buttonDiv,e])},_Z_63.prototype={_initOuterBlock:function(t){if(!t._buttonDiv){var e,i=t.get_element();$Dom.hasClass(i,"FlexAuto")&&(e="FlexAuto");var s=$craba.editorButtonWidth,o=i.offsetWidth,n=i.offsetHeight;if(0==o){var r=$Dom._getCurrentStyle(i);o=parseInt(r.width),n=parseInt(r.height)+2*parseInt(r.paddingTop)+2*parseInt(r.borderTopWidth)}var a=n-2*(t.get_isInPlace()?0:1);if(!e){var l=o-s;l<0&&(l=0),i.style.width=l+"px"}var h=$common.createClassDiv($skin.joinCssClass("EditBlock",e,t._outerCssClass));return"none"==i.style.display&&$Dom.setVisible(h,!1),i.parentNode.insertBefore(h,i),h.appendChild(i),h._control=t,t._buttonHeight=a,t._buttonDiv=h,i._outerElement=h,h}},dispose:function(){this._control=null,_Z_63.callBaseMethod(this,"dispose")},get_control:function(){return this._control},get_owner:function(){return this._control},get_enabled:function(){return this.get_control().get_enabled()}},_Z_63.registerClass("_Z_63",_Z_23),_Z_64=function(t){_Z_64.initializeBase(this,[t]),this._requireMouseEnter=!0,this._requireMouseLeave=!0,this._requireMouseDown=!0,this._requireMouseUp=!0,this._requireClick=!0,this._flat=!1},_Z_64.prototype={get_flat:function(){return this._flat},set_flat:function(t){this._flat=t,1==t&&(this._tabOnEnter=!0)},canFocus:function(){return(!this._flat||!this._tabOnEnter)&&_Z_64.callBaseMethod(this,"canFocus")},doMouseEnter:function(t){this._initActive(!1);var e=this.get_events().getHandler("mouseover");e&&e(t)},doMouseLeave:function(t){this._initNormal();var e=this.get_events().getHandler("mouseout");e&&e(t)},doMouseDown:function(){this.addCssClass("active")},doMouseUp:function(){this.removeCssClass("active")},_initNormal:function(){},_initActive:function(t){}},_Z_64.registerClass("_Z_64",Sys.UI.Controls.Container),Sys.UI.Controls.FlatButton=function(t){Sys.UI.Controls.FlatButton.initializeBase(this,[t]),this._tabOnEnter=!0},Sys.UI.Controls.FlatButton.registerClass("Sys.UI.Controls.FlatButton",_Z_64),Sys.UI.Controls.FlatButton.create=function(t,e){return $create(Sys.UI.Controls.FlatButton,null,t,{click:e})},_Z_107=function(){throw Error.notImplemented()},_Z_107.prototype={none:0,ok:1,cancel:2},_Z_107.registerEnum("_Z_107"),Sys.Net.WebRequest.invokeMethod=function(webMethodName,args,owner){if(!webMethodName)throw Error.argumentNull("调用服务方法必须指定 webMethod 属性");if(!owner)throw Error.argumentNull("owner");var service=owner.get_form().get_service();if(!service)throw Error.invalidOperation("找不到 "+owner.get_id()+" 的服务");var webMethod=eval("service."+webMethodName);if(!webMethod)throw Error.invalidOperation("Web方法 "+webMethodName+" 没有定义");return service.set_owner(owner),webMethod.apply(service,args)},Sys.UI.Controls.Buttons=function(t){Sys.UI.Controls.Buttons.initializeBase(this,[t]),this._requireClick=!0,this._selectedIndex=-1},Sys.UI.Controls.Buttons.prototype={initialize:function(){Sys.UI.Controls.Buttons.callBaseMethod(this,"initialize"),this._initButtons(),this._doActiveItem(),this._doActiveItems()},get_multiple:function(){return this._multiple},set_multiple:function(t){this._multiple=t},set_value:function(t,e){if(this._multiple){"string"==typeof t&&(t=t.split(",")),this._selectedIndexs=[],this._selectedIndex=-1;for(var i=0;i<t.length;i++){var s=$craba.getItemIndexByValue(this._items,this.get_dataValueField(),t[i],e);s>-1&&this._selectedIndexs.push(s)}this.get_isInitialized()&&this._doActiveItems()}else this._setValue(t,e)},_setValue:function(t,e){var i=$craba.getItemIndexByValue(this._items,this.get_dataValueField(),t,e);return this._selectedIndex=i,i>-1&&this.set_selectedIndex(i),i},get_value:function(){if(!this._multiple){var t=this.get_selectedItem();return t?t[this.get_dataValueField()]:null}return this._multiples(!0)},set_selectedIndex:function(t){this._selectedIndex=t,this.get_isInitialized()&&this._doActiveItem()},findRowData:function(t){return this._items[t]},findRowDataByValue:function(t){var e=$craba.getItemIndexByValue(this._items,this.get_dataValueField(),t,absoluteEqual);return this.findRowData(e)},findButtonByIndex:function(t){return this._element.childNodes[t]},findButtonByValue:function(t,e){var i=$craba.getItemIndexByValue(this._items,this.get_dataValueField(),t,e);return this.findButtonByIndex(i)},get_selectedIndex:function(){return this._selectedIndex},get_selectedItem:function(){return this._multiple?this._multiples():this._selectedIndex<0?null:this._items[this._selectedIndex]},set_mustOne:function(t){this._mustOne=!0},get_mustOne:function(){return this._mustOne},_multiples:function(t){for(var e=[],i=this._element.childNodes,s=0,o=i.length;s<o;s++){var n=i[s];if($Dom.hasClass(n,"active")){var r=this._items[s],a=t?r[this.get_dataValueField()]:r;e.push(a)}}return Object.clone(e)},get_selectedButton:function(){return this._prevBtn},get_itemCount:function(){return this._items.length},addItem:function(t){this._createButton(t),this._items.push(t)},insertItemByIndex:function(t,e){this._createButton(e,t),Array.insert(this._items,t,e)},insertItem:function(t,e){var i=this.getItemIndex(t);this.insertItemByIndex(i,e)},removeItemByIndex:function(t){if(!(t<0)){var e=this._element.childNodes[t];this._element.removeChild(e),Array.removeAt(this._items,t)}},removeItemByValue:function(t){var e=this.getItemIndex(t);this.removeItemByIndex(e)},setItemVisible:function(t,e){var i=this.getItemIndex(t);if(!(i<0)){var s=this._element.childNodes[i];$Dom.setVisible(s,e)}},getItemVisible:function(t){var e=this.getItemIndex(t);if(!(e<0)){var i=this._element.childNodes[e];return $Dom.getVisible(i)}},setItemEnabled:function(t,e){var i=this.getItemIndex(t);if(!(i<0)){var s=this._element.childNodes[i];$Dom.setEnabled(s,e)}},getItemEnabled:function(t){var e=this.getItemIndex(t);if(!(e<0)){var i=this._element.childNodes[e];return $Dom.getEnabled(i)}},getItemIndex:function(t){for(var e=0,i=this._items.length;e<i;e++){if(this._items[e][this._dataValueField]===t)return e}return-1},setItemText:function(t,e){var i=this.getItemIndex(t);if(!(i<0)){this._element.childNodes[i].innerHTML=e}},set_dataSource:function(t){this.set_items(t)},get_dataSource:function(){return this.get_items()},set_items:function(t){this._items=t,this.get_isInitialized()&&(this._selectedIndex=-1,this._prevBtn=null,this._element.innerHTML="",this._initButtons())},get_items:function(){return this._items},_doActiveItems:function(){if(this._selectedIndexs){for(var t=this._element.childNodes,e=0,i=t.length;e<i;e++)$Dom.removeCssClass(t[e],"active");for(var e=0,i=this._selectedIndexs.length;e<i;e++){var s=t[this._selectedIndexs[e]];s&&$Dom.addCssClass(s,"active")}}},_doActiveItem:function(t){if(!(this._prevBtn&&this._prevBtn==t&&this._mustOne||(this._prevBtn&&!this._multiple&&$Dom.removeCssClass(this._prevBtn,"active"),this._selectedIndex<0))){if(!t){var e=this._element.childNodes;if(this._selectedIndex>=e.length)return;t=e[this._selectedIndex]}if(this._prevBtn==t&&!this._multiple)return this._selectedIndex=-1,void(this._prevBtn=null);$Dom.toggleCssClass(t,"active"),this._prevBtn=t}},_initButtons:function(){for(var t=0,e=this._items.length;t<e;t++)this._createButton(this._items[t])},_createButton:function(t,e){var i=t[this._dataTextField],s=this._getFieldValue(t,this._dataCssField),o=this._getFieldValue(t,this._dataCssStyleField),n=this._getFieldValue(t,this._dataEnabledField),r=this._getFieldValue(t,this._dataVisibleField),a=this._getFieldValue(t,this._dataHintField),l=this._getFieldValue(t,this._dataHotKeyField);if(l){l=l.split(",");var h=this.get_form(),d=this;Array.forEach(l,function(t){var e=Craba.UI.Shortcut[t];e&&(a=(a||"")+" ("+$craba.shortcutToString(t)+")",h.addShortcut(e,d.doHotKey,d))})}var _=$common.createClassDiv($skin.joinCssClass("Button",s));o&&(_.style.cssText=o),_.innerHTML=i||"",a&&(_.title=a);var c=this._element;if(e!=undefined){var u=c.childNodes[e];u?c.insertBefore(_,u):c.appendChild(_)}else c.appendChild(_);!1===n&&$Dom.setEnabled(_,!1),!1===r&&$Dom.setVisible(_,!1)},_getFieldValue:function(t,e){return e?t[e]:""},get_dataValueField:function(){return this._dataValueField},set_dataValueField:function(t){this._dataValueField=t},get_dataTextField:function(){return this._dataTextField},set_dataTextField:function(t){this._dataTextField=t},get_dataCssField:function(){return this._dataCssField},set_dataCssField:function(t){this._dataCssField=t},get_dataCssStyleField:function(){return this._dataCssStyleField},set_dataCssStyleField:function(t){this._dataCssStyleField=t},get_dataClickField:function(){return this._dataClickField},set_dataClickField:function(t){this._dataClickField=t},get_dataEnabledField:function(){return this._dataEnabledField},set_dataEnabledField:function(t){this._dataEnabledField=t},get_dataVisibleField:function(){return this._dataVisibleField},set_dataVisibleField:function(t){this._dataVisibleField=t},set_dataHotKeyField:function(t){this._dataHotKeyField=t},get_dataHotKeyField:function(){return this._dataHotKeyField},get_dataHintField:function(){return this._dataHintField},set_dataHintField:function(t){this._dataHintField=t},doHotKey:function(t){for(var e=this.get_items(),i=0,s=e.length;i<s;i++){var o=e[i],n=this._getFieldValue(o,this._dataHotKeyField);if(n)for(var r=0,a=(n=n.split(",")).length;r<a;r++){var l=n[r],h=Craba.UI.Shortcut[l],d=_Z_220.shortcutToHotkey(h);if(_Z_220.matchHotkey(d,t))return t.target=this._element.childNodes[i],t.hotkey=l,this.doClick(t),t.over(),void t.cancel()}}},doClick:function(t){if(!this.get_isDisposed()){var e=t.target;if(e!==this._element&&"true"!==e.getAttribute("disabled")){var i=this._selectedIndex,s=this._selectedIndex=Array.indexOf(this._element.childNodes,e),o=this._items[s],n=new _Z_210(s,i,o,e,t);if(this._doActiveItem(e),this._dataClickField&&o[this._dataClickField]){var r=o[this._dataClickField],a=this.get_form().get_action(),l=a[r];if("function"!=typeof l)return void $common.alert(String.format("按钮的点击事件[{0}]没有实现",r));if(l.apply(a,[this,n]),n.get_cancel())return}var h=this.get_events().getHandler("_click");h&&h(this,n,t)}}}},Sys.UI.Controls.Buttons.registerClass("Sys.UI.Controls.Buttons",_Z_249),_Z_210=function(t,e,i,s,o){_Z_210.initializeBase(this),this._index=t,this._oldIndex=e,this._data=i,this._target=s,this._event=o},_Z_210.prototype={get_index:function(){return this._index},get_oldIndex:function(){return this._oldIndex},get_data:function(){return this._data},get_target:function(){return this._target},get_event:function(){return this._event}},_Z_210.registerClass("_Z_210",_Z_162),_Z_65=function(t){_Z_65.initializeBase(this,[t]),this._buttonKind=_Z_107.none,this._tabOnEnter=!1},_Z_65.prototype={get_text:function(){var t=this.get_element();if(!t)return null;var e=t.firstChild;return e?("#text"!=e.nodeName&&(e=$common.getNextSibling(e)),e.nodeValue):""},set_text:function(t){var e=this.get_element();if(e)if(e.firstChild){Object.isUndefinedOrNull(this._accessKey)||(t+="(");var i=e.firstChild;"#text"!=i.nodeName&&(i=$common.getNextSibling(i)),i.nodeValue=t}else e.nodeValue?e.nodeValue=t:e.innerHTML=t},createLabel:function(t,e,i){i.get_layoutDirection()!=Sys.UI.Controls.LayoutDirection.horz&&_Z_65.callBaseMethod(this,"createLabel",[t,e,i])},get_buttonKind:function(){return this._buttonKind},set_buttonKind:function(t){this._buttonKind=t},get_webMethod:function(){return this._webMethod},set_webMethod:function(t){this._webMethod=t},webCall:function(){Sys.Net.WebRequest.invokeMethod(this._webMethod,arguments,this)},doClick:function(t){t&&t.preventDefault(),$craba.hideDropPopup(),_Z_65.callBaseMethod(this,"doClick",[t]);i=this.__form&&this.get_form();if(i)switch(this._buttonKind){case _Z_107.ok:e=i.get_parentForm();i&&i.doOk?i.doOk():e&&e.doOk&&e.doOk();break;case _Z_107.cancel:var e=i.get_parentForm();if(i&&i.doCancel&&i._allLoaded)i.doCancel();else if(e&&e.doCancel&&e._allLoaded)e.doCancel();else if(window.top!=window){var i;(i=window.top.$app.getActiveForm())&&i.doCancel&&i._allLoaded&&i.doCancel()}}}},_Z_65.registerClass("_Z_65",_Z_64),Sys.UI.Controls.Button=function(t){Sys.UI.Controls.Button.initializeBase(this,[t]),this._cancel=!1,this._shortcut=0,this._rightIconVisible=!0,this._tabIndex=0},Sys.UI.Controls.Button.prototype={dispose:function(){this._rightBtn&&$clearHandlers(this._rightBtn),Sys.UI.Controls.Button.callBaseMethod(this,"dispose")},updated:function(){var t=this.get_langText();null!==t&&this.set_text(t)},get_popupMenu:function(){return this._popupMenu},set_popupMenu:function(t){this._popupMenu=t},get_cancel:function(){return this._cancel},set_cancel:function(t){this._cancel=t},get_shortcut:function(){return this._shortcut},set_shortcut:function(t){if(this._shortcut=t,this.get_isInitialized()&&"string"==typeof t){var e=Craba.UI.Common.lowerFirstChar(t),i=Craba.UI.Shortcut[e];if(i>0){this.get_form().addShortcut(i,this.focusThenClick,this)}}},set_icon:function(t){this._icon=t,this.get_isInitialized()&&this._refreshIcon()},get_icon:function(){return this._icon},set_rightIcon:function(t){this._rightIcon=t,this.get_isInitialized()&&this._refreshRightIcon()},get_rightIcon:function(){return this._rightIcon},set_hoverIcon:function(t){this._hoverIcon=t},get_hoverIcon:function(){return this._hoverIcon},doFormInit:function(t){var e=this.get_accessKey();e>0&&t.addHotkey({keyCode:e,altKey:!0},this.focusThenClick,this),this.get_cancel()&&t.addHotkey({keyCode:Sys.UI.Key.esc},this.focusThenClick,this);var i=this.get_shortcut();i>0&&t.addShortcut(i,this.focusThenClick,this),this._createIcon(),this._createRightButton()},focusThenClick:function(){this.focus(),Sys.Browser.isIE?setTimeout($createDelegate(this,this.click),0):this.click()},set_enabled:function(t){Sys.UI.Controls.Button.callBaseMethod(this,"set_enabled",[t]),$Dom.setAttribute(t,this._element,"tabindex",0)},get_outerElement:function(){return this._element},set_height:function(t){return t=Sys.UI.Controls.Button.callBaseMethod(this,"set_height",[t]),$common.setLineHeight(this._element,t),t},_refreshIcon:function(){this._iconName&&(this.removeCssClass(this._iconName),this._iconName=null),this._iconDom&&($removeNode(this._iconDom),this._iconDom=null),this._createIcon()},_createIcon:function(){if(this._icon)if($craba.isIconfont(this._icon))this._iconName=this._icon,this.addCssClass(this._icon);else{var t=this._iconDom=$craba.createIcon(this._icon,null,this),e=this._element.firstChild;this._element.insertBefore(t,e)}},_refreshRightIcon:function(){this._rightBtn&&(this._rightName&&($Dom.removeCssClass(this._rightBtn,this._rightName),this._rightName=null),this._rightIconDom&&($removeNode(this._rightIconDom),this._rightIconDom=null),this._createRightIcon(this._rightBtn,this._rightIcon))},_hasClick:function(){return this.get_events().hasEvent("_click")||this.get_events().hasEvent("rightIconClick")},_createRightButton:function(){if((this._popupMenu||this._reportAction||this._rightIcon||this._hasRightIconClick)&&!this._created){this._created=!0,this.addCssClass("hasRight"),this._rightIcon||(this._rightIcon="ArrowCombo aicon-moreunfold");var t=this._rightBtn=$common.createClassDiv("RightIcon");this._createRightIcon(t,this._rightIcon);var e=this.get_element();this.get_rightIconVisible()||$Dom.addCssClass(e,"HideRightIcon"),e.appendChild(t),$common.addClickHandler(t,this._doRightBtnClick,this)}},_createRightIcon:function(t,e){$craba.isIconfont(e)?(this._rightName=e,$Dom.addCssClass(t,e)):(t.innerHTML="&nbsp;",this._rightIconDom=$craba.createIcon(e,t,this))},doClick:function(t){if(this.get_rightIconVisible()&&!Sys.Browser.isChrome&&this._rightBtn&&t&&t.rawEvent.offsetX>this._rightBtn.offsetLeft-this._element.offsetLeft)return this._doRightBtnClick(t);$craba._checkFastClick(this)&&(!this._hasClick()&&this._popupMenu&&this._doRightBtnClick(t,!1),Sys.UI.Controls.Button.callBaseMethod(this,"doClick",[t]))},_doRightBtnClick:function(t,e){if(this.get_enabled()&&(t.stopPropagation(),$craba.raiseMouseDown(t),$craba._checkFastClick(this)||!1===e)){var i=this.get_events().getHandler("rightIconClick");if(i&&i(this,t),this._reportAction&&this._reportAction._initPrintMenu(this),this._popupMenu){var s=this._hasClick()?this._rightBtn:this.get_element(),o=$Dom.getBounds(s);$craba.lastMenu&&$craba.lastMenu.hide();var n=$craba.lastMenu=this.get_form()[this._popupMenu];if(!n)throw Error.abort(this._popupMenu+"不存在");n.popupAt(o.x,o.y+o.height,o.width,o.height);var r=this.get_outerElement();this._bindHide||(n.add_hide(function(){$Dom.removeCssClass(r,"ShowDrop")}),this._bindHide=!0),$Dom.addCssClass(r,"ShowDrop")}}},isPrintButton:function(){return $settings.UsePrintButton},set_reportAction:function(t){this._icon||this.addCssClass("aicon-dayin"),this.isPrintButton()&&(this._reportAction=t,this._createRightButton())},set_rightIconVisible:function(t){this._rightIconVisible=t,this._rightBtn&&$Dom.setCssClass(!t,this.get_element(),"HideRightIcon")},get_rightIconVisible:function(){return this._rightIconVisible},add_rightIconClick:function(t,e){this._hasRightIconClick=!0,this.get_events().addHandler("rightIconClick",t,e),this.get_isInitialized()&&this._createRightButton()},remove_rightIconClick:function(t){this.get_events().removeHandler("rightIconClick",t)}},Sys.UI.Controls.Button.registerClass("Sys.UI.Controls.Button",_Z_65),Sys.UI.Controls.PrintButton=function(t){Sys.UI.Controls.PrintButton.initializeBase(this,[t])},Sys.UI.Controls.PrintButton.prototype={isPrintButton:function(){return!0}},Sys.UI.Controls.PrintButton.registerClass("Sys.UI.Controls.PrintButton",Sys.UI.Controls.Button),Sys.UI.Controls.Hotkey=function(){Sys.UI.Controls.Hotkey.initializeBase(this),this._shortcut=0},Sys.UI.Controls.Hotkey.prototype={doFormInit:function(t){t.addShortcut(this.get_shortcut(),this._doExecute,this)},get_shortcut:function(){return this._shortcut},set_shortcut:function(t){this._shortcut=t},add_execute:function(t){this.get_events().addHandler("execute",t)},remove_execute:function(t){this.get_events().removeHandler("execute",t)},_doExecute:function(t){var e=this.get_form();if(e.get_enabled()&&e.get_isActive()){var i=this.get_events().getHandler("execute");i&&i(this,t)}}},Sys.UI.Controls.Hotkey.registerClass("Sys.UI.Controls.Hotkey",_Z_242),Sys.UI.Controls.ImageButton=function(t){Sys.UI.Controls.ImageButton.initializeBase(this,[t]),this._imageSrc=null,this._imageUrl=null,this._hoverImageUrl=null},Sys.UI.Controls.ImageButton.prototype={_initNormal:function(){this._hoverImageUrl&&this._setSrc(this._imageUrl)},_initActive:function(t){this._hoverImageUrl&&this._setSrc(this._hoverImageUrl)},_setSrc:function(t){this.get_element().src=t},get_imageSrc:function(){return this._imageSrc},set_imageSrc:function(t){this._imageSrc=t,this.get_isInitialized()&&this._setSrc(t)},get_imageUrl:function(){return this._imageUrl},set_imageUrl:function(t){this._imageUrl=t},get_hoverImageUrl:function(){return this._hoverImageUrl},set_hoverImageUrl:function(t){this._hoverImageUrl=t}},Sys.UI.Controls.ImageButton.registerClass("Sys.UI.Controls.ImageButton",_Z_65),_Z_59=function(){throw Error.notImplemented()},_Z_59.prototype={_default:0,string:1,number:2,_boolean:3,date:4},_Z_59.registerEnum("_Z_59"),_Z_233=function(t){_Z_233.initializeBase(this,[t]),this._requireMouseUp=!0,this._requireKeyUp=!0,this._requireKeyDown=!0,this._isInPlace=!1,this._disableChangeHandler=!1,this._requireInput=!1,this._changeHandler=null,this._buttons=[],this._caretPos=-1,this._dataField=null,this._nullDisplayText=null,this._valueType=_Z_59._default,this._maxLength=0,this._allowTags=$settings.EditAllowTags,this._filterChars=null,this._instantValidationEnabled=!1,this._focusText=!1,this._delayInterval=100},_Z_233.prototype={dispose:function(){if(this._buttons){for(var t=this._buttons.length-1;t>=0;t--)this._buttons[t].dispose();delete this._buttons}this._inputHandler=null,this._changeHandler=null,_Z_233.callBaseMethod(this,"dispose")},doFormLoaded:function(){this.initEditor(),this._showRequiredIcon(!0)},doPageLoaded:function(){this.refreshLabelTitle(),this._noVisible=0==this._element.offsetWidth},initEditor:function(){var t=this.get_element();this._requireInput&&(Sys.Browser.isIE||(this._inputHandler=$common.addHandler(t,"input",this.doInput,this))),"DIV"!=t.tagName&&(this._disableChangeHandler||(this._changeHandler=$common.addChangeHandler(t,this.doChange,this)),$common.addPasteHandler(t,this.doPaste,this),$common.addCutHandler(t,this._doCut,this)),this._buttonInit||(this._initButtons(),this._buttonInit=!0),this.get_enabled()||this.doSetEnabled(!1),this._handleNullDisplayText(),this._instantValidationEnabled=!0},set_visible:function(t){t&&$Dom.setVisible(this._element,!0,this._getFlex()),this._buttonInit||(this._initButtons(),this._buttonInit=!0),_Z_233.callBaseMethod(this,"set_visible",[t,""]),this._noVisible&&t&&(this.refreshLabelTitle(),delete this._noVisible)},_getFlex:function(){},get_outerElement:function(){var t=this.get_element();return t._outerElement||t},updated:function(){var t=this.get_langText();null!==t&&this.set_label(t)},get_isInPlace:function(){return this._isInPlace},set_isInPlace:function(t){this._isInPlace=t},get_requiredIcon:function(){return this._requiredIcon},set_requiredIcon:function(t){this._requiredIcon=t},get_owner:function(){return this.column?this.column.get_grid():null},get_column:function(){return this.column},selectAll:function(){this.selectText()},selectText:function(){var t=this.get_element();setTimeout(function(){try{t.select()}catch(e){}},0)},focusNext:function(){this.column?this.column.focusNextCell():this.tabOnEnter()},addButton:function(t){t.initialize(),this._buttons[this._buttons.length]=t},_initButtons:function(){},dataBind:function(t){var e=this._dataField;if(e){var i=this.get_form().get_dataController(),s=t?t[e]:i.getValue(e);this.set_value(s);var o=this._displayField;if(o){var n=t?t[o]:i.getText(o);this.set_text(n)}this.doDataBind()}},revalidate:function(){if(this.get_id()){var t=this.get_form().get_validationManager();if(t.checkResultsVisible(this)){var e=this.get_value();this._validate(e),t.showResults(!0)}}},doSaveData:function(t){var e=this._dataField;if(e){var i=this.get_form().get_dataController(),s=t,o=this.get_value(s),n=this._valueType;n!=_Z_59._default&&(o=this.convertType(o,n)),i.setValue(e,o),t||this._validate(o)}},convertType:function(t,e){return(e=this._valueType)!=_Z_59._default?this.doConvertType(t,e):t},doConvertType:function(t,e){return t},_validate:function(t){var e=this.get_form().get_validationManager(),i=this.get_requiredLabel();i||(i=this.get_label()),i||(i=this.get_reportField()),i||(i=this.get_tag()),!i&&this.get_nullDisplayText&&(i=this.get_nullDisplayText()),i&&(i=$common.deleteHTMLTag(i)),e.validate(this._dataField,t,i,null,this,null,this._labelChanged),this._labelChanged=!1},get_value:function(){return this.get_text()},set_value:function(t){this.set_text(null!=t?t:"")},get_editValue:function(){return this.get_value()},get_elementValue:function(){return this.get_element().value},set_elementValue:function(t){this.get_element().value=t},get_text:function(){var t=this.get_elementValue();if(t&&!this.column&&(t=t.trim()),this._instantValidationEnabled&&this._checkCharsValid(t),t){return t==this._nullDisplayText?"":(t=unescape(escape(t).replace("%u202D","").replace("%u202C","")),this.needEncodeTags()&&(t=(t=t.replace(/</g,"&lt;")).replace(/>/g,"&gt;")),t)}return""},set_text:function(t){t&&this.needEncodeTags()&&(t=t.toString(),t=$common.htmlDecode(t)),this.set_elementValue(t),this._initOldValue(!0),this._handleNullDisplayText(),this._showRequiredIcon()},get_valueType:function(){return this._valueType},set_valueType:function(t){this._valueType=t},get_readOnly:function(){return this.get_element().readOnly},set_readOnly:function(t){this.get_element().readOnly=t},get_dataField:function(){return this._dataField},set_dataField:function(t){this._dataField=t},get_nullDisplayText:function(){return this._nullDisplayText},set_nullDisplayText:function(t){this._nullDisplayText=t,this.get_isInitialized()&&this._handleNullDisplayText()},get_maxLength:function(){return this._maxLength},set_maxLength:function(t){t>0&&(this._maxLength=t,this.get_element().maxLength=t)},get_allowTags:function(){return this._allowTags},set_allowTags:function(t){this._allowTags=t},needEncodeTags:function(){return this._allowTags},needFilterChars:function(){return!1},add_change:function(t,e){this.get_events().addHandler("_change",t,e)},remove_change:function(t){this.get_events().removeHandler("_change",t)},doChange:function(t){if(!this.get_isDisposed()){this._changeRaised=!0;var e=this.get_events().getHandler("_change");if(e&&(e(this,t),this._changeRaised=!0),this.get_dataField()){var i=this.get_form(!0);i&&i.doChange()}this.revalidate(),this._showRequiredIcon()}},get_isTextEdit:function(){var t=this.get_element().type;return"text"==t||"password"==t||"textarea"==t},get_isButtonEdit:function(){return this._buttons.length>0},doFocus:function(t){this._handleActivate(!0),_Z_233.callBaseMethod(this,"doFocus",[t]),this._textChecked=!1;if(this._nullDisplayText){var e=this.get_value();(Object.isUndefinedOrNull(e)||""===e)&&(this.get_element().value=""),this.get_element().style.color=this._oldTextColor}this._changeNotified=!1;var i=this._instantValidationEnabled;this._instantValidationEnabled=!1;try{this._initOldValue(!1),this._searchText=this.get_text()}finally{this._instantValidationEnabled=i}this._focusText&&this.selectText()},_initOldValue:function(t){this._oldValue=this.get_value()},get_oldValue:function(){return this._oldValue},doBlur:function(t){this._handleActivate(!1),this._textChecked||this._nonInPlaceValidate(),this._checkRaiseChange(),this._handleNullDisplayText(),_Z_233.callBaseMethod(this,"doBlur",[t])},doInput:function(t){},doPropChange:function(t){t.rawEvent.propertyName.toLowerCase()},get_focusText:function(){return this._focusText},set_focusText:function(t){this._focusText=t},doSetEnabled:function(t){},_handleActivate:function(t){this.get_isTextEdit()&&this.get_isButtonEdit()&&$Dom.setCssClass(t,this.get_outerElement(),"active")},doInstantValidate:function(){this.userText=this._element.value,this.get_text()},_nonInPlaceValidate:function(){this.get_isInPlace()||this.doInstantValidate()},doEnterPress:function(t){this._nonInPlaceValidate(),_Z_233.callBaseMethod(this,"doEnterPress",[t])},notifyChanged:function(){this._changeNotified=!0},_checkRaiseChange:function(){if(this.get_isTextEdit()){var t=this.get_value();this._changeRaised||t==this._oldValue&&!this._changeNotified?this._oldValue=t:(this._changeNotified=!1,this.doChange()),this._changeRaised=!1}},doFormClose:function(){this._checkRaiseChange()},get_filterChars:function(){return this._filterChars||$settings.EditFilterChars},set_filterChars:function(t){this._filterChars=t},_checkCharsValid:function(t){if(!this._dataBinding&&this.needFilterChars()&&!this.get_readOnly()&&this.get_enabled()){this._textChecked=!0;var e=this.doValidateText(t),i=this.findForm();i&&(e?i.errorAbort(e,this):i.clearErrors(this))}},doValidateText:function(t){var e=this.get_filterChars();if(t&&e)for(var i=0,s=t.length;i<s;i++){var o=t.charAt(i);if(e.indexOf(o)>=0)return"输入的文字中含有本系统所不允许的非法字符“"+o+"”！\n请重新输入或换用别的字符代替。"}return null},_handleNullDisplayText:function(){this.get_element();this._nullDisplayText?this._showNullDisplayValue(this._nullDisplayText):this._removeNullText()},_showNullDisplayValue:function(t){var e=this.get_elementValue(),i=this.get_element();""===e||Object.isUndefinedOrNull(e)||e==t?(i.setAttribute("placeholder",t),Sys.Browser.isIE&&Sys.Browser.version<10&&(i.value=t,i.style.color="#bbb")):this._removeNullText()},_removeNullText:function(){var t=this.get_element();t.removeAttribute("placeholder"),Sys.Browser.isIE&&Sys.Browser.version<10&&(t.style.color="")},get_selectionText:function(){return $common.getSelectionText(this.get_element())},get_caretPos:function(){return this._caretPos<0&&this._saveCaretPos(),this._caretPos},set_caretPos:function(t){$common.setCaretPosition(this.get_element(),t)},_saveCaretPos:function(){var t=this;asyncCall(function(){t._caretPos=$common.getCaretPosition(t.get_element())})},doKeyDown:function(t){this.get_form(!0)&&(this.get_readOnly()&&t.keyCode==Sys.UI.Key.backspace?t.preventDefault():$app._loadingPage?this.blur():_Z_233.callBaseMethod(this,"doKeyDown",[t]))},doKeyUp:function(t){_Z_233.callBaseMethod(this,"doKeyUp",[t]),this._saveCaretPos();switch(t.keyCode){case Sys.UI.Key.left:case Sys.UI.Key.right:case Sys.UI.Key.esc:return}this._raiseTextChanged(t)},doMouseUp:function(t){_Z_233.callBaseMethod(this,"doMouseUp",[t]),this._saveCaretPos()},add_textChanged:function(t,e){this.get_events().addHandler("textChanged",t,e)},remove_textChanged:function(t){this.get_events().removeHandler("textChanged",t)},add_delayChanged:function(t,e){this.get_events().addHandler("delayChanged",t,e)},remove_delayChanged:function(t){this.get_events().removeHandler("delayChanged",t)},get_delayTime:function(){return this._delayInterval},set_delayTime:function(t){this._delayInterval=t},doPaste:function(t){this._raiseTextChanged(t)},_doCut:function(t){this._raiseTextChanged(t)},_raiseTextChanged:function(t){this._showRequiredIcon(),this._refreshEditHint(),this._textChanging=!0;var e=this.get_events().getHandler("textChanged");if(e&&e(this,t),this._textChanging=!1,e=this.get_events().getHandler("delayChanged")){this._delaySearchTimer&&clearTimeout(this._delaySearchTimer);var i=this;i._delaySearchTimer=setTimeout(function(){i._delaySearchTimer=null,e(i,t)},i._delayInterval),t.keyCode==Sys.UI.Key.esc&&t.cancel()}},_refreshEditHint:function(){var t=this;asyncCall(function(){t.get_isDisposed()||$common._doEditHint(t.get_element(),t._hint)})},_showRequiredIcon:function(t){if(this._requiredIcon&&(this.__loaded||t)){var e=this.get_outerElement(),i="requiredIcon ";e||(i="requiredEditIcon ",e=this.get_element()),this.get_elementValue()?$Dom.addCssClass(e,i+this._requiredIcon):$Dom.removeCssClass(e,i+this._requiredIcon)}},set_icon:function(t){this._oldIcon=this._icon,this._icon=t,this.get_isInitialized()&&this._refreshIcon()},get_icon:function(){return this._icon},_refreshIcon:function(){}},_Z_233.registerClass("_Z_233",Sys.UI.Controls.Container),_Z_101=function(t){_Z_101.initializeBase(this,[t]),this._requireKeyDown=!0,this._requireKeyPress=!0,this._maxByteLength=0},_Z_101.prototype={initialize:function(){this._maxByteLength>0&&(this._requireKeyPress=!0),_Z_101.callBaseMethod(this,"initialize")},get_maxByteLength:function(){return this._maxByteLength},set_maxByteLength:function(t){this._maxByteLength=t},doKeyDown:function(t){var e=!0,i=this._maxByteLength;if(i>0&&t.keyCode==Sys.UI.Key.ime){this._getByteLength()+2>i&&(e=!1)}e?_Z_101.callBaseMethod(this,"doKeyDown",[t]):t.preventDefault(),t.keyCode==Sys.UI.Key.space&&t.stopPropagation()},doKeyPress:function(t){var e=!0,i=this._maxByteLength;if(i>0){this._getByteLength()+(t.charCode>127?2:1)>i&&(e=!1)}e?_Z_101.callBaseMethod(this,"doKeyPress",[t]):t.preventDefault()},doValidateText:function(t){var e=_Z_101.callBaseMethod(this,"doValidateText",[t]);if(e)return e;var i=this._maxByteLength;if(i>0){var s=String.getByteLength(t);if(s>i)return"输入内容的长度（"+s+"）超过了 "+i+" 个字符（一个汉字算两个字符）"}return null},doPaste:function(t){if(_Z_101.callBaseMethod(this,"doPaste",[t]),window.clipboardData){this.get_elementValue()==this.get_nullDisplayText()&&(this.get_element().value="",this.get_element().style.color=this._oldTextColor);if(this._maxByteLength>0){var e=window.clipboardData.getData("Text");if(e){this._getByteLength()+String.getByteLength(e)>this._maxByteLength&&t.cancel()}}}},_getByteLength:function(){var t=this.get_selectionText();return String.getByteLength(this.get_elementValue())-String.getByteLength(t)},needFilterChars:function(){return!0}},_Z_101.registerClass("_Z_101",_Z_233),_Z_99=function(t){_Z_99.initializeBase(this,[t]),this._requireDblClick=!0,this._requireClick=!0,this._dropDownRows=$settings.DefaultDropDownRows,this._icon="aicon-moreunfold"},_Z_99.prototype={initialize:function(){_Z_99.callBaseMethod(this,"initialize"),this._documentClickHandler=$createDelegate(this,this._documentClick),this._windowResizeHandler=$createDelegate(this,this._doWindowResize)},dispose:function(){this._bottomBlock&&(this._bottomBlock.clear(!0),this._bottomBlock.dispose()),this._hasDocumentClickHandler&&this.closeUp();var t=this._popupWindow;t&&($clearHandlers(t),$removeNode(t),this._popupWindow=null),this._documentClickHandler=null,this._windowResizeHandler=null,$common._lastDropDownEdit=null,_Z_99.callBaseMethod(this,"dispose")},getInputAction:function(){return"选择"},doDblClick:function(t){_Z_99.callBaseMethod(this,"doDblClick",[t]),this._getAllowHandInput()||this.toggleDroppedDown()},doClick:function(t){_Z_99.callBaseMethod(this,"doClick",[t]),this._getAllowHandInput()||(this.toggleDroppedDown(),t.stopPropagation())},get_dataValueField:function(){return this._dataValueField},set_dataValueField:function(t){this._dataValueField=t},get_dataTextField:function(){return this._dataTextField},set_dataTextField:function(t){this._dataTextField=t},get_dropDownRows:function(){return this._dropDownRows},set_dropDownRows:function(t){this._dropDownRows=t},get_dropDownStyle:function(){return this._dropDownStyle},set_dropDownStyle:function(t){this._dropDownStyle=t},_getAllowHandInput:function(){return!1},set_childGspx:function(t){this._childGspx=t},get_childGspx:function(t){return this._childGspx},_initButtonStyle:function(t){if(0!=this._buttons.length){var e=this._buttons[0].get_element();e.style.backgroundColor=t;var i=$skin.hexToRgb(t);if(i){var s=i[0]+i[1]+i[2];e.style.color=s>500?$skin.getDarkColor(t,.5):$skin.getLightColor(t,.5)}else e.style.color="inherit"}},set_selectOnly:function(t){this._selectOnly=t,this.set_readOnly(t)},get_selectOnly:function(){return this._selectOnly},_initButtons:function(){this.addButton(new _Z_67(this,this._icon+" ArrowCombo"))},_refreshIcon:function(){if(1==this._buttons.length){var t=this._buttons[0].get_element();this._oldIcon&&$dom.removeCssClass(t,this._oldIcon),$dom.addCssClass(t,this._icon)}},get_droppedDown:function(){if(!this._popupWindow)return!1;var t=this._popupWindow.style;return($common.supportFlexBrowsers()?""==t.opacity||"1"==t.opacity:""==t.visibility||"visible"==t.visibility)||$common._lastDropDownEdit==this},set_droppedDown:function(t){this.get_droppedDown()!=t&&(t?this.dropDown():this.closeUp())},toggleDroppedDown:function(t){this.get_events().hasEvent("buttonClick")?this.doButtonClick(window.event):(this.get_droppedDown()?this.closeUp():this.dropDown(t),this.focus())},set_outerCssClass:function(t){this._outerCssClass=t},get_outerCssClass:function(){return this._outerCssClass},add_dropDown:function(t){this.get_events().addHandler("dropDown",t)},remove_dropDown:function(t){this.get_events().removeHandler("dropDown",t)},add_buttonClick:function(t,e){return this.get_events().addHandler("buttonClick",t,e)},remove_buttonClick:function(t){this.get_events().removeHandler("buttonClick",t)},doButtonClick:function(){var t=this.get_events().getHandler("buttonClick");if(t){return t(this,new _Z_174),!1}return!0},dropDown:function(t){if(this.canDropDown()){$common._lastDropDownEdit&&!t&&$common._lastDropDownEdit!=this&&($common._lastDropDownEdit.closeUp(!0),$common._lastDropDownEdit=null);var e=this.get_events().getHandler("dropDown");if(e){var i=new _Z_162;if(e(this,i),i.get_cancel())return}this._popupWindow||(this._popupWindow=this.createPopupWindow()),this.doInitPopup(),this._initBottomBar(),this._hasDocumentClickHandler||($common.addClickHandler(document,this._documentClickHandler),$common.addResizeHandler(window,this._windowResizeHandler),this._hasDocumentClickHandler=!0),t||($common._lastDropDownEdit=this),$Dom.addCssClass(this.get_outerElement(),"ShowDrop"),this.fadeIn(this._popupWindow)}},_initBottomBar:function(){if(this._childGspx){var t=this.get_form(),e=this.get_idPart(),i=$createControl("HBlock",{CssClass:"DropBottomBlock "+e},t,null,!0);$craba.resolveGspx(this._childGspx,i,t),i.appendTo(this._popupWindow),this._bottomBlock=t[i.ID],delete this._childGspx,this._initChildSize()}},_initChildSize:function(){if(this._bottomBlock){var t=this._popupWindow.offsetHeight,e=this._bottomBlock.get_height();this._bottomBlock.height=e,$common.setHeight(this._popupWindow,t+e)}},getBottomHeight:function(){return this._bottomBlock?this._bottomBlock.height:0},_documentClick:function(t){this._hasEditor=!1,this.closeUp(),_Z_99.callBaseMethod(this,"doBlur",[t])},_doWindowResize:function(t){this._popupWindow&&this.doInitPopup()},fastHide:function(){this.removeHandler(),this._popupWindow&&($Dom.setVisible(this._popupWindow,!1),$Dom.setOpacity(this._popupWindow,0))},fastShow:function(){this._popupWindow&&($Dom.setVisible(this._popupWindow,!0),$Dom.setOpacity(this._popupWindow,1))},removeHandler:function(){this._hasDocumentClickHandler&&($common.removeClickHandler(document,this._documentClickHandler),$common.removeResizeHandler(window,this._windowResizeHandler),this._hasDocumentClickHandler=!1,this.doCloseUp(),$common._lastDropDownEdit==this&&($common._lastDropDownEdit=null))},closeUp:function(t){this.removeHandler(),$Dom.removeCssClass(this.get_outerElement(),"ShowDrop"),t&&$Dom.removeCssClass(this.get_outerElement(),"active"),this._popupWindow&&this.fadeOut(this._popupWindow)},doCloseUp:function(){this._popup&&this._popup.doCloseUp&&this._popup.doCloseUp()},canDropDown:function(){return!this.get_readOnly()},createPopupWindow:function(){return null},doInitPopup:function(){this._popupWindow&&(this._hasEditor=!0,this._initPopupSize(),this._initPopupWindowPosition())},_initPopupSize:function(){var t=this._popupWindow;$Dom.setVisible(t,!0);var e=this._getPopupScrollWidth(),i=e,s=$settings.GridDefaultScrollBarWidth,o=this.get_outerElement(),n=this._getScrollDiv();if(i>n.offsetWidth){var r=0;o&&(r=Math.max(100,o.offsetWidth)),s=this._getPopupScrollHeight()>n.offsetHeight?s:4;var a=Math.max(e+s,r);$common.setWidth(t,a)}else o&&o.clientWidth>t.offsetWidth&&$common.setWidth(t,o.clientWidth)},_getScrollDiv:function(){return this._popupWindow},_getPopupScrollWidth:function(){return this._popupWindow.scrollWidth},_getPopupScrollHeight:function(){return this._popupWindow.scrollHeight},_initPopupWindowPosition:function(){var t=this.get_bounds(),e=this._popupWindow,i=$common.calcPopupPosition(t.x,t.y+t.height,e.offsetWidth,e.offsetHeight,t.width,t.height);this._showUp=i.y<t.y,this._setPopupPosition(i.x,i.y,t)},_setPopupPosition:function(t,e,i){var s=this._popupWindow;s.style.left=t+"px",s.style.top=(this.get_column()?e+1:e)+"px"},_canBlur:function(t){if(this._hasEditor)return!1;if(!t)return!0;var e=this.get_element(),i=t;do{var s=i.control;if(s&&(s._edit==e||s._control==this)||i._edit==e)return!1;i=i.parentNode}while(i);return!0},doBlur:function(t){var e;try{e=this._canBlur(document.activeElement)}catch(t){e=!0}e&&(_Z_99.callBaseMethod(this,"doBlur",[t]),this.closeUp())},doFormDeactivate:function(){this.fastHide()},_findItemsByStr:function(t){for(var e=this._items,i=[],s=e.length,o=0;o<s;o++){var n=e[o],r=n;if("object"==typeof n)if(this._searchByFields&&0!=this._searchByFields.length)for(var a=0,l=this._searchByFields.length;a<l;a++){if(r=n[this._searchByFields[a]],this._checkAppendItem(i,n,r,t))break}else r=n[this._dataTextField],this._checkAppendItem(i,n,r,t);else this._checkAppendItem(i,n,r,t)}return i},_checkAppendItem:function(t,e,i,s){if(void 0===i)return!1;if(s=s.toLowerCase(),(i=i.toString().toLowerCase()).indexOf(s)>-1)return t.push(Object.clone(e)),!0;return!!$string.getPinyinCode(i).toLowerCase().startsWith(s)&&(t.push(Object.clone(e)),!0)},set_text:function(t){_Z_99.callBaseMethod(this,"set_text",[t]),$common._doEditHint(this.get_element(),this._hint,!0)},doSetEnabled:function(t){_Z_99.callBaseMethod(this,"doSetEnabled",[t]),$Dom.setCssClass(!t,this.get_outerElement(),"disabled")},_initOldValue:function(t){t||_Z_99.callBaseMethod(this,"_initOldValue",[t])}},_Z_99.registerClass("_Z_99",_Z_233),Sys.UI.Controls.TextEdit=function(t){Sys.UI.Controls.TextEdit.initializeBase(this,[t]),this._allowDelIcon=$settings.DefaultAllowClearIcon},Sys.UI.Controls.TextEdit.prototype={set_text:function(t){Sys.UI.Controls.TextEdit.callBaseMethod(this,"set_text",[t]),$common._doEditHint(this.get_element(),this._hint)},_raiseTextChanged:function(t){Sys.UI.Controls.TextEdit.callBaseMethod(this,"_raiseTextChanged",[t]),this._showIcons()},doFocus:function(t){Sys.UI.Controls.TextEdit.callBaseMethod(this,"doFocus",[t]),this._showIcons()},doBlur:function(t){Sys.UI.Controls.TextEdit.callBaseMethod(this,"doBlur",[t]),$common.hideEditEx()},set_allowDelIcon:function(t){this._allowDelIcon=t,this._isSetDel=!0},get_allowDelIcon:function(){return this._allowDelIcon},set_editExIndex:function(t){this._editExIndex=t},get_editExIndex:function(){return this._editExIndex},_showIcons:function(){!this._allowDelIcon||this.get_readOnly()&&!this._isSetDel||$Dom.hasClass(this._element,"NoClearIcon")||(window.__craba_editEx||(window.__craba_editEx=new _Z_100),window.__craba_editEx.showAt(this))}},Sys.UI.Controls.TextEdit.registerClass("Sys.UI.Controls.TextEdit",_Z_101),_Z_100=function(){this._offsetRight=7,this.initialize()},_Z_100.prototype={initialize:function(){var t=this._btn=$common.createClassDiv("EditDelButton aicon-close");document.body.appendChild(t),$common.addMouseDownHandler(t,this.doDelText,this),$common.addResizeHandler(window,this._doResize,this),$common.addMouseWheelHandler(window,this.fastHide,this)},showAt:function(t){Object.isEmpty(t.get_text())?this.fastHide():t==this._edit&&this._isShow||(this._isShow=!0,this._edit=t,this._reLocation())},_reLocation:function(){var t=0,e=0;Sys.Browser.isIE&&(t=window.__bodyXOffset,e=window.__bodyYOffset);var i=this._btn,s=this._edit;if(s&&!s.get_isDisposed()){var o=s.get_bounds();if(o.width<70)this.fastHide();else{var n=s.get_form(),r=n.get_bounds();if(n.get_isChildForm()||!(r.x+r.width<o.x+o.width)){var a=s.get_column();if(a){var l=a._grid.get_bounds();if(l.x+l.width<o.x+o.width)return}this._setEditPadding();s.get_element();t=t+o.x+o.width-i.offsetWidth-this._offsetRight-s._savePaddingRight,e=e+o.y+(o.height-i.offsetHeight)/2-1,i.style.left=t+"px",i.style.top=e+"px",i.style.zIndex=s.get_editExIndex()?s.get_editExIndex():$app.getPopupElementZIndex()+1}}}},_setEditPadding:function(){var t=this._btn;t.style.display="block";var e=t.offsetWidth,i=this._edit,s=i.get_element();if(Object.isUndefinedOrNull(i._savePaddingRight)){var o=$dom._getCurrentStyle(s);i._savePaddingRight=parseInt(o.paddingRight)}s.style.paddingRight=$common.pix(e+i._savePaddingRight+this._offsetRight)},_resetEditPadding:function(t){t&&!t.get_isDisposed()&&(Object.isUndefinedOrNull(t._savePaddingRight)||(t.get_element().style.paddingRight=$common.pix(t._savePaddingRight)))},fastHide:function(){this._isShow&&(this._resetEditPadding(this._edit),this._isShow=!1,this._edit=null,this._btn&&(this._btn.style.display="none"))},doDelText:function(t){var e=this._edit;e&&(e.set_text(""),e.doChange(),e.asyncFocus())},_doResize:function(t){if(this._edit&&this._btn){var e=this;asyncCall(function(){e._reLocation()})}}},_Z_171=function(){_Z_171.initializeBase(this),this._request=null},_Z_171.prototype={get_request:function(){return this._request},set_request:function(t){this._request=t}},_Z_171.registerClass("_Z_171",_Z_162),_Z_172=function(t){_Z_172.initializeBase(this),this._rowData=t},_Z_172.prototype={get_selectedRowData:function(){return this._rowData}},_Z_172.registerClass("_Z_172",_Z_162),Sys.UI.Controls.SearchEdit=function(t){Sys.UI.Controls.SearchEdit.initializeBase(this,[t]),this._gridId=null,this._grid=null,this._requestList=[],this._interval=500,this._lastText="",this._selectedIndex=-1,this._selectedItemData=null,this._popup=null,this._webMethodName=null},Sys.UI.Controls.SearchEdit.prototype={dispose:function(){this._popup&&(this._popup.dispose(),this._popup=null),this._grid=null,Sys.UI.Controls.SearchEdit.callBaseMethod(this,"dispose")},get_webMethodName:function(){return this._webMethodName},set_webMethodName:function(t){this._webMethodName=t},get_grid:function(){return this._gridId},set_grid:function(t){this._gridId=t},get_interval:function(){return this._interval},set_interval:function(t){this._interval=t},set_selectedItem:function(t){this._selectedItemData=t},get_selectedItem:function(){return this._selectedItemData},get_itemCount:function(){return this._grid.get_recordCount()},doFormInit:function(){if(this._gridId){var t=this._grid=this.get_form()[this._gridId];if(t){var e=t.get_element();e.style.border="none",e.style.padding="0px",t._allowCustomScrollBar=!1,t._allowPopup=!1;var i=$createDelegate(this,this.closeUp);t.add_rowDblClick(i),t.add_rowClick(this._gridRowClick,this)}}},_gridClicked:function(t){t.cancel()},_canBlur:function(){return!1},_initButtons:function(){},createPopupWindow:function(){var t=this._popup=new Sys.UI.Controls.Popup(this,!0);t.set_child(this._grid);var e=t.render();return $common.addClickHandler(e,this._gridClicked,this),e},doInitPopup:function(){if(this._popup){Sys.UI.Controls.SearchEdit.callBaseMethod(this,"doInitPopup");var t=this._grid;if(t){t._edit&&t._edit!=this&&this._popup._element.appendChild(t.get_element());var e=this.get_width();t.get_width()<e&&$common.setWidth(this._popupWindow,e),t._edit=this}}},_initPopupWindowPosition:function(){Sys.UI.Controls.SearchEdit.callBaseMethod(this,"_initPopupWindowPosition");var t=this.get_column();if(t){t.get_grid().get_focusedColumn()!=t&&this.closeUp()}},_gridRowClick:function(t){this._grid._edit==this&&(this._abortChange=!0,this._raiseSelected(this),this.closeUp())},_raiseSelected:function(t){var e=this._grid.get_selectedRowData();if(e){var i=this.get_events().getHandler("_selected");if(i){i(this,new _Z_172(e)),this.get_column()&&this._grid.set_dataSource(null)}}else this._selectedItemData=null},_raiseTextChanged:function(t){if(Sys.UI.Controls.SearchEdit.callBaseMethod(this,"_raiseTextChanged",[t]),this._abortChange)this._abortChange=!1;else{if(this._grid||this._bindSearch){var e=!1,i=t.keyCode;this.get_droppedDown();switch(i){case Sys.UI.Key.up:case Sys.UI.Key.down:case Sys.UI.Key.pageUp:case Sys.UI.Key.pageDown:case Sys.UI.Key.home:case Sys.UI.Key.end:e=!0}if(!e&&!t.ctrlKey){var s=this.get_text();if(s!=this._searchText){this._searchText=s,this._searchTimer&&clearTimeout(this._searchTimer);var o=this;o._searchTimer=setTimeout(function(){o._searchTimer=null,o._doSearch()},o._interval)}}}}},_doSearch:function(){var t=this.get_events().getHandler("_search");if(t){t(this,new _Z_171)}},refresh:function(t,e){if(t){var i=this.get_form()._service,s=this.get_webMethodName();if(!s)throw Error.invalidOperation("SearchEdit没有指定WebMethodName");if(!i||"function"!=typeof i[s])throw Error.invalidOperation("SearchEdit指定的WebMethodName不存在，请在服务端添加[WebMthod]:"+s);var o=this,n=i[s](t,function(t){e&&e(t),o.set_dataSource(t)});this._request=n}else this.closeUp()},set_dataSource:function(t){if(this._grid&&!this.get_isDisposed()){if(this.get_form().get_isActive())if(void 0===t&&(t=[]),0!=t.length){this.get_droppedDown()||this.dropDown(),this._grid.dataBind(t),this._selectedIndex=0;var e=this;setTimeout(function(){e._initPopupWindowPosition()},10)}else this.closeUp()}},doKeyDown:function(t){var e=this._grid;if(e){var i=!1,s=t.keyCode,o=this.get_droppedDown(),n=e.get_recordCount();if(0!=n){switch(s){case Sys.UI.Key.up:i=!0,o?t.altKey?this.closeUp():this._incMoveItemIndex(-1):this.get_column()?i=!1:this._selectedIndex>0&&this._setMoveItemIndex(this._selectedIndex-1);break;case Sys.UI.Key.down:i=!0,o?this._incMoveItemIndex(1):t.altKey?this.dropDown():this.get_column()?i=!1:this._selectedIndex<n-1&&this._setMoveItemIndex(this._selectedIndex+1);break;case Sys.UI.Key.pageUp:o&&this._incMoveItemIndex(-5);break;case Sys.UI.Key.pageDown:o&&this._incMoveItemIndex(5);break;case Sys.UI.Key.home:o&&n>0&&this._setMoveItemIndex(0);break;case Sys.UI.Key.end:o&&n>0&&this._setMoveItemIndex(n-1);break;case Sys.UI.Key.enter:o||this.get_column()?(this._gridRowClick(),i=!0):i=!1;break;case Sys.UI.Key.esc:this.closeUp();break;case Sys.UI.Key.backspace:case Sys.UI.Key.del:break;case Sys.UI.Key.left:case Sys.UI.Key.right:case Sys.UI.Key.tab:i=!1}i?t.cancel():Sys.UI.Controls.SearchEdit.callBaseMethod(this,"doKeyDown",[t])}else Sys.UI.Controls.SearchEdit.callBaseMethod(this,"doKeyDown",[t])}else Sys.UI.Controls.SearchEdit.callBaseMethod(this,"doKeyDown",[t])},_setMoveItemIndex:function(t){this.get_droppedDown()||this.dropDown(),this._selectedIndex=t,this._grid.set_selectedRowIndex(t)},_incMoveItemIndex:function(t){var e=this._selectedIndex+t,i=this.get_itemCount();e<0?e=i-1:e>i-1&&(e=0),this._setMoveItemIndex(e)},add_search:function(t,e){this._bindSearch=!0,this.get_events().addHandler("_search",t,e)},remove_search:function(t){this._bindSearch=!1,this.get_events().removeHandler("_search",t)},add_selected:function(t,e){this.get_events().addHandler("_selected",t,e)},remove_selected:function(t){this.get_events().removeHandler("_selected",t)}},Sys.UI.Controls.SearchEdit.registerClass("Sys.UI.Controls.SearchEdit",_Z_99),_Z_41=function(t){_Z_41.initializeBase(this,[t]),this.__isPanel=!0,this._requireClick=!0},_Z_41.prototype={dataBind:function(t){this.doBind(t)},doBind:function(t){this._initChildControls();var e=this.get_form().get_dataController();e._panelData=t||{};for(var i=this._controls,s=0;s<i.length;s++){var o=i[s];o.dataBind&&!o.__isPanel&&(o._dataBinding=!0,o.dataBind(),o._dataBinding=!1)}delete e._panelData},saveData:function(t){this._initChildControls();var e=this.get_form().get_dataController();e._panelData={};var i=!0,s=t;"object"==typeof t&&(s=t.ignore,i=t.visible);var o=this.get_form();o.setValidationControl(null);for(var n=this._controls,r=0;r<n.length;r++){var a=n[r];if(a.doSaveData){(!i||a.get_visible&&a.get_visible(!0))&&a.doSaveData(s)}}o.get_validationManager().checkResults();var l=Object.clone(e._panelData);return delete e._panelData,l},saveTags:function(){this._initChildControls();for(var t=[],e=this._controls,i=0;i<e.length;i++){var s=e[i];s.saveTags?t=t.concat(s.saveTags()):$craba._pushControlTag(s,t)}return t},removeChilds:function(t,e){if(!this.get_isDisposed()){this._initChildControls(),t||(t=this.get_form());for(var i=this._controls,s=0;s<i.length;s++){var o=i[s];o.get_isDisposed()||(e&&Array.indexOf(e,o)>-1||t.removeControl(o,!0))}e||(this.get_element().innerHTML=""),delete this._controls}},get_controls:function(){return this._initChildControls(),this._controls},_initChildControls:function(){this._controls||(this._controls=$common.getElementChildControls(this.get_element()))},clear:function(t){t?this.removeChilds():delete this._controls},doFormInit:function(){this._inited=!0,this.get_enabled()||$common.setContainerEnabled(this.get_element(),this.get_enabled(),!0)},set_enabled:function(t){this.get_enabled()!=t&&(_Z_41.callBaseMethod(this,"set_enabled",[t]),this._inited&&$common.setContainerEnabled(this.get_element(),t,!0))}},_Z_41.registerClass("_Z_41",_Z_249),Sys.UI.Controls.Popup=function(t,e,i){Sys.UI.Controls.Popup.resolveInheritance(this),this._childControl=null,this._control=t,this._element=null,this._isSingle=i,this._showBorder=e,this._position="absolute",this._hideArrow=!1,this._isHide=!0,this.__isPanel=!0,this._zIndex=$app.getPopupElementZIndex()+1},Sys.UI.Controls.Popup.prototype={dispose:function(){this.hide(),this._childControl&&(this._childControl.dispose(),this._childControl=null),this._maskDiv&&($clearHandlers(this._maskDiv),$removeNode(this._maskDiv),this._maskDiv=null),$removeNode(this._element),Sys.UI.Controls.Popup.callBaseMethod(this,"dispose")},canFocus:function(){return this._canFocus},focus:function(){for(var t=this.get_controls(),e=t.length,i=0;i<e;i++){var s=t[i];if(Sys.UI.Control.canFocus(s))return void s.focus()}this.focusNextControl()},get_visible:function(){return this.isShow()},get_zIndex:function(){return this._zIndex},get_isModal:function(){return this._showModal},get_isLoading:function(){return!1},set_child:function(t){this._childControl=t},set_element:function(t){this._element=t,this._init()},set_offsetTop:function(t){this._element.style.top=parseInt(this._element.style.top)+t+"px"},set_position:function(t){this._position=t},set_hideArrow:function(t){this._hideArrow=t},get_hideArrow:function(){return this._hideArrow},render:function(){return this._element?this._element:(this._element=$common.createDiv(),this._init(),this._element)},_init:function(){var t=this._element;if(t.style.left="-20000px",t.style.top="-20000px",document.body.appendChild(t),$common.initPopupElement(t,this._showBorder,!1),this._childControl){var e=this._childControl.get_element();t.appendChild(e),this._childControl.set_visible(!0)}var i=this._arrow=$common.createClassSpan("PopupArrow");t.appendChild(i)},popupAt:function(t,e,i){if("object"==typeof e?(this._showModal=e.showModal,this._mode=e.mode,i=e.hideArrow):(this._mode=null,this._showModal=e),!this._isHide&&!this._isStep)return!0;if(i=i==undefined?this._hideArrow:i,!t)return $common.showTips("popupAt必须指定control参数");this.parentControl=t,this.set_owner(t);var s=null,o={},n=null;this._showCenter=!1;var r=getClientBounds(),a=!1;if("string"!=typeof t&&t)if(t.nodeName)n=t,"BODY"==t.nodeName?(this._showCenter=!0,s=r):s=$Dom.getBounds(n);else{if(!(n=t._element||t.get_element()))return!1;n._outerElement&&(n=n._outerElement),!this._showModal&&t.get_outerElement&&$dom.addCssClass(t.get_outerElement(),"ShowPopup"),s=$Dom.getBounds(n),a=!0}else t||(t="ForRight"),s=t;if("string"!=typeof s&&(s.x+s.width<0||s.y+s.height<0||0==s.width||0==s.height))return!1;if($app.getLastPopup()!=this){var l=this.__form;a&&t.get_form&&(l=t.get_form()),l?(l.popupIndex||(l.popupIndex=1),this._zIndex=l.get_rootForm().get_zIndex()+l.popupIndex,l.popupIndex++):this._zIndex=$app.getPopupElementZIndex()}if(this._offsetIndex&&(this._zIndex+=this._offsetIndex),this._isSingle||$app.addBlockPopup(this),this._clearDocumentClickHandler(),this._showModal){if($app.IsPopup=!0,this._isHide&&(setClientScrollPosition(0,0),$common._hideScrollBar(),!this._showCenter&&n&&(s=$Dom.getBounds(n))),this._zIndex=this._isStep?$app.StepIndex:$app.PopupMaxIndex,n){Object.copyTo(s,o);var h=document.body.scrollTop;if(s.y>r.height+h){o=this._getNewRect(n);0==getClientScrollPosition().y&&(s=o)}else o.y=o.y-h}this.disablePopupScreen(o)}var d=this._getPopupNode(),_=!1;if(d.offsetHeight>=parseInt(.99*r.height)&&($Dom.addCssClass(d,"overflow"),_=!0),"string"==typeof s)return this._showRect(s,d,r);var c={};if(this._showCenter)c.x=(s.width-d.offsetWidth)/2,c.y=Math.max(1,(s.height-d.offsetHeight)/2),i=!0;else{var u=s.x,p=s.y+s.height,g=d.offsetHeight+8;"right"==this._mode&&(u+=s.width+8,p=s.y,g-=8),c=$common.calcPopupPosition(u,p,d.offsetWidth,g,s.width,s.height),"right"==this._mode&&c.x<u&&(c.x=u-d.offsetWidth-s.width-16,u<0?(this._mode=null,c.y=c.y<p?c.y:p+s.height):this._mode="left"),this._isLeft=c.x<s.x,this._isTop=c.y<s.y,c.y<5||_?(c.y=5,this._isLeft?c.x-=s.width+4:c.x+=s.width+4,i=!0):i||(c.y=this._isTop?c.y-3:c.y+10)}return d.style.left=$common.pix(c.x),d.style.top=$common.pix(c.y),$Dom.addCssClass(d,"opacity"),this._showArrow(d,i,s,c),this._popupEnd(),!0},popup:function(t){$app.addBlockPopup(this),this._clearDocumentClickHandler();var e=this._getPopupNode(),i=$common.calcPopupPosition(t.x,t.y,e.offsetWidth,e.offsetHeight,t.width||0,t.height||0);e.style.left=$common.pix(i.x),e.style.top=$common.pix(i.y),$Dom.addCssClass(e,"opacity"),this._showArrow(e,t.hideArrow||!1,t,i),this._popupEnd()},_getPopupNode:function(){var t=this._zIndex,e=this.render();return $Dom.addCssClass(e,"Popup"),$Dom.setCssClass(this._showModal,e,"Modal"),$Dom.removeCssClass(e,"overflow"),e.style.position=this._position,e.style.zIndex=t,e.style.height="auto",$Dom.setVisibleByPosition(e,!0),e},set_offsetIndex:function(t){this._offsetIndex=t},_showRect:function(t,e,i){$Dom.addCssClass(e,"opacity");var s=0,o=0;"ForRight"==t?(s=i.width+e.offsetWidth,o=Math.max(0,(i.height-e.offsetHeight)/2)):"ForLeft"==t?(s=-1*e.offsetWidth,o=Math.max(0,(i.height-e.offsetHeight)/2)):"ForUp"==t?(s=(i.width-e.offsetWidth)/2,o=-1*e.offsetHeight):"ForDown"==t&&(s=(i.width-e.offsetWidth)/2,o=i.height+e.offsetHeight),this._direction=t,$dom.addCssClass(e,"noArrow"),$dom.addCssClass(e,"posfixed"),e.style.left=s+"px",e.style.top=o+"px",this._popupEnd(),setTimeout(function(){e.style.transition="all .4s linear","ForRight"==t?e.style.left=Math.max(0,i.width-e.offsetWidth-5)+"px":"ForLeft"==t?e.style.left="5px":"ForDown"==t?e.style.y=Math.max(0,i.height-e.offsetHeight-5)+"px":"ForUp"==t&&(e.style.y="5px")},10)},_popupEnd:function(){this._isHide=!1,asyncCall($createDelegate(this,this._bindClickHandler)),$step.popHideStep(),this._focusControl()},_showArrow:function(t,e,i,s){var o=this._arrow;if($Dom.setCssClass(e,t,"noArrow"),!e){if($Dom.removeCssClass(t,"p-top"),$Dom.removeCssClass(t,"p-bottom"),$Dom.removeCssClass(t,"p-right"),$Dom.removeCssClass(t,"p-left"),"left"==this._mode)return $Dom.addCssClass(t,"p-right"),o.style.left="100%",void(o.style.top="5px");if("right"==this._mode)return $Dom.addCssClass(t,"p-left"),o.style.left="-19px",void(o.style.top="5px");this._isTop?$Dom.addCssClass(t,"p-bottom"):$Dom.addCssClass(t,"p-top");var n=i.x-s.x,r=this._isStep?40:8;n>t.offsetWidth-r&&(r*=-1),o.style.left=n+r+"px",o.style.top=""}},_focusControl:function(){},_getNewRect:function(t){t.scrollIntoView(!1);var e=$Dom.getBounds(t),i=getClientScrollPosition();return e.y=e.y-i.y,e},disablePopupScreen:function(t){if(this._createMasks(),!this._showCenter&&this._isStep){this._showOverlay(this._topDiv,0,0,"100%",t.y+"px",$settings.StepOpacity),this._showOverlay(this._leftDiv,0,t.y+"px",t.x+"px",t.height+"px",$settings.StepOpacity),this._showOverlay(this._rectDiv,t.x+"px",t.y+"px",t.width+"px",t.height+"px",0),this._showOverlay(this._rightDiv,t.x+t.width+"px",t.y+"px","100%",t.height+"px",$settings.StepOpacity);var e=$Dom._getCurrentStyle(this._topDiv).height,i=$Dom._getCurrentStyle(this._leftDiv).height;this._showOverlay(this._bottomDiv,0,parseFloat(e)+parseFloat(i)+"px","100%","100%",$settings.StepOpacity),$Dom.removeCssClass(this._maskDiv,"CenterOverlay")}else $Dom.addCssClass(this._maskDiv,"CenterOverlay");this._maskDiv.style.left="0",this._maskDiv.style.top="0"},_createMasks:function(){if(!this._maskDiv){var t=this._maskDiv=$common.createClassDiv("PopupOverlay");!this._showCenter||this._isStep?(t.style.zIndex=this._isStep?$app.StepIndex-1:$app.PopupMaxIndex-1,this._topDiv=this._getDiv("FormOverlay Step"),this._leftDiv=this._getDiv("FormOverlay Step"),this._rectDiv=this._getDiv("FormOverlay Step"),this._rightDiv=this._getDiv("FormOverlay Step"),this._bottomDiv=this._getDiv("FormOverlay Step")):$Dom.addCssClass(t,"CenterOverlay"),$Dom.setCssClass(this._isStep,t,"StepOverlay"),$common.addClickHandler(t,this._documentClick,this),$common.addClickHandler(this._element,this._documentClick,this),$common.addContextMenuHandler(t,this._documentClick,this),document.body.appendChild(t)}},_showOverlay:function(t,e,i,s,o,n){t.style.left=e,t.style.top=i,t.style.width=s,t.style.height=o,$Dom.setOpacity(t,n)},_getDiv:function(t){var e=$common.createClassDiv(t);return this._maskDiv.appendChild(e),e},enablePopupScreen:function(){this._maskDiv&&($common._restoreBar(),this._maskDiv.style.left="300%",this._maskDiv.style.top="300%")},get_relativePos:function(){return{isLeft:this._isLeft,isTop:this._isTop}},hide:function(t){if(window.__craba_editEx&&window.__craba_editEx.fastHide(),this.__form&&this.__form.popupIndex&&this.__form.popupIndex--,$app.IsPopup=!1,this._element&&!this._isHide&&(!0===t||this._doHide(t))){var e=this._element;if($app.removeBlockPopup(this),this._isHide=!0,this.enablePopupScreen(),this._direction){var i=getClientBounds();"ForRight"==this._direction?e.style.left=_px(i.width+50):"ForLeft"==this._direction?e.style.left=_px(-1*e.offsetWidth-50):"ForDown"==this._direction?e.style.y=_px(-1*e.offsetHeight-50):"ForUp"==this._direction&&(e.style.y=_px(i.height+50)),delete this._direction,e.style.transition="",$dom.removeCssClass(e,"posfixed")}else $Dom.removeCssClass(e,"opacity"),$Dom.setVisibleByPosition(e,!1);this._clearDocumentClickHandler();var s=this.parentControl;s&&"string"!=typeof s&&!s.tagName&&s.get_outerElement&&$dom.removeCssClass(s.get_outerElement(),"ShowPopup")}},_fromHide:function(t){this._showModal&&"esc"!=t||this.hide()},_doHide:function(t){var e=this;this._popupBlock&&(e=this._popupBlock);var i=e.get_events().getHandler("_hide");if(!i)return!0;var s=new _Z_162;return s.event=t,i(e,s),!s.get_cancel()},_onBodyScroll:function(t){this._isHide||t.cancel()},_isClickPopup:function(t){for(var e=t.target;e&&"BODY"!=e.tagName&&e!=this._element;)e=e.parentNode;return e==this._element},_documentClick:function(t){if(this._showModal){if(this._isClickPopup(t))return;this.get_isActive()&&t.preventDefault()}else if(!$step._stepShow&&this.get_isActive()){var e=$common.getMouseEventPos(t),i=$common.getBounds(this._element);$common.ptInRect(e,i)||this._isClickPopup(t)||this.hide(t)}},_bindClickHandler:function(){this._isHide||this._documentClickHandler||(this._documentClickHandler=$common.addMouseDownHandler(document,this._documentClick,this),this._windowSizeHandler=$common.addResizeHandler(window,this._windowResize,this))},_windowResize:function(t){this.popupAt(this.parentControl,this._showModal)},_clearDocumentClickHandler:function(){this._documentClickHandler&&($common.removeMouseDownHandler(document,this._documentClickHandler),$common.removeResizeHandler(window,this._windowSizeHandler),this._documentClickHandler=null,this._windowSizeHandler=null)},isShow:function(){return!this._isHide},set_enabled:function(t){$common.setContainerEnabled(this._element,t,!0,!0)},get_enabled:function(){return $Dom.getEnabled(this._element)},add_hide:function(t){this.get_events().addHandler("_hide",t)},remove_hide:function(t){this.get_events().removeHandler("_hide",t)},set_owner:function(t){this._owner=t},get_owner:function(){return this._owner},get_isActive:function(){return $app.getLastPopup()==this&&!$common._lastDropDownEdit}},Sys.UI.Controls.Popup.registerClass("Sys.UI.Controls.Popup",_Z_41),Sys.UI.Controls.PopupBlock=function(t){Sys.UI.Controls.PopupBlock.initializeBase(this,[t]),this._popup=null},Sys.UI.Controls.PopupBlock.prototype={dispose:function(){this._popup&&(this._popup.dispose(),this._popup=null),$removeNode(this._element),Sys.UI.Controls.PopupBlock.callBaseMethod(this,"dispose")},doFormLoaded:function(){if(!this.get_reportVisible())for(var t=this.get_controls(),e=0,i=t.length;e<i;e++){var s=t[e];s.get_reportVisible&&!s._reportVisibleSet&&s.set_reportVisible(!1)}},doFormDeactivate:function(){this.hide(!0)},popup:function(t){this._initPopup(),this._popup.popup(t)},popupAt:function(t,e,i){this._initPopup();var s=this._popup;this.parentControl=t,s.set_offsetIndex(this._offsetIndex),s.popupAt(t,e,i)},_initPopup:function(){if(!this._popup){var t=this._popup=new Sys.UI.Controls.Popup(null);t.set_element(this.get_element()),t.__form=this.get_form(),t._popupBlock=this}},get_popup:function(){return this._popup},hide:function(t){var e=this._popup;e&&e.hide(t)},get_zIndex:function(){return this._popup.get_zIndex()},set_offsetIndex:function(t){this._offsetIndex=t},isShow:function(){var t=this._popup;return!!t&&t.isShow()},add_hide:function(t){this.get_events().addHandler("_hide",t)},remove_hide:function(t){this.get_events().removeHandler("_hide",t)}},Sys.UI.Controls.PopupBlock.registerClass("Sys.UI.Controls.PopupBlock",_Z_41),Sys.UI.Controls.InnerBlock=function(t){Sys.UI.Controls.InnerBlock.initializeBase(this,[t])},Sys.UI.Controls.InnerBlock.prototype={},Sys.UI.Controls.InnerBlock.registerClass("Sys.UI.Controls.InnerBlock",_Z_41),Sys.UI.Controls.HintBlock=function(t){Sys.UI.Controls.HintBlock.initializeBase(this,[t]),this._popupWidth=0,this._mouseInTime=0,this._mouseOutTime=0},Sys.UI.Controls.HintBlock.prototype={dispose:function(){this._contentElement&&($clearHandlers(this._contentElement),this._contentElement=null),this._popupElement&&($clearHandlers(this._popupElement),$removeNode(this._popupElement),this._popupElement=null),this._clearDocumentClickHandler(),this._ownerControl=null,this._lastControl=null,Sys.UI.Controls.HintBlock.callBaseMethod(this,"dispose")},get_for:function(){return this._for},set_for:function(t){this._for=t},get_wait:function(){return this._wait},set_wait:function(t){this._wait=t},doFormInit:function(t){if(this._calculatePopupWidth(),this._for){var e=this._ownerControl=t[this._for];if(!e)throw Error.invalidOperation("控件 "+this._for+" 不存在");var i=e.get_element();$common.addMouseOverHandler(i,this._handleMouseOver,this),$common.addMouseOutHandler(i,this._handleMouseOut,this)}},_calculatePopupWidth:function(){var t=this.get_element(),e=parseInt(t.style.width);isNaN(e)&&(e=0),e<30&&(e=30,t.style.width=e+"px"),this._popupWidth=e+26},_handleMouseOver:function(t){this._mouseInTime=(new Date).getTime(),this._popupElement&&this._isShow||this.popupAt(this._ownerControl)},_handleMouseOut:function(t){this._mouseOutTime=(new Date).getTime(),this._wait&&this._mouseOutTime-this._mouseInTime<this._wait?clearTimeout(this._timeoutId):this.hide()},_show:function(t,e,i,s){this._documentClick();var o=this._createPopupElement();o.style.zIndex=$app.getPopupElementZIndex();var n=getClientScrollPosition(),r=getClientBounds(),a=t,l=!0,h=o.offsetWidth;t+h-n.x>r.width&&(a=t+i-h,l=!1);var d=e+8,_=!0,c=o.offsetHeight;e+c-n.y>r.height&&(d=e-s-c-10,_=!1),$Dom.setCssClass(!l,this._angleElement,"right"),$Dom.setCssClass(!_,this._angleElement,"bottom"),$Dom.setLocation(o,a,d),setTimeout($createDelegate(this,this._bindClickHandler),0),this._isShow=!0},_bindClickHandler:function(){this._documentClickHandler||(this._documentClickHandler=$common.addClickHandler(document,this._documentClick,this))},_createPopupElement:function(){var t=this._popupElement;if(t)return t;t=this._popupElement=this.get_element();var e=this._angleElement=$common.createClassDiv("arrow aicon-shangjiantou");return t.appendChild(e),document.body.appendChild(t),this._ownerControl&&($common.addMouseOverHandler(t,this._handleMouseOver,this),$common.addMouseOutHandler(t,this._handleMouseOut,this)),$common.addClickHandler(t,this.hide,this),t},_clearDocumentClickHandler:function(){this._documentClickHandler&&($common.removeClickHandler(document,this._documentClickHandler),this._documentClickHandler=null)},_documentClick:function(t){null!=this.get_form()&&this.get_form().get_isActive()&&this.get_visible()&&this.hide()},hide:function(){this._popupElement.style.left="-10000px",this._popupElement.style.top="-10000px",this._clearDocumentClickHandler(),this._isShow=!1},get_visible:function(){return this._popupElement&&this._isShow},doFormActivate:function(){this._needRestore&&(this.popupAt(this._lastControl),this._needRestore=!1)},doFormDeactivate:function(){this._lastControl&&this.get_visible()&&(this._needRestore=!0,this.hide())},popupAt:function(t){if(!t)throw Error.argumentNull("control");_this=this,this._lastControl=t;var e=t.get_bounds();if(null==this._wait||this._wait<=0){if(null==e)return;this._show(e.x,e.y+e.height+2,e.width,e.height)}else this._timeoutId=setTimeout(function(){null!=e&&_this._show(e.x,e.y+e.height+2,e.width,e.height)},this._wait)}},Sys.UI.Controls.HintBlock.registerClass("Sys.UI.Controls.HintBlock",_Z_249),Sys.UI.Controls.PasswordEdit=function(t){Sys.UI.Controls.PasswordEdit.initializeBase(this,[t]),this._requireKeyPress=!0,this._softKeyboardPopup=null,this._allowSoftKeyboard=!0,this._allowBrowserPassword=$settings.DefaultAllowBrowserPassword,this._showIcon=!0,this._isKeyboardClicked=!0,this._realValue="",this._icon="aicon-jianpan1"},Sys.UI.Controls.PasswordEdit.prototype={dispose:function(){this._softKeyboardPopup&&(this._softKeyboardPopup.dispose(),this._softKeyboardPopup=null),Sys.UI.Controls.PasswordEdit.callBaseMethod(this,"dispose")},_getAllowHandInput:function(){return!0},_refreshEditHint:function(){},doFocus:function(t){if(Sys.UI.Controls.PasswordEdit.callBaseMethod(this,"doFocus",[t]),!this._allowBrowserPassword){this._focused=!0;var e=this.get_element();e.setAttribute("type","password"),e.value=this._realValue}},doBlur:function(t){this._focused=!1,this._saveValue(),Sys.UI.Controls.PasswordEdit.callBaseMethod(this,"doBlur",[t])},_saveValue:function(){if(!this._allowBrowserPassword){var t=this.get_element();t.setAttribute("type","text"),this._realValue=t.value,t.value=$string.repeat("•",this._realValue.length)}},get_value:function(){return this._allowBrowserPassword||this._focused?this.get_element().value:this._realValue},get_keyboardValue:function(){var t=this.get_value(),e=this._softKeyboardPopup;return e?e.get_value(t):t},set_text:function(t){var e=this.get_element();e.value=null!=t?t:"",this._realValue=e.value},needFilterChars:function(){return!0},_showNullDisplayValue:function(t){},_initButtons:function(){this._allowSoftKeyboard&&(this._showIcon&&this.addButton(new _Z_69(this,this._icon)),this.get_events().hasEvent("buttonClick")||(this._softKeyboardPopup=new _Z_66(this.get_element())))},_documentClick:function(t){this._isKeyboardClicked?Sys.UI.Controls.PasswordEdit.callBaseMethod(this,"_documentClick",[t]):this._isKeyboardClicked=!0},showSoftKeyboard:function(){if(!this._allowSoftKeyboard)throw Error.invalidOperation("PasswordEdit没有启用软件盘功能");this._isKeyboardClicked=!1,Sys.UI.Controls.PasswordEdit.callBaseMethod(this,"toggleDroppedDown")},canDropDown:function(){return this._allowSoftKeyboard},createPopupWindow:function(){return this._softKeyboardPopup.render()},doInitPopup:function(){this._softKeyboardPopup&&Sys.UI.Controls.PasswordEdit.callBaseMethod(this,"doInitPopup")},doKeyDown:function(t){var e=t.keyCode||t.charCode,i=this.get_allowSoftKeyboard(),s=i&&this.get_droppedDown(),o=this._softKeyboardPopup,n=!0;switch(e){case Sys.UI.Key.up:s&&t.altKey&&this.closeUp();break;case Sys.UI.Key.down:i&&!s&&t.altKey&&this.dropDown();break;case Sys.UI.Key.esc:case Sys.UI.Key.enter:s&&this.closeUp();break;case Sys.UI.Key.left:case Sys.UI.Key.right:n=!1}o&&!n?t.cancel():Sys.UI.Controls.PasswordEdit.callBaseMethod(this,"doKeyDown",[t])},refresh:function(t){var e=this._softKeyboardPopup;e&&(this.closeUp(),e.clearText(),this._popupWindow=e.refresh())},set_keyboardData:function(t){this._keyList=null,this._keyboadData=t,this.get_isInitialized()&&this.refresh(t)},get_keyboardData:function(){return this._keyboadData?this._keyboadData:(this._keyboadData="6548319720glvpfemisdrybtukznojqwxhca>#*=}/@,!(%-`]|:_+&<.\\){^[\"?'$~;",this._keyboadData)},getKeyList:function(){var t=this._keyList;if(!t){t=this.get_keyboardData().split("")}return t},set_allowSoftKeyboard:function(t){this._allowSoftKeyboard=t},get_allowSoftKeyboard:function(){return this._allowSoftKeyboard},set_allowBrowserPassword:function(t){this._allowBrowserPassword=t},get_allowBrowserPassword:function(){return this._allowBrowserPassword},get_showIcon:function(){return this._showIcon},set_showIcon:function(t){this._showIcon=t}},Sys.UI.Controls.PasswordEdit.registerClass("Sys.UI.Controls.PasswordEdit",_Z_99),_Z_66=function(t){_Z_66.initializeBase(this),this._edit=t,this._isUpperCase=!1,this._letterTdList=[],this._okButtonText="确认|关闭"},_Z_66.prototype={dispose:function(){this._clearContents(),_Z_66.callBaseMethod(this,"dispose")},_clearContents:function(){this._table&&$clearHandlers(this._table)},get_value:function(t){for(var e=this._edit.control.getKeyList(),i=t.split(""),s=[],o=0,n=i.length;o<n;o++){var r=i[o],a=r.charCodeAt(0),l=!1;a>64&&a<91&&(r=r.toLowerCase(),l=!0);var h=Array.indexOf(e,r);if(32==a&&(h=e.length),-1==h)throw Error.abort("<p>您输入的密码包含中文或其它不支持的特殊字符</p><p>请按软键盘上给定的字符重新录入</p>");var d=Math.floor(h/10)+","+h%10;l&&(d+=",0"),s.push(d)}return s.join(".")},refresh:function(){return this._clearContents(),$removeNode(this._table),this.render()},render:function(){var t=this._edit.control.get_keyboardData(),e=t.substr(0,10),i=t.substr(10,26),s=t.substr(36),o=this._table=$common.createPopupTable(0,0);o.rules="",o.style.borderCollapse="",o.style.left="-20000px",o.style.top="-20000px",document.body.appendChild(o),$common.initPopupElement(o,!0,!1),$Dom.addCssClass(o,"SoftKeyboardPopup");for(var n,r=$common.createTBody(),a=e.length,l=0;l<a;l++){(_=l%10==0)&&(n=$common.createTr()),this._addButton(n,e[l],"Number"),_&&r.appendChild(n)}this._createEmptyLine(r),a=i.length;for(l=0;l<a;l++){(_=l%10==0)&&(n=$common.createTr());var h=l<a?i[l]:"",d=this._addButton(n,h,"Letter");this._letterTdList.push(d),_&&r.appendChild(n)}this._addButton(n,"Space","Letter",4),this._createEmptyLine(r),a=s.length;for(l=0;l<a;l++){var _=l%10==0;_&&(n=$common.createTr());h=l<a?s[l]:"";this._addButton(n,h,"Symbol"),_&&r.appendChild(n)}return this._addButton(n,"Shift","FN",2,"切换大小写"),this._addButton(n,"Delete","FN",2,"倒数逐位删除"),this._addButton(n,this._okButtonText,"OK",4),r.appendChild(n),o.appendChild(r),$common.addMouseDownHandler(o,this.onPopupMouseDown,this),$common.addClickHandler(o,this._buttonsClick,this),o.control=this,o},_createEmptyLine:function(t){var e=$common.createTr();this._addButton(e," ","Line",10),t.appendChild(e)},_addButton:function(t,e,i,s,o){var n=$common.createTd();return s&&(n.colSpan=s),""!=e&&(n.innerText=e,n.className="SoftKeyboardButton SoftKeyboard_"+i),n.title=o||e,t.appendChild(n),n},onPopupMouseDown:function(t){t.cancel()},_buttonsClick:function(t){t.cancel();var e=t.target;if("TD"==e.tagName){var i=e.innerHTML;if(""!=i){var s=this._edit.control;switch(s&&s.focus(!1),i){case"Shift":this._onShiftButtonPressed();break;case"Delete":this._onBackButtonPressed();break;case this._okButtonText:this._onOkButtonPressed();break;default:this._onKeyButtonPressed(e)}}}},_onShiftButtonPressed:function(){if(0!=this._letterTdList.length)for(var t=this._isUpperCase=!this._isUpperCase,e=0,i=this._letterTdList.length;e<i;e++){var s=this._letterTdList[e],o=s.innerHTML;o=t?o.toUpperCase():o.toLowerCase(),s.innerHTML=o}},_onBackButtonPressed:function(){var t=this._edit.value;t=t.substring(0,t.length-1),this._edit.value=t},_onOkButtonPressed:function(){var t=this._edit.control;t.closeUp&&t.closeUp()},_onKeyButtonPressed:function(t){var e=t.innerText;e="Space"==e?" ":e;var i=this._edit.value;i+=e,this._edit.value=i,this._edit.control.set_caretPos(i.length)}},_Z_66.registerClass("_Z_66",_Z_242),Sys.UI.Controls.HiddenField=function(t){Sys.UI.Controls.HiddenField.initializeBase(this,[t]),this._value=null,this.get_outerElement=!1},Sys.UI.Controls.HiddenField.prototype={initEditor:function(){},canFocus:function(){return!1},get_visible:function(){return!0},set_visible:function(){},get_value:function(){return this._value},set_value:function(t){this._value=t,this.get_element().value&&(this.get_element().value=t)}},Sys.UI.Controls.HiddenField.registerClass("Sys.UI.Controls.HiddenField",_Z_233),Sys.UI.Controls.TextLabel=function(t){Sys.UI.Controls.TextLabel.initializeBase(this,[t])},Sys.UI.Controls.TextLabel.prototype={canFocus:function(){return!1},get_isTextEdit:function(){return!1},get_text:function(){return this.get_element().value},set_text:function(t){t=$common.clearHTMLTag(t);Sys.UI.Controls.TextLabel.callBaseMethod(this,"set_text",[t]),$common._doEditHint(this.get_element(),this._hint)}},Sys.UI.Controls.TextLabel.registerClass("Sys.UI.Controls.TextLabel",_Z_233),Sys.UI.Controls.FileEdit=function(t){Sys.UI.Controls.FileEdit.initializeBase(this,[t]),this._btnText="选择文件","true"==t.getAttribute("multiple")&&(this._btnText="多选文件",this._multiple=!0)},Sys.UI.Controls.FileEdit.prototype={initialize:function(){Sys.UI.Controls.FileEdit.callBaseMethod(this,"initialize"),this._resetStyle(),this._initPasteHandle()},_showNullDisplayValue:function(t){this._hasText||(this._fileName.innerText=t)},_removeNullText:function(){this._hasText||(this._fileName.innerText="")},_initPasteHandle:function(){this.get_events().getHandler("_paste")&&$addHandler(document,"paste",$createDelegate(this,this._doPaste))},_doPaste:function(t){var e=this.get_form();if(e&&e.get_isActive()&&this.get_enabled()){var i=t.rawEvent;if(i.clipboardData||i.originalEvent){var s=i.clipboardData||i.originalEvent.clipboardData;if(s.items){for(var o=s.items,n=o.length,r=null,a=0;a<n;a++)-1!==o[a].type.indexOf("image")&&(r=o[a].getAsFile());if(null!=r){var l=this.get_events().getHandler("_paste");if(l){var h={};if(l(this,h),h.saveAPI){var d=new FormData;if(d.append(this.get_idPart(),r,"clipboard.png"),"object"==typeof h.params)for(var _ in h.params)d.append(_,h.params[_]);$common.showUploading(),$common.ajax({url:h.saveAPI,data:d,complete:function(t){if($common.hideWaiting(),t.get_responseAvailable()){var e=t.get_statusCode();e>=200&&e<300?(result=t.get_responseData(),h.callback&&h.callback(result)):$common.showError("粘贴文件上传错误")}else $common.alert("粘贴文件上传失败")},ignoreHeader:["content-type"]})}}}}}}},_resetStyle:function(){var t=this.get_visible(),e=this.get_element(),i=e.parentNode,s=this._editor=$common.createDiv();e.offsetWidth>0&&(s.style.width=e.offsetWidth+"px",s.style.height=e.offsetHeight+"px",s.style.lineHeight=e.offsetHeight+"px"),s.style.display=t?"":"none",s.className="FileEditor";var o=this._btn=$common.createSpan();o.className="FileButton",o.innerText=this._btnText;var n=this._fileName=$common.createSpan();n.className="FileName ellipsis",s.appendChild(o),s.appendChild(n);var r=$common.getNextSibling(e);s.appendChild(e),r?i.insertBefore(s,r):i.appendChild(s)},get_outerElement:function(){return this._editor?this._editor:null},set_width:function(t){this.get_isInitialized()&&($common.setWidth(this._editor,t-2),Sys.UI.Controls.FileEdit.callBaseMethod(this,"set_width",[t]))},set_height:function(){this.get_isInitialized()&&($common.setHeight(this._editor,value),this._editor.style.lineHeight=value+"px",Sys.UI.Controls.FileEdit.callBaseMethod(this,"set_height",[value]))},getInputAction:function(){return"选择"},doChange:function(t){Sys.UI.Controls.FileEdit.callBaseMethod(this,"doChange",[t]);var e=this.get_value();if(e){this._hasText=!0;var i=e.split("\\"),s=i[i.length-1];this._fileName.innerText=s}else this._fileName.innerText="",this._hasText=!1},set_text:function(t){if(this.get_isInitialized()&&this.get_form()._allLoaded)if(this._fileName.innerText=t,""==t&&Sys.Browser.isIE){var e=this._element;$clearHandlers(e);var i=e.cloneNode(!0),s=e.parentNode;$removeNode(e),i.control=this,s.appendChild(i),this._changeHandler=$common.addChangeHandler(i,this.doChange,this),this._focusHandler=$common.addFocusHandler(i,this.doFocus,this),this._blurHandler=$common.addBlurHandler(i,this.doBlur,this),this._element=i,this._hasText=!1}else this._hasText=!0,Sys.UI.Controls.FileEdit.callBaseMethod(this,"set_text",[t])},set_buttonText:function(t){this._btnText=t,this.get_isInitialized()&&this._btn&&(this._btn.innerText=this._btnText)},get_buttonText:function(){return this._btnText},set_visible:function(t){var e=this.get_visible(),i=this._editor;e!=t&&(this._setControlAndLabelVisible(i,t),Sys.UI.Controls.FileEdit.callBaseMethod(this,"set_visible",[t]))},add_paste:function(t){this.get_events().addHandler("_paste",t)},remove_paste:function(t){this.get_events().removeHandler("_paste",t)}},Sys.UI.Controls.FileEdit.registerClass("Sys.UI.Controls.FileEdit",_Z_233),Sys.UI.Controls.FileUpload=function(t){Sys.UI.Controls.FileUpload.initializeBase(this,[t]),this._webMethodPath=null,this._frame=null,this._timeout=600,this._callerControl=null},Sys.UI.Controls.FileUpload.prototype={dispose:function(){this._clearTimer(),this._frame&&($clearHandlers(this._frame),this._frame=null),this._uploading=!1,$common.hideWaiting(),Sys.UI.Controls.FileUpload.callBaseMethod(this,"dispose")},get_webMethodPath:function(){return this._webMethodPath},set_webMethodPath:function(t){this._webMethodPath=t,this._isGspx=t.indexOf(".gspx")>0},get_timeout:function(){return this._timeout},set_timeout:function(t){this._timeout=t},_setControlEnabled:function(t){t?$common.hideWaiting():$common.showUploading();var e=this._callerControl;e&&e.set_enabled&&asyncCall(function(){e.get_isDisposed()||e.set_enabled(t)})},_internalSubmit:function(t,e,i,s){this._callerControl=t,this._onSuccess=e,this._onFaild=i;var o=this.get_form(),n=t.saveData?t.saveData():o.saveData(),r=this.get_element();s&&s(n);for(var a=0;a<r.elements.length;a++){var l=r.elements[a].control;if(l&&Sys.UI.Controls.FileEdit.isInstanceOfType(l)){h=l.get_dataField();l._multiple?n[h]="true":delete n[h]}}r.setAttribute("action",this._webMethodPath);var h;(h=r._dataField).value=escape($crabaJSON.serialize(n)),this._frame||(this._frame=$get(r.target),$addHandler(this._frame,"load",$createDelegate(this,this._succeeded))),this._setControlEnabled(!1),this._clearTimer(),this._timeout>0&&(this._timer=setTimeout($createDelegate(this,function(){this._fail("上传超时 ("+this._timeout+"秒)")}),1e3*this._timeout));try{this._uploading=!0,r.submit()}catch(_){var d=_.message?_.message:_+"上传失败";this._fail(d)}},_postFormData:function(t,e,i,s,o){var n=this.get_element();t.saveData&&t.saveData();var r={};s&&s(r);var a=new FormData(n);a["delete"]&&a["delete"]("_dataField");for(var l in r)a.append(l,r[l]);var h=this;h._setControlEnabled(!1),$common.ajax({url:this._webMethodPath,data:a,complete:function(s){h._setControlEnabled(!0);var o=s.get_statusCode();if(0!=o)s.get_responseAvailable()?o>=200&&o<300?e(t,s.get_object(),o):i&&i(t,s.get_object(),o):i&&i(t);else{i?i(t,"上传文件失败，请重新打开界面再试。",o):$common.alert("上传文件失败，请重新打开界面再试。")}},headers:o,ignoreHeader:["content-type"]})},_clearTimer:function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},_succeeded:function(t){if(this._uploading){this._uploading=!1,this._setControlEnabled(!0),this._clearTimer();var e,i=this._frame,s=null;if(i.contentWindow)try{e=i.contentWindow.document}catch(n){s="上传文件失败，请重新打开界面再试。"}else e=i.contentDocument?i.contentDocument:window.frames[i.id].document;if(s)this._doFail(s);else if(e.location.href){var o=this._getResult(e.body.innerHTML,e);null==o?this._doFail("上传文件后服务端返回的数据解析失败：同时三方插件和数据包含html标签才导致。"):"object"==typeof o&&o.ExceptionType?this._doFail(o.Message):this._onSuccess?this._onSuccess(this._callerControl,o):$common.alert(o)}else this._doFail()}else this._clearTimer()},_getResult:function(t,e){var i=null;if(this._isGspx)i=t;else{var s=t.replace(/<\/?[^>]+>/g,"");if(s&&s.indexOf("<html")<0)try{i=$crabaJSON.deserialize(s)}catch(o){return e?this._getResult(e.body.firstChild.wholeText):null}}return i},_fail:function(t){this._doFail(t),this._setControlEnabled(!0)},_doFail:function(t){this._uploading=!1,"Maximum request length exceeded."!=t&&"超过了最大请求长度。"!=t||(t="文件大小超过了系统允许的范围。"),this._onFaild?this._onFaild(this._callerControl,t):$common.alert(t||"上传失败")},set_visible:function(t){var e=this.get_visible(),i=this.get_element();if(e!=t&&i){var s=i.parentNode;if(s&&s.getAttribute("_vert")){var o=s.parentNode;o&&"TR"==o.tagName&&$Dom.setVisible(o,t)}}Sys.UI.Controls.FileUpload.callBaseMethod(this,"set_visible",[t])}},Sys.UI.Controls.FileUpload.registerClass("Sys.UI.Controls.FileUpload",Sys.UI.Control),$uploader=Sys.UI.Controls.FileUpload.submit=function(t,e,i,s,o){var n=$common.getFirstParentByTagName(t.get_element(),"form");if(!n)throw Error.invalidOperation("提交按钮必须放在 FileUpload 标签内");var r=n.control;if(!r)throw Error.invalidOperation(n.outerHTML+" 没有对应的 FileUpload 标签");o?r._postFormData(t,e,i,s,o):r._internalSubmit(t,e,i,s)},Sys.UI.Controls.MultiFileUpload=function(t){Sys.UI.Controls.MultiFileUpload.initializeBase(this,[t]),this._allowDelete=!0,this._allowShowPopup=!0,this._fileCount=0,this._btnList=[],this._maxSize=10,this._errCount=0,this._clientMaxSize=10,this._maxFileCount=-1,this._uploadCount=0},Sys.UI.Controls.MultiFileUpload.prototype={dispose:function(){Sys.UI.Controls.MultiFileUpload.callBaseMethod(this,"dispose"),this._popup&&(this._popup.dispose(),this._popup=null);for(var t=0;t<this._btnList.length;t++)$clearHandlers(this._btnList[t])},doFormLoaded:function(){if(!this.get_isDisposed())try{this.set_instanceId()}catch(e){this._errCount++;var t=this;setTimeout(function(){t.doFormLoaded()},300)}},doFormDeactivate:function(){this.hidePopup()},set_instanceId:function(){var t=this.get_id();this._getFlash().set_instanceId(t),window[t]=this,$debug.consoleLog(t+"，初始化成功，失败次数:"+this._errCount),this.doFlashLoaded(),this._queryParams&&this._initQueryParams(),this._initFlashWidth(this.get_width()),this._initFlashHeight(this.get_height())},doFlashLoaded:function(){this._loaded=!0,$Dom.removeNode(this._element.lastChild);var t=this.get_events().getHandler("_loaded");t&&t(this)},_initFlashHeight:function(t){this._getFlash().setHeight(t),this._getFlash().setAttribute("height",t)},_initFlashWidth:function(t){this._getFlash().setWidth(t),this._getFlash().setAttribute("width",t)},set_width:function(t){t=Sys.UI.Controls.MultiFileUpload.callBaseMethod(this,"set_width",[t]),this._loaded&&this._initFlashWidth(t)},set_height:function(t){t=Sys.UI.Controls.MultiFileUpload.callBaseMethod(this,"set_height",[t]),this._loaded&&this._initFlashHeight(t)},set_maxFileCount:function(t){this._maxFileCount=t,this._loaded&&this._getFlash().setMaxFileCount(t)},get_maxFileCount:function(){return this._maxFileCount},set_uploadCount:function(t){this._uploadCount=t,this._loaded&&this._getFlash().setUploadCount(t)},get_uploadCount:function(){return this._uploadCount},_getFlash:function(){if(this._flash)return this._flash;var t=this.get_element(),e=t.firstChild.firstChild;return e||(alert("正在初始化，点确定继续"),e=t.firstChild.firstChild),(Sys.Browser.isChrome||Sys.Browser.isFirefox||Sys.Browser.isIE11)&&(e=$common.getChildByTagName(e,"embed",0)),this._flash=e},hidePopup:function(){this._popup&&this._popup.hide()},showPopup:function(t){var e=this._popup;e&&(t&&e.isShow()?this.hidePopup():e.popupAt(this))},_initMultiPopup:function(){if(!this._popup){var t=this._popup=new Sys.UI.Controls.Popup(this),e=this._popupWindow=$common.createClassDiv("multi_popup");t.set_element(e),this.add_rightIconClick(this.showPopup,this),this._createRightButton();var i=$common.createClassDiv("header");this._createItemSpan(i,"文件名","title col1"),this._createItemSpan(i,"文件大小","title col2"),this._createItemSpan(i,"状态","title col3"),e.appendChild(i)}},_createItemSpan:function(t,e,i,s){var o=$common.createClassSpan(i);return o.innerHTML=e,t.appendChild(o),s&&($common.addClickHandler(o,s,this),this._btnList.push(o)),o},_createFileItem:function(t){var e=t.id,i=t.fileName,s=t.fileSize,o=t.allowUpload,n=$common.createClassDiv("item"),r=Math.roundTo(s/1024,1),a=r+"kb";r>1024&&(a=(r=Math.roundTo(r/1024,1))+"MB");var l=this._createItemSpan(n,i,"name col1 ellipsis",this._doFileNameClick),h=(this._createItemSpan(n,"("+a+")","size col2"),this._createItemSpan(n,"("+a+")","process")),d=this._createItemSpan(h,"","processValue"),_=this._createItemSpan(n,i,"status col3");if(this._allowDelete){var c=this._createItemSpan(n,"","Button iconfont icononly del",this._doDeleteFileItem);o&&(c.fileId=e)}o?(h.style.display="inline-block",l.id="fileName_"+e,d.id="processStep_"+e,_.id="processValue_"+e,_.innerText="0%"):(h.style.display="none",_.innerText="超出允许大小"+this.get_maxSize()+"MB"),this._popupWindow.appendChild(n)},_doDeleteFileItem:function(t){t.cancel();var e=t.target,i=e.parentNode,s=i.fileUrl;if(s){var o=this.get_events().getHandler("_deleted");o&&o(this,s),this._getFlash().addUploadCount(-1)}else{var n=e.fileId;n&&(this._fileCount--,this._getFlash().abortUpload(n))}Array.remove(this._btnList,e),$clearHandlers(e),$removeNode(i)},_doFileNameClick:function(t){t.cancel();var e=t.target.getAttribute("_src");e&&window.open(e)},onUploaderBeforeSelect:function(){var t=this.get_events().getHandler("_beforeSelect");t&&t(this)},onUploaderSelect:function(t){if(this.focus(),0!=t.length){for(var e=1048576*parseFloat(this._clientMaxSize),i=0,s=t.length;i<s;i++){if((n=t[i]).fileSize>e)return $common.showHint(n.fileName+"超过限制大小,最大允许:"+e/1024+"kb",this,4),void this._getFlash().abortUpload(n.id)}this._allowShowPopup&&(this._initMultiPopup(),this.showPopup());var o=this.get_events().getHandler("_startPost");o&&o(this,t);for(i=0;i<t.length;i++){var n=t[i];n.allowUpload&&this._fileCount++,this._allowShowPopup&&this._createFileItem(n)}}},onUploaderProgress:function(t){if(this._allowShowPopup){var e=t.id,i=$get("processValue_"+e),s=$get("processStep_"+e);if(null!=i&&null!=s){var o=Math.roundTo(t.uploadedSize/t.fileSize*100,2)+"%";i.innerText=o,s.style.width=o}}},onUploaderComplete:function(t,e){try{e?(e=(e=e.data).replace(/\r\n/g,""),e=$crabaJSON.deserialize(e)):e={}}catch(o){return void $common.showTips("文件上传成功，但客户端序列化返回的json字符串失败。")}finally{if(this._fileCount--,this._refreshComplete(t,e))return}var i=this.get_events().getHandler("_completed");if(i&&!e.ExceptionType&&i(this,e),this._fileCount<1){var s=this.get_events().getHandler("_finished");s&&s(this)}},_refreshComplete:function(t,e){var i=this._getFailMessage(e);if(i)return this.onUploaderHTTPError(t,i),!0;if(this._allowShowPopup){var s=t.id,o=$get("processValue_"+s),n=$get("processStep_"+s);if(o&&(n.parentNode.style.display="none",o.parentNode.fileUrl=e,o.className="status col3",o.innerText="100%",o.id=n.id="",e)){var r;if("object"==typeof e&&e.realPath)r=e.realPath;else{if("string"!=typeof e)return;r=e}var a="<img src='"+r+"' class='MultiPreviewImage'></img>",l=$get("fileName_"+s);l.title=a,l.setAttribute("_src",r)}}},_getFailMessage:function(t){return"string"!=typeof t?t.Message?t.Message:"":t.indexOf("Maximum")>-1||t.indexOf("超过了")>-1?"文件太大":""},onUploaderHTTPError:function(t,e){if(!this._allowShowPopup){var i="上传出错";return"string"==typeof e?i+=":"+e:e.text?i+=":"+e.text+","+e.type:e.message&&(i+=":"+e.message),$common.showTips(i)}var s="string"==typeof e?e:"上传出错:flash"+e.text,o=t.id,n=$get("processValue_"+o),r=$get("processStep_"+o);n&&(n.className="status col3 ellipsis",n.id=r.id="",r.parentNode.style.display="none",n.innerText=s,n.title=s,n.style.color="red")},onMaxFileCount:function(t,e,i){$common.showHint("您选择了"+i+"个文件，还允许上传"+(t-e)+"个文件.",this,4)},focus:function(){},get_queryParams:function(){return this._queryParams},set_queryParams:function(t){this._queryParams=t,this.get_isInitialized()&&this._initQueryParams()},_initQueryParams:function(){var t=this._getFlash(),e=$crabaJSON.serialize(this._queryParams);"null"!=e&&"{}"!=e||(e=""),t.setParams(e)},get_allowDelete:function(){return this._allowDelete},set_allowDelete:function(t){this._allowDelete=t},get_buttonText:function(){return this._buttonText},set_buttonText:function(t){if(this._buttonText=t,this.get_isInitialized()){this.get_element().firstChild.lastChild.innerHTML=t}},set_buttonColor:function(t){try{this.get_element().style.color=t}catch(e){}},get_maxSize:function(){return this._maxSize},set_maxSize:function(t){this._maxSize=t},get_clientMaxSize:function(){return this._clientMaxSize},set_clientMaxSize:function(t){this._clientMaxSize=t},get_webMethodPath:function(){return this._webMethodPath},set_webMethodPath:function(t){this._webMethodPath=t},get_maxFileCount:function(){return this._maxFileCount},set_maxFileCount:function(t){this._maxFileCount=t},get_allowShowPopup:function(){return this._allowShowPopup},set_allowShowPopup:function(t){this._allowShowPopup=t},add_loaded:function(t){this.get_events().addHandler("_loaded",t)},remove_loaded:function(t){this.get_events().removeHandler("_loaded",t)},add_failLoad:function(t){this.get_events().addHandler("_failLoad",t)},remove_failLoad:function(t){this.get_events().removeHandler("_failLoad",t)},add_beforeSelect:function(t){this.get_events().addHandler("_beforeSelect",t)},remove_beforeSelect:function(t){this.get_events().removeHandler("_beforeSelect",t)},add_completed:function(t){this.get_events().addHandler("_completed",t)},remove_completed:function(t){this.get_events().removeHandler("_completed",t)},add_finished:function(t){this.get_events().addHandler("_finished",t)},remove_finished:function(t){this.get_events().removeHandler("_finished",t)},add_startPost:function(t){this.get_events().addHandler("_startPost",t)},remove_startPost:function(t){this.get_events().removeHandler("_startPost",t)},add_delete:function(t){this.get_events().addHandler("_deleted",t)},remove_delete:function(t){this.get_events().removeHandler("_deleted",t)}},Sys.UI.Controls.MultiFileUpload.registerClass("Sys.UI.Controls.MultiFileUpload",Sys.UI.Controls.Button),Sys.UI.Controls.MemoEdit=function(t){Sys.UI.Controls.MemoEdit.initializeBase(this,[t]),this._tabOnEnter=!1,this._isPercentWidth=!1},Sys.UI.Controls.MemoEdit.prototype={initialize:function(){if(Sys.UI.Controls.MemoEdit.callBaseMethod(this,"initialize"),this._isPercentWidth&&this.get_visible()){var t=this.get_element(),e=t.offsetWidth-4;Sys.Browser.isIE&&(e-=15),t.style.width=e+"px"}},_refreshEditHint:function(){},get_isPercentWidth:function(){return this._isPercentWidth},set_isPercentWidth:function(t){this._isPercentWidth=t},doKeyPress:function(t){var e=!0,i=this._maxLength;if(i>0){this._getLength()+1>i&&(e=!1)}e?_Z_101.callBaseMethod(this,"doKeyPress",[t]):t.preventDefault()},doPaste:function(t){if(_Z_101.callBaseMethod(this,"doPaste",[t]),window.clipboardData&&!(Sys.Browser.isIE&&Sys.Browser.version>9)){var e=this._maxLength;if(e>0){var i=window.clipboardData.getData("Text");if(i){this._getLength()+i.length>e&&t.cancel()}}}},_getLength:function(){var t=this.get_selectionText();return this.get_elementValue().length-t.length}},Sys.UI.Controls.MemoEdit.registerClass("Sys.UI.Controls.MemoEdit",_Z_101),_Z_235=function(t){_Z_235.initializeBase(this,[t]),this._requireClick=!0,this._requireKeyUp=!1,this._requireMouseUp=!1,this._checked=!1},_Z_235.prototype={initialize:function(){_Z_235.callBaseMethod(this,"initialize"),this._readOnly&&this.set_enabled(!1)},updated:function(){var t=this.get_langText();null!==t&&(this._labelLang?this.set_label(t):this.set_text(t))},get_value:function(){return this.get_checked()},set_value:function(t){"0"==t&&(t=!1),this.set_checked(t),this._oldChecked=t},get_textElement:function(){var t=this.get_id();return t?$get(t+"_text"):null},get_text:function(){var t="",e=this.get_textElement();if(e&&(t=e.innerHTML),t)return t;var i=this.get_labelElement();return i?i.innerHTML:""},set_text:function(t){if(this.get_isInitialized()){var e=this.get_textElement();if(e||(e=this.get_labelElement()),!e){(e=document.createElement("label")).id=this.get_id()+"_text",e.className="FlowLabel",e.setAttribute("for",this.get_id());var i=this.get_element().parentNode.parentNode,s=$common.createTd();i.appendChild(s),s.appendChild(e)}e.innerHTML=t}},get_reportText:function(){return this.get_checked()?"√":"×"},get_checked:function(){var t=this.get_element();return t?t.checked:this._checked},set_checked:function(t){this._checked=t,this._oldChecked=t;var e=this.get_element();e&&(e.checked=t,$common._changeCheckedHalfStyle(e.parentNode,t,2===t))},set_visible:function(t){_Z_233.callBaseMethod(this,"set_visible",[t]);this.get_element().parentNode.style.display=t?"":"none"},get_outerElement:function(){return this._element.parentNode},get_readOnly:function(){return!this.get_enabled()},set_readOnly:function(t){this._readOnly=t,this.get_isInitialized()&&this.set_enabled(!t)},doSetEnabled:function(t){$Dom.setEnabled(this.get_outerElement(),t)},_setControlAndLabelVisible:function(t,e){var i=this.get_textElement();i||(i=this.get_labelElement()),i&&(i._oldDisplayMode="inline-block"),_Z_235.callBaseMethod(this,"_setControlAndLabelVisible",[t,e])}},_Z_235.registerClass("_Z_235",_Z_233),Sys.UI.Controls.BadgeButton=function(t){Sys.UI.Controls.BadgeButton.initializeBase(this,[t]),this._max=99},Sys.UI.Controls.BadgeButton.prototype={initialize:function(){Sys.UI.Controls.BadgeButton.callBaseMethod(this,"initialize"),this._createBadge(),this._initValue()},get_value:function(){return this._value},set_value:function(t){isNaN(parseInt(t))||(t=parseInt(t)),this._value=t,this._initValue(!0)},get_isDot:function(){return this._isDot},set_isDot:function(t){this._isDot=t,this._initValue(!0)},get_max:function(){return this._max},set_max:function(t){this._max=t,this._initValue(!0)},_createBadge:function(){var t=this._badgeSpan=$common.createSpan();this._element.appendChild(t)},_initValue:function(t){if(!t||this.get_isInitialized()){var e=this._badgeSpan;if(this._isDot)return e.innerHTML="",void(e.className="BadgeDot");var i=this._value;e.className="BadgeValue","number"==typeof i&&i>this._max&&(e.title=i,i=this._max+"+"),Object.isUndefinedOrNull(i)?$dom.addCssClass(e,"dnone"):($dom.removeCssClass(e,"dnone"),e.innerHTML=i)}}},Sys.UI.Controls.BadgeButton.registerClass("Sys.UI.Controls.BadgeButton",Sys.UI.Controls.Button),Sys.UI.Controls.SwitchButton=function(t){Sys.UI.Controls.SwitchButton.initializeBase(this,[t]),this._checked=!$settings.SwitchButtonCheckedValue,this._requireClick=!0,this._checkedValue=$settings.SwitchButtonCheckedValue},Sys.UI.Controls.SwitchButton.prototype={initialize:function(){Sys.UI.Controls.SwitchButton.callBaseMethod(this,"initialize"),this._createBtn()},_createBtn:function(){var t=this._element,e=this._btn=$common.createClassDiv("SwitchBlock");t.appendChild(e)},get_owner:function(){return this.column?this.column.get_grid():null},get_column:function(){return this.column},get_isInPlace:function(){return this._isInPlace},set_isInPlace:function(t){this._isInPlace=t},set_checkedValue:function(t){this._checkedValue=t},get_checkedValue:function(){return this._checkedValue},get_dataField:function(){return this._dataField},set_dataField:function(t){this._dataField=t},dataBind:function(t){var e=this._dataField;if(e){var i=this.get_form().get_dataController(),s=t?t[e]:i.getValue(e);this.set_value(s),this.doDataBind()}},doSaveData:function(){var t=this._dataField;if(t){t.indexOf(".")>-1&&(t=(t=t.split("."))[t.length-1]);this.get_form().get_dataController().setValue(t,this.get_value())}},get_value:function(){return this.get_checked()},set_value:function(t){t=Boolean.convert(t),this.set_checked(t)},get_text:function(){return this._text},set_text:function(t){if(t){if(t.indexOf(",")<0)throw Error.argument("text","值必须是以逗号分隔的字符串");this._text=t,this._initText()}},get_checked:function(){return this._checked},set_checked:function(t){this._checked=t,this._initText();var e=this._checked==this._checkedValue;$common._changeCheckedStyle(this._element,e)},_changeChecked:function(t){this.set_checked(t),this.doChange()},_initText:function(){if(this._text){this._textSpan||(this._textSpan=$common.createSpan(),this._textSpan.className="SwitchText",this._element.appendChild(this._textSpan),$dom.addCssClass(this._element,"hasText"));var t=this._checked==this._checkedValue,e=this._text.split(","),i=t?e[1]:e[0];this._textSpan.innerHTML=i,this._textSpan.title=i}},doClick:function(t){this.set_checked(!this._checked),this.doChange(),Sys.UI.Controls.SwitchButton.callBaseMethod(this,"doClick",[t])},doChange:function(){var t=this.get_events().getHandler("_change");if(t){var e=new _Z_162;if(t(this,e),e.get_cancel()){var i=!this._checked;this.set_checked(i),this.get_column()&&(this.get_column()._lastValue=i,this.get_column()._changed=!0)}}},add_change:function(t,e){this.get_events().addHandler("_change",t,e)},remove_change:function(t){this.get_events().removeHandler("_change",t)}},Sys.UI.Controls.SwitchButton.registerClass("Sys.UI.Controls.SwitchButton",_Z_249),Sys.UI.Controls.CheckBox=function(t){Sys.UI.Controls.CheckBox.initializeBase(this,[t]),this._disableChangeHandler=!0},Sys.UI.Controls.CheckBox.prototype={_changeChecked:function(t){this.set_checked(t),this.doChange()},doClick:function(t){_Z_235.callBaseMethod(this,"doClick",[t]),this.get_checked()!=this._oldChecked&&(this._oldChecked=this.get_checked(),this.doChange(t),$common._changeCheckedStyle(this._element.parentNode,this.get_checked()))}},Sys.UI.Controls.CheckBox.registerClass("Sys.UI.Controls.CheckBox",_Z_235),Sys.UI.Controls.RadioButton=function(t){Sys.UI.Controls.RadioButton.initializeBase(this,[t])},Sys.UI.Controls.RadioButton.prototype={doChange:function(t){Sys.UI.Controls.RadioButton.callBaseMethod(this,"doChange",[t]),$common._resetRadioGroupChecked(this._element)},set_checked:function(t){this._checked=t;var e=this.get_element();e&&(e.checked=t,$common._resetRadioGroupChecked(e))},get_radio:function(){var t=this.get_element().getAttribute("name");if(!t)return null;for(var e=document.getElementsByName(t),i=0,s=e.length;i<s;i++){var o=e[i];if(o.checked)return o.control}return null}},Sys.UI.Controls.RadioButton.registerClass("Sys.UI.Controls.RadioButton",_Z_235),_Z_67=function(t,e){e=e||"aicon-moreunfold",_Z_67.initializeBase(this,[t,e])},_Z_67.prototype={doMouseUp:function(t){_Z_67.callBaseMethod(this,"doMouseUp",[t]);this.get_control().toggleDroppedDown()},doMouseDown:function(t){_Z_67.callBaseMethod(this,"doMouseDown",[t]),t.preventDefault(),$craba.raiseMouseDown(t)},doClick:function(t){_Z_67.callBaseMethod(this,"doClick",[t]),t.stopPropagation()}},_Z_67.registerClass("_Z_67",_Z_63),_Z_28=function(){throw Error.notImplemented()},_Z_28.prototype={_float:0,positiveFloat:1,_int:2,positiveInt:3},_Z_28.registerEnum("_Z_28"),_Z_68=function(t,e){e=e||"aicon-icon--",_Z_68.initializeBase(this,[t,e]),$common.addContextMenuHandler(this.get_element(),this._doContextMenu,this)},_Z_68.prototype={doMouseUp:function(t){if(_Z_68.callBaseMethod(this,"doMouseUp",[t]),0==t.button){this.get_control().toggleDroppedDown()}},_doContextMenu:function(t){t.cancel()},doMouseDown:function(t){_Z_68.callBaseMethod(this,"doMouseDown",[t]),t.preventDefault(),$craba.raiseMouseDown(t)},doClick:function(t){_Z_68.callBaseMethod(this,"doClick",[t]),t.stopPropagation()}},_Z_68.registerClass("_Z_68",_Z_63),_Z_69=function(t,e){_Z_69.initializeBase(this,[t,e])},_Z_69.registerClass("_Z_69",_Z_68),Sys.UI.Controls.NumberEdit=function(t){Sys.UI.Controls.NumberEdit.initializeBase(this,[t]),this._requireKeyDown=!0,this._requireKeyPress=!0,this._requireInput=!0,this._numberType=_Z_28._float,this._decimalDigits=0,this._decimalPrecision=0,this._decimalScale=-1,this._defaultValue=null,this._displayZeroToDigits=$settings.DisplayZeroToDigits,this._showCalculator=$settings.NumberEditDefaultShowCalculator,this._displayThousandSeperator=!1,this._increment=1,this._useSpin=!0},Sys.UI.Controls.NumberEdit.prototype={initialize:function(){Sys.UI.Controls.NumberEdit.callBaseMethod(this,"initialize"),$common.disableIme(this.get_element());var t=this.get_decimalPrecision();if(t>0){var e=t+1,i=this.get_numberType();i!=_Z_28._float&&i!=_Z_28._int||e++,this.set_maxLength(e)}},dispose:function(){this._calculatorPopup&&(this._calculatorPopup.dispose(),this._calculatorPopup=null),Sys.UI.Controls.NumberEdit.callBaseMethod(this,"dispose")},set_clickOnly:function(t){this._clickOnly=t},get_clickOnly:function(){return this._clickOnly},_getAllowHandInput:function(){return!this._clickOnly},set_stepButton:function(t){this._stepButton=t},get_stepButton:function(){return this._stepButton},get_increment:function(){return this._increment},set_increment:function(t){this._increment=t},set_useSpin:function(t){this._useSpin=t},get_useSpin:function(){return this._useSpin},incValue:function(){if(!this.get_readOnly()||this._selectOnly){var t=Number.parse(this.get_value());if(isNaN(t))t=this.get_increment();else{var e=t.toString().split(".");2==e.length?t=parseInt(e[0])+this.get_increment()+Number("0."+e[1]):t+=this.get_increment()}this.set_value(t),this.doChange()}},decValue:function(){if(!this.get_readOnly()||this._selectOnly){var t=Number.parse(this.get_value());if(isNaN(t))t=-1*this.get_increment();else{var e=t.toString().split(".");2==e.length?t=parseInt(e[0])-this.get_increment()+Number("0."+e[1]):t-=this.get_increment()}var i=this.get_numberType();(i==_Z_28.positiveFloat||i==_Z_28.positiveInt)&&t<0&&(t=0),this.set_value(t),this.doChange()}},get_displayThousandSeperator:function(){return this._displayThousandSeperator},set_displayThousandSeperator:function(t){this._displayThousandSeperator=t},get_elementValue:function(){var t=Sys.UI.Controls.NumberEdit.callBaseMethod(this,"get_elementValue");return this._displayThousandSeperator?t.replace(/,/gi,""):t},set_elementValue:function(t){this._displayThousandSeperator&&(t=$common.formatNumber(Number(t),this.get_decimalDigits(),this.get_decimalScale(),!0,!1,this.get_displayZeroToDigits())),Sys.UI.Controls.NumberEdit.callBaseMethod(this,"set_elementValue",[t])},doFocus:function(t){this.get_droppedDown()||(Sys.UI.Controls.NumberEdit.callBaseMethod(this,"doFocus",[t]),this._displayThousandSeperator&&Sys.UI.Controls.NumberEdit.callBaseMethod(this,"set_elementValue",[this.get_elementValue()]))},doBlur:function(t){e=this.get_elementValue();if(!this.get_droppedDown()&&(Sys.UI.Controls.NumberEdit.callBaseMethod(this,"doBlur",[t]),this._displayThousandSeperator)){var e;(e=this.get_elementValue())&&(e=$common.formatNumber(Number(e),this.get_decimalDigits(),this.get_decimalScale(),!0,!1,this.get_displayZeroToDigits()),Sys.UI.Controls.NumberEdit.callBaseMethod(this,"set_elementValue",[e]))}},_initButtons:function(){if(this.get_stepButton()){this.addButton(new _Z_86(this,"aicon-zengjia add stepNum")),this.addButton(new _Z_85(this,"aicon-jian jian stepNum"));var t=this.get_element();$dom.addCssClass(t.parentNode,"stepBlock");var e=t.parentNode.lastChild;t.parentNode.insertBefore(e,t)}else this._showCalculator&&this.addButton(new _Z_68(this))},set_showEmpty:function(t){this._showEmpty=t},get_showEmpty:function(){return this._showEmpty},set_defaultValue:function(t){this._defaultValue=t},get_defaultValue:function(){return this._defaultValue},createPopupWindow:function(){return(this._calculatorPopup=new _Z_70(this.get_element())).set_maxLength(this.get_maxLength()),this._calculatorPopup.render()},doInitPopup:function(){var t=this._calculatorPopup;if(t){var e=this.get_text();t.set_text(e),this.set_caretPos(e.length),this._saveValue=this.get_value();var i=this._popupWindow;$Dom.setVisible(i,!0),this._initPopupWindowPosition()}},_setPopupPosition:function(t,e,i){var s=this._popupWindow;i.width>s.offsetWidth&&(t=t+i.width+20-s.offsetWidth),s.style.left=t+"px",s.style.top=(this.get_column()?e+1:e)+"px"},doCloseUp:function(){Sys.UI.Controls.NumberEdit.callBaseMethod(this,"doCloseUp");var t=this._calculatorPopup;if(t){var e=this._saveValue,i=t.get_value();if(isNaN(i)&&(i=null),i!=e){if(null!=i){var s=this.get_numberType();if(s==_Z_28._int||s==_Z_28.positiveInt)i=parseInt(i),s==_Z_28.positiveInt&&(i=Math.abs(i));else{var o=this._formatValue(i);i=parseFloat(o)}}this.set_value(i),this.doChange()}else this.set_value(i)}},get_value:function(t){return this._textChanging?this.get_text():this._replaceText&&this._value!==undefined?this._value:this.doGetValue(t)},_initOldValue:function(t){var e=this.get_elementValue();e||(e=null),Object.isUndefinedOrNull(this._defaultValue)||(e=this._defaultValue),this._oldValue=e},doGetValue:function(t){var e=this.get_text();if(this.get_decimalDigits()>8||this.get_decimalScale()>8)return e;if(e>Number.MAX_SAFE_INTEGER)return e;if(this._bindReadOnlyString)return e;if(!this.allowFormat()&&this._oldValue==e)return e;var i=t?0:null;if(Object.isUndefinedOrNull(this._defaultValue)||(i=this._defaultValue),e){var s=e,o=i;if((e=this._trimNumber(e))&&(o=parseFloat(e)),0==o&&(e="0"),this.get_decimalDigits()>0)e=this._formatValue(o),o=parseFloat(e);else if(null!=o){var n=o.toString();-1==n.indexOf("e")&&(e=n)}if(this.get_decimalPrecision()>0){var r=this.get_decimalPrecision();e.indexOf("-")>-1&&r++,e.indexOf(".")>-1&&r++,e=e.substr(0,r)}return e!=s&&(this.set_text(e),this.set_caretPos(0),this.notifyChanged()),o}var a=this.get_minValue();return null==a||null!=i||this._showEmpty?null!=i&&this.set_text(i):(i=a,this.set_text(a)),i},_trimNumber:function(t){for(var e="",i=this.get_numberType(),s=!1,o=0;o<t.length;o++){var n=t.charAt(o),r=!1;if(n>="0"&&n<="9")r=!0;else if("-"==n){if(!(r=(i==_Z_28._float||i==_Z_28._int)&&0==o)&&0==o&&t.length>=2)return""}else"."==n&&(r=(i==_Z_28._float||i==_Z_28.positiveFloat)&&!s,s=!0);r&&(e+=n)}if(e)if("-"==e||"-."==e)e+="0";else if("."==e)e="0";else{var a=this.get_integerDigits();if(a>0&this._savedText!=t){var l=e.split(".");l[0].length>0&&"-"==l[0].charAt(0)&&a++,l[0].length>a?(l[0]=l[0].substr(0,a),l[1]=""):0==l[0].length&&(l[0]=0);var h=Math.max(this.get_decimalScale(),this.get_decimalDigits());h>0&&l.length>=2&&l[1].length>h&&(l[1]=l[1].substr(0,h)),e=l.join(".")}}return e},allowFormat:function(){return!!Object.isUndefinedOrNull(this.column)||(this.column.get_formatNumber()||$settings.NumberColumnFormatNumber)},_convertValue:function(t){return Object.isUndefinedOrNull(t)?"":t},set_value:function(t,e){if(this._checkMinMax(t)){var i=this.allowFormat()?this._formatValue(t,e):this._convertValue(t);this._bindReadOnlyString="string"==typeof t&&this.get_readOnly(),this._savedText=i,this._value=t,Object.isUndefinedOrNull(this._replaceText)?this.set_text(i):this.set_text(this._replaceText)}},_formatValue:function(t,e){return $common.formatNumber(t,this.get_decimalDigits(),this.get_decimalScale(),!1,!1,this.get_displayZeroToDigits(),e)},get_displayZeroToDigits:function(){return this._displayZeroToDigits},set_displayZeroToDigits:function(t){this._displayZeroToDigits=t},get_numberType:function(){return this._numberType},set_numberType:function(t){this._numberType=t},get_decimalDigits:function(){return this.column?this.column.get_decimalDigits():this._decimalDigits},set_decimalDigits:function(t){this._decimalDigits=t},get_decimalPrecision:function(){return this._decimalPrecision},set_decimalPrecision:function(t){this._decimalPrecision=t},get_decimalScale:function(){return this._decimalScale},set_decimalScale:function(t){this._decimalScale=t},get_maxValue:function(){return this._maxValue},set_maxValue:function(t){this._maxValue=Object.isUndefinedOrNull(t)?null:Number(t)},get_minValue:function(){return this._minValue},set_minValue:function(t){this._minValue=Object.isUndefinedOrNull(t)?null:Number(t)},get_showCalculator:function(){return this._showCalculator},set_showCalculator:function(t){this._showCalculator=t},canDropDown:function(){return this._showCalculator&&(!this.get_readOnly()||this._selectOnly)},get_replaceText:function(){return this._replaceText},set_replaceText:function(t){this.get_isInitialized()&&this._replaceText!=t?(Object.isUndefinedOrNull(t)?(this._value=this.get_value(),this.set_text(this._value)):this.set_text(t),this._replaceText=t):this._replaceText=t},get_integerDigits:function(){var t=this.get_decimalPrecision(),e=this.get_decimalScale();return t>0&&e>0&&t>e?t-e:0},doChange:function(t){this._checkValue(),this.get_replaceText()&&this.set_text(this._replaceText),Sys.UI.Controls.NumberEdit.callBaseMethod(this,"doChange",[t])},_checkValue:function(){var t=this.get_value();this.get_replaceText()&&!this.get_readOnly()&&(t=this._value=this.doGetValue()),null!==t&&this._checkMinMax(t)},_checkMinMax:function(t,e){if(t===this._defaultValue)return!0;if(Object.isUndefinedOrNull(t)||""===t)return!0;var i=this.get_maxValue(),s=this.get_minValue();return null!==i&&t>i?(!1!==e?this.set_value(i,!1):$common.showHint("允许输入最大数值"+i,this),!1):!(null!==s&&t<s)||(!1!==e?this.set_value(s,!1):$common.showHint("允许输入最小数值"+s,this),!1)},doPaste:function(t){if(Sys.UI.Controls.NumberEdit.callBaseMethod(this,"doPaste",[t]),window.clipboardData){var e=window.clipboardData.getData("Text");if(e){var i=!1,s=parseFloat(e);isNaN(s)||(e.indexOf(".")>=0||e.indexOf("-")>=0?this._isValidNumber(e)&&this.set_text(e):i=this._canInputNewDigit(e.length)),i||t.cancel()}}},_isValidNumber:function(t,e){var i=!0,s=this.get_decimalPrecision();if(s>0){var o=this.get_decimalScale();s-=o;var n=t.length,r=t.indexOf(".");if(r<0)i=n<=s;else{i=r<=s,e||(i=i&&n-r-1<=o)}}return i},doKeyDown:function(t){var e=t.keyCode,i=this.get_showCalculator(),s=i&&this.get_droppedDown(),o=s,n=this._calculatorPopup;switch(e){case Sys.UI.Key.up:s&&t.altKey?this.closeUp():this._useSpin&&this.incValue();break;case Sys.UI.Key.down:i&&!s&&t.altKey?(this.dropDown(),o=!0):this._useSpin&&this.decValue();break;case Sys.UI.Key.esc:s&&this.closeUp();break;case Sys.UI.Key.ime:var r=t.rawEvent.code;"Equal"!=r&&"Minus"!=r&&"Period"!=r||(o=!0),"Period"==r&&$common.showHint("当前为中文输入模式，请切换到英文输入法",this.get_element());break;case Sys.UI.Key.space:i&&$settings.NumberEditUseSpace&&(this.toggleDroppedDown(),o=!0);break;case 67:!i||t.ctrlKey||t.shiftKey||(s?n&&n._processKey(t):(this.dropDown(),o=!0));break;default:s&&n?n._processKey(t):229==e&&(o=!0)}o?t.cancel():Sys.UI.Controls.NumberEdit.callBaseMethod(this,"doKeyDown",[t])},_canInputNewDigit:function(t){var e=!0,i=this.get_decimalPrecision();if(i<=0)return!0;var s=Math.max(this.get_decimalScale(),this.get_decimalDigits());i-=s;var o=this.get_element().value,n=o.length,r=o.indexOf(".");if(s<=0&&r>-1)return!1;var a=this.get_caretPos();if(r<0||a<=r){var l=r>=0?r:n;"-"==o.charAt(0)&&l--,e=l+t<=i}else if(r>=0&&a>r&&s>0){e=n-r-1+t<=s}return e},doKeyPress:function(t){if(t.ctrlKey||t.shiftKey)Sys.UI.Controls.NumberEdit.callBaseMethod(this,"doKeyPress",[t]);else{var e=t.charCode,i=!0;if(e>=32){this.get_numberType();var s=this.get_caretPos(),o=$common.getSelectionText(this.get_element()).length,n=o==this.get_element().value.length;if(e>=48&&e<=57)i=!0,n||(i=this._canInputNewDigit(1-o));else if(45==e)i=this._isNotPositive()&&(n||0==s);else if(46==e){var r=this.get_text().indexOf(".");i=this.isFloat()&&r<0}else i=!1}i?Sys.UI.Controls.NumberEdit.callBaseMethod(this,"doKeyPress",[t]):t.preventDefault(),this._keyPressValue=this.get_elementValue()}},isFloat:function(){var t=this.get_numberType();return t==_Z_28._float||t==_Z_28.positiveFloat},_isNotPositive:function(){var t=this.get_numberType();return t==_Z_28._float||t==_Z_28._int},_checkMinMaxText:function(t){return!!this._checkMinMax(t,!1)||(this.set_text(this._keyPressValue),!1)},doInput:function(t){this._allowCalculate||this._checkInput(this.get_text(),!0)},_checkInput:function(t,e){if("-"==t&&(t="",!this._isNotPositive()))return this.set_text("");var i=this._trimNumber(t);return t==i||(e&&this.set_text(i),!1)}},Sys.UI.Controls.NumberEdit.registerClass("Sys.UI.Controls.NumberEdit",_Z_99),_Z_70=function(t,e){_Z_70.initializeBase(this),this._edit=t,this._isInPlace=e,this._maxLength=0},_Z_70.prototype={dispose:function(){this._table&&($clearHandlers(this._table),this._table=null),_Z_70.callBaseMethod(this,"dispose")},get_maxLength:function(){return this._maxLength},set_maxLength:function(t){this._maxLength=t},get_displayText:function(){var t=this.currentNumber;return this.isFloatButtonPressed&&t.indexOf(".")<0&&(t+="."),t},get_text:function(){return this.currentNumber},set_text:function(t){this.hasValue=null!=t&&t.length>0,this.currentNumber=t,this.firstNumber=t,this._isReset=!0,this._doClear()},get_value:function(){if(!this.hasValue)return null;return parseFloat(this.currentNumber)},render:function(){var t=this._table=$common.createDiv();document.body.appendChild(t),this._isInPlace||$common.initPopupElement(t,!0,!1),$Dom.addCssClass(t,"CalculatorPopup");var e=$common.createClassDiv("ctorLeft");t.appendChild(e),this._addButton(e,"c","opt"),this._addButton(e,"/","opt"),this._addButton(e,"*","opt"),this._addClear(e),this._addButton(e,"7"),this._addButton(e,"8"),this._addButton(e,"9"),this._addClear(e),this._addButton(e,"4"),this._addButton(e,"5"),this._addButton(e,"6"),this._addClear(e),this._addButton(e,"1"),this._addButton(e,"2"),this._addButton(e,"3"),this._addClear(e),this._addButton(e,"+/-"),this._addButton(e,"0"),this._addButton(e,".");var i=$common.createClassDiv("ctorRight");return t.appendChild(i),this._addButton(i,"","opt aicon-qingchu"),this._addButton(i,"-","opt"),this._addButton(i,"+","opt"),this._addButton(i,"=","opt equalsign"),$common.addMouseDownHandler(t,this.onPopupMouseDown,this),$common.addClickHandler(t,this._buttonsClick,this),t.control=this,t},_addClear:function(t){var e=$common.createClassDiv("clear");t.appendChild(e)},_addButton:function(t,e,i){var s=$common.createClassDiv("Btn");return e=e||"",s.innerHTML=e,e&&$Dom.addCssClass(s,"hasText"),i&&$Dom.addCssClass(s,i),t.appendChild(s),s},onPopupMouseDown:function(t){t.cancel()},_processKey:function(t){var e=t.keyCode;switch(e){case 67:this._onClearButtonPressed();break;case Sys.UI.Key.backspace:this._onBackButtonPressed();break;case 187:this._onEqualsButtonPressed(!0);break;case 190:case 110:this._onFloatButtonPressed();break;case 78:this._onNegateButtonPressed();break;case 187:case 107:this._onOperationButtonPressed("+");break;case 189:case 109:this._onOperationButtonPressed("-");break;case 106:this._onOperationButtonPressed("*");break;case 191:case 111:this._onOperationButtonPressed("/");break;default:56==e&&t.shiftKey?this._onOperationButtonPressed("*"):e>=48&&e<=57?this._onDigitButtonPressed(e-48):e>=96&&e<=105&&this._onDigitButtonPressed(e-96)}},_buttonsClick:function(t){t.cancel();var e=t.target;if($Dom.hasClass(e,"Btn")){var i=e.innerHTML;switch(i||(i="Back"),this._resetFocus(),i){case"c":this._isReset=!1,this._onClearButtonPressed();break;case"Back":this._isReset=!1,this._onBackButtonPressed();break;case"=":this._isReset=!1,this._onEqualsButtonPressed(!0);break;case".":this._isReset=!1,this._onFloatButtonPressed();break;case"+/-":this._isReset=!1,this._onNegateButtonPressed();break;case"+":case"-":case"*":case"/":this._isReset=!1,this._onOperationButtonPressed(i);break;default:i>="0"&&i<="9"&&this._onDigitButtonPressed(parseInt(i))}}},_resetFocus:function(){var t=this._edit.control;t&&t.focus(!1)},_onClearButtonPressed:function(){this.firstNumber="0",this.currentNumber="0",this._doClear(),this._onValueChanged()},_doClear:function(){this.isOperationButtonPressed=!1,this.isFloatButtonPressed=!1,this.isEnteringSecondNumber=!1,this.isCalculationDone=!1,this.currentOperation=null},_hideHintBox:function(){null!=this.hintBox&&this.hintBox.hide()},_onBackButtonPressed:function(t){var e=this._getNumberDigitsCount(this.currentNumber);0!=e&&(1==e?(this.currentNumber="0",this.isFloatButtonPressed=!1):(this.isFloatButtonPressed=this._getNumberHasFloatPoint(this.currentNumber),this.currentNumber=this._numberRemoveLastDigit(this.currentNumber)),t||this._onValueChanged())},_onDigitButtonPressed:function(t){this._isReset&&(this.currentNumber="",this.firstNumber="",this._doClear(),this._isReset=!1),this.hasValue=!0;var e=this.get_maxLength(),i=this.get_displayText().length;e>0&&i>=e&&!this.isOperationButtonPressed||(this.isOperationButtonPressed?(this.isOperationButtonPressed=!1,this.isCalculationDone=!1,this.isFloatButtonPressed=!1,this.isEnteringSecondNumber=!0,this.firstNumber=this.currentNumber,this.currentNumber=t.toString()):"0"==this.currentNumber&&1==this._getNumberDigitsCount(this.currentNumber)&&!this.isFloatButtonPressed||this.isCalculationDone?(this.isCalculationDone=!1,this.isFloatButtonPressed=!1,this.currentNumber=t.toString()):this.isFloatButtonPressed?(this.isFloatButtonPressed=!1,this.currentNumber=this._numberAppendLastDigit(this.currentNumber,t,!0)):this.currentNumber=this._numberAppendLastDigit(this.currentNumber,t,!1),this._onValueChanged())},_onEqualsButtonPressed:function(t){var e=this._edit.control;if(null!=this.currentOperation&&!this.isOperationButtonPressed){this._hideHintBox();var i=null;try{switch(this.currentOperation){case"+":this.currentNumber=this._numberAdd(this.currentNumber,this.firstNumber);break;case"-":this.currentNumber=this._numberSubtract(this.firstNumber,this.currentNumber);break;case"*":this.currentNumber=this._numberMultiply(this.currentNumber,this.firstNumber);break;case"/":if("0"==this.currentNumber){i="分母不能为 0";break}this.currentNumber=this._numberDivide(this.firstNumber,this.currentNumber)}}catch(s){this.currentNumber="0",i="计算结果太大，已清零"}null!=i?(null==this.hintBox&&(this.hintBox=new _Z_102),this.hintBox.show(i,e,2)):this._onValueChanged(),this.currentOperation=null,this.isCalculationDone=!0}t&&e.closeUp()},_onFloatButtonPressed:function(){this.isFloatButtonPressed=!0,this._onValueChanged()},_onNegateButtonPressed:function(){this.isOperationButtonPressed?this._onDigitButtonPressed(0):this.currentNumber=this._numberNegate(this.currentNumber),this._onValueChanged()},_onOperationButtonPressed:function(t){this.isEnteringSecondNumber&&this._onEqualsButtonPressed(!1),this.currentOperation=t,this.isOperationButtonPressed=!0,this.isFloatButtonPressed=!1},_onValueChanged:function(){var t=this._edit.control;if(t){var e=this.get_displayText();t._checkMinMax(e,!1)&&t._checkInput(e,!1)?t.set_text(e):this._onBackButtonPressed(!0),t.set_caretPos(e.length)}},_getNumberDigitsCount:function(t){return null!=t?t.length:0},_getNumberHasFloatPoint:function(t){return null!=t&&t.indexOf(".")>0},_numberRemoveLastDigit:function(t){if(this._getNumberDigitsCount(t)<=0)throw Error.invalidOperation("The number has no digits to remove.");var e=(t=t.substr(0,t.length-1)).length;return e>0&&"."==t[e-1]&&(t=t.substr(0,e-1)),t},_numberAppendLastDigit:function(t,e,i){var s=e.toString();if(i){t.indexOf(".")<0&&(t+="."),t+=s}else t+=s;return t},_numberAdd:function(t,e){var i=this._parseNumber(t)+this._parseNumber(e);return this._formatNumber(i)},_numberSubtract:function(t,e){var i=this._parseNumber(t)-this._parseNumber(e);return this._formatNumber(i)},_numberMultiply:function(t,e){var i=this._parseNumber(t)*this._parseNumber(e);return this._formatNumber(i)},_numberDivide:function(t,e){var i=this._parseNumber(t)/this._parseNumber(e);return this._formatNumber(i)},_parseNumber:function(t){return t?parseFloat(t):0},_numberNegate:function(t){var e=-1*this._parseNumber(t);return this._formatNumber(e)},_formatNumber:function(t){return $common.formatNumber(t,0,8)}},_Z_70.registerClass("_Z_70",_Z_242),_Z_24=function(){throw Error.notImplemented()},_Z_24.prototype={dropDown:0,dropDownList:1,dropDownEdit:2,dropDownSearch:3,dropDownSearchEdit:4,dropDownMultiSearch:5},_Z_24.registerEnum("_Z_24"),_Z_92=function(t){_Z_92.initializeBase(this),this._moveItemIndex=-1,this._edit=t,this._popupClassName="DropPopup"},_Z_92.prototype={dispose:function(){this._itemContainer&&$clearHandlers(this._itemContainer),this._popupWindow&&($clearHandlers(this._popupWindow),$removeNode(this._popupWindow)),this._searchEdit&&(this._searchEdit.dispose(),this._searchEdit=null),_Z_92.callBaseMethod(this,"dispose")},init:function(){var t=this._popupWindow=$common.createDiv();$common.initPopupElement(t,!0,!0),$Dom.addCssClass(t,this._popupClassName),document.body.appendChild(t),this.initTopBar();var e=this._itemContainer=$common.createClassDiv("DropContainer");t.appendChild(e),$common.addClickHandler(e,this.doPopupClick,this),$common.addClickHandler(t,this._stopEvent,this),$common.addMouseDownHandler(t,this._stopEvent,this),$common.addMouseWheelHandler(t,this._stopEvent,this),t.control=this,t._edit=this._edit.get_element()},initTopBar:function(){if(this.get_allowSearch()){var t=this._popupWindow,e=this._edit.get_form(),i=$createControl("TextEdit",{NullDisplayText:"请搜索...",Hint:"",AllowDelIcon:!1,CssClass:"DropSearchEdit"},e,null,!0);i.appendTo(t);var s=$common.createClassSpan("DropSearchIcon aicon-chaxun");t.appendChild(s),this._searchEdit=e[i.ID],this._searchEdit.add_keyUp(this._doKeyUp,this)}},render:function(){return this.init(),this.dataBind(),$common.addMouseOverHandler(this._popupWindow,this.doRowMouseOver,this),this._popupWindow},dataBind:function(){var t=this._edit;this._itemContainer.innerHTML="",this._initHeight(),this._rows=[];for(var e=t.get_itemCount(),i=0;i<e;i++){var s=$common.createClassDiv("DropItem");s.innerHTML=t.doGetItemDisplayText(i),this._itemContainer.appendChild(s),t.doInitItemEnabled(i,s),t.doInitItemColor(i,s),this._rows.push(s)}t._rows=this._rows},get_allowSearch:function(){return this._edit.get_dropDownStyle()==_Z_24.dropDownSearch||this._edit.get_dropDownStyle()==_Z_24.dropDownMultiSearch},_initHeight:function(){var t=this._itemContainer,e=this._popupWindow,i=this._edit._getIsScrolling(),s=this._getDisplayRows()*$settings.DefaultItemHeight;this._searchEdit&&(s+=$settings.DefaultItemHeight+10),s+=this._edit.getBottomHeight(),t.style.overflow=i?"auto":"hidden",$common.setHeight(e,s+3)},_getDisplayRows:function(){var t=this._edit._getIsScrolling(),e=this._getRowCount(),i=this._edit.get_dropDownRows();return t?i:e},_getRowCount:function(){return this._edit.get_itemCount()},_doKeyUp:function(t){var e=t.keyCode;if(e!=Sys.UI.Key.enter&&e!=Sys.UI.Key.esc&&e!=Sys.UI.Key.tab){var i=this._searchEdit,s=i.get_text();s!=i._drpSearchText&&(i._drpSearchText=s||null,this._edit._searchItems=this._edit._findItemsByStr(s),this.dataBind())}},doCloseUp:function(){this._searchEdit&&this._searchEdit.set_text("")},_stopEvent:function(t){t.stopPropagation()},doRowMouseOver:function(t){var e=this._findDropItem(t);if(e){var i=Array.indexOf(this._rows,e);i>=0&&this._setMoveItemIndex(i)}},doPopupClick:function(t){this._edit._doSelectMoveItem(),t.cancel()},_setRowSelected:function(t,e){if(t){var i=this._edit;$Dom.getEnabled(t)?e?(t.className="DropItem selected",i._getIsScrolling()&&$common.scrollToView(t,this._popupWindow)):t.className="DropItem normal":(t.style.backgroundColor="",t.style.color="")}},_setMoveItemIndex:function(t){var e=this._edit;e._moveItemIndex!=t&&(e._moveItemIndex>=0&&this._setRowSelected(this._rows[e._moveItemIndex],!1),e._moveItemIndex=t,this._setRowSelected(this._rows[e._moveItemIndex],!0))},_findDropItem:function(t){var e=t.target;return e.className.indexOf("DropItem")>-1?e:null}},_Z_92.registerClass("_Z_92",_Z_242),_Z_91=function(t){_Z_91.initializeBase(this,[t]),this._requireKeyDown=!0,this._rows=null,this._selectedIndex=-1,this._moveItemIndex=-1,this._items=[],this._searchItems=null,this._dataValueField=null,this._dataTextField=null,this._dropDownStyle=_Z_24.dropDown},_Z_91.prototype={initialize:function(){_Z_91.callBaseMethod(this,"initialize"),this._dropDownStyle==_Z_24.dropDownList&&(this.add_contextMenu(this._doContextMenu,this),$common.disableIme(this.get_element()),$common.addDragStartHandler(this.get_element(),this._onDragStart,this),$common.addDropHandler(this.get_element(),this._onDragStart,this))},dispose:function(){this._rows&&delete this._rows,this._popup&&this._popup.dispose(),_Z_91.callBaseMethod(this,"dispose")},_onDragStart:function(t){return t.cancel(),!1},_getScrollDiv:function(){return this._popup._itemContainer},_getPopupScrollWidth:function(){return this._popup._itemContainer.scrollWidth},_getPopupScrollHeight:function(){return this._popup._itemContainer.scrollHeight},_checkRaiseChange:function(){if(this._searchItems&&-1==this._selectedIndex&&this._dropDownStyle==_Z_24.dropDownSearch)return this.fastHide(),void this.set_value(null);_Z_91.callBaseMethod(this,"_checkRaiseChange")},_canBlur:function(t){return!this.get_droppedDown()},set_dataSource:function(t){this.set_items(t)},get_dataSource:function(){return this.get_items()},get_items:function(){return this._searchItems?this._searchItems:this._items},set_items:function(t){if(t||(t=[]),this._items=t,this._searchItems=null,t&&"undefined"==typeof t.length)throw Error.argumentOutOfRange("value",t,"不支持的下拉列表数据类型");this.get_isInitialized()&&(this._selectedIndex=-1,this._moveItemIndex=-1,this._popup&&(this._rebuild=!0),this.set_text(""))},get_itemCount:function(){return this.get_items().length},get_searchByFields:function(){return this._searchByFields},set_searchByFields:function(t){t=t.split(","),this._searchByFields=t},canDropDown:function(){return!0},doPaste:function(t){_Z_91.callBaseMethod(this,"doPaste",[t]),this._getAllowHandInput()||this._getAllowSearch()||t.cancel()},_doContextMenu:function(t){this._dropDownStyle==_Z_24.dropDownList&&t.cancel()},_getAllowSearch:function(){return this._dropDownStyle==_Z_24.dropDownSearch||this._dropDownStyle==_Z_24.dropDownSearchEdit},_getAllowHandInput:function(){return this._dropDownStyle==_Z_24.dropDownEdit},_getUseDefaultValueType:function(){return this.get_valueType()==_Z_59._default},_getUseTextValueType:function(){return this._getAllowHandInput()||this._dropDownStyle==_Z_24.dropDownSearchEdit||!this._getUseDefaultValueType()},_getItemValueByText:function(t){if(!this._dataTextField)return null;for(var e=0;e<this.get_itemCount();e++){var i=this.get_items()[e],s=i;if("object"==typeof i&&(s=i[this._dataTextField]),s===t)return i[this._dataValueField]}return null},get_value:function(){if(this._getUseTextValueType()){var t=this.get_text();if(this.get_valueType()==_Z_59.string)return t;i=this._getItemValueByText(t);return Object.isUndefinedOrNull(i)?t:i}var e=this._selectedIndex;if(e<0)return null;var i;return null==(i=$craba._getItemValue(this,e))?e:i},set_value:function(t,e){this._refresh();var i=-1;i=this.get_valueType()==_Z_59.string?$craba.getItemIndexByText(this._items,this.get_dataTextField(),t,e):$craba.getItemIndexByValue(this._items,this.get_dataValueField(),t,e),this._selectedIndex=i,i<0&&this._getUseTextValueType()?this.set_text(t?t.toString():""):this.set_selectedIndex(i)},set_text:function(t,e){_Z_91.callBaseMethod(this,"set_text",[t]),e||(this._selectedIndex=-1)},get_selectedIndex:function(){return this._selectedIndex},set_selectedIndex:function(t){this._selectedIndex=t,t>=0?(this._searchText=$craba._getItemText(this,t),this.set_text(this._searchText,!0)):(this._searchText="",this.set_text("",!0))},get_selectedItem:function(){return this.get_items()[this.get_selectedIndex()]},_getIsScrolling:function(){var t=this.get_dropDownRows();return t>0&&this.get_itemCount()>t},doGetItemHeight:function(){},createPopupWindow:function(){return this._popup=new _Z_92(this),this._popup.render()},doGetItemDisplayText:function(t){},doInitPopup:function(){this._refresh(),_Z_91.callBaseMethod(this,"doInitPopup"),this._initSelected()},_initSelected:function(){this._moveItemIndex=this._selectedIndex;var t=this._rows.length;this._moveItemIndex<0&&t>0&&(this._moveItemIndex=0);for(var e=0;e<t;e++)this._popup._setRowSelected(this._rows[e],e==this._moveItemIndex)},_refresh:function(){if(this._searchItems||this._rebuild){this._rebuild=null;var t=this.get_value();this._searchItems=null,this._popup.dataBind();var e=$craba.getItemIndexByValue(this._items,this.get_dataValueField(),t);this._selectedIndex=e}},doKeyDown:function(t){var e=!1,i=t.keyCode,s=this.get_droppedDown(),o=this.get_items().length,n=!this._getAllowHandInput()&&!this._getAllowSearch(),r=_Z_91;if(0==o){if(i==Sys.UI.Key.esc||i==Sys.UI.Key.tab)return;return n&&229==i?(this._isIme=!0,this.set_readOnly(!0),t.cancel(),void r.callBaseMethod(this,"doKeyDown",[t])):(n&&t.cancel(),void r.callBaseMethod(this,"doKeyDown",[t]))}if(this.get_readOnly())r.callBaseMethod(this,"doKeyDown",[t]);else{if(n&&229==i)return this._isIme=!0,this.set_readOnly(!0),t.cancel(),void r.callBaseMethod(this,"doKeyDown",[t]);switch(i){case Sys.UI.Key.up:s?t.altKey?this.closeUp():this._incMoveItemIndex(-1):this._selectedIndex>0&&this._changeSelectedIndex(this._selectedIndex-1),e=!0;break;case Sys.UI.Key.down:s?this._incMoveItemIndex(1):t.altKey?this.dropDown():this._selectedIndex<o-1&&this._changeSelectedIndex(this._selectedIndex+1),e=!0;break;case Sys.UI.Key.pageUp:s&&this._incMoveItemIndex(-5);break;case Sys.UI.Key.pageDown:s&&this._incMoveItemIndex(5);break;case Sys.UI.Key.home:s&&o>0&&this._setMoveItemIndex(0);break;case Sys.UI.Key.end:s&&o>0&&this._setMoveItemIndex(o-1);break;case Sys.UI.Key.enter:s&&this._doSelectMoveItem(),e=!1;break;case Sys.UI.Key.esc:e=!1;break;case Sys.UI.Key.backspace:case Sys.UI.Key.del:this._dropDownStyle==_Z_24.dropDown&&this._selectedIndex>=0&&(this.closeUp(),this._changeSelectedIndex(-1)),e=n;break;case Sys.UI.Key.space:(n||0==this.get_caretPos())&&(this.toggleDroppedDown(),e=!0);break;case Sys.UI.Key.left:case Sys.UI.Key.right:case Sys.UI.Key.tab:e=!1;break;default:e=this._doDefaultKeyDown(t,i,n,o,s)}e?t.cancel():r.callBaseMethod(this,"doKeyDown",[t])}},_doDefaultKeyDown:function(t,e,i,s,o){var n=!1;if(t.altKey||t.ctrlKey||16==e||e>=Sys.UI.Key.f1&&e<=Sys.UI.Key.f12)this._dropDownStyle==_Z_24.dropDownList&&(n=t.ctrlKey&&"X"==String.fromCharCode(e));else{if(n=i,s<1)return n;i&&!o&&(this.dropDown(),o=!0);var r=this._getAllowSearch();if(!o||r)return n;var a=String.fromCharCode(e);if(a>="A"&&a<="Z"||a>="0"&&a<="9"){var l=this._findItemByFirstChar(a);if(l<0)return n;this._setMoveItemIndex(l),i||(n=!0)}}return n},doKeyUp:function(t){if(this._isIme)return this._isIme=!1,this.set_readOnly(!1),void t.cancel();_Z_91.callBaseMethod(this,"doKeyUp",[t]),this._dropRaised=!1;var e=t.keyCode;if(this._getAllowSearch()&&e!=Sys.UI.Key.enter){var i=this.get_text();i!=this._searchText&&(this._searchText=i,this._selectedIndex=-1,this._moveItemIndex=-1,this.get_droppedDown()||this.dropDown(),this._searchItems=this._findItemsByStr(i),this._popup.dataBind(),this._initPopupWindowPosition(),this._selectedIndex=-1,this._moveItemIndex=-1)}},_setMoveItemIndex:function(t){this._popup._setMoveItemIndex(t)},_incMoveItemIndex:function(t){var e=this._moveItemIndex+t;e<0?e=0:e>this._rows.length-1&&(e=this._rows.length-1),this._setMoveItemIndex(e)},_doSelectMoveItem:function(){this.closeUp(),this._changeSelectedIndex(this._moveItemIndex)},_changeSelectedIndex:function(t){if(!this.get_readOnly()||this._selectOnly){var e=this._selectedIndex;this.set_selectedIndex(t),t!=e&&(this.selectText(),this._dropRaised=!0,this.doChange())}},doChange:function(t){var e=_Z_91;if(!t)return e.callBaseMethod(this,"doChange");{if(!this._dropRaised)return!this._rebuild&&this._searchItems&&this._dropDownStyle==_Z_24.dropDownSearch?(this.set_text(""),void(this._rebuild=!0)):void e.callBaseMethod(this,"doChange",[t]);this._dropRaised=!1}},_findItemByFirstChar:function(t){var e=this._items.length;t=t.toLowerCase();for(var i=0;i<e;i++){if($string.getFirstPinyinCode($craba._getItemText(this,i)).indexOf(t)>=0)return i}return-1},doInitItemEnabled:function(t,e){},doInitItemColor:function(t,e){}},_Z_91.registerClass("_Z_91",_Z_99),Sys.UI.Controls.DropDownEdit=function(t){Sys.UI.Controls.DropDownEdit.initializeBase(this,[t]),this._enabledField=null},Sys.UI.Controls.DropDownEdit.prototype={doGetItemHeight:function(){return $settings.DefaultItemHeight},doGetItemDisplayText:function(t){var e=$craba._getItemText(this,t);return $common.textToHtml(e)},_changeSelectedIndex:function(t){if(!this.getItemEnabled(t)&&t>-1&&t<this.get_itemCount()){var e=this._selectedIndex-t>0;this._changeSelectedIndex(e?--t:++t)}else t>=this.get_itemCount()||t<-1||Sys.UI.Controls.DropDownEdit.callBaseMethod(this,"_changeSelectedIndex",[t])},getItemEnabled:function(t){if(!this._rows){if(this._enabledField){var e=this.get_items()[t];return"object"!=typeof e||e[this._enabledField]}return!0}var i=this._rows[t];return!!i&&$Dom.getEnabled(i)},setItemEnabled:function(t,e){if(this._rows){var i=this._rows[t];i&&$Dom.setEnabled(i,e)}},_doSelectMoveItem:function(){var t=this._moveItemIndex;this.getItemEnabled(t)&&(this.doInitItemColor(t,this._element),Sys.UI.Controls.DropDownEdit.callBaseMethod(this,"_doSelectMoveItem"))},doInitItemEnabled:function(t,e){if(this._enabledField){var i=this.get_items()[t];if("object"==typeof i){i[this._enabledField]||$Dom.setEnabled(e,!1)}}},doInitItemColor:function(t,e){if(this._colorField){var i=this.get_items()[t];if("object"==typeof i){var s=i[this._colorField];e.style.color=s||""}}},get_enabledField:function(){return this._enabledField},set_enabledField:function(t){this._enabledField=t},get_colorField:function(){return this._colorField},set_colorField:function(t){this._colorField=t}},Sys.UI.Controls.DropDownEdit.registerClass("Sys.UI.Controls.DropDownEdit",_Z_91),Sys.UI.Controls.ImageDropDownEdit=function(t){Sys.UI.Controls.ImageDropDownEdit.initializeBase(this,[t]),this._imageHeight=0},Sys.UI.Controls.ImageDropDownEdit.prototype={initialize:function(){Sys.UI.Controls.ImageDropDownEdit.callBaseMethod(this,"initialize"),this.get_imgElement()},get_imageHeight:function(){return this._imageHeight},set_imageHeight:function(t){this._imageHeight=t},get_text:function(){var t=this.get_imgElement();return t?t.src:null},set_text:function(t){var e=this.get_imgElement();e&&(e.src=t||$skin.getBlankImageSrc())},get_imgElement:function(){var t=this.get_element(),e=t.firstChild;return e||(e=$common.createBlankImg(),t.appendChild(e)),e},get_reportText:function(){return this.get_value()},doGetItemHeight:function(){var t=this.get_imageHeight();return t||$settings.DefaultItemHeight},doGetItemDisplayText:function(t){var e=$craba._getItemText(this,t);return $craba.getImage(e,this._imageWidth,this._imageHeight)}},Sys.UI.Controls.ImageDropDownEdit.registerClass("Sys.UI.Controls.ImageDropDownEdit",_Z_91),Sys.UI.Controls.ColorDropDownEdit=function(t){Sys.UI.Controls.ColorDropDownEdit.initializeBase(this,[t])},Sys.UI.Controls.ColorDropDownEdit.prototype={initialize:function(){Sys.UI.Controls.ColorDropDownEdit.callBaseMethod(this,"initialize"),this._initItems()},_initItems:function(){if(this._dropDownStyle!=_Z_24.dropDown&&!(this._items&&this._items.length>0)){var t=this._dataValueField,e=this._dataTextField;this._items=[];var i=this;Array.forEach(["020000","424242","d1d1d1","d6ddde","ffffff","990000","ff0000","ff9d00","ffff00","00ff00","4a87e9","0000ff","9900ff","ff00ff","dd7e6a","feeccd","feeccd","e7b9af","eb9999","f7b36a","264e12","0c343c","063662","20124c","4c1030","7e6000","600700","3c78d9","6aa94e","a71c00","a71c00","cd4024","a5c3f5"],function(s,o){var n={};n[t]="#"+s,n[e]="#"+s,i._items.push(n)})}},_get_colorReg:function(){return/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/},get_defaultValue:function(){return this._defaultValue},set_defaultValue:function(t){this._defaultValue=t,this._value||this.set_value(t)},_colorNameToColorCode:function(t){switch(t){case"蓝色":return"#0000FF";case"红色":return"#FF0000";case"黑色":return"#000000";case"白色":return"#FFFFFF";case"绿色":return"#00FF00";default:return""}},_formatColorValueToHtml:function(t){t=t.toUpperCase();var e=this._get_colorReg();if(!t)return"";var i=t;return e.test(t)||(i=this._colorNameToColorCode(t)),"<span class='colorItem' style='background-color:"+i+"'></span><span style='color:"+i+"'>"+t+"</span>"},doFormLoaded:function(){Sys.UI.Controls.ColorDropDownEdit.callBaseMethod(this,"doFormLoaded"),this._initButtonStyle(this.get_elementValue())},get_text:function(t){var e=this.get_element();if(e){var i=e.value;if(t){var s=this._colorNameToColorCode(i);return""==s?i:s}return i}},set_text:function(t){var e=this.get_element();if(e){var i=this._get_colorReg();t=t.toUpperCase(),e.value=t,t?(i.test(t)||(t=this._colorNameToColorCode(t)),e.style.color=t,this._initButtonStyle(t)):this._initButtonStyle(null)}},doGetItemHeight:function(){return $settings.DefaultItemHeight},doGetItemDisplayText:function(t){var e=$craba._getItemText(this,t);return this._formatColorValueToHtml(e)}},Sys.UI.Controls.ColorDropDownEdit.registerClass("Sys.UI.Controls.ColorDropDownEdit",_Z_91),_Z_90=function(t,e){_Z_90.initializeBase(this),this._edit=t,this._editControl=t.control,this._isInPlace=e,this.mtPrev=-1,this.mtCurr=0,this.mtNext=1,this._year=-1,this._month=-1,this._day=-1,this._prevMonth=-1,this._nextMonth=-1,this._prevYear=-1,this._nextYear=-1,this._startDay=-1,this._dayIndex=-1,this._moveDayIndex=-1},_Z_90.prototype={initialize:function(){_Z_90.callBaseMethod(this,"initialize");var t=this;setTimeout(function(){t._calendarBody.style.height=t._element.clientHeight-t._calendarHead.offsetHeight+"px"})},dispose:function(){this._element&&$clearHandlers(this._element),$clearHandlers(this._prevMonthArrow),$clearHandlers(this._nextMonthArrow),$clearHandlers(this._calendarHead),this._todayButton&&(this._todayButton.dispose(),this._todayButton=null),this._monthEdit&&(this._monthEdit.dispose(),this._monthEdit=null),this._prevMonthArrow=null,this._nextMonthArrow=null,this._calendarHead=null,this._yearLabel=null,this._monthLabel=null,this._date=null,_Z_90.callBaseMethod(this,"dispose")},get_date:function(){var t=this._editControl._getDateValue?this._editControl._getDateValue(this):this._editControl.get_editValue();if("number"!=typeof t)return t;var e=new Date;return e.setDate(e.getDate()+t),e},set_date:function(t){if(this._rangePopup)this._rangePopup.set_date(t);else{var e=this._edit.control,i=e.set_value(t);e.closeUp&&(e._hasEditor=!1,e.closeUp()),i&&e.doChange()}},doInitDate:function(t){var e=this.get_date();e||(e=new Date),this.changeDate(e.getFullYear(),e.getMonth(),e.getDate(),t,!0)},_addArrow:function(t,e,i){var s=$common.createArrow(e);return $common.addClickHandler(s,i,this),t.appendChild(s),s},_createMonthYear:function(t,e){var i=$common.createSpan();return i.className=e,t.appendChild(i),i},render:function(){Object.getTypeName(this);var t=this._element=$common.createDiv();this._createHeader(t);var e=this._calendarBody=$common.createClassDiv("CalendarBody");t.appendChild(e);for(var i=_Z_228.CurrentCulture.dateTimeFormat,s=$common.createClassDiv("WeekRow"),o=0;o<7;o++){var n=$common.createClassDiv("WeekCell");n.innerHTML=i.ShortestDayNames[o],s.appendChild(n)}e.appendChild(s);var r=0;this._dayCells=new Array(42);for(o=0;o<6;o++){for(var a=$common.createClassDiv("DayRow"),l=0;l<7;l++){var h=$common.createClassDiv("DayCell");a.appendChild(h),this._dayCells[r]=h,r++}e.appendChild(a)}return $common.addMouseUpHandler(e,this.doDayCellMouseUp,this),this._isInPlace?$Dom.addCssClass(t,"CalendarMain"):($common.initPopupElement(t,!0,!1),$Dom.addCssClass(t,"CalendarMain"),document.body.appendChild(t)),this._createBottomPanel(t),$common.addMouseDownHandler(t,this.onPopupMouseDown,this),$common.addClickHandler(t,this.onPopupClick),t.control=this,t},_createHeader:function(t){var e=this._calendarHead=$common.createGlyphDiv();e.unselectable="on",e.className="CalendarTitle",this._prevYearArrow=this._addArrow(e,"YearArrow1 aicon-jiantou2",this.doPrevYearMouseDown),this._prevMonthArrow=this._addArrow(e,"DateArrow1 aicon-jiantou1",this.doPrevMonthMouseDown),this._createMonthYear(e,"Flex1"),this._yearLabel=this._createMonthYear(e,"Year"),this._monthLabel=this._createMonthYear(e,"Month"),this._createMonthYear(e,"Flex1"),this._nextMonthArrow=this._addArrow(e,"DateArrow aicon-jiantou1",this.doNextMonthMouseDown),this._nextYearArrow=this._addArrow(e,"YearArrow aicon-jiantou2",this.doNextYearMouseDown),$common.addClickHandler(e,this.doMonthYearClick,this),t.appendChild(e)},_createBottomPanel:function(t){if(!this._isInPlace){var e=document.createElement("button");e.innerHTML="今天",e.className="TodayButton Button",t.appendChild(e),this._todayButton=Sys.UI.Controls.FlatButton.create(e,$createDelegate(this,this.doToday)),this._todayButton.set_hint(Date.dateToStr(new Date))}},onPopupMouseDown:function(t){t.target._isDateEdit||t.cancel()},onPopupClick:function(t){t.cancel()},changeDate:function(t,e,i,s,o){if(this._year!=t||this._month!=e||i&&this._day!=i||s){if(this._year!=t||this._month!=e||this._isInPlace||s){this._year=t,this._month=e,this._changeYearMonth(t,e),0==e?(this._prevMonth=11,this._prevYear=t-1):(this._prevMonth=e-1,this._prevYear=t),11==e?(this._nextMonth=0,this._nextYear=t+1):(this._nextMonth=e+1,this._nextYear=t),this._startDay=new Date(t,e,1).getDay(),0==this._startDay&&(this._startDay=7);for(var n=Date.getMonthDays(this._year,this._month),r=Date.getMonthDays(this._prevYear,this._prevMonth),a=(Date.getMonthDays(this._nextYear,this._nextMonth),r-this._startDay+1),l=42-n-this._startDay,h=0,d=a;d<=r;d++)this._initDayCell(h,this.mtPrev,d,!1),h++;for(var _=new Date,c=_.getFullYear()==this._year&&_.getMonth()==this._month,u=_.getDate(),d=1;d<=n;d++)this._initDayCell(h,this.mtCurr,d,c&&u==d),h++;for(d=1;d<=l;d++)this._initDayCell(h,this.mtNext,d,!1),h++}if(i&&(this._day=i),this._moveDayIndex=-1,this._setMoveDayIndex(this._day+this._startDay-1),this._rangePopup&&!s&&this._rangePopup.changeDate(this),!o){var p=Date.toDateTime(this._year,this._month,this._day);this._refreshControlValue(p)}}},_changeYearMonth:function(t,e){this._yearLabel.innerHTML=t+"年",this._monthLabel.innerHTML=e+1+"月"},_initDayCell:function(t,e,i,s){var o=this._dayCells[t];o.startClass=null,o.className="DayCell",o._hasUserSytle=!1,o._monthType=e,o._day=i,o.innerHTML=i,s?$Dom.addCssClass(o,"Today"):$Dom.removeCssClass(o,"Today"),this._setDayCellSelected(o,!1),this._edit.control.add_dayRendering&&this.raiseDayRendering(o,t)},raiseDayRendering:function(t,e){var i=this._edit.control,s=i.get_events().getHandler("_dayRendering");if(s){this.setDayCellStyle(t,"","","");var o=this.getDayCellDate(t),n=new _Z_173(t,o,e);s(i,n),this.setDayCellStyle(t,n._bgColor,n._fontColor,n._cssClass)}},setDayCellStyle:function(t,e,i,s){t.style.backgroundColor=e,t.style.color=i,t.startClass||(t.startClass=t.className),t.className=$skin.joinCssClass(t.startClass,s),t._hasUserSytle=!0},_findDayCellIndex:function(t){var e=t.target,i=$Dom.hasClass(e,"DayCell")?e:null;return i?Array.indexOf(this._dayCells,i):-1},doSelectDayCell:function(t){if(!this._rangePopup||this._rangePopup.checkDateValue(t,this)){var e=this.getDayCellDate(t);$craba._checkDateValue(this._editControl,e)&&this.set_date(e)}},getDayCellDate:function(t){var e,i;t._monthType==this.mtPrev?(e=this._prevYear,i=this._prevMonth):t._monthType==this.mtNext?(e=this._nextYear,i=this._nextMonth):(e=this._year,i=this._month);var s=t._day;return Date.toDateTime(e,i,s)},doSelectCurrDayCell:function(t){return this.isMonthPopupShow()?(this._monthPopup.doSelectDate(),!0):(this._moveDayIndex>=0&&this.doSelectDayCell(this._dayCells[this._moveDayIndex]),!1)},doPrevDay:function(){this.isMonthPopupShow()?this._monthPopup.doPrevMonth():this._moveDay(this._moveDayIndex-1)},doNextDay:function(){this.isMonthPopupShow()?this._monthPopup.doNextMonth():this._moveDay(this._moveDayIndex+1)},doPrevWeek:function(){if(this.isMonthPopupShow())this._monthPopup.doPrevMonth();else if(this._moveDayIndex<7){var t=Date.getMonthDays(this._prevYear,this._prevMonth)+this._day-7;this.changeDate(this._prevYear,this._prevMonth,t)}else this._moveDay(this._moveDayIndex-7)},doNextWeek:function(){if(this.isMonthPopupShow())this._monthPopup.doNextMonth();else if(this._moveDayIndex>34){var t=7-(Date.getMonthDays(this._year,this._month)-this._day);this.changeDate(this._nextYear,this._nextMonth,t)}else this._moveDay(this._moveDayIndex+7)},_moveDay:function(t){t<0?t=0:t>=this._dayCells.length&&(t=this._dayCells.length-1);var e=this._dayCells[t];if(e._monthType==this.mtCurr)this._setMoveDayIndex(t),this._day=e._day;else{var i,s,o;e._monthType==this.mtPrev?(i=this._prevYear,s=this._prevMonth,o=Date.getMonthDays(i,s)-this._startDay+t+1):e._monthType==this.mtNext&&(i=this._nextYear,s=this._nextMonth,o=t-Date.getMonthDays(this._year,this._month)-this._startDay+1),this.changeDate(i,s,o)}},doDayCellMouseUp:function(t){var e=this;if(!e._up){e._up=!0,setTimeout(function(){e._up=!1},300);var i=this._findDayCellIndex(t);i>=0&&this.doSelectDayCell(this._dayCells[i]),t.stopPropagation()}},_setMoveDayIndex:function(t){this._moveDayIndex!=t&&(this._moveDayIndex>=0&&this._setDayCellSelected(this._dayCells[this._moveDayIndex],!1),this._moveDayIndex=t,this._setDayCellSelected(this._dayCells[this._moveDayIndex],!0))},_setDayCellSelected:function(t,e){if(t&&!t._hasUserSytle)if(e){if(!this._checkDateValue(t))return;this._curCell&&$Dom.removeCssClass(this._curCell,"selected"),this._curCell=t,$Dom.addCssClass(t,"selected")}else{var i=this._checkDateValue(t);t._monthType==this.mtCurr&&i?$Dom.addCssClass(t,"mtCurr"):$Dom.removeCssClass(t,"mtCurr"),$Dom.setCssClass(!i,t,"dis")}},_checkDateValue:function(t){var e=this.getDayCellDate(t);return $craba._checkDateValue(this._editControl,e)},doPrevMonth:function(t){this.isMonthPopupShow()?this._monthPopup.doPrevMonth():this.changeDate(this._prevYear,this._prevMonth)},doNextMonth:function(t){this.isMonthPopupShow()?this._monthPopup.doNextMonth():this.changeDate(this._nextYear,this._nextMonth)},doMonthFirstDay:function(){this.isMonthPopupShow()?this._monthPopup.doFirstMonth():this._setMoveDayIndex(this._startDay)},doMonthLastDay:function(){this._setMoveDayIndex(this._startDay+Date.getMonthDays(this._year,this._month)-1)},doPrevMonthMouseDown:function(t){this.doPrevMonth(t),t.cancel()},doNextMonthMouseDown:function(t){this.doNextMonth(t),t.cancel()},doPrevYearMouseDown:function(t){this.isMonthPopupShow()?this._monthPopup.doPrevYear():this.changeDate(this._year-1,this._month),t.cancel()},doNextYearMouseDown:function(t){this.isMonthPopupShow()?this._monthPopup.doNextYear():this.changeDate(this._year+1,this._month),t.cancel()},doToday:function(t){this.set_date(new Date)},setDayCellStyleByDate:function(t,e,i,s){var o=this.getDayCellByDate(t);this.setDayCellStyle(o,e||"",i||"",s||"")},getDayCellByDate:function(t){if(!t||!t.getFullYear)throw Error.invalidOperation("不是合法的日期");for(var e=t.getFullYear(),i=t.getMonth(),s=t.getDate(),o=new Date(e,i,s),n=this._dayCells.length,r=0;r<n;r++){var a=this._dayCells[r];if(this.getDayCellDate(a)-o==0)return a}return null},doCloseUp:function(){return!this._monthEdit||(this._monthEdit.closeUp(),!0)},initMonthEdit:function(){if(!this._monthEdit){var t=$common.createInput();this._calendarHead.appendChild(t),t.style.display="none",this._monthEdit=$create(Sys.UI.Controls.MonthEdit,{editKind:_Z_53.yearMonth},t,null,this._editControl.get_form(),!0),this._monthEdit.set_visible(!1),this._monthEdit.add_change(this._yearMonthChange,this),t._outerElement=this._calendarHead}},_yearMonthChange:function(t){var e=t.get_value();e&&this.changeDate(e.getFullYear(),e.getMonth())},_refreshControlValue:function(t){var e=this._editControl;if(!(e._minValue||e._maxValue||this._rangePopup)){var i=e._getDateValue?e._getDateValue(this):e.get_value(),s=Object.clone(i);s||(s=new Date),s.setFullYear(t.getFullYear()),s.setMonth(t.getMonth()),s.getMonth()!=t.getMonth()&&s.setMonth(t.getMonth()),e.set_value(s),e.doChange(),e.focus()}},isMonthPopupShow:function(){return!!this._monthPopup&&this._monthEdit.get_droppedDown()},doMonthYearClick:function(t){this._editControl._hasEditor=!0,this.initMonthEdit();if(this._monthEdit.get_droppedDown())this._monthEdit.toggleDroppedDown();else{this._monthEdit.toggleDroppedDown(!0);var e=this._monthEdit._popupWindow;this._calendarBody.appendChild(e),$Dom.removeCssClass(e,"trTop"),e.style.left="0",e.style.top="-100%",setTimeout(function(){$Dom.addCssClass(e,"trTop"),e.style.top="0"},1),this._monthEdit.set_value(new Date(this._year,this._month,1)),this._monthPopup=this._monthEdit._calendarPopup,this._monthPopup.doInitDate(),this._monthPopup._prevYearArrow.parentNode.parentNode.style.display="none"}}},_Z_90.registerClass("_Z_90",_Z_242),_Z_89=function(t,e){_Z_89.initializeBase(this,[t,e]),this._showSecond=!0},_Z_89.prototype={set_showSecond:function(t){this._showSecond=t},get_hour:function(){return this._hourEdit.get_value()},get_minute:function(){return this._minuteEdit.get_value()},get_second:function(){return this._showSecond?this._secondEdit.get_value():"00"},doInitDate:function(t){var e=this.get_date();e||(e=new Date,this._initTime(e)),this.changeDateTime(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),t,!0);var i=this._editControl.get_editKind()==_Z_49.normal;$Dom.addCssClass(this._bottomTable,i?"":"hideTime")},_initTime:function(t){var e=this._edit.control.get_defaultTime();if(e){var i=Date.strToTime(e);t.setHours(i.getHours(),i.getMinutes(),i.getSeconds(),0)}},changeDateTime:function(t,e,i,s,o,n,r,a){if(_Z_89.callBaseMethod(this,"changeDate",[t,e,i,r,!0]),this._hour!=s&&(this._hour=s,this._hourEdit.set_text(s)),this._minute!=o&&(this._minute=o,this._minuteEdit.set_text(o)),this._second!=n&&(this._second=n,this._secondEdit&&this._secondEdit.set_text(n)),!a){var l=new Date(this._year,this._month,this._day,this._hour,this._minite,this._second);this._refreshControlValue(l)}},createTdAndEdit:function(t,e){var i=$common.createInput();i._isDateEdit=!0,i.className="ButtonEdit Edit",i.type="text",t.appendChild(i);var s=document.createTextNode(e);return t.appendChild(s),i},_createBottomPanel:function(t){var e=this._edit.control.get_form(),i=this._bottomTable=$common.createClassDiv("CalendarBottom");t.appendChild(i);var s=$common.createClassDiv("timeBlock");i.appendChild(s);var o=$createDelegate(this,this.doTimeChange),n=this.createTdAndEdit(s,"时"),r=this.createTdAndEdit(s,"分");if(this._hourEdit=this._createEdit(0,23,n,o,e),this._minuteEdit=this._createEdit(0,59,r,o,e),this._showSecond){var a=this.createTdAndEdit(s,"秒");this._secondEdit=this._createEdit(0,59,a,o,e)}_Z_89.callBaseMethod(this,"_createBottomPanel",[i])},_createEdit:function(t,e,i,s,o){var n={minValue:t,maxValue:e,clickOnly:!0};return $create(Sys.UI.Controls.SpinEdit,n,i,{change:s},o,!1)},doTimeChange:function(t){if(this._rangePopup)this._rangePopup.doTimeChange(this);else{this._setValue()&&this._edit.control.doChange()}},set_date:function(t){var e=this._setValue(t);if(!this._rangePopup){var i=this._edit.control;i.closeUp&&i.closeUp(),e&&i.doChange(),i.focus()}},_setValue:function(t){if(t||(t=new Date(this._year,this._month,this._day)),t=Date.dateToStr(t),t+=" "+this.get_hour()+":"+this.get_minute()+":"+this.get_second(),t=Date.strToDateTime(t),!this._rangePopup){return this._edit.control.set_value(t)}this._rangePopup.set_date(t)}},_Z_89.registerClass("_Z_89",_Z_90),_Z_236=function(t){_Z_236.initializeBase(this,[t]),this.controls=[]},_Z_236.prototype={dispose:function(){this._element&&$clearHandlers(this._element),this._rangeBody&&$clearHandlers(this._rangeBody);for(var t=0,e=this.controls.length;t<e;t++){this.controls[t].dispose()}this._calendar1.dispose(),this._calendar2.dispose(),this.controls=null,_Z_236.callBaseMethod(this,"dispose")},render:function(){var t=this._editControl.isShowTime()?_Z_89:_Z_90,e=this._calendar1=new t(this._edit,!0),i=this._calendar2=new t(this._edit,!0);e._rangePopup=this,i._rangePopup=this,this._editControl.isShowTime()&&(e.set_showSecond(this._showSecond),i.set_showSecond(this._showSecond));var s=this._element=$common.createDiv(),o=this._rangeBody=$common.createClassDiv("RangeBody kind"+this._editControl._editKind);s.appendChild(o),this._createButtons(o);var n=$common.createClassDiv("rightBody");o.appendChild(n);var r=$common.createClassDiv("tBody");n.appendChild(r);var a=$common.createClassDiv("cBody");n.appendChild(a);var l=e.render();$Dom.addCssClass(l,"calendar1"),a.appendChild(l);var h=i.render();$Dom.addCssClass(h,"calendar2"),a.appendChild(h),$common.addMouseDownHandler(s,this.onPopupMouseDown,this),$common.addClickHandler(s,this.onPopupClick,this),$common.addMouseMoveHandler(a,this.mouseMove,this),s.control=this,$common.initPopupElement(s,!0,!1),$Dom.addCssClass(s,"CalendarRange"),this._createBottomPanel(s),document.body.appendChild(s);var d=this._editControl.get_form(),_=this._editControl.isShowTime()?"DateTimeEdit":"DateEdit",c=$createControl(_,{ReadOnly:!0,CssClass:"FlexAuto"},d);c.appendTo(r),this._dateEdit1=d[c.ID];var u=document.createTextNode("—");r.appendChild(u);return(c=$createControl(_,{ReadOnly:!0,CssClass:"FlexAuto"},d)).appendTo(r),this._dateEdit2=d[c.ID],s},_createButtons:function(t){var e=$common.createClassDiv("LeftButtons");t.appendChild(e),this._editControl.get_selectOnly()||this._createButton({text:"清空",tag:"clear"},e);var i=this._editControl.get_rangeItems();Array.forEach(i,function(t){this._createButton(t,e)},this)},_createBottomPanel:function(t){var e=$common.createClassDiv("BottomButtons BottomBlock");t.appendChild(e);var i=this._dateLabel=$common.createClassDiv("DateLabel");e.appendChild(i);var s=$common.createClassDiv("Flex1");e.appendChild(s),this._createButton({text:"确定",tag:"ok"},e,"SpecialButton"),this._createButton({text:"取消",tag:"cancel"},e,"SecondButton")},get_element:function(){return this._element},mouseMove:function(t){if(this._startDate){var e=t.target;if(!Object.isUndefinedOrNull(e._day)&&$Dom.hasClass(e,"mtCurr")){this._waitTimer&&clearTimeout(this._waitTimer);var i=this;this._waitTimer=setTimeout(function(){i._endDate2=i.getCellDate(e),i.renderCalendar()},10)}}},getCellDate:function(t){for(var e,i=t;i;)if((i=i.parentNode).control){e=i.control;break}return e?e.getDayCellDate(t):null},doTimeChange:function(t){var e=this._date1||this._startDate;t==this._calendar1&&e&&(e.setHours(t.get_hour(),t.get_minute(),t.get_second()),this._dateEdit1.set_value(e)),this._date1=e;var i=this._date2||this._endDate;t==this._calendar2&&i&&(i.setHours(t.get_hour(),t.get_minute(),t.get_second()),this._dateEdit2.set_value(i)),this._date2=i,this._timeChanged=!0},checkDateValue:function(t,e){var i=!0;return t._monthType==e.mtPrev?i=!1:t._monthType==e.mtNext&&(i=!1),i},set_maxRangeDay:function(t){this._maxRangeDay=t},set_showSecond:function(t){this._showSecond=t},doInitDate:function(){this._clickDate=null,this._calendar1.doInitDate(!0),this._calendar2.doInitDate(!0),this.renderCalendar()},changeDate:function(t){this.renderCellStyle(t)},renderCalendar:function(){this.renderCellStyle(this._calendar1),this.renderCellStyle(this._calendar2);var t=this._date1||this._startDate,e=this._endDate||this._endDate2,i=0;e&&(i=Math.abs(Date.getDaysBetween(t,e))+1),this._dateLabel.innerHTML='相距<span class="RangeDay">'+i+"</span>天"},clearCellStyle:function(t){for(var e=t._dayCells,i=0,s=e.length;i<s;i++){var o=e[i];t.setDayCellStyle(o,"","","")}},renderCellStyle:function(t){for(var e=t._dayCells,i=0,s=e.length;i<s;i++)this.raiseDayRendering(e[i],t)},raiseDayRendering:function(t,e){if(e.setDayCellStyle(t,"","",""),this.checkDateValue(t,e)){var i=this._date1||this._startDate,s=this._date2||this._endDate||this._endDate2;if(i&&s&&i>s){var o=i;i=s,s=o}var n=e.getDayCellDate(t);if(i){var r=Date.getDaysBetween(i,n);if(r>0)return;if(0==r)return void e.setDayCellStyle(t,"","","start")}if(s){var a=Date.getDaysBetween(s,n);0==a?e.setDayCellStyle(t,"","","end"):a>0&&e.setDayCellStyle(t,"","","inRange")}}},_getDateValue:function(t){var e=this._editControl.get_text(),i=this._editControl.get_splitterText();if(!e||e.indexOf(i)<1){var s=new Date;return t==this._calendar1?(s.setMonth(s.getMonth()-1),this._setTime(s,0,0,0),s):(this._setTime(s,23,59,59),s)}var o=e.split(this._editControl.get_splitterText(!0)),n=o[0],r=o[1],a=this._editControl.isShowTime();if(t==this._calendar1)return this._startDate=a?Date.strToDateTime(n):Date.strToDate(n),this._dateEdit1.set_value(this._startDate),this._startDate;this._endDate=a?Date.strToDateTime(r):Date.strToDate(r);return(r=a?Date.strToDateTime(r):Date.strToDate(r)).getMonth()-this._startDate.getMonth()==0&&r.setMonth(r.getMonth()+1),this._dateEdit2.set_value(this._endDate),r},doButtonClick:function(t){var e=t.get_tag();if("clear"!=e)if("cancel"!=e){if("ok"==e)return this._date1?($common.checkTips(!this._date2,"请选择结束日期"),void this._setDate(this._date1,this._date2)):void this._editControl.closeUp();var i=0;e<0&&(e=30*(-1*e+9),i=90);var s=new Date;s.setDate(s.getDate()-e),this._setTime(s,0,0,0);var o=this._date2=new Date;i>0&&o.setDate(o.getDate()-i),this._setTime(o,23,59,59),this._setDate(s,o,!0)}else this._editControl.closeUp();else this._setControl("")},doCloseUp:function(){return!this._calendar1||(this._calendar1.doCloseUp(),this._calendar2.doCloseUp(),this._date1=this._date2=this._endDate2=null,!0)},_setTime:function(t,e,i,s){t.setHours(e,i,s,0)},_setDate:function(t,e,i){if(this._maxRangeDay>0){var s=Date.getDaysBetween(e,t);if(s>this._maxRangeDay)return void $common.showTips("最大间隔日期不能超过‘"+this._maxRangeDay+"’天,当前间隔‘"+s+"’天")}$common.hideTips();var o=this._getText(t,e);this._setControl(o)},_getText:function(t,e){var i=this._editControl,s=i._editKind==_Z_49.normal?Date.dateTimeToStr(t):Date.dateToStr(t),o=e?i._editKind==_Z_49.normal?Date.dateTimeToStr(e):Date.dateToStr(e):"";return s+i.get_splitterText()+o},_setControl:function(t){var e=this._editControl;e.set_text(t),e.closeUp&&(e._hasEditor=!1,e.closeUp()),e.doChange(),this._date1=this._clickDate=this._endDate2=null},set_date:function(t){"string"==typeof t&&(t=Date.strToDateTime(t));var e=this._editControl.isShowTime();if(!this._clickDate||this._date1&&this._date2){e&&this._setTime(t,this._calendar1.get_hour(),this._calendar1.get_minute(),this._calendar1.get_second()),this._date2=null,this._date1=this._startDate=this._clickDate=t,this._endDate=null,this._endDate2=null,this.clearCellStyle(this._calendar1),this.clearCellStyle(this._calendar2),this._dateEdit1.set_value(this._date1),this._dateEdit2.set_value(null);var i=this._calendar1.getDayCellByDate(t);return i&&this.checkDateValue(i,this._calendar1)||(i=this._calendar2.getDayCellByDate(t)),void(i&&this._calendar2.setDayCellStyle(i,"","","start"))}var s=!1;t<this._date1?(this._date2=this._date1,this._date1=t):t.getTime()==this._date1.getTime()&&e?(this._setTime(this._date1,0,0,0),this._setTime(t,23,59,59),this._date2=t,s=!0):this._date2=t,this._renderDate(s)},_renderDate:function(t){this._editControl.isShowTime()&&!t&&(this._setTime(this._date1,this._calendar1.get_hour(),this._calendar1.get_minute(),this._calendar1.get_second()),this._setTime(this._date2,this._calendar2.get_hour(),this._calendar2.get_minute(),this._calendar2.get_second())),this._dateEdit1.set_value(this._date1),this._dateEdit2.set_value(this._date2),this.renderCalendar()},_createButton:function(t,e,i){i=$skin.joinCssClass("Button",i);var s=document.createElement("button");s.innerHTML=t.text,s.className=i,e.appendChild(s);var o=Sys.UI.Controls.FlatButton.create(s,$createDelegate(this,this.doButtonClick));return o.set_tag(t.tag),this.controls.push(o),s},doPrevDay:function(){},doNextDay:function(){},doPrevWeek:function(){},doNextWeek:function(){},doPrevMonth:function(){},doNextMonth:function(){},doMonthFirstDay:function(){},doMonthLastDay:function(){},doSelectCurrDayCell:function(){}},_Z_236.registerClass("_Z_236",_Z_90),Sys.UI.Controls.Calendar=function(t){Sys.UI.Controls.Calendar.initializeBase(this,[t]),this._tabIndex=-1},Sys.UI.Controls.Calendar.prototype={initialize:function(){Sys.UI.Controls.Calendar.callBaseMethod(this,"initialize"),$craba._initMinMaxDateValue(this);var t=this.get_element(),e=this._internalCalendar=new _Z_90(t,!0),i=e.render();t.appendChild(i),e.initialize(),e.doInitDate()},dispose:function(){this._internalCalendar&&(this._internalCalendar.dispose(),this._internalCalendar=null),Sys.UI.Controls.Calendar.callBaseMethod(this,"dispose")},get_value:function(){return this.get_date()},set_value:function(t){var e=this.get_text();return Date.dateToStr(t)!=e&&(this.set_date(t),!0)},get_minValue:function(){return this._minValue},set_minValue:function(t){this._minValue=t,this.get_isInitialized()&&$craba._initMinMaxDateValue(this)},get_maxValue:function(){return this._maxValue},set_maxValue:function(t){this._maxValue=t,this.get_isInitialized()&&$craba._initMinMaxDateValue(this)},get_text:function(){return Date.dateToStr(this.get_date())},set_text:function(t){this.set_date(Date.strToDate(t))},get_date:function(){var t=this._date;return t||new Date},set_date:function(t){this._date=t,this._internalCalendar&&this._internalCalendar.doInitDate()},setDayStyle:function(t,e,i,s){this._internalCalendar.setDayCellStyleByDate(t,e,i,s)},getDayCell:function(t){return this._internalCalendar.getDayCellByDate(t)},add_dayRendering:function(t){this.get_events().addHandler("_dayRendering",t)},remove_dayRendering:function(t){this.get_events().removeHandler("_dayRendering",t)}},Sys.UI.Controls.Calendar.registerClass("Sys.UI.Controls.Calendar",_Z_233),_Z_173=function(t,e,i){_Z_173.initializeBase(this),this._date=e,this._cell=t,this._cssClass="",this._fontColor="",this._bgColor="",this._index=i},_Z_173.prototype={get_date:function(){return this._date},get_cell:function(){return this._cell},get_index:function(){return this._index},set_bgColor:function(t){this._bgColor=t},set_fontColor:function(t){this._fontColor=t},set_cssClass:function(t){this._cssClass=t}},_Z_173.registerClass("_Z_173",Sys.EventArgs),Sys.UI.Controls.DateEdit=function(t){Sys.UI.Controls.DateEdit.initializeBase(this,[t]),this._requireKeyDown=!0,this._requireKeyPress=!0,this._curDate=new Date,this._icon="aicon-rili"},Sys.UI.Controls.DateEdit.prototype={initialize:function(){Sys.UI.Controls.DateEdit.callBaseMethod(this,"initialize"),$common.disableIme(this.get_element()),$craba._initMinMaxDateValue(this)},dispose:function(){this._calendarPopup&&(this._calendarPopup.dispose(),this._calendarPopup=null),Sys.UI.Controls.DateEdit.callBaseMethod(this,"dispose")},canDropDown:function(){return!this.get_readOnly()||this._selectOnly||this._useClick},_initButtons:function(){this.addButton(new _Z_67(this,this._icon))},textToValue:function(t){return Date.toDateTime(Date.strToDate(t))},valueToStr:function(t){return Date.dateToStr(t)},doGetValue:function(t){var e=this.get_text();if(e){if(!this._date){var i=this.textToValue(e);i&&i.getFullYear()<$settings.DateYearMinValue?($common.showHint("对不起，系统支持输入的最小年份为:"+$settings.DateYearMinValue,this,2),i=null):i&&i.getFullYear()>$settings.DateYearMaxValue&&($common.showHint("对不起，系统支持输入的最大年份为:"+$settings.DateYearMaxValue,this,2),i=null),this.set_value(i)}}else this._date=null;var s=this._date;return s||(this._required?null:t?this._defaultValue:null)},get_date:function(){return Date.strToDate(this.get_text())},get_value:function(){return this.doGetValue(!0)},set_value:function(t){if("string"==typeof t&&(t=this.textToValue(t)),this.get_isInitialized()&&t&&!$craba._checkDateValue(this,t))return $common.showTips(this._getCheckText(),null,this);this._date=t;var e=this.get_text(),i=this.valueToStr(t);return i!=e&&(this.set_text(i),!0)},_getCheckText:function(){var t="日期超出预设范围";return this._minValue&&(t+=",最小日期:"+Date.dateToStr(this._minValue)),this._maxValue&&(t+=",最大日期:"+Date.dateToStr(this._maxValue)),t},get_editValue:function(){return this.doGetValue(!1)},get_defaultValue:function(){return this._defaultValue},set_defaultValue:function(t){"string"==typeof t&&(t=this.textToValue(t)),this._defaultValue=t,this._date||this.set_value(t)},get_minValue:function(){return this._minValue},set_minValue:function(t){this._minValue=t,this.get_isInitialized()&&($craba._initMinMaxDateValue(this),this._calendarPopup&&this._calendarPopup.doInitDate(!0))},get_maxValue:function(){return this._maxValue},set_maxValue:function(t){this._maxValue=t,this.get_isInitialized()&&($craba._initMinMaxDateValue(this),this._calendarPopup&&this._calendarPopup.doInitDate(!0))},doConvertType:function(t,e){return e==_Z_59.string?Date.dateToStr(t):t},_baseDoChange:function(t){Sys.UI.Controls.DateEdit.callBaseMethod(this,"doChange",[t])},doChange:function(t){this._date=null,this._baseDoChange(t)},doBlur:function(t){if(!this._date){var e=this.doGetValue(!1);this._date||this.set_value(e)}Sys.UI.Controls.DateEdit.callBaseMethod(this,"doBlur",[t])},get_userText:function(){return this.userText},_documentClick:function(t){this._hasEditor=!1,Sys.UI.Controls.DateEdit.callBaseMethod(this,"_documentClick",[t]),this.doBlur()},_canBlur:function(t){return!this._hasEditor},createPopupWindow:function(){return this._calendarPopup=new _Z_90(this.get_element()),this._calendarPopup.render()},closeUp:function(t){if(!this.get_droppedDown())return!1;var e=!0;return this._calendarPopup&&(e=this._calendarPopup.doCloseUp()),!!e&&(Sys.UI.Controls.DateEdit.callBaseMethod(this,"closeUp",[t]),!0)},doInitPopup:function(t){this._hasEditor=!0,this._calendarPopup&&!t&&this._calendarPopup.doInitDate(),Sys.UI.Controls.DateEdit.callBaseMethod(this,"doInitPopup",[t])},doKeyDown:function(t){var e=t.keyCode,i=this.get_droppedDown(),s=i,o=t.ctrlKey||t.shiftKey;switch(e){case Sys.UI.Key.left:i&&this._calendarPopup.doPrevDay();break;case Sys.UI.Key.right:i&&this._calendarPopup.doNextDay();break;case Sys.UI.Key.up:i?t.altKey?this.closeUp():this._calendarPopup.doPrevWeek():this.get_isInPlace()||(this._incYearMonthDay(1),s=!0);break;case Sys.UI.Key.down:i?this._calendarPopup.doNextWeek():t.altKey?(this.dropDown(),s=!0):this.get_isInPlace()||(this._incYearMonthDay(-1),s=!0);break;case Sys.UI.Key.pageUp:i&&this._calendarPopup.doPrevMonth();break;case Sys.UI.Key.pageDown:i&&this._calendarPopup.doNextMonth();break;case Sys.UI.Key.home:i&&this._calendarPopup.doMonthFirstDay();break;case Sys.UI.Key.end:i&&this._calendarPopup.doMonthLastDay();break;case Sys.UI.Key.enter:s=!!i&&this._calendarPopup.doSelectCurrDayCell(t);break;case Sys.UI.Key.esc:s=!1;break;case Sys.UI.Key.ime:s=!0;break;case Sys.UI.Key.space:this.toggleDroppedDown(),s=!0}s||e>=48&&e<=57&&o?t.cancel():Sys.UI.Controls.DateEdit.callBaseMethod(this,"doKeyDown",[t])},doKeyPress:function(t){if(t.ctrlKey||t.shiftKey)Sys.UI.Controls.DateEdit.callBaseMethod(this,"doKeyPress",[t]);else{var e=t.charCode,i=!0;if(e>=32){var s=this._getCaretInfo();if(e>=48&&e<=57){var o=e>=48&&e<=49,n=e>=48&&e<=51;i=s.inMonth10?o:s.inDay10?n:s.pos<=10}else i=45==e&&!s.full}i?(this._date=null,Sys.UI.Controls.DateEdit.callBaseMethod(this,"doKeyPress",[t])):t.preventDefault()}},_getCaretInfo:function(){var t={},e=this.get_text();t.len=e.length;var i=t.pos=this.get_caretPos();i<0&&(i=t.pos=e.length);var s=e.indexOf("-"),o=-1;return s>=0&&(o=e.indexOf("-",s+1)),t.full=s>=0&&o>=0,s>=0&&o>=0?i<s?t.inYear=!0:i>s&&i<o?t.inMonth=!0:i>o&&(t.inDay=!0):s>=0?4==s?i<s?t.inYear=!0:i>s&&(t.inMonth=!0):i<s?t.inMonth=!0:i>s&&(t.inDay=!0):s<0&&(t.inYear=!0),t},_incYearMonthDay:function(t){if(!this.get_readOnly()){this._date=null;var e=this.get_editValue();if(e){var i=this._getCaretInfo(),s=(e.getFullYear(),e.getMonth()),o=e.getDate();i.inYear?e.setDate(o+t):i.inMonth?e.setMonth(s+t):i.inDay&&(i.inDay10&&(t*=10),e.setDate(o+t)),this.set_value(e);var n=i.pos+this.get_text().length-i.len;$common.setCaretPosition(this.get_element(),n),this._baseDoChange()}}}},Sys.UI.Controls.DateEdit.registerClass("Sys.UI.Controls.DateEdit",_Z_99),_Z_53=function(){throw Error.notImplemented()},_Z_53.prototype={yearMonth:0,year:1,monthDay:2,month:3},_Z_53.registerEnum("_Z_53"),Sys.UI.Controls.MonthEdit=function(t){Sys.UI.Controls.MonthEdit.initializeBase(this,[t]),this._editKind=_Z_53.yearMonth},Sys.UI.Controls.MonthEdit.prototype={set_editKind:function(t){this._editKind=t},get_editKind:function(){return this._editKind},doBlur:function(t){var e=this._oldValue;this.get_editValue()&&(this._checkYearMonth(this._date.getFullYear(),this._date.getMonth())||($common.showTips("日期超出预设范围，已恢复原值",0,this),this.set_value(e))),Sys.UI.Controls.MonthEdit.callBaseMethod(this,"doBlur",[t])},_checkYear:function(t){return this._minValue&&this._maxValue?t-this._minValue.getFullYear()>=0&&this._maxValue.getFullYear()-t>=0:this._minValue?t-this._minValue.getFullYear()>=0:!this._maxValue||this._maxValue.getFullYear()-t>=0},_checkYearMonth:function(t,e){var i=new Date(t,e,1);if(this._minValue&&this._maxValue){var s=new Date(this._minValue.getFullYear(),this._minValue.getMonth(),1),o=new Date(this._maxValue.getFullYear(),this._maxValue.getMonth(),1);return i-s>=0&&o-i>=0}if(this._minValue){return i-(s=new Date(this._minValue.getFullYear(),this._minValue.getMonth(),1))>=0}if(this._maxValue){return(o=new Date(this._maxValue.getFullYear(),this._maxValue.getMonth(),1))-i>=0}return!0},doGetValue:function(t){var e=this.get_text();if(e){if(!this._date){this._editKind==_Z_53.yearMonth?e.length<8&&(e+="-01"):this._editKind==_Z_53.monthDay?e.length<3&&(e=this._curDate.getMonth()+1+"-"+e):this._editKind==_Z_53.month?e=this._curDate.getFullYear()+"-"+e+"-01":e.length<5&&(e.length>3?e+="-01-01":e=this._curDate.getFullYear()+parseInt(e)+"-01-01");var i=Date.strToDate(e);this.set_value(i)}}else this._date=null;var s=this._date;return s||(t?this._defaultValue:null)},set_value:function(t){"string"==typeof t&&(t=Date.strToDate(t)),this._date=t;var e=this.get_text(),i="";return t&&(i=this._editKind==_Z_53.yearMonth?t._format("yyyy-MM"):this._editKind==_Z_53.monthDay?t._format("MM-dd"):this._editKind==_Z_53.month?(i=t._format("MM")).trimStart("0"):t._format("yyyy")),i!=e&&(this.set_text(i),!0)},createPopupWindow:function(){return this._editKind==_Z_53.monthDay?Sys.UI.Controls.MonthEdit.callBaseMethod(this,"createPopupWindow"):(this._calendarPopup=new _Z_88(this.get_element()),this._calendarPopup.render())},_incYearMonth:function(t){},doKeyDown:function(t){var e=t.keyCode,i=this.get_droppedDown(),s=i;switch(e){case Sys.UI.Key.left:i&&this._calendarPopup.doPrevMonth();break;case Sys.UI.Key.right:i&&this._calendarPopup.doNextMonth();break;case Sys.UI.Key.up:i?t.altKey?this.closeUp():this._calendarPopup.doPrevMonth():this.get_isInPlace()||(this._incYearMonth(1),s=!0);break;case Sys.UI.Key.down:i?this._calendarPopup.doNextMonth():t.altKey?(this.dropDown(),s=!0):this.get_isInPlace()||(this._incYearMonth(-1),s=!0);break;case Sys.UI.Key.pageUp:i&&this._calendarPopup.doPrevYear();break;case Sys.UI.Key.pageDown:i&&this._calendarPopup.doNextYear();break;case Sys.UI.Key.home:i&&this._calendarPopup.doFirstMonth();break;case Sys.UI.Key.end:i&&this._calendarPopup.doLastMonth();break;case Sys.UI.Key.enter:i&&this._calendarPopup.doSelectDate(),s=!1;break;case Sys.UI.Key.esc:s=!1;break;case Sys.UI.Key.ime:s=!0;break;case Sys.UI.Key.space:this.toggleDroppedDown(),s=!0}s&&t.cancel()},get_bounds:function(){var t=this.get_element();return t._outerElement&&(t=t._outerElement),$Dom.getBounds(t)}},Sys.UI.Controls.MonthEdit.registerClass("Sys.UI.Controls.MonthEdit",Sys.UI.Controls.DateEdit),_Z_88=function(t){_Z_88.initializeBase(this),this._edit=t,this._editControl=t.control,this._editKind=t.control.get_editKind(),this._monthCells=[],this._yearCells=[],this._years=[],this._year=-1,this._month=-1},_Z_88.prototype={dispose:function(){this._dateTable&&($clearHandlers(this._dateTable),this._dateTable=null,this._yearCells=null,this._monthCells=null),$clearHandlers(this._prevYearArrow),$clearHandlers(this._nextYearArrow),this._nextYearArrow=null,this._prevYearArrow=null,this._yearEdit&&(this._yearEdit.dispose(),this._yearEdit=null),_Z_88.callBaseMethod(this,"dispose")},doInitDate:function(t){this._isIniting=!0;var e=this._editControl.get_editValue();e||(e=new Date),this.changeDate(e.getFullYear(),e.getMonth()+1),this._yearEdit&&this._yearEdit.set_value(this._year),this._isIniting=!1},_addVLine:function(t){var e=$common.createClassDiv("VLine");t.appendChild(e)},_addArrow:function(t,e,i){var s=$common.createArrow(e);return $common.addMouseDownHandler(s,i,this),t.appendChild(s),s},renderYearBlock:function(t){if(this._editKind!=_Z_53.month){var e=$common.createClassDiv("YearBlock");t.appendChild(e);var i=$common.createClassDiv("YearArrowRow");e.appendChild(i);var s=this._createArrowTd(i);this._prevYearArrow=this._addArrow(s,"DateArrow ArrowLeft",this.doPrevYear);var o=this._createArrowTd(i);this._nextYearArrow=this._addArrow(o,"DateArrow ArrowRight",this.doNextYear);for(var n=1;n<6;n++){var r=this._createYearTd(e);this._yearCells.push(r);var a=this._createYearTd(e);this._yearCells.push(a)}this.createYearEdit(e)}},render:function(){var t=this._dateTable=$common.createDiv(),e=$common.createClassDiv("MonthPopupMain");t.appendChild(e),this.renderYearBlock(e);var i="MonthPopup";if(this._editKind!==_Z_53.year){i+=" yearMonth",this._yearEdit&&this._addVLine(e);var s=$common.createClassDiv("MonthBlock");e.appendChild(s);for(var o=1;o<7;o++){var n=this._createMonthTd(s,o+"月");n._month=o,this._monthCells.push(n);var r=this._createMonthTd(s,o+6+"月");r._month=o+6,this._monthCells.push(r)}}return $common.addMouseUpHandler(t,this.doCellMouseUp,this),$common.addDblClickHandler(t,this.doDblCellClick,this),$common.addMouseDownHandler(t,this.onPopupMouseDown),$common.addClickHandler(t,this.onPopupClick),$common.initPopupElement(t,!0,!1),$Dom.addCssClass(t,i),document.body.appendChild(t),t.control=this,t},createYearEdit:function(t){var e=$common.createInput();e._isDateEdit=!0,e.className="Edit",t.appendChild(e),this._yearEdit=$create(Sys.UI.Controls.NumberEdit,{numberType:3,showCalculator:!1,maxLength:4,tabOnEnter:!1},e,{textChanged:$createDelegate(this,this.doYearEditChange),focus:$createDelegate(this,this.doYearEditFocus),enterPress:$createDelegate(this,this.doSelectDate)},this._editControl.get_form(),!0)},doYearEditChange:function(t){var e=t.get_value();e/1e3<1||e/1e3>4||(e=Number(e),isNaN(e)||this.changeDate(e,this._month))},doYearEditFocus:function(t){t.selectText()},_initYear:function(t){if(!(Array.indexOf(this._years,t)>-1)){this._years=[];for(var e=0,i=this._yearCells.length;e<i;e++){var s=this._yearCells[e],o=t;o=e%2==0?t-4+e/2:t+parseInt(e/2)+1,this._years.push(o),s._year=o,s.innerHTML=o}}},_createMonthTd:function(t,e){var i=$common.createDiv();return i.className="_td MonthLabel",i.innerHTML=e,t.appendChild(i),i},_createYearTd:function(t){var e=$common.createDiv();return e.className="_td YearLabel",t.appendChild(e),e},_createArrowTd:function(t){var e=$common.createDiv();return t.appendChild(e),e},onPopupMouseDown:function(t){t.target._isDateEdit||t.cancel()},onPopupClick:function(t){t.cancel()},_checkMinMax:function(){return this._editControl._minValue||this._editControl._maxValue},changeDate:function(t,e){if(this._year!=t||this._month!=e||this._checkMinMax()){if(this._yearEdit){this._initYear(t),this._year=t;for(var i=0,s=this._yearCells.length;i<s;i++){(o=this._yearCells[i])._year==t&&this._setMoveCell(o),$Dom.setEnabled(o,this._editControl._checkYear(o._year))}}this._month=e;for(var i=0,s=this._monthCells.length;i<s;i++){var o=this._monthCells[i];o._month==e&&this._setMoveCell(o),$Dom.setEnabled(o,this._editControl._checkYearMonth(this._year,o._month-1))}}},_findCell:function(t){var e=t.target,i=e._year||e._month?e:null;return i&&(i._year?Array.indexOf(this._yearCells,i)<0&&(i=null):i._month?Array.indexOf(this._monthCells,i)<0&&(i=null):i=null),i},doCellMouseUp:function(t){var e=this._findCell(t);e&&$Dom.getEnabled(e)&&(this._setMoveCell(e),e._year&&this.changeDate(this._year,this._month),this._editKind!=_Z_53.yearMonth&&this.doSelectDate(t)),t.stopPropagation()},_setMoveCell:function(t){t._year?(this._selectYearCell&&this._setCellSelected(this._selectYearCell,!1),this._selectYearCell=t,this._year=t._year,this._setCellSelected(this._selectYearCell,!0)):(this._selectMonthCell&&this._setCellSelected(this._selectMonthCell,!1),this._selectMonthCell=t,this._month=t._month,this._setCellSelected(this._selectMonthCell,!0))},_setCellSelected:function(t,e){e?($Dom.addCssClass(t,"selected"),this.doSelectDate(null,!0)):$Dom.removeCssClass(t,"selected")},doNextMonth:function(){var t=this._year,e=this._month;this._editKind==_Z_53.year?t+=1:12==e?(e=1,t+=1):e+=1,this.changeDate(t,e)},doPrevMonth:function(){var t=this._year,e=this._month;this._editKind==_Z_53.year?t-=1:1==e?(e=12,t-=1):e-=1,this.changeDate(t,e)},doFirstMonth:function(){var t=this._year,e=this._month;this._editKind==_Z_53.year?t=this._years[0]:e=1,this.changeDate(t,e)},doLastMonth:function(){var t=this._year,e=this._month;this._editKind==_Z_53.year?t=this._years[this._years.length-1]:e=12,this.changeDate(t,e)},doPrevYear:function(t){this.changeDate(this._year-5,this._month)},doNextYear:function(t){this.changeDate(this._year+5,this._month)},doDblCellClick:function(t){var e=t.target;(e._year||e._month)&&this.doSelectDate(t,!1)},doCloseUp:function(){return!0},doSelectDate:function(t,e){if(!this._isIniting){var i=(new Date).getFullYear();this._selectYearCell&&(i=this._selectYearCell._year);var s="01";this._selectMonthCell&&(s=this._selectMonthCell._month);var o=i+"-"+s+"-01",n=Date.strToDate(o);n?this._editControl._checkYearMonth(n.getFullYear(),n.getMonth())&&this.set_date(n,e):$common.showTips("日期格式不正确，请重新输入")}},set_date:function(t,e){var i=this._editControl;if(e){i.set_value(t)&&i.doChange()}i.closeUp&&1!=e&&(i._hasEditor=!1,i.closeUp())}},_Z_88.registerClass("_Z_88",_Z_242),Sys.UI.Controls.DateLimitEdit=function(t){Sys.UI.Controls.DateLimitEdit.initializeBase(this,[t]),this._dateEdit=null},Sys.UI.Controls.DateLimitEdit.prototype={initialize:function(){Sys.UI.Controls.DateLimitEdit.callBaseMethod(this,"initialize"),$common.disableIme(this.get_element()),this.set_maxLength(6),this._minValue&&(this._minValue=$common.toMinDate(this._minValue));var t=this.get_dateEdit();if(t){this.get_form()[t].add_change(this._doLinkChange,this)}},_doLinkChange:function(t){this.set_value(this._date)},doChange:function(t){this._baseDoChange(t)},doFocus:function(t){var e=this.get_value();e&&(this.set_text(e),this.selectText()),Sys.UI.Controls.DateEdit.callBaseMethod(this,"doFocus",[t])},doBlur:function(t){var e=this.get_value();Object.isUndefinedOrNull(e)?this.set_text(""):e>0?this.set_value(e):this.set_value(this._date),Sys.UI.Controls.DateEdit.callBaseMethod(this,"doBlur",[t])},doKeyDown:function(t){var e=t.keyCode,i=this.get_droppedDown(),s=i;switch(e){case Sys.UI.Key.up:i||(this.set_value(this.get_value()+1),s=!0);break;case Sys.UI.Key.down:i||(this.set_value(this.get_value()-1),s=!0)}s?t.cancel():Sys.UI.Controls.DateLimitEdit.callBaseMethod(this,"doKeyDown",[t])},doKeyPress:function(t){if(t.ctrlKey||t.shiftKey)Sys.UI.Controls.DateLimitEdit.callBaseMethod(this,"doKeyPress",[t]);else{var e=t.charCode;e>=32&&(e<48||e>57)?t.preventDefault():Sys.UI.Controls.DateLimitEdit.callBaseMethod(this,"doKeyPress",[t])}},get_dateEdit:function(){return this._dateEdit},set_dateEdit:function(t){this._dateEdit=t},_getDateValue:function(t){return this.toDate()},_getDate:function(){var t=this.get_dateEdit();if(t){var e=this.get_form()[t].get_value();if(e)return new Date(e.getTime())}return new Date},toDate:function(){var t=this.get_value(),e=this._getDate();return e.setDate(e.getDate()+t),e},get_value:function(){var t=Number.parse(this.get_text());return isNaN(t)?this._date?Date.getDaysBetween(this._date,this._getDate()):0:t},doGetValue:function(t){return 0|Number.parse(this.get_text())},set_value:function(t){if(Object.isUndefinedOrNull(t))return this._date=null,void this.set_text("");var e=this._getDate(),i=0;if("number"==typeof t?(e.setDate(e.getDate()+t),i=t):(i=Date.getDaysBetween(t,e),e=t),this._minValue){if(Date.getDaysBetween(e,this._minValue)<0)return $common.alert("所选日期不能小于日期 "+Date.dateToStr(this._minValue));this.set_text(i+" 天"),this._date=e}else i>=0?(this.set_text(i+" 天"),this._date=e):$common.alert("所选日期不能小于最低期限 "+Date.dateToStr(this._getDate()))}},Sys.UI.Controls.DateLimitEdit.registerClass("Sys.UI.Controls.DateLimitEdit",Sys.UI.Controls.DateEdit),_Z_49=function(){throw Error.notImplemented()},_Z_49.prototype={normal:0,date:1},_Z_49.registerEnum("_Z_49"),Sys.UI.Controls.DateTimeEdit=function(t){Sys.UI.Controls.DateTimeEdit.initializeBase(this,[t]),this._editKind=_Z_49.normal,this._showSecond=!0,this._defaultTime},Sys.UI.Controls.DateTimeEdit.prototype={initialize:function(){Sys.UI.Controls.DateTimeEdit.callBaseMethod(this,"initialize"),this.set_editKind(this._editKind)},textToValue:function(t){var e=Date.strToDateTime(t);if(e)return e;var i=t.split(" ");return i[0]&&(t=i[0]),Date.strToDate(t)},valueToStr:function(t){return this._editKind==_Z_49.normal?Date.dateTimeToStr(t):Date.dateToStr(t)},set_text:function(t){Sys.UI.Controls.DateTimeEdit.callBaseMethod(this,"set_text",[t]),this.set_hint(t)},doChange:function(t){Sys.UI.Controls.DateTimeEdit.callBaseMethod(this,"doChange",[t]),this.set_hint(this.get_text())},doKeyPress:function(t){if(!t.ctrlKey&&!t.shiftKey){var e=t.charCode;e>=48&&e<=57||45==e||58==e||t.preventDefault()}},createPopupWindow:function(){return this._calendarPopup=new _Z_89(this.get_element()),this._calendarPopup.set_showSecond(this.get_showSecond()),this._calendarPopup.render()},set_editKind:function(t){this._editKind=t,this.get_isInitialized()&&this.set_value(this.get_value())},get_editKind:function(){return this._editKind},set_showSecond:function(t){this._showSecond=t},get_showSecond:function(){return this._showSecond},set_defaultTime:function(t){this._defaultTime=t},get_defaultTime:function(){return this._defaultTime}},Sys.UI.Controls.DateTimeEdit.registerClass("Sys.UI.Controls.DateTimeEdit",Sys.UI.Controls.DateEdit),Sys.UI.Controls.DateRangeEdit=function(t){Sys.UI.Controls.DateRangeEdit.initializeBase(this,[t]),this._splitterText="至",this._maxRangeDay=0,this._valueType=_Z_59.date},Sys.UI.Controls.DateRangeEdit.prototype={_incYearMonthDay:function(){},get_rangeItems:function(){return this._rangeItems||[{text:"今天",tag:0},{text:"近7天",tag:6},{text:"近15天",tag:14},{text:"近1月",tag:29},{text:"近3个月",tag:90},{text:"3个月前",tag:-3}]},set_rangeItems:function(t){this._rangeItems=t},get_useClick:function(){return this._useClick},set_useClick:function(t){this._useClick=t},set_layoutDirection:function(t){this._layoutDirection=t},get_layoutDirection:function(){return this._layoutDirection},dataBind:function(t){var e=this._dataStartField,i=this._dataEndField;if(e&&i){var s=this.get_form().get_dataController(),o=t?t[e]:s.getValue(e),n=t?t[i]:s.getValue(i);o&&n?this.set_date(Date.strToDateTime(o),Date.strToDateTime(n)):this.set_value(""),this.doDataBind()}else Sys.UI.Controls.DateRangeEdit.callBaseMethod(this,"dataBind")},doSaveData:function(t){var e=this._dataStartField,i=this._dataEndField;if(e&&i){var s=this.get_form().get_dataController(),o=this.get_date();s.setValue(e,o[0]),s.setValue(i,o[1]),t||this._validate(o[0])}else Sys.UI.Controls.DateRangeEdit.callBaseMethod(this,"doSaveData",[t])},_toType:function(t){var e=this._valueType,i=this.isShowTime();return e==_Z_59.date?i?Date.strToDateTime(t):Date.strToDate(t):t},set_dataStartField:function(t){this._dataStartField=t},get_dataStartField:function(){return this._dataStartField},set_dataEndField:function(t){this._dataEndField=t},get_dataEndField:function(){return this._dataEndField},set_maxRangeDay:function(t){this._maxRangeDay=t},get_maxRangeDay:function(){return this._maxRangeDay},set_editKind:function(t){this._editKind=t},isShowTime:function(){return this._editKind==_Z_50.normal},doGetValue:function(){var t=this.get_text(),e=this.get_date();return e[0]&&e[1]||(t=""),t},set_value:function(t){Object.isUndefinedOrNull(t)&&(t=""),this.set_text(t)},set_text:function(t){if(t){var e=t.split(this.get_splitterText(!0));if(2==e.length){var i=this.get_splitterText();i=this._layoutDirection==Sys.UI.Controls.LayoutDirection.vert?"\r\n":"   "+i+"   ",t=e[0].trim()+i+e[1].trim()}}Sys.UI.Controls.DateRangeEdit.callBaseMethod(this,"set_text",[t])},get_text:function(){var t=Sys.UI.Controls.DateRangeEdit.callBaseMethod(this,"get_text");if(t){var e=t.split(this.get_splitterText(!0));2==e.length&&(t=e[0].trim()+this.get_splitterText()+e[1].trim())}return t},get_date:function(){var t=this.get_text(),e=["",""];if(!t)return e;var i=t.split(this.get_splitterText(!0));if(2==i.length&&i[0].length>8&&i[1].length>8){e[0]=this._toType(i[0]),e[1]=this._toType(i[1]);!this.isShowTime()&&e[0]&&e[1]&&(e[0].getTime()==e[1].getTime()&&e[0].setHours(0,0,0,0),e[1].setHours(23,59,59,59))}return e},set_date:function(t,e){var i=this.isShowTime();t instanceof Date&&(t=i?Date.dateTimeToStr(t):Date.dateToStr(t)),e instanceof Date&&(e=i?Date.dateTimeToStr(e):Date.dateToStr(e)),this.set_text(t+this.get_splitterText()+e)},get_splitterText:function(t){return this._layoutDirection==Sys.UI.Controls.LayoutDirection.vert?t?/\n/:"\r\n":this._splitterText},set_splitterText:function(t){this._splitterText=t},createPopupWindow:function(){return this._calendarPopup=new _Z_236(this.get_element()),this._calendarPopup.set_showSecond(this.get_showSecond()),this._calendarPopup.set_maxRangeDay(this.get_maxRangeDay()),this._calendarPopup.render()},_getDateValue:function(t){return this._calendarPopup._getDateValue(t)}},Sys.UI.Controls.DateRangeEdit.registerClass("Sys.UI.Controls.DateRangeEdit",Sys.UI.Controls.DateTimeEdit),Sys.UI.Controls.ColorEdit=function(t){Sys.UI.Controls.ColorEdit.initializeBase(this,[t]),this._closeColorBox=!0,this._icon="aicon-bg-colors"},Sys.UI.Controls.ColorEdit.prototype={initialize:function(){Sys.UI.Controls.ColorEdit.callBaseMethod(this,"initialize"),$common.disableIme(this.get_element()),this.set_maxLength(7)},dispose:function(){this._colorPopup&&(this._colorPopup.dispose(),this._colorPopup=null),Sys.UI.Controls.ColorEdit.callBaseMethod(this,"dispose")},_initPopupSize:function(){$Dom.setVisible(this._popupWindow,!0)},doFormLoaded:function(){Sys.UI.Controls.ColorEdit.callBaseMethod(this,"doFormLoaded"),this._initButtonStyle(this._value)},_initButtons:function(){this.addButton(new _Z_67(this,this._icon))},createPopupWindow:function(){return this._colorPopup=new _Z_87(this),this._colorPopup.render()},doInitPopup:function(){this._colorPopup&&(this._colorPopup._refreshHistory(),Sys.UI.Controls.ColorEdit.callBaseMethod(this,"doInitPopup"))},_initOldValue:function(t){t||Sys.UI.Controls.ColorEdit.callBaseMethod(this,"_initOldValue",[t])},get_closeColorBox:function(){return this._closeColorBox},set_closeColorBox:function(t){this._closeColorBox=t},doChange:function(t){var e=this._element.value;if(e){var i=e.toUpperCase();if(!/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(i))return;this._value=e}Sys.UI.Controls.ColorEdit.callBaseMethod(this,"doChange",[t])},get_value:function(){return this._value},set_value:function(t){if(t||(t=this.get_defaultValue()),t){t.startsWith("#")||(t="#"+t);var e=t.toUpperCase();/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e)?(this._value=t,this.set_text(t)):($common.showHint("格式错误，已恢复默认颜色；格式应以‘#’开头，如：#000、#000000",this,4),this.set_text(this._value)),this._initButtonStyle(this._value)}},get_defaultValue:function(){return this._defaultValue},set_defaultValue:function(t){this._defaultValue=t,this._value||this.set_value(t)}},Sys.UI.Controls.ColorEdit.registerClass("Sys.UI.Controls.ColorEdit",_Z_99),_Z_87=function(t,e){_Z_87.initializeBase(this),this._control=t,this._cacheKey="__colorHistory",this._isInPlace=e},_Z_87.prototype={dispose:function(){_Z_87.callBaseMethod(this,"dispose"),$clearHandlers(this._element)},render:function(){var t=this._element=$common.createDiv(),e=$common.createFragment();e.appendChild(t);var i=["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc7","#f79646"];this._createBlock("调色板","TSBlock",i);return this._createColorBody(t,"BodyBlock",["#f2f2f2","#d9d9d9","#bfbfbf","#a6a6a6","#808080","#808080","#595959","#404040","#262626","#0d0d0d","#ddd9c3","#c4bd97","#948a54","#4a452a","#1e1c11","#c6d9f1","#8eb4e3","#558ed5","#17375e","#10243f","#dce6f2","#b9cde5","#95b3d7","#376092","#254061","#f2dcdb","#e6b9b8","#d99694","#953735","#632523","#ebf1de","#d7e4bd","#c3d69b","#77933c","#4f6228","#e6e0ec","#ccc1da","#b3a2c7","#604a7b","#403152","#dbeef4","#b7dee8","#93cddd","#31859c","#215968","#fdeada","#fcd5b5","#fac090","#e46c0a","#984807"]),i=["#c00000","#ff0000","#ffc000","#ffff00","#92d050","#00b050","#00b0f0","#0070c0","#002060","#7030a0"],this._createBlock("标准色","BZBlock",i),this._createBlock("最近使用","ZJBlock",[]),this._isInPlace?(t.className="ColorPopup",this._refreshHistory(),this._control.get_element().appendChild(e)):($common.initPopupElement(t,!0,!0),$Dom.addCssClass(t,"ColorPopup"),document.body.appendChild(e)),$common.addClickHandler(t,this.doBodyClick,this),t},_refreshHistory:function(){var t=$cache.get(this._cacheKey);t||(t=[]);var e=[];if(Array.forEach(t,function(t,i){e.push(t.color)}),0!=e.length){var i=$common.getFirstChildByClassName(this._element,"ZJBlock");i.innerHTML="",$skin.createColorItems(i,e)}},_createBlock:function(t,e,i){var s=this._element,o=$common.createClassDiv("Title");o.innerHTML=t,s.appendChild(o),this._createColorBody(s,e,i)},_createColorBody:function(t,e,i){var s=$common.createClassDiv(e);t.appendChild(s),$skin.createColorItems(s,i)},doBodyClick:function(t){var e=t.target.getAttribute("color");if(e){this._control.set_value(e);var i=$cache.get(this._cacheKey);i||(i=[]),Array.addByKey(i,{color:e},"color",10),$cache.set(this._cacheKey,i),this._isInPlace&&this._refreshHistory()}else this._isInPlace||t.cancel()}},_Z_87.registerClass("_Z_87",_Z_242),Sys.UI.Controls.ColorBlock=function(t){Sys.UI.Controls.ColorBlock.initializeBase(this,[t])},Sys.UI.Controls.ColorBlock.prototype={initialize:function(){Sys.UI.Controls.ColorBlock.callBaseMethod(this,"initialize");(this._popup=new _Z_87(this,!0)).render()},dispose:function(){this._popup&&(this._popup.dispose(),this._popup=null),Sys.UI.Controls.ColorBlock.callBaseMethod(this,"dispose")},get_text:function(){return this.get_value()},set_text:function(t){this.set_value(t)},get_value:function(){return this._value},set_value:function(t){this._value=t,this.doChange()}},Sys.UI.Controls.ColorBlock.registerClass("Sys.UI.Controls.ColorBlock",_Z_233),_Z_86=function(t,e){e=e||"aicon-less",_Z_86.initializeBase(this,[t,e])},_Z_86.prototype={_createElement:function(t,e){var i=this._control,s=t;return i instanceof Sys.UI.Controls.NumberEdit||(s=$common.createClassDiv("SkinButtonBlock"),t.appendChild(s),i._buttonDiv=s),_Z_86.callBaseMethod(this,"_createElement",[s,e])},doMouseDown:function(t){_Z_86.callBaseMethod(this,"doMouseDown",[t]),this._control._clickOnly||$craba.raiseMouseDown(t)},doMouseUp:function(t){_Z_86.callBaseMethod(this,"doMouseUp",[t]),this.get_control().incValue(),this.get_control().focus(!1)}},_Z_86.registerClass("_Z_86",_Z_63),_Z_85=function(t,e){e=e||"aicon-moreunfold",_Z_85.initializeBase(this,[t,e])},_Z_85.prototype={_createElement:function(t,e){var i=$common.createClassDiv("SkinButton "+e);return t.appendChild(i),i},doMouseDown:function(t){_Z_85.callBaseMethod(this,"doMouseDown",[t]),this._control._clickOnly||$craba.raiseMouseDown(t)},doMouseUp:function(t){_Z_85.callBaseMethod(this,"doMouseUp",[t]),this.get_control().decValue(),this.get_control().focus(!1)}},_Z_85.registerClass("_Z_85",_Z_63),Sys.UI.Controls.SpinEdit=function(t){Sys.UI.Controls.SpinEdit.initializeBase(this,[t])},Sys.UI.Controls.SpinEdit.prototype={initialize:function(){Sys.UI.Controls.SpinEdit.callBaseMethod(this,"initialize"),this.get_text()||this._showEmpty||this.set_value(0)},_initButtons:function(){this.addButton(new _Z_86(this)),this.addButton(new _Z_85(this))},canDropDown:function(){return!1},set_clickOnly:function(t){this._clickOnly=t},get_clickOnly:function(){return this._clickOnly}},Sys.UI.Controls.SpinEdit.registerClass("Sys.UI.Controls.SpinEdit",Sys.UI.Controls.NumberEdit),_Z_50=function(){throw Error.notImplemented()},_Z_50.prototype={normal:0,hourAndMinute:1,hour:2},_Z_50.registerEnum("_Z_50"),Sys.UI.Controls.TimeEdit=function(t){Sys.UI.Controls.TimeEdit.initializeBase(this,[t]),this._requireKeyDown=!0,this._requireKeyPress=!0,this._editKind=_Z_50.normal,this._time=null,this._showSecond=!0},Sys.UI.Controls.TimeEdit.prototype={initialize:function(){Sys.UI.Controls.TimeEdit.callBaseMethod(this,"initialize"),$common.disableIme(this.get_element())},set_clickOnly:function(t){this._clickOnly=t},get_clickOnly:function(){return this._clickOnly},get_hour:function(){return 10},get_minute:function(){return 10},get_second:function(){return 10},_initButtons:function(){this.addButton(new _Z_86(this)),this.addButton(new _Z_85(this))},set_minValue:function(t){},get_minValue:function(){},set_maxValue:function(){},get_maxValue:function(){},set_selectOnly:function(t){this._selectOnly=t,this.set_readOnly(t)},get_selectOnly:function(){return this._selectOnly},set_editKind:function(t){this._editKind=t},get_editKind:function(){return this._editKind},set_showSecond:function(t){this._showSecond=t},get_showSecond:function(){return this._showSecond},get_value:function(){var t=this.get_text();return t?((t=(t+=":00:00").substr(0,8)).endsWith(":")&&(t=t.substr(0,7)),this._time=Date.strToTime(t),this._time||(this._time=Date.strToTime("00:00:00"))):this._time=null,this._time},set_value:function(t){var e;"string"==typeof t?(this._time=Date.strToTime(t),e=t):(this._time=t,e=Date.timeToStr(t)),this._editKind==_Z_50.hourAndMinute?e=e.substring(0,e.lastIndexOf(":")):this._editKind==_Z_50.hour&&(e=e.substring(0,e.indexOf(":"))),this.set_text(e)},doChange:function(t){Sys.UI.Controls.TimeEdit.callBaseMethod(this,"doChange",[t]),this._time=null},doBlur:function(t){this._time||this.set_value(this.get_value()),Sys.UI.Controls.TimeEdit.callBaseMethod(this,"doBlur",[t])},doFocus:function(t){Sys.UI.Controls.TimeEdit.callBaseMethod(this,"doFocus",[t]),Sys.Browser.isIE&&this._caretPos>=0&&$common.setCaretPosition(this.get_element(),this._caretPos)},incValue:function(){this._incHourMinSec(1)},decValue:function(){this._incHourMinSec(-1)},_getCaretInfo:function(){var t={},e=this.get_text();t.len=e.length;var i=t.pos=this.get_caretPos();i<0&&(i=t.pos=e.length);var s=e.indexOf(":"),o=-1;return s>=0?(o=e.indexOf(":",s+1),i<s?(t.inHour=!0,t.inHour10=i-1!=s):i>s&&(o<0||i<=o)?(t.inMin=!0,t.inMin10=i-1==s):o>=0&&i>o?(t.inSec=!0,t.inSec10=i-1==o):(t.inHour=!0,t.inHour10=!1)):(t.inHour=!0,t.inHour10=!1),this._editKind==_Z_50.hourAndMinute?t.full=s>=0:this._editKind==_Z_50.hour?t.full=!0:t.full=s>=0&&o>=0,t},_incHourMinSec:function(t){if(!this.get_readOnly()){var e=this.get_value();e||(e=new Date);var i=this._getCaretInfo(),s=e.getHours(),o=e.getMinutes(),n=e.getSeconds();i.inHour?e.setHours(s+t):i.inMin?(i.inMin10&&(t*=10),e.setMinutes(o+t)):i.inSec&&(i.inSec10&&(t*=10),e.setSeconds(n+t)),this.set_value(e);var r=i.pos+this.get_text().length-i.len;$common.setCaretPosition(this.get_element(),r)}},doKeyDown:function(t){var e=t.keyCode,i=!0;e===Sys.UI.Key.up?this.incValue():e===Sys.UI.Key.down?this.decValue():e==Sys.UI.Key.ime&&(i=!1),i?Sys.UI.Controls.TimeEdit.callBaseMethod(this,"doKeyDown",[t]):t.cancel()},doKeyPress:function(t){if(t.ctrlKey||t.shiftKey)Sys.UI.Controls.TimeEdit.callBaseMethod(this,"doKeyPress",[t]);else{var e=t.charCode,i=!0;if(e>=32){var s=this._getCaretInfo();if(e>=48&&e<=57){var o=e>=48&&e<=50,n=e>=48&&e<=53,r=n;i=s.inHour10?o:s.inMin10?n:s.inSec10?r:s.pos<=8}else i=58==e&&!s.full}i?Sys.UI.Controls.TimeEdit.callBaseMethod(this,"doKeyPress",[t]):t.preventDefault()}}},Sys.UI.Controls.TimeEdit.registerClass("Sys.UI.Controls.TimeEdit",_Z_233),_Z_84=function(t,e){_Z_84.initializeBase(this,[t,e])},_Z_84.prototype={doMouseUp:function(t){_Z_84.callBaseMethod(this,"doMouseUp",[t]);var e=this.get_control();e._clickNotFocus||e.focus(!0),e.doButtonClick()},_doContextMenu:function(t){t.cancel()},doMouseDown:function(t){_Z_84.callBaseMethod(this,"doMouseDown",[t]),t.preventDefault(),$craba.raiseMouseDown(t)},doClick:function(t){_Z_84.callBaseMethod(this,"doClick",[t]),t.stopPropagation()}},_Z_84.registerClass("_Z_84",_Z_63),_Z_174=function(){_Z_174.initializeBase(this),this._focusNext=!0},_Z_174.prototype={get_focusNext:function(){return this._focusNext},set_focusNext:function(t){this._focusNext=t}},_Z_174.registerClass("_Z_174",_Z_162),Sys.UI.Controls.ButtonEdit=function(t){Sys.UI.Controls.ButtonEdit.initializeBase(this,[t]),this._requireDblClick=!0,this._buttonVisible=!0,this._icon="aicon-gengduotianchong"},Sys.UI.Controls.ButtonEdit.prototype={_initButtons:function(){this.get_buttonVisible()&&this.addButton(new _Z_84(this,this._icon))},set_outerCssClass:function(t){this._outerCssClass=t},get_outerCssClass:function(){return this._outerCssClass},get_buttonVisible:function(){return this._buttonVisible},set_buttonVisible:function(t){this._buttonVisible=t},add_buttonClick:function(t,e){return this.get_events().addHandler("buttonClick",t,e)},remove_buttonClick:function(t){this.get_events().removeHandler("buttonClick",t)},doButtonClick:function(){this._enterPressed=!!this._enterPressing,this._enterPressing=!1;var t=this.get_events().getHandler("buttonClick");if(t){var e=new _Z_174;return t(this,e),e}return null},get_enterPressed:function(){return this._enterPressed},doEnterPress:function(t){this._t0=(new Date).getTime();var e=new _Z_174;this.raiseEnterPress(e),e.get_cancel()||this.doEnterPressing(e),e.get_cancel()?(this.doEnterPressed(),e.get_focusNext()&&(this.focusNext(),t.cancel())):(this._enterPressing=!0,this.doButtonClick(),t.cancel())},doEnterPressing:function(t){},doEnterPressed:function(){},doDblClick:function(t){var e=new _Z_162;Sys.UI.Controls.ButtonEdit.callBaseMethod(this,"doDblClick",[e]),e.get_cancel()||this.doButtonClick(),t.cancel()},doSetEnabled:function(t){Sys.UI.Controls.ButtonEdit.callBaseMethod(this,"doSetEnabled",[t]),$Dom.setCssClass(!t,this.get_outerElement(),"disabled")},get_enabled:function(){return!(this.get_owner()&&!this.get_owner().get_enabled())&&Sys.UI.Controls.ButtonEdit.callBaseMethod(this,"get_enabled")},getInputAction:function(){return"选择"}},Sys.UI.Controls.ButtonEdit.registerClass("Sys.UI.Controls.ButtonEdit",Sys.UI.Controls.TextEdit),_Z_175=function(t,e){_Z_175.initializeBase(this),this._form=t,this._selector=e,this._selectorPage=null},_Z_175.prototype={get_form:function(){return this._form},get_selector:function(){return this._selector},get_selectorPage:function(){return this._selectorPage},set_selectorPage:function(t){this._selectorPage=t}},_Z_175.registerClass("_Z_175",_Z_162),_Z_25=function(t,e){_Z_25.initializeBase(this,[t,e]),this._canClose=!0,this._focusNext=!0},_Z_25.prototype={get_canClose:function(){return this._canClose},set_canClose:function(t){this._canClose=t},get_focusNext:function(){return this._focusNext},set_focusNext:function(t){this._focusNext=t}},_Z_25.registerClass("_Z_25",_Z_175),_Z_176=function(t,e){_Z_176.initializeBase(this),this._edit=t,this._value=e},_Z_176.prototype={get_edit:function(){return this._edit},get_value:function(){return this._value}},_Z_176.registerClass("_Z_176",_Z_162),Sys.UI.Controls.SelectorEdit=function(t){Sys.UI.Controls.SelectorEdit.initializeBase(this,[t]),this._requireKeyDown=!0,this._requireKeyPress=!0,this._value=null,this._selectOnly=!1,this._selectorWidth=0,this._selectorHeight=0,this._textSetted=!1,this._textChanged=!1,this._allowHandInput=!1,this._requiredFlag=!0,this._autoFocusNext=!1,this._trimDelimiters=!1},Sys.UI.Controls.SelectorEdit.prototype={dispose:function(){this._selector&&(this._selector.dispose(),this._selector=null),Sys.UI.Controls.SelectorEdit.callBaseMethod(this,"dispose")},get_clickNotFocus:function(){return this._clickNotFocus},set_clickNotFocus:function(t){this._clickNotFocus=t},get_showMDI:function(){return this._showMDI},set_showMDI:function(t){this._showMDI=t},doFormInit:function(){this._doValueChanged()},get_value:function(){if(this.get_buttonVisible()){var t=this.get_allowHandInput()?this.get_text():this._value;return null==t&&(t=this._getDefaultValue()),t}return this.get_text()},set_value:function(t,e){void 0===t&&(t=null),this._value=t,this.get_isInitialized()&&(this._doValueChanged(),this.get_isDataBinding()||e||(this._valueSetted=!0))},_doValueChanged:function(){value=this._value;var t=!Object.isUndefinedOrNull(value);if(t&&this._displayField){var e=this.get_form().get_dataController(),i=this._displayField,s=i.lastIndexOf(".");s>0&&(i=i.substr(s+1));var o;o="object"==typeof value?e.getValueDisplayText(value,i):e.getText(i),this.set_text(o)}else this.set_text(t?value.toString():"")},doSaveData:function(t){Sys.UI.Controls.SelectorEdit.callBaseMethod(this,"doSaveData",[t]);var e=this._displayField;if(e&&e.indexOf(".")<0){this.get_form().get_dataController().setValue(e,this.get_text())}},doButtonClick:function(){if(!this.get_isDisposed()){var t=Sys.UI.Controls.SelectorEdit.callBaseMethod(this,"doButtonClick");if(t&&t.get_cancel())t.get_focusNext()&&this.focusNext();else if(this.get_buttonVisible()){if(!(this.get_readOnly()&&!this.get_selectOnly()||$jsLoader.getInstance().get_isLoading())){this.column&&(this.column._hasPage=!0);var e=this.get_selector();e&&e.doButtonClick(this);var i=null,s=this.get_events().getHandler("getSelectorPage");if(s){var o=new _Z_175(null,e);if(s(this,o),o.get_cancel())return;i=o.get_selectorPage()}if(null==i&&(i=this.get_selectorPage()),i){$common._lastDropDownEdit=this;var n=this.get_selectorWidth(),r=this.get_selectorHeight(),a=0==n&&0==r,l=new Sys.UI.Form(this.column?this.column:this,n,r,a);l.add_init($createDelegate(this,this.doSelectorInit)),l.add_loaded($createDelegate(this,this.doSelectorLoaded)),l.add_ok($createDelegate(this,this.doSelectorSelected));var h=$createDelegate(this,this.doSelectorClose);l.add_close(h),this._showMDI?l.showMDI(i,this.get_selectorPageParams(),!0):l.showModal(i,this.get_selectorPageParams())}else this.focusNext()}}else this.focusNext()}},closeUp:function(){},add_selectorInit:function(t,e){return this.get_events().addHandler("selectorInit",t,e)},remove_selectorInit:function(t){this.get_events().removeHandler("selectorInit",t)},doSelectorInit:function(t){var e=this.get_selector(),i=new _Z_175(t,e);e&&e.doSelectorInit(this,i);var s=this.get_events().getHandler("selectorInit");s&&s(this,i)},add_selectorLoaded:function(t,e){return this.get_events().addHandler("selectorLoaded",t,e)},remove_selectorLoaded:function(t){this.get_events().removeHandler("selectorLoaded",t)},get_selector:function(){if(!this._selector){var t=this.get_selectorType();if(t){var e;if("string"==typeof t){if(!(e=evil2(t)))throw Error.invalidOperation(t+"对应的类找不到")}else e=t;this._selector=new e}}return this._selector},doSelectorLoaded:function(t){this.column&&delete this.column._hasPage;var e=this.get_selector(),i=new _Z_175(t,e);e&&e.doSelectorLoaded(this,i);var s=this.get_events().getHandler("selectorLoaded");s&&s(this,i);var o=(new Date).getTime()-this._t0;$debug.log("显示完 "+t.get_caption()+": "+o)},add_selectorSelected:function(t,e){return this.get_events().addHandler("selectorSelected",t,e)},remove_selectorSelected:function(t){this.get_events().removeHandler("selectorSelected",t)},add_getSelectorPage:function(t,e){return this.get_events().addHandler("getSelectorPage",t,e)},remove_getSelectorPage:function(t){this.get_events().removeHandler("getSelectorPage",t)},doSelectorSelected:function(t,e){if(!this.get_isDisposed()){var i=this.get_selector(),s=new _Z_25(t,i);s.set_canClose(e.get_canClose()),i&&i.doSelectorSelected(this,s);var o=this.get_events().getHandler("selectorSelected");o&&o(this,s),this._checkRaiseValueChange();var n=s.get_canClose();if(e.set_canClose(n),n&&s.get_focusNext()){var r=this;asyncCall(function(){r.get_isDisposed()||r.focusNext()})}this._textChanged=!1}},get_autoFocusNext:function(){return this._autoFocusNext},set_autoFocusNext:function(t){this._autoFocusNext=t},get_trimDelimiters:function(){return this._trimDelimiters},set_trimDelimiters:function(t){this._trimDelimiters=t},doEnterPressing:function(t){this.get_autoFocusNext()&&this.get_value()&&!this.get_textChanged()&&(t.set_cancel(!0),t.set_focusNext(!0))},doEnterPressed:function(){this._checkRaiseValueChange()},doKeyPress:function(t){Sys.UI.Controls.SelectorEdit.callBaseMethod(this,"doKeyPress",[t])},doKeyDown:function(t){var e=!1,i=this._shortcut;if(i){var s=_Z_220.shortcutToHotkey(i);(e=_Z_220.matchHotkey(s,t))&&this.doShortcutPress()}e?t.cancel():Sys.UI.Controls.SelectorEdit.callBaseMethod(this,"doKeyDown",[t])},add_shortcutPress:function(t){this.get_events().addHandler("shortcutPress",t)},remove_shortcutPress:function(t){this.get_events().removeHandler("shortcutPress",t)},doShortcutPress:function(){var t=new _Z_162,e=this.get_events().getHandler("shortcutPress");e&&e(this,t),t.get_cancel()||this.doButtonClick()},get_selectOnly:function(){return this._selectOnly},set_selectOnly:function(t){this._selectOnly=t,this.get_isInitialized()&&this.set_readOnly(t)},get_requiredFlag:function(){return this._requiredFlag},set_requiredFlag:function(t){this._requiredFlag=t},get_shortcut:function(){return this._shortcut},set_shortcut:function(t){this._shortcut=t},get_textChanged:function(){return!this.get_selectOnly()&&(this._textChanged||this.get_text()!=this._savedText)},set_textChanged:function(t){this._textChanged=t},get_allowHandInput:function(){return this._allowHandInput},set_allowHandInput:function(t){this._allowHandInput=t},doSelectorClose:function(t){this.focus()},doFocus:function(t){Sys.UI.Controls.SelectorEdit.callBaseMethod(this,"doFocus",[t]),this._textSetted=!1,this._textChanged=!1,this._savedText=this.get_text()},doBlur:function(t){Sys.UI.Controls.SelectorEdit.callBaseMethod(this,"doBlur",[t]);var e=this.get_allowHandInput(),i=this.get_text(),s=this.get_value();if(i)if(e){if(this.get_trimDelimiters()){var o=this._doTrimDelimiters(i);o!=i&&this._baseSetText(o)}}else Object.isUndefinedOrNull(s)||""===s?this._baseSetText(""):this._textSetted||this._baseSetText(this._lastText);else{if(this.column&&this.column._lastText==i)return;if($common._lastDropDownEdit==this)return;this.set_value(null,!0),Object.isUndefinedOrNull(s)||""==s||this._baseDoChange()}this._textSetted=!1},_doTrimDelimiters:function(t){for(var e=t.length,i=0,s=i;s<e;s++)if(";"!=t.charAt(s)){i=s;break}for(var o=e-1,s=o;s>=0;s--)if(";"!=t.charAt(s)){o=s;break}return t.substring(i,o+1)},add_selectorBeforeSelected:function(t,e){return this.get_events().addHandler("selectorBeforeSelected",t,e)},remove_selectorBeforeSelected:function(t){this.get_events().removeHandler("selectorBeforeSelected",t)},doBeforeSelect:function(t){var e=new _Z_176(this,t),i=this.get_events().getHandler("selectorBeforeSelected");if(i&&(i(this,e),e.get_cancel()))throw Error.abort()},doSelect:function(t){this.doBeforeSelect(t),this.set_value(t)},_getDefaultValue:function(){var t=$settings.DefaultSelectorValue;return void 0!==t?t:null},_checkRaiseValueChange:function(){!this._allowHandInput&&this._valueSetted&&(this._valueSetted=!1,this._baseDoChange())},_baseDoChange:function(t){Sys.UI.Controls.SelectorEdit.callBaseMethod(this,"doChange",[t])},doChange:function(t){!this._allowHandInput&&this.get_buttonVisible()||this._baseDoChange(t)},_baseSetText:function(t){Sys.UI.Controls.SelectorEdit.callBaseMethod(this,"set_text",[t])},set_text:function(t){this._baseSetText(t),this._lastText=t,this._textSetted=!0},get_displayField:function(){return this._displayField},set_displayField:function(t){this._displayField=t},get_selectorPage:function(){return this._selectorPage},set_selectorPage:function(t){this._selectorPage=t},get_selectorPageParams:function(){return this._selectorPageParams},set_selectorPageParams:function(t){this._selectorPageParams=t},get_selectorWidth:function(){return this._selectorWidth},set_selectorWidth:function(t){this._selectorWidth=t},get_selectorHeight:function(){return this._selectorHeight},set_selectorHeight:function(t){this._selectorHeight=t},get_selectorType:function(){return this._selectorType},set_selectorType:function(t){this._selectorType=t}},Sys.UI.Controls.SelectorEdit.registerClass("Sys.UI.Controls.SelectorEdit",Sys.UI.Controls.ButtonEdit),_Z_79=function(t){_Z_79.initializeBase(this,[t]),this._requireKeyDown=!0,this._dropDownWidth=300,this._dropDownHeight=150},_Z_79.prototype={initialize:function(){_Z_79.callBaseMethod(this,"initialize"),this.set_readOnly(!0)},dispose:function(){this._okButton&&(this._okButton.dispose(),this._okButton=null),this._cancelButton&&(this._cancelButton.dispose(),this._cancelButton=null),_Z_79.callBaseMethod(this,"dispose")},get_value:function(){return this._value?this._value:""},set_value:function(t){this._value=t,this.set_text(t?t.replace("\n"," ").replace("\r"," "):"")},get_dropDownWidth:function(){return this._dropDownWidth},set_dropDownWidth:function(t){t>0&&(this._dropDownWidth=t)},get_dropDownHeight:function(){return this._dropDownHeight},set_dropDownHeight:function(t){t>0&&(this._dropDownHeight=t)},createPopupWindow:function(){var t=this.get_element(),e=$common.createPopupTable(0,1);e.style.left="-20000px",e.style.top="-20000px",document.body.appendChild(e),$common.initPopupElement(e,!0,!1),$common.setBounds(e,this._dropDownWidth,this._dropDownHeight);var i=$common.createTBody(),s=$common.createTr(),o=$common.createTd();o.height="100%";var n=this._textAreaElement=document.createElement("textarea");n.style.width="100%",n.style.height="100%",n.style.borderStyle="none",o.appendChild(n),s.appendChild(o),i.appendChild(s);s=$common.createTr();(o=$common.createTd()).align="right",o.style.padding=5;var r=$common.createFlatButton(46,21,"确认");r.style.marginRight=10,o.appendChild(r);var a=this._cancelButton=$common.createFlatButton(46,21,"取消");return a.style.marginRight=5,o.appendChild(a),s.appendChild(o),i.appendChild(s),e.appendChild(i),e._edit=t,this._okButton=Sys.UI.Controls.FlatButton.create(r,$createDelegate(this,this._doOkClick)),this._cancelButton=Sys.UI.Controls.FlatButton.create(a,$createDelegate(this,this._doCancelClick)),e},doInitPopup:function(){_Z_79.callBaseMethod(this,"doInitPopup");var t=this._textAreaElement;t.value=this.get_value(),asyncCall(function(){t.focus()})},_doClose:function(){this.closeUp(),this.focusNext()},_doOkClick:function(t){this.set_value(this._textAreaElement.value),this.doChange(),this._doClose()},_doCancelClick:function(t){this._doClose()},doKeyDown:function(t){var e=t.keyCode,i=this.get_droppedDown(),s=i;switch(e){case Sys.UI.Key.up:i&&t.altKey&&(this.closeUp(),s=!0);break;case Sys.UI.Key.down:!i&&t.altKey&&(this.dropDown(),s=!0);break;case Sys.UI.Key.esc:s=!1;break;case Sys.UI.Key.space:this.toggleDroppedDown(),s=!0}s?t.cancel():_Z_79.callBaseMethod(this,"doKeyDown",[t])}},_Z_79.registerClass("_Z_79",_Z_99),_Z_250=function(){throw Error.notImplemented()},_Z_250.prototype={left:0,center:1,right:2},_Z_250.registerEnum("_Z_250"),_Z_251=function(){throw Error.notImplemented()},_Z_251.prototype={top:0,middle:1,bottom:2},_Z_251.registerEnum("_Z_251"),_Z_55=function(){throw Error.notImplemented()},_Z_55.prototype={center:0,rightBottom:1,designed:2},_Z_55.registerEnum("_Z_55"),_Z_54=function(){throw Error.notImplemented()},_Z_54.prototype={fixedDialog:0,fixedToolWindow:1},_Z_54.registerEnum("_Z_54"),_Z_252=function(){throw Error.notImplemented()},_Z_252.prototype={free:0,hide:1},_Z_252.registerEnum("_Z_252"),_Z_177=function(t){_Z_177.initializeBase(this),this._canClose=!0,this._eventName=t},_Z_177.prototype={get_canClose:function(){return this._canClose},set_canClose:function(t){this._canClose=t},get_eventName:function(){return this._eventName}},_Z_177.registerClass("_Z_177",Sys.EventArgs),Sys.UI.Form=function(t,e,i,s,o){this._isModal=!0,Sys.UI.Form.initializeBase(this,[t]),this._allowMove=!0,this._showMaxButton=$settings.FormShowMaxButton,this._autoFit=!0,this._caption="...",this._width=e,this._height=i,this._owner=t,this._captionVisible=!0,this._borderStyle=_Z_54.fixedDialog,this._bodyHAlign=_Z_250.left,this._bodyVAlign=_Z_251.top,this._closeAction=_Z_252.free,this._allowResize=$settings.DefaultAllowResizeForm,this._allowSaveFormSize=$settings.DefaultAllowSaveFormSize,this._constructor(t,e,i,s,o)},Sys.UI.Form.prototype={_constructor:function(t,e,i,s,o){var n=$app.getLastPopup();this._zIndex=n?n.get_zIndex()+10:20,t&&(this._parentForm=$common.getSenderForm(t)),s!=undefined&&o!=undefined?(this._left=s,this._top=o,this._position=_Z_55.designed):(this._left=0,this._top=0,this._position=_Z_55.center),this._autoSize=!(e>0&&i>0),"boolean"==typeof s&&(this._autoSize=s)},initialize:function(){Sys.UI.Form.callBaseMethod(this,"initialize"),$app.addPopup(this),this._initForm()},dispose:function(){if(!this.get_isDisposed()){var t=(new Date).getTime();this._buttonClose&&$clearHandlers(this._buttonClose),this.destroyContent(),this._floatingBehavior&&(this._floatingBehavior.dispose(),this._floatingBehavior=null),this._captionElement&&($clearHandlers(this._captionElement),this._captionElement=null),this._resizerTop&&($clearHandlers(this._resizerTop),$clearHandlers(this._resizerBottom),$clearHandlers(this._leftLine),$clearHandlers(this._rightLine),$clearHandlers(this._rightBottomArrow),this._resizerTop=null),this._removeFormNode(),Sys.UI.Form.callBaseMethod(this,"dispose"),$app.removePopup(this);var e=this._owner;if(e){var i=this._parentForm;if(i){i._hasMDI=!1;var s=i.get_rootForm(!0);s&&(s._hasMDI=!1,s._addMDI(this,!1))}if(i&&e!=i&&!i.get_focusedControl()&&e.focus)try{e.focus()}catch(r){}this._owner=null}var o=this.get_id()+"_style",n=$get(o);n&&$removeNode(n),$debug.log("表单释放时间: "+((new Date).getTime()-t)),$common.hideTips("disposed")}},_removeFormNode:function(){if(this._popup){$clearHandlers(this._popup);var t=this;if(!this._closePosition)return this._enableScreen(),void $removeNode(this._popup);$dom.addCssClass(this._popup,"transition5"),$dom.addCssClass(this._popup,this._closePosition),setTimeout(function(){t._enableScreen(),$removeNode(t._popup),t._popup=null},500)}},_initForm:function(){var t=this._parentForm;if(t){var e=t.get_focusedControl();if(e&&e.blur)try{e.blur()}catch(a){}}var i=this._isMessageBox?"FormBorder MessageBox":"FormBorder";i=$skin.joinCssClass(i,this._cssClass),this._captionVisible||(i=$skin.joinCssClass(i,"HideCaption"));var s=this._popup=$common.createClassDiv(i);s.control=this,s.style.zIndex=this.get_zIndex();var o=$common.createClassDiv(this._smallCaption?"FormCaption dselect small":"FormCaption dselect");this._initCaptionButtons(o),s.appendChild(o);var n=this._contentElement=$common.createClassDiv("FormContent");if(this._autoSize||($common.setWidth(s,this._width),$common.setHeight(s,this._height)),s.appendChild(n),this._getOverlayDom().appendChild(s),this.get_allowMove()){var r=this._floatingBehavior=_Z_52.create(s,this._captionElement);r.add_startDrag(this._startDragForm,this),r.add_moveDrag(this._moveDragForm,this),r.add_endDrag(this._endDragForm,this)}},raiseControlVisible:function(t){if(Sys.Browser.isIE&&this.get_isModal()&&(this.__saveAutoSize===undefined&&(this.__saveAutoSize=this._autoSize),this.__saveAutoSize)){this._rvTimer&&(clearTimeout(this._rvTimer),this._rvTimer=null);var e=this;this._rvTimer=setTimeout(function(){e.get_isDisposed()||e._resizeForm()},100)}},get_parent:function(){return null},set_captionVisible:function(t){this._captionVisible=t,this.get_isInitialized()&&$Dom.setCssClass(!t,this.get_element(),"HideCaption")},get_captionVisible:function(){return this._captionVisible},set_isMessageBox:function(t){this._isMessageBox=t},get_isMessageBox:function(){return this._isMessageBox},_saveNewSize:function(){if(this.get_allowSaveFormSize()){var t=$settings.UserHashID+"__formSize",e=this.get_internalId(),i=$cache.get(t);(i=i||{})[e]={width:this.get_width(),height:this.get_height()},$cache.set(t,i)}},_saveDefaultSize:function(){if(this._resizerInitd&&!this._autoSize){var t=this.get_internalId(),e=$cache.get("__formDefaultSize");(e=e||{})[t]={width:this.get_width(),height:this.get_height()},$cache.set("__formDefaultSize",e)}},_resetDefaultSize:function(t){if(this._resizerInitd){this._prevBounds=null;var e=$settings.UserHashID+"__formSize",i=this.get_internalId(),s=$cache.get(e);s&&s[i]&&(delete s[i],$cache.set(e,s));if((s=$cache.get("__formDefaultSize"))&&s[i]){var o=s[i],n=o.width-this.get_width(),r=o.height-this.get_height();0===n&&0===r||(this._doBeforeResizeHander(o.width,o.height,n,r),this._doEndResize(null,null,o.width,o.height))}else this._autoSized()}},_autoSized:function(){this._popup.style.width="auto",this._popup.style.height="auto"},_recoveryCacheSize:function(){if(this._resizerInitd&&this.get_allowSaveFormSize()){var t=$settings.UserHashID,e=this.get_internalId(),i=$cache.get(t+"__formSize"),s=i?i[e]:null;if(s){var o=getClientBounds(),n=Math.min(o.width,s.width),r=Math.min(o.height,s.height);this._doBeforeResizeHander(n,r,n-this.get_width(),r-this.get_height()),this._doEndResize(null,null,n,r)}}},get_allowSaveFormSize:function(){return this._allowSaveFormSize},set_allowSaveFormSize:function(t){this._allowSaveFormSize=t},set_cssClass:function(t){this._cssClass=t,this._popup&&$Dom.addCssClass(this._popup,t)},set_icon:function(t){this._icon=t,this._captionElement&&$Dom.addCssClass(this._captionElement,t)},get_autoSize:function(){return this._autoSize},set_autoSize:function(t){this._autoSize=t},get_allowMove:function(){return this._allowMove&&this._captionVisible},set_allowMove:function(t){this._allowMove=t},get_showMaxButton:function(){return this._showMaxButton},set_showMaxButton:function(t){this._showMaxButton=t,this.get_isInitialized()&&this._buttonMax&&$Dom.setVisible(this._buttonMax,t)},_showContent:function(t){this._contentElement.style.visibility=t?"":"hidden",$Dom.setOpacity(this._popup,t?100:50)},_startDragForm:function(t){this._showContent(!1)},_moveDragForm:function(t,e){if(this._isMDI){var i=this._getOverlayBounds();e.offsetX-=i.x,e.offsetY-=i.y}},_endDragForm:function(t){var e=this.get_bounds(),i=this._getOverlayBounds(),s=e.x-i.x,o=e.y-i.y,n=getClientScrollPosition(),r=s+e.width-i.width;r>0&&(s-=r),s<0&&(s=0),(r=o+e.height-n.y-i.height)>0&&(o-=r),o<0&&(o=0),this.setLocation(s,o),this._showContent(!0)},_calcPosition:function(t,e){var i=this.get_left(),s=this.get_top(),o=this._getOverlayBounds();switch(this.get_position()){case _Z_55.center:i=(o.width-t)/2,s=(o.height-e)/2;var n=this._getCaptionHeight();s>2*n&&(s-=n/2);break;case _Z_55.rightBottom:var r=$Dom.getBounds(document.body);o.width>r.width&&(o.width=r.width),i=o.width-t;var a=Sys.Browser.isIE?2:3;s=o.height-e-a}return{x:i>-1?i:0,y:s>-1?s:0}},_getOverlayBounds:function(){return $Dom.getBounds(this._getOverlayDom())},get_isActive:function(){var t=$app.getLastPopup();return!(t&&t.get_isModal()&&t.get_visible&&t.get_visible())||(t==this||t==this.get_parentForm())},get_element:function(){return this._popup?this._popup:this.get_contentElement()},set_bounds:function(t){var e=this._popup;e&&(e.style.left=t.x+"px",e.style.top=t.y+"px",t.width>=0&&(e.style.width=t.width+"px"),t.height>=0&&(e.style.height=t.height+"px"))},setLocation:function(t,e){this.set_bounds({x:t,y:e})},resize:function(){var t=this.get_bounds(),e=this._calcPosition(t.width,t.height);this.set_bounds(e)},_getCaptionHeight:function(){return this._captionElement?this._captionElement.offsetHeight:this._smallCaption?25:35},_initCaptionButtons:function(t){var e="FormCaptionText";this._icon&&(e+=" "+this._icon);var i=this._captionElement=$common.createClassDiv(e);if(i.innerHTML=this.get_caption(),t.appendChild(i),this._initSubCaption(),this.get_showCloseButton()){var s=this._buttonClose=$common.createClassDiv("FormCaptionButton aicon-close");$common.addClickHandler(s,this.doCloseClick,this),t.appendChild(s)}},get_borderStyle:function(){return this._borderStyle},set_borderStyle:function(t){this._borderStyle=t,this._smallCaption=this._borderStyle==_Z_54.fixedToolWindow},set_title:function(t){this.set_caption(t)},get_title:function(){return this._caption},get_caption:function(){return this._caption},set_caption:function(t){if(this._caption=t,this._captionElement){var e=this._captionElement;e.firstChild?e.firstChild.nodeValue=t:e.nodeValue?e.nodeValue=t:e.innerHTML=t}},get_captionElement:function(){return this._captionElement},get_subCaption:function(){return this._subCaption},set_subCaption:function(t){this._subCaption=t,this._initSubCaption()},_initSubCaption:function(){if(this._captionElement){var t=this._subCaptionElement;t||(t=this._subCaptionElement=$common.createClassDiv("FormSubCaption ellipsis"),this._captionElement.appendChild(t)),this.get_subCaption()?(t.innerHTML=this.get_subCaption(),t.title=this.get_subCaption()):(t.innerHTML="",t.title="",t._title="")}},doShowProgressor:function(){this._autoFit?this.internalShowProgressor():this.set_content($common.getLoadingHTML())},set_content:function(t){this._contentElement.innerHTML=t},doInit:function(t){this._setMinSize(),Sys.UI.Form.callBaseMethod(this,"doInit",[t])},_setMinSize:function(){var t=this._autoSize;this._isSetWidth&&t&&(this.set_width(this._minWidth),this._autoSize=!1),this._isSetHeight&&t&&(this.set_height(this._minHeight),this._autoSize=!1)},_resizeForm:function(){this._setMinSize();var t=getClientBounds(),e=this._popup,i=this._contentElement;if(e.scrollHeight>t.height-5){$common._getDomCachePadding(i,!0);$common.setHeight(e,t.height-5),Sys.Browser.isIE&&$common.setWidth(e,e.scrollWidth+18),this._autoSize=!1}else this.__saveAutoSize&&(e.style.height="auto",e.style.width="auto");e.scrollWidth>t.width-5&&($common.setWidth(e,t.width-5),this._autoSize=!1),$Dom.setCssClass(!this._autoSize&&!this._allowResize,e,"FlowAuto")},doBeforeEndLoaded:function(){this._popup&&(this._resizeForm(),this._initResizer(),this._saveDefaultSize(),this._recoveryCacheSize(),this._createMaxButton())},_createMaxButton:function(){if(this._resizerInitd&&this._captionElement&&this.get_showMaxButton()){var t=this._buttonMax=$common.createClassDiv("FormCaptionButton max aicon-fullscreen");$common.addClickHandler(t,this.showFullorNormal,this),this._captionElement.parentNode.appendChild(t)}},doEndLoaded:function(){if(this._popup){var t=this;asyncCall(function(){t._positionCenter(),t.set_fullWindow(t._fullWindow)})}},showCenter:function(){this._resizeForm(),this._positionCenter()},_positionCenter:function(){var t=this._popup;if(t){var e=this._calcPosition(t.offsetWidth,t.offsetHeight),i=getClientScrollPosition();Sys.UI.DomElement.setLocation(t,e.x+i.x,e.y+i.y)}},_initResizer:function(){if(!this._resizerInitd&&this._allowResize&&this._isModal&&!this._isMessageBox&&this._captionVisible&&this._hasFlexBlock){this._createResizer("FLeftTop FResizer","nw-resize","nw"),this._createResizer("FRightTop FResizer","ne-resize","ne"),this._createResizer("FLeftBottom FResizer","sw-resize","sw"),this._leftLine=this._createResizer("FLeft FResizer","ew-resize","ew"),this._leftLine.title="拖动调整宽度/双击还原窗口默认尺寸",this._rightLine=this._createResizer("FRight FResizer","ew-resize","we"),this._rightLine.title="拖动调整宽度/双击还原窗口默认尺寸",this._rightBottomArrow=this._createResizer("FRightBottom FResizer","se-resize","se"),this._rightBottomArrow.title="拖动调整宽高/双击还原窗口默认尺寸",this._resizerTop=this._createResizer("FTop FResizer","ns-resize","ns"),this._resizerTop.title="拖动调整高度/双击撑满",this._resizerBottom=this._createResizer("FBottom FResizer","ns-resize","sn"),this._resizerBottom.title="拖动调整高度/双击撑满",this._resizerLine=this._createResizer("ResizerLine","default","");var t=this._popup;$common.addMouseDownHandler(t,this._resizerMouseDown,this),$common.addDblClickHandler(this._resizerTop,this._showStretchVert,this),$common.addDblClickHandler(this._resizerBottom,this._showStretchVert,this),$common.addDblClickHandler(this._captionElement,this.showFullorNormal,this),$common.addDblClickHandler(this._leftLine,this._resetDefaultSize,this),$common.addDblClickHandler(this._rightLine,this._resetDefaultSize,this),$common.addDblClickHandler(this._rightBottomArrow,this._resetDefaultSize,this),this._resizerInitd=!0,$common.addSteps([{group:"craba",control:{tipsId:"_Form_Caption",control:this._captionElement},html:"鼠标双击这个区域可全屏显示"},{group:"craba",control:{tipsId:"_Form_BottomResizer",control:this._rightBottomArrow},html:"鼠标可以拖动窗体的四角和四边调整窗体尺寸"}])}},_createResizer:function(t,e,i){var s=$common.createClassDiv(t);return s._isResizer=!0,s.style.cursor=e,s.type=i,this._popup.appendChild(s),s},_resizerMouseDown:function(t){var e=t.target;e._isResizer&&(t.cancel(),this._setDragLine("block"),this._setCursor(e.style.cursor),$common.hideEditEx(),this._startPos={x:t.clientX,y:t.clientY},this._startSize={width:this._resizerLine.offsetWidth,height:this._resizerLine.offsetHeight},this._curResizer=e,this._processEventHandle(!0))},_setCursor:function(t){document.body.style.cursor=t,this._resizerLine.style.cursor=t,this._screenOverlay.style.cursor=t},_setDragLine:function(t){this._resizerLine.style.width=this._popup.offsetWidth+6+"px",this._resizerLine.style.height=this._popup.offsetHeight+6+"px",this._resizerLine.style.display=t,this._resizerLine.style.left="-3px",this._resizerLine.style.top="-3px",$Dom.setCssClass("block"==t,this._popup,"ResizeMode")},_dragMoveResizer:function(t){if(t.cancel(),!this.get_isDisposed()){var e={x:t.clientX,y:t.clientY};e.x<0&&(e.x=0),e.y<0&&(e.y=5);var i=e.x-this._startPos.x,s=e.y-this._startPos.y;if(!(Math.abs(i)<5&&Math.abs(s)<5)){this._resizerDraging=!0;var o=-3,n=-3,r=this._curResizer.type;"nw"==r?(o=i+o,n=s+n,i*=-1,s*=-1):"sw"==r?(o=i+o,i*=-1):"ne"==r?(n=s+n,s*=-1):"ns"==r?(n=s+n,i=0,s*=-1):"sn"==r?i=0:"ew"==r?(o=i+o,i*=-1,s=0):"we"==r&&(s=0);var a=this._startSize.width+i,l=this._startSize.height+s;a<this._minWidth&&(a=this._minWidth,o=parseInt(this._resizerLine.style.left)),l<this._minHeight&&(l=this._minHeight,n=parseInt(this._resizerLine.style.top)),this._resizerLine.style.width=a+"px",this._resizerLine.style.height=l+"px",this._resizerLine.style.left=o+"px",this._resizerLine.style.top=n+"px"}}},_endDragResizer:function(t){if(t.cancel(),this._processEventHandle(!1),this.get_isDisposed())document.body.style.cursor="default";else{if(!this._resizerDraging)return this._setCursor("default"),void this._setDragLine("none");var e=this._resizerLine.offsetWidth-6,i=this._resizerLine.offsetHeight-6,s=e-this._startSize.width,o=i-this._startSize.height;this._doBeforeResizeHander(e,i,s,o);var n=parseInt(this._popup.style.left)+parseInt(this._resizerLine.style.left)+3,r=parseInt(this._popup.style.top)+parseInt(this._resizerLine.style.top)+3;this._doEndResize(n,r,e,i),this._resetDragLine(),this._saveNewSize()}},_doBeforeResizeHander:function(t,e,i,s){return this._doResizeHandler(t,e,i,s)},_showStretchVert:function(t){t.cancel();var e=$Dom.getBounds(this._popup),i=e.x,s=0,o=0,n=e.width,r=this._getOverlayBounds();this._prevBounds?(s=this._prevBounds.y-r.y,i-=r.x,o=this._prevBounds.height,this._prevBounds=null):(this._prevBounds=e,o=r.height);var a=o-e.height;this._doBeforeResizeHander(n,o,0,a),this._doEndResize(i,s,n,o),this._resetDragLine()},_resetDragLine:function(){this._resizerDraging=!1,this._resizerLine.style.width=this._popup.offsetWidth-3+"px",this._resizerLine.style.height=this._popup.offsetHeight-3+"px",this._resizerLine.style.left="-3px",this._resizerLine.style.top="-3px",this._setCursor("default"),this._setDragLine("none")},_processEventHandle:function(t){t?this._mouseMoveHandler||(this._mouseMoveHandler=$common.addMouseMoveHandler(document,this._dragMoveResizer,this),this._endHandler=$common.addMouseUpHandler(document,this._endDragResizer,this)):this._mouseMoveHandler&&($common.removeMouseMoveHandler(document,this._mouseMoveHandler),$common.removeMouseUpHandler(document,this._endHandler),this._mouseMoveHandler=null,this._endHandler=null)},set_fullWindow:function(t){this._fullWindow=t,t&&!this._loading&&this._popup&&this.showFullorNormal()},showFullorNormal:function(t){t&&t.cancel(),$common.hideEditEx();var e=this._popup;this._isFull?(this.showNormal(),$Dom.removeCssClass(e,"FullWindow")):(this.showFull(),$Dom.addCssClass(e,"FullWindow")),this._isFull=!this._isFull,this._buttonMax&&($Dom.setCssClass(this._isFull,this._buttonMax,"aicon-fullscreen-exit"),$Dom.setCssClass(!this._isFull,this._buttonMax,"aicon-fullscreen"))},showFull:function(){var t=this._getOverlayBounds(),e=getClientScrollPosition(),i=$Dom.getBounds(this._popup);this._popup._normalBounds=i;var s=t.width,o=t.height,n=s-i.width,r=o-i.height;this._doBeforeResizeHander(s,o,n,r),this._doEndResize(e.x,e.y,s,o)},showNormal:function(){var t=this._getOverlayBounds(),e=this._popup._normalBounds,i=e.width,s=e.height,o=e.width-t.width,n=e.height-t.height;this._doBeforeResizeHander(i,s,o,n),this._doEndResize(e.x-t.x,e.y-t.y,i,s)},_doEndResize:function(t,e,i,s){Math.abs(this.get_height()-s)>2&&this.set_height(s),Math.abs(this.get_width()-i)>2&&this.set_width(i),null!=t&&(this._popup.style.left=t+"px",this._popup.style.top=e+"px")},addCssClass:function(t){this._cssClass=t,this._popup&&$Dom.addCssClass(this._popup,t)},get_position:function(){return this._position},set_position:function(t){this._position=t},get_bodyHAlign:function(){return this._bodyHAlign},set_bodyHAlign:function(t){this._bodyHAlign=t},get_bodyVAlign:function(){return this._bodyVAlign},set_bodyVAlign:function(t){this._bodyVAlign=t},get_width:function(){return this._popup?this._popup.offsetWidth:this._width},set_width:function(t){this._width=t;var e=this._popup;e&&($common.setWidth(e,t),this._autoSize||(this._contentElement.style.width="auto"))},get_height:function(){return this._popup?this._popup.offsetHeight:this._height},set_height:function(t){this._height=t;var e=this._popup;e&&($common.setHeight(e,t),this._autoSize||(this._contentElement.style.height="auto"))},_getBorderHSize:function(){return 2},_getBorderVSize:function(){return 2},_getBorderVAndCaptionSize:function(){return this._getCaptionHeight()+this._getBorderVSize()},_getPaddingSize:function(){return 10},get_clientWidth:function(){return this._width-this._getBorderHSize()-this._getPaddingSize()},set_clientWidth:function(t){this._width=t+this._getBorderHSize()+this._getPaddingSize()},get_clientHeight:function(){return this._height-this._getBorderVAndCaptionSize()-this._getPaddingSize()},set_clientHeight:function(t){this._height=t+this._getBorderVAndCaptionSize()+this._getPaddingSize()},get_left:function(){return this._left},set_left:function(t){this._left=t,this.get_visible()&&(this._popup.style.left=t+"px")},get_top:function(){return this._top},set_top:function(t){this._top=t,this.get_visible()&&(this._popup.style.top=t)},get_closeAction:function(){return this._closeAction},set_closeAction:function(t){this._closeAction=t},get_visible:function(){return this._popup&&$Dom.getVisible(this._popup)},set_visible:function(t){this._popup&&($Dom.setVisible(this._popup,t),t?this._disableScreen():this._enableScreen())},show:function(t){var e=$app.getLastPopup();if(e&&!e.get_isModal()){var i=e.get_url();if(t&&t==i)throw e.focus(),Error.abort()}this.set_isModal(!1),this.set_visible(!0),t&&this._showPage(t)},hide:function(){this.set_visible(!1)},close:function(t){return"boolean"==typeof t&&1==t?this._execClose():this._handleClose("close"),!0},_execClose:function(){switch(this._closeAction){case _Z_252.free:this.dispose();break;case _Z_252.hide:this._enableScreen(),this.hide()}},_handleClose:function(t){var e=new _Z_177(t),i=this.get_events().getHandler(t);if(i)try{i(this,e)}catch(s){if(handleError(s),s.isAbort)throw s}else"close"!=t&&this.doClose(e);e.get_canClose()&&this._execClose()},add_ok:function(t,e){this.get_events().addHandler("ok",t,e)},remove_ok:function(t){this.get_events().removeHandler("ok",t)},doOk:function(){this._handleClose("ok")},add_cancel:function(t,e){this.get_events().addHandler("cancel",t,e)},remove_cancel:function(t){this.get_events().removeHandler("cancel",t)},doCancel:function(){this._handleClose("cancel")},get_contentElement:function(){return this.get_isInitialized()||this.initialize(),this._contentElement},_showPage:function(t,e){if(this.get_isInitialized()||this.initialize(),t){if(this.get_autoSize())if($settings.DefaultUseClientSize){var i=getClientBounds();this._initClientSize(i.width,i.height,80)}else this.set_clientSize(null);else this._initClientSize(this._contentElement.offsetWidth,this._contentElement.offsetHeight,28);this.showPage(t,null,e)}else this.doEndLoad(!0)},_initClientSize:function(t,e,i){var s="ClientHeight="+(e-i)+",ClientWidth="+(t-i);this.set_clientSize(s)},showModal:function(t,e){if(t){t=$common.encodeUrlParams(t,e);var i=$app.findFormByUrl(t);if(i)return void(this.get_isMDI()||i.get_isMDI()?($common.getMainPanel().set_activeForm(i._tabForm),i.showTopIndex()):$common.alertError("相同Url和参数的页面只能打开一次"))}return this.set_isModal(!0),this._disableScreen(),this._showPage(t,e)},showMDI:function(t,e,i){if(this.set_isMDI(!0),t&&i&&(t=$common.addUrlParam(t,"_r_",Math.random())),this._parentForm){this._parentForm._hasMDI=!0;var s=this._parentForm.get_rootForm(!0);s&&(s._hasMDI=!0,s._addMDI(this,!0))}this.showModal(t,e)},doCloseClick:function(){var t=this.get_closeButton();if(t){var e=this[t];if(!e)throw Error.invalidOperation("按钮 "+t+" 不存在");e.focusThenClick()}else this.close()},_disableScreen:function(){var t=this._screenOverlay;$common._hideScrollBar(),t?this._initScreenOverlay(t):(this._screenOverlay=t=$common.createGlyphDiv(),t.className="FormOverlay",this._getOverlayDom().appendChild(t),this._initScreenOverlay(t),this._bindWindowReise())},_enableScreen:function(){$common._restoreBar(),this._repositionHandler&&($common.removeResizeHandler(window,this._repositionHandler),this._repositionHandler=null),this._removeScreenOverlay()},_bindWindowReise:function(){this._repositionHandler||(this._repositionHandler=$createDelegate(this,this._doWindowPeposition),$common.addResizeHandler(window,this._repositionHandler))},_removeScreenOverlay:function(){this._screenOverlay&&($removeNode(this._screenOverlay),this._screenOverlay=null)},_initScreenOverlay:function(t){this._initScreenOverlayPosition(t),$common.renderOverlay(t,this.get_zIndex()-1,$settings.FormOverlayOpacity)},_initScreenOverlayPosition:function(t){if(!this._isMDI){var e=getClientBounds(),i=this._getOverlayDom(),s=$common.getBounds(i),o=Math.min(e.width,s.width)-1,n=Math.max(e.height,s.height);n=Math.max(n,i.scrollHeight),this._screenOverlayWidth==o&&this._screenOverlayHeight==n||(this._screenOverlayWidth=o,this._screenOverlayHeight=n,$common.setHeight(t,n))}},_doWindowPeposition:function(t){t.cancel(),this._screenOverlay&&this._initScreenOverlayPosition(this._screenOverlay)},_getOverlayDom:function(t){if(t)return this.get_element();var e=document.body;if(this._isMDI&&$common.getMainPanel(null,!1)){var i=$common.getMainPanel().get_activeForm();i&&(this._tabForm=i,e=i.get_contentElement())}return e},showTopIndex:function(){if(this._popup){var t=$app.getLastPopup();this._zIndex=t?t.get_zIndex()+10:20,$app.removePopup(this),$app.addPopup(this),this._popup.style.zIndex=this._zIndex,this._disableScreen()}}},Sys.UI.Form.registerClass("Sys.UI.Form",Sys.UI.CustomForm),Sys.UI.Form.create=function(t,e){return $create(Sys.UI.Form,t,null,e)},Type.registerNamespace("Sys.Validators"),_Z_229=function(){this._validationResults=[]},_Z_229.prototype={dispose:function(){delete this._validationResults},addResult:function(t){Array.add(this._validationResults,t)},clear:function(t){for(var e=this.get_count()-1;e>=0;e--){var i=this.getResult(e).get_control(),s=!1;t?t==i&&(s=!0,Array.removeAt(this._validationResults,e)):s=!0,s&&i.removeCssClass&&i.removeCssClass("HasRequire")}t||Array.clear(this._validationResults)},get_count:function(){return this._validationResults.length},get_isValid:function(){return 0==this.get_count()},get_data:function(){return this._validationResults},get_first:function(){return this.getResult(0)},getResult:function(t){return this._validationResults[t]},toString:function(){for(var t=new Sys.StringBuilder,e=this.get_count(),i=0;i<e;i++){var s=this.getResult(i);t.appendLine(s.get_message())}return t.toString()}},_Z_229.registerClass("_Z_229"),_Z_230=function(t,e){this._message=t,this._control=e},_Z_230.prototype={get_message:function(){return this._message},get_control:function(){return this._control}},_Z_230.registerClass("_Z_230"),_Z_231=function(t){this._validationNode=null,this._validationResults=new _Z_229,this._hintBox=null,this._form=t},_Z_231.prototype={initialize:function(){},dispose:function(){this._hintBox&&(this._hintBox.dispose(),this._hintBox=null),this._validationResults&&(this._validationResults.dispose(),this._validationResults=null),this._validationNode=null,this._form=null},get_form:function(){return this._form},get_validationNode:function(){return this._validationNode},set_validationNode:function(t){this._validationNode=t},get_isValid:function(){return this._validationResults.get_isValid()},_hideHintBox:function(){this._hintBox&&!$common._hasHint&&this._hintBox.hide()},addValidationResult:function(t,e){var i=new _Z_230(t,e);this._validationResults.addResult(i)},clearResults:function(){this._validationResults.clear(),this._hideHintBox()},validate:function(t,e,i,s,o,n,r){if(n||(n=this._validationNode),n){var a=this._doGetChildValidationNode(n,t);if(a){var l=null;o&&o.getInputAction&&(l=o.getInputAction());for(var h=a[a._name],d=h.length,_=0;_<d;_++){var c=h[_];c.get_tag()&&!r||(i=$craba.trimLabel(i),c.set_tag(i)),c.set_form&&c.set_form(this.get_form()),l&&c.set_inputAction(l),c.validate(e,s,o,this._validationResults)}return a}}return null},getChildValidationNode:function(t){return this._doGetChildValidationNode(this._validationNode,t)},_initValidationNodeInternal:function(t,e){return t._name=e||"",t},_doGetChildValidationNode:function(t,e){return e?this._doGetChildValidationNodeInternal(t,e):this._initValidationNodeInternal(t,e)},_doGetChildValidationNodeInternal:function(t,e){var i=t.childNodes;if(void 0===i)return null;for(var s=i.length,o=0;o<s;o++){var n=i[o];for(var r in n)if(r==e)return this._initValidationNodeInternal(n,e)}return null},checkResults:function(){if(!this.get_isValid())throw this.showResults(!0),Error.abort()},checkResultsVisible:function(t){return this._hintBox&&this._hintBox.get_visible()?(this.get_isValid()||this._validationResults.clear(t),!0):(this.get_isValid()||this._validationResults.clear(),!1)},doHintClose:function(t){this.get_isValid()||this._validationResults.clear()},showResults:function(t){if(this.get_isValid())this._hideHintBox();else{var e=this._hintBox;e||(e=this._hintBox=new _Z_102).add_close($createDelegate(this,this.doHintClose));for(var i=this._validationResults,s=i.get_first().get_control(),o="",n=0,r=i.get_count();n<r;n++){var a=i.getResult(n);if(a.get_control()==s){var l=a.get_message();o&&(o+="\n"),o+=l}}if(s&&s._validateColumnIndex!=undefined){var h=s.getColumnByIndex(s._validateColumnIndex);h.focus(),s=h._control||s}$common._hasHint||(e.show(o,s),$common._hasHint=!0,setTimeout(function(){delete $common._hasHint},300)),t&&s.focus&&asyncCall(function(){s.focus()})}}},_Z_231.registerClass("_Z_231"),_Z_232=function(){this._messageTemplate=null,this._tag=null,this._inputAction="输入"},_Z_232.prototype={get_messageTemplate:function(){var t=this._messageTemplate;return t||this.getDefaultMessageTemplate()},set_messageTemplate:function(t){this._messageTemplate=t},get_tag:function(){return this._tag},set_tag:function(t){this._tag=t},get_inputAction:function(){return this._inputAction},set_inputAction:function(t){this._inputAction=t},validate:function(t,e,i,s){if(null==s)throw Error.argumentNull("validationResults");this.doValidate(t,e,i,s)},doValidate:function(t,e,i,s){},getDefaultMessageTemplate:function(){},logValidationResult:function(t,e,i){i.addCssClass&&i.addCssClass("HasRequire"),t.addResult(new _Z_230(e,i))},getTag:function(t){return t?t+this._tag:this._tag},getMessage:function(t,e){return String.format(this.get_messageTemplate(),this.getTag(e),t)}},_Z_232.registerClass("_Z_232");var $createValidator=function(t,e){if(!t.inheritsFrom(_Z_232))throw Error.argument("type",String.format(Sys.Res.createNotValidator,t.getName()));var i=new t;return e&&_Z_242$_setProperties(i,e),i};Sys.Validators.ValueValidator=function(){Sys.Validators.ValueValidator.initializeBase(this),this._negated=!1},Sys.Validators.ValueValidator.prototype={getDefaultMessageTemplate:function(){return this._negated?this.getNegaMsgTemplate():this.getMsgTemplate()},getMsgTemplate:function(){},getNegaMsgTemplate:function(){},get_negated:function(){return this._negated},set_negated:function(t){this._negated=t}},Sys.Validators.ValueValidator.registerClass("Sys.Validators.ValueValidator",_Z_232),Sys.Validators.NotNullValidator=function(){Sys.Validators.NotNullValidator.initializeBase(this)},Sys.Validators.NotNullValidator.prototype={doValidate:function(t,e,i,s){var o=Object.isUndefinedOrNull(t);!o&&Date.isInstanceOfType(t)&&(o=1==t.getFullYear()),o==!this.get_negated()&&this.logValidationResult(s,this.getMessage(t,e),i)},getMsgTemplate:function(){return"请"+this.get_inputAction()+"{0}"},getNegaMsgTemplate:function(){return"“{0}”要求为空"}},Sys.Validators.NotNullValidator.registerClass("Sys.Validators.NotNullValidator",Sys.Validators.ValueValidator),Sys.Validators.NotEmptyValidator=function(){Sys.Validators.NotEmptyValidator.initializeBase(this)},Sys.Validators.NotEmptyValidator.prototype={doValidate:function(t,e,i,s){Object.isEmpty(t)==!this.get_negated()&&this.logValidationResult(s,this.getMessage(t,e),i)}},Sys.Validators.NotEmptyValidator.registerClass("Sys.Validators.NotEmptyValidator",Sys.Validators.NotNullValidator),Sys.Validators.RangeBoundaryType=function(){throw Error.notImplemented()},Sys.Validators.RangeBoundaryType.prototype={ignore:0,inclusive:1,exclusive:2},Sys.Validators.RangeBoundaryType.registerEnum("Sys.Validators.RangeBoundaryType"),Sys.Validators.RangeValidator=function(){Sys.Validators.RangeValidator.initializeBase(this),this._lowerBound=null,this._lowerBoundType=Sys.Validators.RangeBoundaryType.ignore,this._upperBound=null,this._upperBoundType=Sys.Validators.RangeBoundaryType.ignore},Sys.Validators.RangeValidator.prototype={get_lowerBound:function(){return this._lowerBound},set_lowerBound:function(t){this._lowerBound=t},get_lowerBoundType:function(){return this._lowerBoundType},set_lowerBoundType:function(t){this._lowerBoundType=t},get_upperBound:function(){return this._upperBound},set_upperBound:function(t){this._upperBound=t},get_upperBoundType:function(){return this._upperBoundType},set_upperBoundType:function(t){this._upperBoundType=t},doValidate:function(t,e,i,s){this._checkProps();var o=Object.isUndefinedOrNull(t),n=!o&&!this._isInRange(t);(o||n!=this.get_negated())&&this.logValidationResult(s,this.getMessage(t,e),i)},_isInRange:function(t){var e=Sys.Validators.RangeBoundaryType.ignore,i=Sys.Validators.RangeBoundaryType.exclusive;if(this._lowerBoundType>e){if(t<this._lowerBound)return!1;if(this._lowerBoundType==i&&t==this._lowerBound)return!1}if(this._upperBoundType>e){if(t>this._upperBound)return!1;if(this._upperBoundType==i&&t==this._upperBound)return!1}return!0},_checkProps:function(){var t=Sys.Validators.RangeBoundaryType.ignore;if(null==this._lowerBound&&this._lowerBoundType!=t)throw Error.argument("The lower bound cannot be null unless it's type is Ignore.");if(null==this._upperBound&&this._upperBoundType!=t)throw Error.argument("The upper bound cannot be null unless it's type is Ignore.");if(this._lowerBoundType!=t&&this._upperBoundType!=t&&this._upperBound<this._lowerBound)throw Error.argument("Upper bound cannot be lower than lower bound.")},_getBoundTypeName:function(t){switch(t){case Sys.Validators.RangeBoundaryType.ignore:return"忽略";case Sys.Validators.RangeBoundaryType.inclusive:return"包括";case Sys.Validators.RangeBoundaryType.exclusive:return"不包括"}},_getLowerBoundTypeString:function(){return this._lowerBoundType==Sys.Validators.RangeBoundaryType.inclusive?"等于":""},_getUpperBoundTypeString:function(){return this._upperBoundType==Sys.Validators.RangeBoundaryType.inclusive?"等于":""},getMessage:function(t,e){return String.format(this.get_messageTemplate(),this.getTag(e),this._lowerBound,this._getBoundTypeName(this._lowerBoundType),this._upperBound,this._getBoundTypeName(this._upperBoundType),t)},getMsgTemplate:function(){return"“{0}”要求在“{1}({2})－{3}({4})”范围内"},getNegaMsgTemplate:function(){return"“{0}”不能在“{1}({2})－{3}({4})”范围内"}},Sys.Validators.RangeValidator.registerClass("Sys.Validators.RangeValidator",Sys.Validators.ValueValidator),Sys.Validators.MinValueValidator=function(){Sys.Validators.MinValueValidator.initializeBase(this)},Sys.Validators.MinValueValidator.prototype={getMessage:function(t,e){return String.format(this.get_messageTemplate(),this.getTag(e),this._lowerBound,this._lowerBoundType,t)},getMsgTemplate:function(){return"“{0}”要求大于"+this._getLowerBoundTypeString()+"“{1}”"},getNegaMsgTemplate:function(){return"“{0}”不能大于"+this._getLowerBoundTypeString()+"“{1}”"}},Sys.Validators.MinValueValidator.registerClass("Sys.Validators.MinValueValidator",Sys.Validators.RangeValidator),Sys.Validators.MaxValueValidator=function(){Sys.Validators.MaxValueValidator.initializeBase(this)},Sys.Validators.MaxValueValidator.prototype={getMessage:function(t,e){return String.format(this.get_messageTemplate(),this.getTag(e),this._upperBound,this._upperBoundType,t)},getMsgTemplate:function(){return"“{0}”要求小于"+this._getUpperBoundTypeString()+"“{1}”"},getNegaMsgTemplate:function(){return"“{0}”不能小于"+this._getUpperBoundTypeString()+"“{1}”"}},Sys.Validators.MaxValueValidator.registerClass("Sys.Validators.MaxValueValidator",Sys.Validators.RangeValidator),Sys.Validators.LengthValidator=function(){Sys.Validators.LengthValidator.initializeBase(this)},Sys.Validators.LengthValidator.prototype={doValidate:function(t,e,i,s){this._checkProps();var o=Object.isUndefinedOrNull(t),n=!o&&!this._isInRange(t.length);(o||n!=this.get_negated())&&this.logValidationResult(s,this.getMessage(t,e),i)},getMsgTemplate:function(){return"“{0}”长度要求在“{1}({2})－{3}({4})”范围内"},getNegaMsgTemplate:function(){return"“{0}”长度不能在“{1}({2})－{3}({4})”范围内"}},Sys.Validators.LengthValidator.registerClass("Sys.Validators.LengthValidator",Sys.Validators.RangeValidator),Sys.Validators.MinLengthValidator=function(){Sys.Validators.MinLengthValidator.initializeBase(this)},Sys.Validators.MinLengthValidator.prototype={getMessage:function(t,e){return String.format(this.get_messageTemplate(),this.getTag(e),this._lowerBound,this._lowerBoundType,t)},getMsgTemplate:function(){return"“{0}”长度要求大于"+this._getLowerBoundTypeString()+"“{1}”"},getNegaMsgTemplate:function(){return"“{0}”长度不能大于"+this._getLowerBoundTypeString()+"“{1}”"}},Sys.Validators.MinLengthValidator.registerClass("Sys.Validators.MinLengthValidator",Sys.Validators.LengthValidator),Sys.Validators.MaxLengthValidator=function(){Sys.Validators.MaxLengthValidator.initializeBase(this)},Sys.Validators.MaxLengthValidator.prototype={getMessage:function(t,e){return String.format(this.get_messageTemplate(),this.getTag(e),this._upperBound,this._upperBoundType,t)},getMsgTemplate:function(){return"“{0}”长度要求小于"+this._getUpperBoundTypeString()+"“{1}”"},getNegaMsgTemplate:function(){return"“{0}”长度不能小于"+this._getUpperBoundTypeString()+"“{1}”"}},Sys.Validators.MaxLengthValidator.registerClass("Sys.Validators.MaxLengthValidator",Sys.Validators.LengthValidator),Sys.Validators.EqualsToValidator=function(){Sys.Validators.EqualsToValidator.initializeBase(this),this._name=null,this._form=null},Sys.Validators.EqualsToValidator.prototype={get_name:function(){return this._name},set_name:function(t){this._name=t},set_form:function(t){this._form=t},doValidate:function(t,e,i,s){if(!this._form)throw Error.argumentNull("this._form");var o=this._form[this._name];if(!o)throw new Error.invalidOperation(String.format(Sys.Res.referenceNotFound,this._name));var n=t!=o.get_value(),r=null;o.get_label&&(r=o.get_label()),r=r||this._name,n==!this.get_negated()&&this.logValidationResult(s,this.getMessage(e,r),i)},getMessage:function(t,e){return String.format(this.get_messageTemplate(),this.getTag(t),e)},getMsgTemplate:function(){return"“{0}”要求与“{1}”相同"},getNegaMsgTemplate:function(){return"“{0}”要求与“{1}”不同"}},Sys.Validators.EqualsToValidator.registerClass("Sys.Validators.EqualsToValidator",Sys.Validators.ValueValidator),Sys.UI.Controls.Selector=function(){Sys.UI.Controls.Selector.initializeBase(this)},Sys.UI.Controls.Selector.prototype={doButtonClick:function(t){},doSelectorInit:function(t,e){},doSelectorLoaded:function(t,e){},doSelectorSelected:function(t,e){}},Sys.UI.Controls.Selector.registerClass("Sys.UI.Controls.Selector",_Z_242),_Z_52=function(t){_Z_52.initializeBase(this,[t]),this._handle=null,this._location=null,this._dragLocation=null,this._mouseDownHandler=$createDelegate(this,this._doMouseDown),this._mouseMoveHandler=$createDelegate(this,this._dragBehavior),this._mouseUpHandler=$createDelegate(this,this._doMouseUp),this._keyPressHandler=$createDelegate(this,this._doKeyPress)},_Z_52.prototype={initLocation:function(){var t=this.get_element();this._location||(this._location=$common.getLocation(t))},dispose:function(){this._handle&&this._mouseDownHandler&&$common.removeMouseDownHandler(this._handle,this._mouseDownHandler),this._mouseDownHandler=null,this._handle=null,_Z_52.callBaseMethod(this,"dispose")},add_startDrag:function(t,e){this.get_events().addHandler("startDrag",t,e)},remove_startDrag:function(t){this.get_events().removeHandler("startDrag",t)},add_endDrag:function(t,e){this.get_events().addHandler("endDrag",t,e)},remove_endDrag:function(t){this.get_events().removeHandler("endDrag",t)},add_beforeDrag:function(t,e){this.get_events().addHandler("beforeDrag",t,e)},remove_beforeDrag:function(t){this.get_events().removeHandler("beforeDrag",t)},add_moveDrag:function(t,e){this.get_events().addHandler("moveDrag",t,e)},remove_moveDrag:function(t){this.get_events().removeHandler("moveDrag",t)},get_handle:function(){return this._handle},set_handle:function(t){null!=this._handle&&$common.removeMouseDownHandler(this._handle,this._mouseDownHandler),this._handle=t,$common.addMouseDownHandler(this._handle,this._mouseDownHandler)},get_location:function(){return this._location},set_location:function(t){this._location!=t&&(this._location=t,this.get_isInitialized()&&$common.setLocation(this.get_element(),this._location),this.raisePropertyChanged("location"))},_checkCanDrag:function(t){var e=this.get_events().getHandler("beforeDrag");if(e&&(e(this,t),t.hasCancel))return!1;var i=t.target,s=i.tagName;return!("a"==s.toLowerCase()&&null!=i.href&&i.href.length>0)&&!(Array.indexOf(["input","button","select","textarea","label"],s.toLowerCase())>-1)},_doMouseDown:function(t){return this.initLocation(),!!this._checkCanDrag(t)&&(this._dragLocation=$common.getLocation(this.get_element()),this._startPos={x:t.clientX,y:t.clientY},t.preventDefault(),this._processEventHandle(!0),!0)},_dragBehavior:function(t){if(!this.get_isDisposed()){var e={x:t.clientX,y:t.clientY};if(!(!this._draging&&Math.abs(e.x-this._startPos.x)<5&&Math.abs(e.y-this._startPos.y)<5)){this._startDragBehavior(t);var i=e.x-this._startPos.x,s=e.y-this._startPos.y,o=this._dragLocation,n=this.get_events().getHandler("moveDrag"),r=0,a=0;if(n){var l={event:t,offsetX:i,offsetY:s,elementPos:o};if(n(this,l),t.isPreventDefault||t.isStopPropagation)return;l.minX&&(r=l.minX),l.minY&&(a=l.minY),i=l.offsetX,s=l.offsetY}i=o.x+i,s=o.y+s,$Dom.setLocation(this.get_element(),i>=r?i:r,s>=a?s:a),t.preventDefault()}}},_startDragBehavior:function(t){if(!this._draging){var e=this.get_events().getHandler("startDrag");e&&e(this,t),this.get_handle().style.cursor="move"}this._draging=!0,$common._lastDropDownEdit&&$common._lastDropDownEdit.closeUp(),$common.hideEditEx()},_doMouseUp:function(t){this._endDragBehavior(t,!1)},_doKeyPress:function(t){27==(t.keyCode?t.keyCode:t.rawEvent.keyCode)&&this._endDragBehavior(t,!0)},_endDragBehavior:function(t,e){if(this._processEventHandle(!1),!this.get_isDisposed()&&this._draging){if(this._draging=!1,!e){var i=this.get_events().getHandler("endDrag");if(i){var s=new _Z_162;s.event=t,i(this,s),e=s.get_cancel()}}var o=this.get_element();e?$common.setLocation(o,this._dragLocation):(this._location=$common.getLocation(o),this.raisePropertyChanged("location")),this.get_handle().style.cursor="default"}},_processEventHandle:function(t){t?this._isBind||($common.addMouseMoveHandler(document,this._mouseMoveHandler),$common.addMouseUpHandler(document,this._mouseUpHandler),$common.addKeyPressHandler(document,this._keyPressHandler),this._isBind=!0):(this._isBind&&($common.removeMouseMoveHandler(document,this._mouseMoveHandler),$common.removeMouseUpHandler(document,this._mouseUpHandler),$common.removeKeyPressHandler(document,this._keyPressHandler)),this._isBind=!1)}},_Z_52.registerClass("_Z_52",_Z_221),_Z_52.create=function(t,e,i){return $create(_Z_52,{handle:e},t,i,null)},Sys.UI.Controls.VerificationCode=function(t){Sys.UI.Controls.VerificationCode.initializeBase(this,[t]),this._requireClick=!0,this._imageSrc=null},Sys.UI.Controls.VerificationCode.prototype={get_imageSrc:function(){return this._imageSrc},set_imageSrc:function(t){this._imageSrc=t},change:function(){var t=(new Date).getTime()-new Date(2008,6,11).getTime();this.get_element().src=this.get_imageSrc()+"&T="+t},doClick:function(t){Sys.UI.Controls.VerificationCode.callBaseMethod(this,"doClick",[t]),this.change()}},Sys.UI.Controls.VerificationCode.registerClass("Sys.UI.Controls.VerificationCode",_Z_249),Sys.UI.Controls.IMStatus=function(t){Sys.UI.Controls.IMStatus.initializeBase(this,[t])},Sys.UI.Controls.IMStatus.prototype={initialize:function(){Sys.UI.Controls.IMStatus.callBaseMethod(this,"initialize"),this._qq&&(this._qqElement=this._element.firstChild),this._aliIM&&(this._aliElement=this._element.lastChild)},set_hint:function(t,e){if(e){if(!this._qqElement)throw Error.argument("必须先设置QQ属性.");this._qqElement.firstChild.title=t}else{if(!this._aliElement)throw Error.argument("必须先设置AliIM属性.");this._aliElement.firstChild.title=t}},get_qq:function(){return this._qq},set_qq:function(t){if(this._qq=t,this.get_isInitialized()){if(!this._qqElement)throw Error.argument("必须先设置QQ属性.");$common.checkTips(!t,"设置的qq不能为空");var e=this._qqElement.href;e=$common.removeUrlParam(e,"uin"),e=$common.addUrlParam(e,"uin",t);var i=this._qqElement.firstChild.src;i=$common.removeUrlParam(i,"p").trim("\\?"),i=$common.addUrlParam(i,"p","2:"+t+":41"),this._qqElement.setAttribute("href",e),this._qqElement.firstChild.setAttribute("src",i)}},get_aliIM:function(){return this._aliIM},set_aliIM:function(t){if(this._aliIM=t,this.get_isInitialized()){if(!this._aliElement)throw Error.argument("必须先设置AliIM属性.");$common.checkTips(!t,"设置的AliIM不能为空");var e=this._aliElement.href;e=$common.removeUrlParam(e,"uid"),e=$common.addUrlParam(e,"uid",t,encodeURI);var i=this._aliElement.firstChild.src;i=$common.removeUrlParam(i,"uid"),i=$common.addUrlParam(i,"uid",t,encodeURI),this._aliElement.setAttribute("href",e),this._aliElement.firstChild.setAttribute("src",i)}}},Sys.UI.Controls.IMStatus.registerClass("Sys.UI.Controls.IMStatus",Sys.UI.Control),_Z_102=function(){this._tableElement=null},_Z_102.prototype={dispose:function(){$common._hintBox=null,this._control=null,this.hide()},get_visible:function(){return null!=this._tableElement},get_control:function(){return this._control},show:function(t,e,i,s,o,n){this.hide();var r="TitleHint"===n;n=$skin.joinCssClass("HintBox",n);var a=this._tableElement=$common.createClassDiv(n);if(i>0?this._hideTimer=setTimeout($createDelegate(this,this.hide),1e3*i):a.style.cursor="default",a.innerHTML=o?t:$common.textToHtml(t),a.style.zIndex=$app.getPopupElementZIndex()+1,$common.addClickHandler(a,this._doHintClick,this),document.body.appendChild(a),this._control=e,e&&!e.tagName){if(e.flowPanel)e.flowPanel.showMorePopup();else{var l=$craba.findInTab(e);l&&!l.get_selected()&&l.get_pageControl().set_selectedTab(l)}pointToElement=e.get_element(),e.focus()}else e.tagName&&(pointToElement=e);var h,d;if(pointToElement){r||pointToElement.scrollIntoView(!1);var _=$Dom.getBounds(pointToElement),c=$Dom.getBounds(a);h=_.x,d=_.y;s===undefined&&(s=Sys.Position.top);var u=$common.createClassSpan("hinticon iconfont");a.appendChild(u);var p=d-c.height-10;switch(p<5&&(s=Sys.Position.bottom),s){case Sys.Position.top:$Dom.addCssClass(u,"arrowTop"),d=p,h=h,c.width>_.width&&(u.style.left=$common.pix(_.width/2-6)),a.style.left=$common.pix(h),a.style.top=$common.pix(d-20);break;case Sys.Position.right:$Dom.addCssClass(u,"arrowRight"),h=h+_.width+10,a.style.left=h+20+"px",a.style.top=d+"px";break;case Sys.Position.bottom:$Dom.addCssClass(u,"arrowBottom"),d=d+_.height+10,c.width>_.width&&(u.style.left=$common.pix(_.width/2-6)),a.style.left=h+"px",a.style.top=d+20+"px";break;case Sys.Position.left:$Dom.addCssClass(u,"arrowLeft"),h=h-c.width-10,a.style.left=h-20+"px",a.style.top=d+"px"}var g=getClientBounds(),m=!0;h+c.width>g.width&&(h=g.width-c.width-5,m=!1,c.width>_.width&&(u.style.left=$common.pix(_.x-h+_.width/2-6)))}else{var f=$common.getElementScreenCenterPos(a);h=f.x,d=f.y}var C=this;setTimeout(function(){m&&$Dom.addCssClass(a,"transition2"),d<0&&(d=0),a.style.left=h+"px",a.style.top=d+"px",a.style.opacity=1,$common._hintBox=C},10)},_doHintClick:function(t){var e=t.target;t.offsetX+25<e.offsetWidth||t.offsetY<10||(this.hide(),this.closeHandler&&this.closeHandler(this),this._control&&this._control.focus())},add_close:function(t){this.closeHandler=t},hide:function(t){$common._hintBox=null,this._hideTimer&&(clearTimeout(this._hideTimer),this._hideTimer=null),this.absoluteHide=t;var e=this._tableElement;e&&($clearHandlers(e),$removeNode(e),this._tableElement=null)}},_Z_102.registerClass("_Z_102"),_Z_0=function(t){_Z_0.initializeBase(this,[t])},_Z_0.prototype={dispose:function(){_Z_0.callBaseMethod(this,"dispose"),this._controls=null},set_positionVisible:function(t){if(this._pvisible!==t){this._pvisible=t;var e=this.get_element(),i=e.parentNode;!i||"LayoutGroupBorder"!=i.className&&"TD"!=i.tagName||(e=i),$Dom.setVisibleByPosition(e,t)}},set_visible:function(t,e){if(this.get_visible()!=t){var i=this.get_element(),s=i.parentNode,o=s;o&&"LayoutGroupBorder"==o.className&&($Dom.setVisible(o,t),s=o.parentNode),_Z_0.callBaseMethod(this,"set_visible",[t]),e&&e!=undefined||this._doSetVisible(i,t,!0),s&&"TD"==s.tagName&&$Dom.setVisible(s,t)}},_doSetVisible:function(t,e,i){if(!i){var s=t.control||t._control;if(s&&"Sys.Content.Controls.HintMenu"==Object.getTypeName(s))return;if(s&&s.set_visible?s.set_visible(e):$Dom.setVisible(t,e),s&&("Sys.UI.Controls.Grid"==Object.getTypeName(s)||"Sys.UI.Controls.Pager"==Object.getTypeName(s)||"Sys.UI.Controls.TreeView"==Object.getTypeName(s)))return}for(var o=t.firstChild;o;)o.tagName&&this._doSetVisible(o,e,!1),o=$common.getNextSibling(o)}},_Z_0.registerClass("_Z_0",_Z_41),Sys.UI.Controls.LayoutGroup=function(t){Sys.UI.Controls.LayoutGroup.initializeBase(this,[t])},Sys.UI.Controls.LayoutGroup.prototype={swapDisplayOrder:function(t,e){if(t>=e)throw Error.invalidOperation("rowIndex1 应小于 rowIndex2");var i=this.get_element(),s=$common.getTableBody(i),o=s.childNodes.length;this._checkRowIndex(t,o,"rowIndex1"),this._checkRowIndex(e,o,"rowIndex2");var n=s.childNodes[t],r=s.childNodes[e];s.removeChild(r),s.insertBefore(r,n),s.removeChild(n),e<=s.childNodes.length-1?s.insertBefore(n,s.childNodes[e]):s.appendChild(n)},_checkRowIndex:function(t,e,i){if(t<0||t>=e)throw Error.argumentOutOfRange(i,t,"参数值应 >= 0 并 <= "+(e-1))},_getCaptionElement:function(){var t=null,e=this.get_element(),i=$common.getTableFirstRow(e);if(i&&(t=$common.getFirstChildByClassName(i,"LayoutGroupCaption")),!t)throw Error.invalidOperation("没有 Caption");return t},get_caption:function(){var t=this._getCaptionElement();return t?t.innerHTML:""},set_caption:function(t){var e=this._getCaptionElement();e&&(e.innerHTML=t||"")},updated:function(){var t=this.get_langText();null!==t&&this.set_caption(t)},_hasOuter:function(){return this._getOuter(),this._pNode!=this._element},_getOuter:function(){if(this._pNode)return this._pNode;var t=this._element.parentNode;return $Dom.hasClass(t,"LayoutGroupBorder")||$Dom.hasClass(t,"LayoutGroupBlock")?(this._pNode=t,t):this._pNode=this._element},get_width:function(){return this._getOuter().offsetWidth},set_width:function(t){var e=this._getOuter();$common.setWidth(e,t-$common._getDomCachePadding(e))},get_height:function(){return this._getOuter().offsetHeight},set_height:function(t){var e=this._getOuter();$common.setHeight(e,t-$common._getDomCachePadding(e,!0))}},Sys.UI.Controls.LayoutGroup.registerClass("Sys.UI.Controls.LayoutGroup",_Z_0),Sys.UI.Controls.Block=function(t){Sys.UI.Controls.Block.initializeBase(this,[t])},Sys.UI.Controls.Block.prototype={get_outerElement:function(){return this.get_element()},set_visible:function(t){_Z_249.callBaseMethod(this,"set_visible",[t])}},Sys.UI.Controls.Block.registerClass("Sys.UI.Controls.Block",_Z_0),Sys.UI.Controls.FlexBlock=function(t){Sys.UI.Controls.FlexBlock.initializeBase(this,[t]),this.__isLayout=!0},Sys.UI.Controls.FlexBlock.prototype={initialize:function(){this.get_form()._hasFlexBlock=!0,Sys.UI.Controls.FlexBlock.callBaseMethod(this,"initialize"),this._initCaption()},get_caption:function(){return this._caption},set_caption:function(t){this._caption=t,this.get_isInitialized()&&this._refreshCaption()},_refreshCaption:function(){this._captionDiv&&(this._captionDiv.innerHTML=this._caption)},_initCaption:function(){if(this._caption){$Dom.addCssClass(this._element,"hasCaption");var t=$common.createClassDiv("FlexCaption");this._element.firstChild&&this._element.firstChild.tagName?this._element.insertBefore(t,this._element.firstChild):this._element.appendChild(t);var e=this._captionDiv=$common.createClassDiv("text");t.appendChild(e),this._refreshCaption()}},set_visible:function(t){$Dom.setCssClass(!t,this.get_element(),"Hided")},get_visible:function(){return $Dom.isAbsolute(this.get_element())&&$Dom.getVisible(this.get_element())},doResized:function(t){for(var e=this.get_controls(),i=0,s=e.length;i<s;i++){var o=e[i];o.doResized&&!o.__isLayout&&o.doResized(t)}}},Sys.UI.Controls.FlexBlock.registerClass("Sys.UI.Controls.FlexBlock",_Z_41),Sys.UI.Controls.FlexColumn=function(t){Sys.UI.Controls.FlexColumn.initializeBase(this,[t])},Sys.UI.Controls.FlexColumn.registerClass("Sys.UI.Controls.FlexColumn",Sys.UI.Controls.FlexBlock),Sys.UI.Controls.FlowPanel=function(t){Sys.UI.Controls.FlowPanel.initializeBase(this,[t]),this._itemWidth=-1,this._itemLabelWidth=-1,this._defaultPopupIds=[],this._defaultDesignIds=[],this._popupControls=[],this._staticIds=[],this._childIds=[],this._configID=0,this._preRows=1,this.__isLayout=!0,this._layoutDirection=Sys.UI.Controls.LayoutDirection.horz},Sys.UI.Controls.FlowPanel.prototype={initialize:function(){this.get_form()._hasFlexBlock=!0,Sys.UI.Controls.FlowPanel.callBaseMethod(this,"initialize"),this._isVert=this.get_layoutDirection()==Sys.UI.Controls.LayoutDirection.vert,this._captionDiv=$common.getFirstChildByClassName(this._element,"FlowCaption")},isPopup:function(){return"CustomerPanel"==this.get_tag()},_initChildControls:function(){if(!this._controls&&(this._controls=$common.getElementChildControls(this.get_element()),this._popupPanel)){var t=$common.getElementChildControls(this._popupPanel.get_element());Array.addRange(this._controls,t)}},dispose:function(){this._popup&&(this._popup.dispose(),this._popup=null),Sys.UI.Controls.FlowPanel.callBaseMethod(this,"dispose")},doFormLoaded:function(){this.get_allowConfig()&&(this._initChildIds(),this._createSetting(),this._refreshPopupDisplayOrder())},_initChildIds:function(){if(this._configData)for(var t=0,e=this._childIds.length;t<e;t++){var i=this._childIds[t];this._checkPushNewIds(i)}},_checkPushNewIds:function(t){if(!Array.contains(this._staticIds,t)&&!Array.contains(this._configData.design,t)&&!Array.contains(this._configData.popup,t)){if(Array.contains(this._defaultPopupIds,t))return void this._configData.popup.push(t);this._configData.design.push(t)}},_getControlElt:function(t){var e=t.get_outerElement();return e||t.get_element()},_refreshPopupDisplayOrder:function(){for(var t=this._getPopupIds(),e=this._idsToControls(t,!0),i=0,s=e.length;i<s;i++){var o=e[i];o.flowPanel=this,o._group&&this._updatePopup(o.get_idPart(),!0)}},_resetControlSort:function(t){this._insertControlSortBefore(t,this)},_insertControlSortBefore:function(t,e){var i=this.get_form().get_controls();Array.remove(i,t);var s=Array.indexOf(i,e);Array.insert(i,s,t)},_createItemLabel:function(t){var e=this._getControlElt(t);if(t&&t.createLabel){if(t.get_showLabel&&!t.get_showLabel())return void t._refreshItemVisible(e.parentNode,t.get_visible());t.createLabel(e,this._itemLabelWidth,this),t._refreshItemVisible(e.parentNode,t.get_visible())}},_createFlowItem:function(t,e,i,s){var o=$common.createClassDiv("FlowItem");if(this._itemWidth>0){var n=this._itemWidth;if(e.offsetWidth>n){var r=e.offsetWidth+this._itemLabelWidth,a=Math.ceil(r/n);n=n*a+8*(a-1)}o.style.width=n+"px"}var l=$common.getNextSibling(e);o.appendChild(e),l&&!i?t.insertBefore(o,l):t.appendChild(o),s._flowItemDom=o},_refreshCaption:function(){this._captionDiv&&(this._captionDiv.innerHTML=this._caption)},removeChilds:function(t){$removeNode(this._captionDiv);var e=null;this._settingsButton&&(e=[this._settingsButton]),Sys.UI.Controls.FlowPanel.callBaseMethod(this,"removeChilds",[t,e]),this._defaultPopupIds=[],this._defaultDesignIds=[],this._popupControls=[],this._childIds=[],this._captionDiv&&this.get_element().appendChild(this._captionDiv)},removeChild:function(t){var e=this.get_form();if("string"==typeof t&&(t=e[t]),t){var i=t.get_idPart();Array.remove(this._defaultDesignIds,i),Array.remove(this._childIds,i),delete this._controls;var s=t._getFlowItem();e.removeControl(t,!0),s&&$removeNode(s)}},_getControl:function(t){if(t.control)return t.control;return $common.getElementChildControls(t)[0]},appendControl:function(t,e,i){var s=t.get_element();if(t.get_outerElement&&(s=this._getControlElt(t)),this._createFlowItem(this.get_element(),s,!1,t),this._createItemLabel(t),this._insertControlSortBefore(t,this._settingsButton),this._resetStaticSort(),i){var o=t.get_idPart();this._defaultDesignIds.push(o),this._childIds.push(o),e&&this._updatePanel(o,e,!1);var n=this._getDesignIds(),r=this._getPopupIds(),a=Array.indexOf(r,o);if(a>-1)this._updatePanel(o,r[a+1],!0);else{var l=Array.indexOf(n,o);if(-1==l)n.push(o);else if(l<n.length-1){for(var h=n[++l],d=this.get_form();l<n.length&&!d[h];)h=n[++l];if(!h)return;this._updatePanel(o,h)}}}},appendUIControl:function(t,e){var i=this.get_element();t.appendTo(i);var s=t.get_ID(),o=this.get_form()[s];$common.checkTips(!o,"appendUIControl失败"),this.appendControl(o,e,!0),this._resetStaticPosition(i),this._settingsButton&&i.appendChild(this._settingsButton._getFlowItem())},_createSetting:function(){var t=$get(this.get_id()+"_moreBtn"),e=this._settingsButton=t.control;e.set_tag({allowConfig:!1}),e.add_click($createDelegate(this,this.showMorePopup)),e.add_rightIconClick($createDelegate(this,this.doConfig))},get_button:function(){return this._settingsButton},_checkAndAppendItems:function(){if(!this._isAppendPopup){this._isAppendPopup=!0;var t=$get(this.get_id()+"_popup");if(t){for(var e=this._popupPanel.get_element(),i=t.childNodes,s=0,o=i.length;s<o;s++)e.appendChild(i[0]);$removeNode(t)}}},showMorePopup:function(t,e){if(this.get_allowConfig()){t||(t=this._settingsButton);var i=this._createPopup();if(!i.isShow())if(e&&0==e.clientX&&0==e.clientY)this.focusNextControl();else{this._checkAndAppendItems(),i.popupAt(t);var s=i._element;if(this._popupCssClass&&$Dom.addCssClass(s,this._popupCssClass),this._expandPopup){var o=$Dom.getBounds(this.get_element());$Dom.addCssClass(s,"ExpandPopup"),s.style.left=o.x+"px",s.style.top=o.y+o.height+"px";var n=$common._getDomCachePadding(s,!1);s.style.width=o.width-n+"px"}}}},get_expandPopup:function(){return this._expandPopup},set_expandPopup:function(t){this._expandPopup=t},get_popupCssClass:function(){return this._popupCssClass},set_popupCssClass:function(t){this._popupCssClass=t},_createPopup:function(){var t=this._popup;if(t)return t;var e=this.get_form(),i=this.get_idPart()+"_panel",s=$createControl("FlowPanel",{ID:i,CssClass:"MorePanel",Tag:"CustomerPanel",LayoutDirection:Sys.UI.Controls.LayoutDirection.horz},e),o=(t=this._popup=new Sys.UI.Controls.Popup(this,!0)).render();s.appendTo(o),s.dispose(),delete s;var n=e.get_controls(),r=Array.indexOf(n,this);return r<n.length-1?Array.insert(n,r+1,t):n.push(t),this._popupPanel=e[i],t},doConfig:function(t){if(this._allowConfig){this._popup&&this._popup.hide();var e=$common.getSysUIBaseURI(this.get_form())+"PanelConfig.gspx",i=new Sys.UI.Form(t);i.PanelContainer=this,i.showModal(e)}},_updatePopup:function(t,e){var i=this.get_form()[t];i._group=e;var s=i._getFlowItem();e?$Dom.addCssClass(s,"clear"):$Dom.removeCssClass(s,"clear")},_updatePanel:function(t,e,i){var s=this.get_form(),o=s[t];o._group=!1;var n=o._getFlowItem();$Dom.removeCssClass(n,"clear");var r=s[e],a=this.get_element(),l=this._getPanelDom();if(e&&!i){if(r){var h=r._getFlowItem(),d=h.parentNode;d==l?o.flowPanel=this:delete o.flowPanel,d.insertBefore(n,h),this._insertControlSortBefore(o,r),this._popup&&(this._popup._controls=null)}}else{if(n.parentNode==l){var _=this._getLastControl();a.insertBefore(n,_._getFlowItem()),delete o.flowPanel,this._insertControlSortBefore(o,r||_)}else l.appendChild(n),o.flowPanel=this,this._insertControlSortBefore(o,this._popup?this._popup:this)}this._settingsButton&&this._resetControlSort(this._settingsButton)},_getLastControl:function(){if(0==this._staticIds.length)return this._settingsButton;var t=this._staticIds[0],e=this.get_form(),i=e["config_"+t];return i||(i=e[t]),i||this._settingsButton},_getPanelDom:function(){if(this._isAppendPopup)return this._popupPanel.get_element();var t=$get(this.get_id()+"_popup");return t||(this._popupPanel?this._popupPanel.get_element():void 0)},_idsToControls:function(t,e){for(var i=[],s=this.get_form(),o=0,n=t.length;o<n;o++){var r=t[o];if(Array.contains(this._childIds,r)){var a=s["config_"+r];if(a||(a=s[r]),a){if(e&&o<n){""==t[o+1]&&(a._group=!0)}i.push(a)}}}return i},resetConfig:function(){if(this.get_allowConfig()){var t=this.get_element();this._resetControlsPosition(t,this._getDesignControls(),!1),this._resetStaticPosition(t),t.appendChild(this._settingsButton._getFlowItem()),this._resetControlSort(this._settingsButton),this._createPopup(),this._resetControlsPosition(this._popupPanel.get_element(),this._getPopupControls(),!0),this._isAppendPopup=!0}},_resetStaticPosition:function(t){if(!(this._staticIds.length<1))for(var e=this._idsToControls(this._staticIds),i=0,s=e.length;i<s;i++){var o=e[i]._getFlowItem();t.appendChild(o)}},_resetStaticSort:function(){if(!(this._staticIds.length<1))for(var t=this._idsToControls(this._staticIds),e=0,i=t.length;e<i;e++){var s=t[e];this._insertControlSortBefore(s,this._settingsButton)}},_getDesignControls:function(t){var e=this._getDesignIds();return this._idsToControls(e)},_getPopupControls:function(t){return this._idsToControls(this._getPopupIds())},_resetControlsPosition:function(t,e,i){for(var s=0,o=e.length;s<o;s++){var n=e[s],r=n._getFlowItem();n._group=!1,i?n.flowPanel=this:delete n.flowPanel,$Dom.removeCssClass(r,"clear"),t.appendChild(r),this._resetControlSort(n)}},get_height:function(){return this._element.scrollHeight},get_configData:function(){return this._configData},set_configData:function(t){this._configData=t,t&&(this._configData.design=this._configData.design.split(","),this._configData.popup=this._configData.popup.split(","))},_saveConfigData:function(t){t=Object.clone(t);this.set_configData(t)},_getPopupIds:function(){return this._configData?this._configData.popup:this._defaultPopupIds},_getDesignIds:function(){return this._configData?this._configData.design:this._defaultDesignIds},_getConfigDesignIds:function(){return this._configData?this._configData.design:null},set_defaultDesignIds:function(t){this._defaultDesignIds=t},get_defaultDesignIds:function(){return this._defaultDesignIds},set_childIds:function(t){this._childIds=t},get_childIds:function(){return this._childIds},set_allowConfig:function(t){this._allowConfig=t},get_allowConfig:function(){return this._allowConfig},get_layoutDirection:function(){return this._layoutDirection},set_layoutDirection:function(t){this._layoutDirection=t},get_itemWidth:function(){return this._itemWidth},set_itemWidth:function(t){this._itemWidth=t},get_itemLabelWidth:function(){return this._itemLabelWidth},set_itemLabelWidth:function(t){this._itemLabelWidth=t},get_caption:function(){return this._caption},set_caption:function(t){this._caption=t,this.get_isInitialized()&&this._refreshCaption()},get_popupIds:function(){return this._defaultPopupIds},set_popupIds:function(t){t&&(this._defaultPopupIds=t.split(","))},get_staticIds:function(){return this._staticIds},set_staticIds:function(t){t&&(this._staticIds=t.split(","))},get_notConfigIds:function(){return this._notConfigIds},set_notConfigIds:function(t){t&&(this._notConfigIds=t.split(","))},get_configID:function(){return this._configID},set_configID:function(t){this._configID=t},get_guid:function(){return this._guid},set_guid:function(t){this._guid=t},get_relationIds:function(){return this._relationIds},set_relationIds:function(t){this._relationIds=t}},Sys.UI.Controls.FlowPanel.registerClass("Sys.UI.Controls.FlowPanel",_Z_0),Sys.UI.Controls.CustomControl=function(t){Sys.UI.Controls.CustomControl.initializeBase(this,[t]),this._index=0},Sys.UI.Controls.CustomControl.prototype={blur:function(){this.customForm&&this.customForm.blur()},canFocus:function(){return this.get_isPage()},get_visible:function(){return!!this.customForm&&this.customForm.get_visible()},set_visible:function(t){if(!this.customForm)return!1;this.customForm.set_visible(t)},focus:function(){return!!this.get_isPage()&&this.customForm.focus()},get_isPage:function(){return!Object.isUndefinedOrNull(this._gspx.Attributes.Src)},set_gspx:function(t){"string"==typeof t&&(t='<Block CssClass="BlockLine">'+t+"</Block>",t=$craba.gspxToJson(t)),this._gspx=t},get_gspx:function(){return this._gspx},set_onlyGspx:function(t){this._onlyGspx=t},get_onlyGspx:function(){return this._onlyGspx},set_roots:function(t){this._roots=t},set_eventTarget:function(t){this._eventTarget=t},appendTo:function(t,e,i){this._check();var s=(i=i||{}).pForm,o=i.callback,n=this.get_idPart()+"_block"+this._index,r=Object.clone(this._gspx.Childs),a=s||this.get_form(),l=null;this._onlyGspx||(l=$createControl("Block",{ID:n,CssClass:$skin.joinCssClass("CustomBlock",this._gspx.Attributes.CssClass)},a));var h=function(s){var n="appendTo";i.insertBefore?n="insertBefore":i.insertAfter&&(n="insertAfter"),s[n].apply(s,[t,o,e])},d=$craba.resolveGspx(r,l,a,this._roots,this._eventTarget);return l?h(l):Array.forEach(d,function(t){h(t)}),this._index++,a[n]},showModal:function(t,e,i){var s=this.get_idPart()+"_form",o=new Sys.UI.Form(this);if("object"==typeof i){i.minWidth&&o.set_minWidth(i.minWidth),i.minHeight&&o.set_minHeight(i.minHeight);var n=!0===i.allowResize;o._hasFlexBlock=n,o._allowResize=n}o.set_id(s),o.set_caption(t),o.Context={pageId:s},o._controls=[],$app.addForm(o),o.addHotkey({keyCode:Sys.UI.Key.esc},o.doCancel,o),o._action=this.get_form().get_action();var r="$"+s+"$__action";o._action._dynamicId=r,window[r]=o._action;var a=o.get_contentElement();return this.appendTo(a,e,{pForm:o}),o.isCustomModal=!0,o.showModal(),o},_check:function(){if(!this._gspx||!this._gspx.Name)throw Error.abort("没有内容可以显示")}},Sys.UI.Controls.CustomControl.registerClass("Sys.UI.Controls.CustomControl",_Z_242),Type.registerNamespace("Craba.Web.Script"),Craba.Web.Script.PagerDataService=function(t){Craba.Web.Script.PagerDataService.initializeBase(this),this._pager=t},Craba.Web.Script.PagerDataService.prototype={get_path:function(){return this._getPath("Craba.Web/Craba.Web.Script.DataService.ajax")},_getData:function(t,e,i,s,o,n){return{refresh:null!=e,pagerId:t,queryParams:e,orders:i,filter:s,first:o,count:n}},_todoData:function(t,e){t.queryParams||(t.queryParams=e.get_queryParams()),!t.filter&&e.getLastFilter&&(t.filter=e.getLastFilter()),!t.sorts&&e.getLastSort&&(t.sorts=e.getLastSort())},_invokeBindData:function(t,e,i,s,o){var n=this.get_form(),r=this._pager;if(r&&r._getTargetControl){var a=r._getTargetControl();if(a.get_bindPagerDataSource&&n){var l=a.get_bindPagerDataSource();if("function"==typeof l)return this._todoData(e,r),void l(t,e,i,s,o);var h=n.__action;if(l&&h&&h[l])return this._todoData(e,r),void h[l](t,e,i,s,o)}}return this._invoke(t,e,i,s,o)}},Craba.Web.Script.PagerDataService.registerClass("Craba.Web.Script.PagerDataService",Sys.Net.WebServiceProxy),_Z_83=function(t){_Z_83.initializeBase(this,[t]),this._maxPageSize=$settings.GridPagerDefaultMaxPageSize,this._numericButtonCount=$settings.PagerNumericButtonCount,this._pageSize=10,this._pageIndex=0,this._itemCount=0,this._showQueryTips=$settings.GridDefaultShowQueryTips},_Z_83.prototype={dispose:function(){this.endLoading(!0),this._pagesCell&&$clearHandlers(this._pagesCell),this._prevPageButton&&($clearHandlers(this._prevPageButton),$clearHandlers(this._nextPageButton)),this._homePageButton&&($clearHandlers(this._homePageButton),$clearHandlers(this._lastPageButton)),this._pageSizeEdit&&(this._pageSizeEdit.dispose(),this._pageSizeEdit=null),this._pageDrpEdit&&(this._pageDrpEdit.dispose(),this._pageDrpEdit=null),_Z_83.callBaseMethod(this,"dispose")},_createPageDrpEdit:function(t){var e=this._pageTextF=$common.createClassSpan("PagerDropPageTextF");e.innerHTML="第",t.appendChild(e);var i=this.get_form(),s=$common.createInput();s.className="ButtonEdit Edit PagerDropPageEdit",t.appendChild(s);var o=this._pageDrpEdit=$create(Sys.UI.Controls.DropDownEdit,{tabOnEnter:!1,dataValueField:"value",dataTextField:"text",enabledField:"enabled",dropDownRows:14,dropDownStyle:_Z_24.dropDownEdit,value:this.get_pageIndex()},s,null,i);o.add_enterPress($createDelegate(this,this._doDropPageIndexChanged)),o.add_change($createDelegate(this,this._doDropPageIndexChanged)),o.add_keyPress($createDelegate(this,this._doDropKeyPress)),(e=this._pageTextS=$common.createClassSpan("PagerDropPageTextS")).innerHTML="页",t.appendChild(e)},_doDropKeyPress:function(t){var e=t.charCode;45!=e&&46!=e||t.cancel()},_doDropPageIndexChanged:function(t,e){e&&e.cancel();var i=this._pageDrpEdit,s=parseInt(i.get_text());if(this._gotoIndex!=s){if(isNaN(s))i.set_value(this.get_pageIndex()+1);else if(s!=this.get_pageIndex()+1){if(s<1||s>this.get_pageCount())return t.set_value(this.get_pageIndex()),void $common.showHint("输入"+s+"无效，已重置",t);this._gotoIndex=s,this._gotoPageOnClick(s-1)}}else i.set_text(this._gotoIndex)},_refreshDropDownPageEdit:function(){var t;t=this.get_pageCount()<=12?this._calculatePageIndexMin():this._calculatePageIndexMax(12);for(var e=[],i=this.get_pageIndex(),s=0;s<t.length;s++){var o=t[s],n=o>-1,r={value:o,text:n?(o+1).toString():"...",enabled:n&&o!=i};e.push(r)}this._pageDrpEdit.set_items(e),this._pageDrpEdit.set_text(i+1)},_gotoPageOnClick:function(t){this.gotoPage(t)},_calculatePageIndexMax:function(t){var e=this.get_pageCount(),i=this.get_pageIndex(),s=[],o=Math.floor(t/3),n=t-o-o,r=0+o,a=Math.floor(i-n/2+(1-n%2)),l=a+n,h=e-o,d=h+o,_=!0,c=!0;if(r+1>a&&(_=!1,l=(a=0)+o+n),h-1<l&&(c=!1,a=(l=d)-o-n),_){for(var u=0;u<r;u++)Array.add(s,u);Array.add(s,-1)}for(var p=a;p<l;p++)Array.add(s,p);if(c){Array.add(s,-1);for(var g=h;g<d;g++)Array.add(s,g)}return s},_calculatePageIndexMin:function(){for(var t=[],e=this.get_pageCount(),i=0;i<e;i++)Array.add(t,i);return t},_createAllNumericButtonsWithOutsideEllipsis:function(t){var e=this._calculatePageIndexMin();this._createNumericButtonsSection(t,e)},_createNumericButtonsWithOutsideEllipsis:function(t,e){var i=this._calculatePageIndex(e);this._createNumericButtonsSection(t,i)},_calculatePageIndex:function(t){var e=this.get_pageIndex(),i=this.get_numericButtonCount(),s=this.get_pageCount(),o=[],n=e-i/2+(1-i%2),r=Math.round(n+i);n<0&&(r=(n=0)+i),r>s&&(n=(r=s)-i),t&&n>0&&Array.add(o,-1);for(var a=Math.round(n);a<r;a++)Array.add(o,a);return t&&r<s&&Array.add(o,-1),o},_createNumericButtonsWithInsideEllipsis:function(t){var e=this.get_numericButtonCount();if(e<3)this._createNumericButtonsWithOutsideEllipsis(t,!0);else{var i=this._calculatePageIndexMax(e);this._createNumericButtonsSection(t,i)}},_doPagerBeforeRefresh:function(){var t=this._getTargetControl();t&&!this._loading&&t._internalDoPagerBeforeRefresh()},get_queryParams:function(){return this._savedQueryParams||this._queryParams},set_queryParams:function(t){this._queryParams=t},_beforeRefresh:function(t){return Object.copyTo(this._queryParams,t),this._savedQueryParams=t,this._hasSummaryLoaded=!1,this._doPagerBeforeRefresh(),t},get_target:function(){return this._target},set_target:function(t){this._target=t},get_pageSize:function(){return this._pageSize},set_pageSize:function(t){this._pageSize=t},get_maxPageSize:function(){return this._maxPageSize},set_maxPageSize:function(t){this._maxPageSize=t},get_numericButtonCount:function(){return this._numericButtonCount},set_numericButtonCount:function(t){this._numericButtonCount=t},get_showQueryTips:function(){return this._showQueryTips},set_showQueryTips:function(t){this._showQueryTips=t},get_itemCount:function(){return this._itemCount},set_itemCount:function(t){this._itemCount=t,this._pageIndex<0&&t>0&&(this._pageIndex=0)},get_pageIndex:function(){return this._pageIndex},set_pageIndex:function(t){this._loadPage(t)},resetPageIndex:function(){this._pageIndex=0},_dataFailed:function(t){if(this.endLoading(),!this.get_isDisposed()){if(t.get_message()){var e=Sys.Net.WebServiceProxy.formatWebServiceFailedServerError(t.get_message());$app.showError(Sys.ErrorType.other,e,!1,this._getTargetControl().get_form())}}},_beginLoading:function(t){var e=this;this._loading=!0,this._waitTimer=setTimeout(function(){e._waitTimer&&$common.showLoading(t.get_element())},600)},endLoading:function(t){this._waitTimer&&(clearTimeout(this._waitTimer),delete this._waitTimer),this._loading&&$common.hideLoading(),this._loading=!1,t||(this.get_showQueryTips()&&0==this.get_itemCount()&&$common.showTips("没有数据,请重新查询！",1e3),this._gotoIndex=-1)},_homePage:function(t){$Dom.getEnabled(t.target)&&this.gotoPage(0)},_prevPage:function(t){var e=this.get_pageIndex();e>0&&this._gotoPageOnClick(e-1)},_nextPage:function(t){var e=this.get_pageIndex();e<this.get_pageCount()-1&&this._gotoPageOnClick(e+1)},_lastPage:function(t){$Dom.getEnabled(t.target)&&this.gotoPage(this.get_pageCount()-1)},_refreshPage:function(t){this.refreshPage({})},_createPageButtonByClass:function(t,e,i,s){var o=$common.createClassDiv("Button SpeedButton icononly iconfont Pager_"+e);return o.id=this.get_id()+"_"+e,s&&(o.title=s),t.appendChild(o),$common.addClickHandler(o,i,this),o},_createPageSizeEditButton:function(t){if(!(this._maxPageSize<=0||!this.get_target()||this._showAll)){var e=this._pageSizeSpan=$common.createClassSpan("PagerEveryPageText");e.innerHTML="每页",t.appendChild(e);var i=$common.createInput();i.className="ButtonEdit Edit PagerEveryPageEdit",t.appendChild(i),this._createPageSizeEdit(i)}},_createPageSizeEdit:function(t){var e=this._pageSizeEdit=$create(Sys.UI.Controls.DropDownEdit,{tabOnEnter:!1,dataValueField:"value",dataTextField:"text",outerCssClass:"pageSize",dropDownStyle:_Z_24.dropDownEdit,items:this.bindPageSizeItems(),value:this.get_pageSize()+"条"},t,null,this.get_form());e.add_enterPress($createDelegate(this,this._doPageSizeChanged)),e.add_change($createDelegate(this,this._doPageSizeChanged)),e.add_keyPress($createDelegate(this,this._doDropKeyPress))},bindPageSizeItems:function(){for(var t=[],e=$settings.GridPagerPageSizeItems.split(","),i=0,s=e.length;i<s;i++){var o=e[i],n={value:o,text:o+"条"};t.push(n)}return t},_doPageSizeChanged:function(t,e){e&&e.cancel();var i=t.get_value(),s=parseInt(i);if(this._pageSizeT!=s){if(isNaN(s)||s>1e4||s<1)return t.set_value(this.get_pageSize()),void $common.showHint("输入"+i+"无效，已重置",t);var o=this.get_pageSize();if(s!=o){if(s>this._maxPageSize)return t.set_value(this.get_pageSize()),void $common.showHint("每页最多显示"+this._maxPageSize+"条数据，已重置",t);this._pageSizeT=s,t.set_value(s+"条");var n=this._caculatePageIndex(s,o);this._doPagerBeforeRefresh(),this.gotoPage(n)}}},_caculatePageIndex:function(t,e){return this._getTargetControl()._savePageSize(t),this.set_pageSize(t),0},_createSummary:function(t){var e=this._summary=$common.createClassDiv("PagerSummaryText");t.appendChild(e)},_createNumericButtons:function(){if(this._pageDrpEdit)this._refreshDropDownPageEdit();else if(!(this.get_numericButtonCount()<=0||this._showAll||this.get_pageCount()<=1)){var t=this._pagesCell;this.get_pageCount()<=this.get_numericButtonCount()?this._createAllNumericButtonsWithOutsideEllipsis(t):this._createNumericButtonsWithInsideEllipsis(t)}},_createNumericButtonsSection:function(t,e){for(var i=this.get_pageIndex(),s=0;s<e.length;s++){var o=e[s],n=$common.createDiv(),r="...";o>-1&&(r=o+1,o==i?className="PagerButton active":(n._pageIndex=o,className="PagerButton"),n.className=className),n.innerHTML=r,t.appendChild(n)}},_onPageButtonClick:function(t){var e=t.target._pageIndex;Object.isUndefined(e)||this._gotoPageOnClick(e)},_clearNumericButtons:function(){this._pagesCell&&(this._pagesCell.innerHTML="")},_initNumericButtons:function(){this._clearNumericButtons(),this._createNumericButtons()}},_Z_83.registerClass("_Z_83",Sys.UI.Control),Sys.UI.Controls.ScrollTopControl=function(t,e){this._scrollElement=t,this._changed=0,e?(this._backTopShape=e.get_element?e.get_element():e,this._bindClickEventHandler(this._backTopShape)):this._createBackTopShape()},Sys.UI.Controls.ScrollTopControl.prototype={dispose:function(){this.checkScrollTop(),this._scrollHandler&&($common.removeScrollHandler(this._getScrollElement(),this._scrollHandler),this._scrollHandler=null),this._backTopShape&&$clearHandlers(this._backTopShape)},_hasDocument:function(){return this._scrollElement==document.documentElement||this._scrollElement==document.body},_createBackTopShape:function(){backTopShape=this._backTopShape=$common.createClassDiv("iconfont BackTopShape"),document.body.appendChild(backTopShape),this._bindClickEventHandler(backTopShape)},_bindClickEventHandler:function(t){t&&($common.addClickHandler(t,this._goScrollTop,this),this._scrollHandler=$common.addScrollHandler(this._getScrollElement(),this.checkScrollTop,this))},_getScrollElement:function(){return this._hasDocument()?window:this._scrollElement},_changeScrollElement:function(){this._changed>2||this._hasDocument()&&(this._changed++,this._scrollElement=document.body.scrollTop>0?document.body:document.documentElement)},checkScrollTop:function(t){this._backTopShape&&(this._changeScrollElement(),this._backTopShape.style.display=this._scrollElement.scrollTop>50?"block":"none")},_goScrollTop:function(t,e){$common.scrollTop(this._scrollElement)}},_Z_81=function(t,e){this._parentDom=e,this._bindElement=t,this._xBar=null,this._yBar=null,this._minY=0,this._maxY=0,this._minX=0,this._maxX=0,this._barMinSize=30,this._isTouchUp=null,this._touchSpeedTime=600,this._allowMouseWheel=!0,this._mouseWheelScroll=!0,t.style.overflow="hidden",t.unselectable="on",e.style.position="relative"},_Z_81.prototype={dispose:function(){_Z_238.IsDraging=!1,this._disposed=!0,$clearHandlers(this._parentDom),$clearHandlers(this._bindElement),$clearHandlers(this._XValueBar),$clearHandlers(this._YValueBar),$removeNode(this._xBar),$removeNode(this._yBar)},onMouseOverContainer:function(t){this._showBar()},onMouseOutContainer:function(t){this._hideBar()},_hasXScroll:function(){var t=this._barElement=this._bindElement;return t.scrollWidth-t.offsetWidth>5||(this._barElement=t.firstChild,t.firstChild.scrollWidth-t.offsetWidth>5)},_hasYScroll:function(){if(this._xbarOnly)return!1;var t=this._bindElement;return t.scrollHeight-t.offsetHeight>2},_showBar:function(t){if(!this._isMove||t){var e=this._xBar,i=this._yBar,s=this._bindElement,o=this._parentDom,n=this._XValueBar,r=this._YValueBar;if(e||(e=this._xBar=$common.createClassDiv("CrabaScrollBar XBar"),this._xbarClass&&$Dom.addCssClass(e,this._xbarClass),n=this._XValueBar=$common.createClassDiv("BarValue"),e.appendChild(n),o.appendChild(e),$common.addMouseWheelHandler(e,this._mouseWheelX,this),$common.addMouseDownHandler(n,this._startScroll,this),$common.addMouseDownHandler(e,this._clickScroll,this),i=this._yBar=$common.createClassDiv("CrabaScrollBar YBar"),r=this._YValueBar=$common.createClassDiv("BarValue"),i.appendChild(r),o.appendChild(i),$common.addMouseWheelHandler(i,this._mouseWheel,this),$common.addMouseDownHandler(r,this._startScroll,this),$common.addMouseDownHandler(i,this._clickScroll,this),$common.addMouseEnterHandler(o,this.onMouseOverContainer,this),$common.addMouseLeaveHandler(o,this.onMouseOutContainer,this),this._allowMouseWheel&&$common.addMouseWheelHandler(s,this._mouseWheel,this),$common.addScrollHandler(s,this._onScroll,this),$common.addTouchStartHandler(s,this._onTouchstart,this)),this._hasYScroll()){$Dom.setVisible(i,!0);var a=s.offsetHeight*s.offsetHeight/s.scrollHeight;a<this._barMinSize&&(a=this._barMinSize),r.style.height=a+"px",r.style.top=this._getTopValue(s.scrollTop)+"px",i.style.height=s.offsetHeight+"px",i.style.top=(s===o?0:s.offsetTop)+"px",this._maxY=i.offsetHeight-a}else $Dom.setVisible(i,!1);if(this._hasXScroll()){$Dom.setVisible(e,!0);var l=s.offsetWidth*s.offsetWidth/s.scrollWidth;l<this._barMinSize&&(l=this._barMinSize),n.style.width=l+"px",n.style.left=this._getLeftValue(s.scrollLeft)+"px",e.style.width=s.offsetWidth+"px",this._maxX=e.offsetWidth-l,$dom.addCssClass(o,"HasXBar")}else $dom.removeCssClass(o,"HasXBar"),$Dom.setVisible(e,!1)}},set_xbarOnly:function(t){this._xbarOnly=t},set_xbarClass:function(t){this._xbarClass=t},_hideBar:function(){this._xBar&&!this._isMove&&(this._hasXScroll()||$Dom.setVisible(this._xBar,!1),this._hasYScroll()||$Dom.setVisible(this._yBar,!1))},_clickScroll:function(t){var e=this._bindElement,i=t.target;if(i==this._yBar){var s=t.offsetY,o=s>this._YValueBar.offsetTop?1:-1;s=e.scrollHeight/4,s*=o,e.scrollTop+=s,this._YValueBar.style.top=s+"px"}else if(i==this._xBar){var n=t.offsetX,o=n>this._XValueBar.offsetLeft?1:-1;n=e.scrollWidth/4,n*=o,e.scrollLeft+=n,this._XValueBar.style.left=n+"px"}},_onTouchstart:function(t){this._showBar();var e=t.rawEvent.currentTarget,i=t.rawEvent.targetTouches[0];this._startTouch=i,this._touchMoveHandler||(this._isMove=!0,this._touchMoveHandler=$common.addTouchMoveHandler(e,this._onTouceMove,this),this._touchEndHandler=$common.addTouchEndHandler(e,this._onTouceEnd,this))},_onTouceMove:function(t){var e=t.rawEvent;if(!(e.targetTouches.length>1||e.scale&&1!==e.scale)){var i=e.targetTouches[0],s=i.pageX-this._startTouch.pageX,o=i.pageY-this._startTouch.pageY;this._isScrollY=Math.abs(s)<Math.abs(o);var n=this._bindElement;this._isScrollY?(n.scrollTop+=-1*o,top=this._getTopValue(n.scrollTop),this._YValueBar.style.top=top+"px"):(n.scrollLeft+=-1*s,left=this._getLeftValue(n.scrollLeft),this._XValueBar.style.left=left+"px"),this._startTouch=i,this._isTouchUp=o<0,t.cancel()}},_onTouceEnd:function(t){this._showBar(),this._checkTouchSpeed();var e=t.rawEvent.currentTarget;this._touchMoveHandler&&($common.removeTouchMoveHandler(e,this._touchMoveHandler),$common.removeTouchEndHandler(e,this._touchEndHandler),this._touchMoveHandler=null,this._isMove=!1,this._tourchUp=null)},_checkTouchSpeed:function(){if(null!==this._isTouchUp){var t=this._bindElement;if(this._touchTimer)this._touchCount++,this._touchCount>2&&(this._isTouchUp?$common.scrollBottom(t):$common.scrollTop(t),this._touchCount=0,this._tourchUp=null);else{var e=this;e._touchCount=1,e._touchTimer=setTimeout(function(){e._touchTimer=null,e._touchCount=0,e._tourchUp=null},this._touchSpeedTime)}}},_mouseWheel:function(t){if(this._mouseWheelScroll)if(this._xbarOnly)this._mouseWheelX(t);else if(this._hasYScroll()){var e=t.wheelType,i=this._bindElement,s=i.scrollHeight/i.offsetHeight*9;s=Math.min(s,40),i.scrollTop+=e*s,s=this._getTopValue(i.scrollTop),this._YValueBar.style.top=s+"px",i.scrollTop>0&&i.scrollTop+i.offsetHeight+1<i.scrollHeight&&t.cancel()}},_mouseWheelX:function(t){var e=t.wheelType,i=this._bindElement,s=i.scrollWidth/i.offsetWidth*9;s=Math.min(s,40),i.scrollLeft+=e*s,s=this._getLeftValue(i.scrollLeft),this._XValueBar.style.left=s+"px",t.cancel()},_onScroll:function(t){if(!this._isMove&&this._yBar){var e=this._getTopValue(this._bindElement.scrollTop);this._YValueBar.style.top=e+"px",$craba.raiseMouseDown()}},_getTopValue:function(t,e){return e||(t=t*this._yBar.offsetHeight/this._bindElement.scrollHeight),t>this._maxY?this._maxY:t<this._minY?this._minY:t},_getLeftValue:function(t,e){return e||(t=t*this._xBar.offsetWidth/this._bindElement.scrollWidth),t<this._minX?this._minX:t>this._maxX?this._maxX:t},_onTextSelectStart:function(t){t.cancel()},_startScroll:function(t){$craba.raiseMouseDown(),this._isScrollY=this._YValueBar==t.target,this._start=this._isScrollY?t.clientY:t.clientX,this._mouseUpHandler||(this._isMove=!0,$Dom.addCssClass(this._isScrollY?this._yBar:this._xBar,"drag"),this._mouseUpHandler=$common.addMouseUpHandler(document,this._stopMove,this),this._mouseMoveHandler=$common.addMouseMoveHandler(document,this._startMove,this),this._clickHandler=$common.addClickHandler(document,this._stopMove,this),this._selectHandler=$common.addSelectStartHandler(this._parentDom,this._onTextSelectStart,this)),t.cancel()},_startMove:function(t){if(_Z_238.IsDraging=!0,this._isScrollY){e=t.clientY-this._start;this._moveY(e),this._start=t.clientY}else{var e=t.clientX-this._start;this._moveX(e),this._start=t.clientX}t.cancel()},_moveY:function(t){var e=this._getTopValue(this._YValueBar.offsetTop+t,!0),i=this._YValueBar.offsetHeight==this._barMinSize?this._yBar.offsetHeight-this._barMinSize:this._yBar.offsetHeight;this._bindElement.scrollTop=e*this._bindElement.scrollHeight/i,this._YValueBar.style.top=e+"px"},_moveX:function(t){var e=this._getLeftValue(this._XValueBar.offsetLeft+t,!0),i=this._XValueBar.offsetWidth==this._barMinSize?this._xBar.offsetWidth-this._barMinSize:this._xBar.offsetWidth;this._bindElement.scrollLeft=e*this._bindElement.scrollWidth/i,this._XValueBar.style.left=e+"px"},_stopMove:function(t){_Z_238.IsDraging=!1,this._mouseUpHandler&&!this._disposed&&($Dom.removeCssClass(this._isScrollY?this._yBar:this._xBar,"drag"),$common.removeMouseUpHandler(document,this._mouseUpHandler),$common.removeMouseMoveHandler(document,this._mouseMoveHandler),$common.removeClickHandler(document,this._clickHandler),$common.removeSelectStartHandler(this._parentDom,this._selectHandler),this._mouseUpHandler=null,this._isMove=!1),t.cancel()}},_Z_81.create=function(t,e){return t&&t.tagName&&e?new _Z_81(t,e):null},Sys.DragBlock=function(t){this._options={id:"__dragBlock",allowDrag:!0,cachePos:!0},Object.copyTo(t,this._options),this.initialize()},Sys.DragBlock.prototype={initialize:function(){var t=this._options;this._allowDrag=t.allowDrag;var e;if(t.control&&(t.control.tagName?e=t.control:t.control.get_element&&(e=t.control.get_element())),t.self)this._element=e;else if(t.parent)t.parent.appendChild(e),this._element=e;else{var i=this._element=$common.createClassDiv("DragBlock");i.id=t.id,$Dom.addCssClass(i,t.cssClass),i.innerHTML=t.html?t.html:"",i.appendChild(e),document.body.appendChild(i),this._resizeHandler=$common.addResizeHandler(window,this._windowResize,this)}this._element.style.zIndex=this._options.zIndex?this._options.zIndex:$app.getPopupElementZIndex(),this._initDrag(),this._showPos()},dispose:function(){$clearHandlers(this.get_element()),this._resizeHandler&&($removeNode(this.get_element()),$common.removeResizeHandler(window,this._resizeHandler))},get_id:function(){return this.get_element().id},get_hasDragged:function(){var t=this._hasDragged;return this._hasDragged=!1,t},removeCssClass:function(){},addCssClass:function(){},get_element:function(){return this._element},get_allowDrag:function(){return this._allowDrag},set_allowDrag:function(t){this._allowDrag=t},_windowResize:function(){var t=$Dom.getBounds(this.get_element()),e=getClientBounds(),i=t.x,s=t.y;t.x+10>e.width&&(i=e.width-t.width/2),t.y+10>e.height&&(s=e.height-t.height/2),this._location(i,s)},_initDrag:function(){this.get_allowDrag()&&(this._mouseDownHandler=$common.addMouseDownHandler(this.get_element(),this._mouseDown,this))},_mouseDown:function(t){if(this.get_allowDrag()){if(this._options.dragControl)for(var e=this._options.dragControl.get_element(),i=t.target;i&&i!=e;){if(i==this.get_element())return;i=i.parentNode}this._startPos={x:t.clientX,y:t.clientY};(e=this.get_element()).style.zIndex=this._options.zIndex?this._options.zIndex:$app.getPopupElementZIndex(),this._startLocation=$Dom.getLocation(this.get_element()),this._processDragEvent(!1),this._processDragEvent(!0),t.cancel(),this._startDrag=!0}},_processDragEvent:function(t){this.get_allowDrag()&&(t?this._mouseMoveHandler||(this._mouseMoveHandler=$common.addMouseMoveHandler(document,this._dragMove,this),this._mouseUpHandler=$common.addMouseUpHandler(document,this._endDrag,this)):this._mouseMoveHandler&&($common.removeMouseMoveHandler(document,this._mouseMoveHandler),$common.removeMouseUpHandler(document,this._mouseUpHandler),this._mouseMoveHandler=this._mouseUpHandler=null))},_dragMove:function(t){if(this._startDrag){t.cancel();var e={x:t.clientX,y:t.clientY};if(!(!_Z_238.IsDraging&&Math.abs(e.x-this._startPos.x)<10&&Math.abs(e.y-this._startPos.y)<10||this._isMouseMoving)){this._isMouseMoving=!0,_Z_238.IsDraging=!0,this._emitDragMove(t);var i=this;setTimeout(function(){i._isMouseMoving=!1},100)}}},_emitDragMove:function(t){this._hasDragged=!0;this.get_element();var e=this._startPos.x-t.clientX,i=this._startPos.y-t.clientY;this._location(this._startLocation.x-e,this._startLocation.y-i,!0)},_location:function(t,e,i){var s=this.get_element();if(i)s.style.left=t+"px",s.style.top=e+"px";else{var o=getClientBounds(),n=t/o.width*100,r=e/o.height*100;n=Math.min(n,98),r=Math.min(r,98),s.style.left=n+"%",s.style.top=r+"%"}s.style.right="auto",s.style.bottom="auto"},_endDrag:function(t){this._startDrag&&(t.cancel(),_Z_238.IsDraging=!1,this._processDragEvent(!1),this._cachePos())},_cachePos:function(){if(this._options.cachePos){var t=$Dom.getLocation(this.get_element());$userCache.set(this._options.id,t)}},_showPos:function(){if(this._options.cachePos){var t=$userCache.get(this._options.id);t&&this._location(t.x,t.y)}},showCenter:function(){var t=this._element.offsetWidth,e=this._element.offsetHeight,i=this._element.parentNode,s=i.offsetWidth/2-t/2,o=i.offsetHeight/2-e/2;this._location(s,o)},set_visible:function(t){$Dom.setVisible(this.get_element(),t)},get_visible:function(){return $Dom.getVisible(this.get_element())}},_Z_82=function(t){this._isTopFixed=!1,this._topDiv=t,this._topLocation=$Dom.getLocation(t),this._scrollEvent=null,this._offsetTop=-1*this._topLocation.y;var e=this._topReplace=$common.createDiv();e.style.height="0px",t.parentNode.insertBefore(e,t),this._scrollHandler=$common.addScrollHandler(window,this._onScroll,this)},_Z_82.prototype={dispose:function(){$common.removeScrollHandler(window,this._scrollHandler),this._topDiv=null,this._topReplace=null,this.scrollHandler=null,_Z_82.callBaseMethod(this,"dispose")},get_topLocation:function(){return this._topLocation},_onScroll:function(t){var e=getClientScrollPosition();if((this._offsetTop=e.y-this._topLocation.y)>0){if(this._isTopFixed)return;this.setFixed(!0),this._offsetTop=0}else this._isTopFixed&&this.setFixed(!1);this._scrollEvent&&this._scrollEvent(this)},setFixed:function(t){this._isTopFixed=t;var e=this._topDiv,i={position:""},s=0;t?(s=e.offsetHeight,this._topLocation=$Dom.getLocation(e),i={position:"fixed",top:"0px",left:this._topLocation.x+"px",zIndex:10},$Dom.addCssClass(e,"fixed")):$Dom.removeCssClass(e,"fixed"),this._topReplace.style.height=s+"px",$Dom.setStyle(e,i)},add_onscroll:function(t,e){this._scrollEvent=$createDelegate(e,t)}},_Z_82.registerClass("_Z_82",Sys.UI.Control);var $msg=$Message=Sys.UI.MessageBox=function(){};$msg._showModal=function(t,e,i,s,o,n){if(t=t?t.toString():""){var r=0==e?"aicon-zhushi":"aicon-question-circle",a=!0,l=Sys.Res.messageBoxTitle,h="",d=null,_=!1;"string"==typeof s?(l=s,s=null):s&&"object"==typeof s&&(l=s.title!==undefined?s.title:l,a=s.iconVisible!==undefined?s.iconVisible:a,r=s.iconName!==undefined?s.iconName:r,s.className&&(s.boxClass=s.className),h=s.boxClass!==undefined?s.boxClass:h,d=s.onLoad,_=s.showMDI,s.buttons&&(e=3,i=s.buttons),s=s.handler),a||(r="");var c=2!=e,u=Sys.UI.Form.create({caption:l,borderStyle:_Z_54.fixedToolWindow,width:0,height:0,isMDI:_,isMessageBox:!0,autoSize:!0,showCloseButton:!!c});u._isAsync=!1,u._result=!1,u._btnClick=!1;var p="";p+='<div class="MessageContent '+r+'"><div class="MessageBoxText">'+(t.indexOf("</")>0?t:$common.textToHtml(t))+"</div></div>",p+='<div class="BottomButtons">';var g,m,f,C,y=(new Date).getTime(),v={buttonKind:2,cancel:!0},S=["SpecialButton"];if(0==e)g=1,m=["确定"],f=[v],C=[!0];else if(1==e)g=2,m=["确定","取消"],f=[{buttonKind:1},v],C=[!0,!1];else{g=i.length,m=i;var I={buttonKind:2};f=[],C=[];for(B=0;B<g;B++)f[B]=I,C[B]=B;g++,m.push("Esc"),v.visible=!1,f.push(v),C.push(-1)}for(B=0;B<g;B++){var D="btn"+(y+B),w="Button AlertBtn"+B;S&&(w=$skin.joinCssClass(w,S[B])),p+='<button id="'+D+'" class="'+w+'" tabindex="0">'+m[B]+"</button>"}p+="</div>",u.addCssClass(h),u.set_content(p);for(var x=function(t){u._result=t.get_tag(),u._btnClick=!t._thenClick},B=0;B<g;B++){var D="btn"+(y+B),b=f[B];b.tag=C[B],$create(Sys.UI.Controls.Button,b,D,{click:x},u)}u.add_closed(function(){s&&(o&&(s=$createDelegate(o,s)),s(u._result,u._btnClick))});var U="frm"+y;return u.set_id(U),u.Context={pageId:U},$app.addForm(u),u.doInit(),u.showModal(),u.doHideProgressor(),u.doBeforeEndLoaded(),u.doEndLoaded(),d&&d(u),setTimeout(function(){u.focusActiveControl()},100),u}},$msg.alert=function(t,e,i){return $msg._showModal(t,0,null,e,i)},$msg.confirm=function(t,e,i,s){return $msg._showModal(t,1,null,e,i,s)},$msg.confirmText=function(t){if("object"==typeof t){var e=t.title,i=t.message,s=t.control,o=t.handler,n=$common.getMainForm();if(!this._popup){var r=$createControl("PopupBlock",{ID:"__alertPopup",CssClass:"AlertPopup"},n,null,!0);$createControl("Label",{ID:"__alertTitle",Text:"提示",CssClass:"Title"},n,r),$createControl("Label",{ID:"__tips",Text:"提示内容",CssClass:"Text"},n,r);var a=$createControl("HBlock",{HAlign:"Right"},n,r);$createControl("Button",{OnClick:"$msg.__ok",Tag:1,Text:"确认",CssClass:"SpecialButton"},n,a),$createControl("Button",{Text:"取消",CssClass:"mr0",OnClick:"$msg.__ok",Tag:0},n,a),$msg.__ok=function(t){this._popup.hide(),o&&o(t.get_tag())},r.appendTo(document.body),this._popup=n.__alertPopup,this._caption=n.__alertTitle,this._tipLabel=n.__tips}this._tipLabel.set_text(i),this._caption.set_text(e),this._popup.popupAt(s)}else $common.showTips("$common.confirmText的参数必须是object类型")},$msg.ask=function(t,e,i,s){if(!(e&&"object"==typeof e&&e.length>=1))throw Error.argumentOutOfRange("buttons",e);return $msg._showModal(t,2,e,i,s)},$msg.prompt=function(t,e,i){var s={ID:"promptEdit",CssClass:"PromptEdit"},o=null;e&&"object"==typeof e&&(o=e.value,s.MaxLength=e.maxLength),s.Text=o||"";var n=$msg._showModal(t,0,null,e,i);e=e&&e.handler?e.handler:e,n.get_events().clearHandlers("closed"),n.add_close(function(){1==n._result?n._result=n.promptEdit.get_text():n._result=null,e&&(i&&(e=$createDelegate(i,e)),e(n._result,n._btnClick))});$createControl("TextEdit",s,n).appendTo(n.get_contentElement().firstChild.lastChild),n._activeControl="promptEdit"},Sys.ImageViewer=function(t){this._options={autoTimer:3e3,showArrowButton:!0,showCloseButton:!0,showControls:!0,allowShortcut:!0,allowZoom:!0,allowDrag:!0,autoPlay:!1,showName:!0,showMaxButton:!0},this._transNumber=1,Object.copyTo(t,this._options)},Sys.ImageViewer.prototype={initialize:function(){if(!this._inited){this._inited=!0;var t=this._options.className?this._options.className+" ImageViewer":"ImageViewer AbsViewer";this._element=$common.createClassDiv(t+" FlexBlock");var e=$common.createFragment();this._createArrowButton(e),this._createCloseButton(e);var i=this._body=$common.createClassDiv("ViewBody");e.appendChild(i),this._createControls(e),this._createImage(i),this._createMaxBtn(e);var s=this.txtElt=$common.createClassSpan("text");if(i.appendChild(s),this._element.appendChild(e),this.get_parent().appendChild(this._element),this._options.showControls){o=$get("_imgView_chk");$common.addChangeHandler(o,this.doChangeTimer,this)}if(this._options.allowZoom&&$common.addMouseWheelHandler(this._element,this.doMouseWheel,this),this._options.allowShortcut&&($common.addDblClickHandler(this._body,this.doClose,this),this._bodyKeyHandler=$common.addKeyDownHandler(document.body,this.doKeyDown,this)),this._options.autoPlay){var o;(o=$get("_imgView_chk"))&&(o.checked=!0)}}},_createMaxBtn:function(t){if(this._options.showMaxButton&&this._options.parentNode){var e=$common.createClassDiv("aicon max aicon-quanping");e.title="最大化",t.appendChild(e),$common.addClickHandler(e,this.doMax,this)}},_createImage:function(t){var e=this._img=document.createElement("img");this._options.allowDrag?(e.className="drag",this._dragImg=new Sys.DragBlock({cssClass:"__dragImg",id:"_dragImg",parent:t,zIndex:1,control:e})):t.appendChild(e)},_createControls:function(t){if(this._options.showControls){var e=$common.createClassDiv("ControlBlock");t.appendChild(e),timerB=this._timerBlock=$common.createClassDiv("TimerBlock"),e.appendChild(timerB),timerB.innerHTML='<div class="CheckBox"><input id="_imgView_chk" type="checkbox"><label for="_imgView_chk">自动播放('+this._options.autoTimer/1e3+"s)</label></div>";var i=$common.createClassDiv("aicon aicon-xuanzhuan");i.title="旋转图片",e.appendChild(i),$common.addClickHandler(i,this.doTrans,this);var s=$common.createClassDiv("aicon aicon-xiazai");s.title="下载原图",e.appendChild(s),$common.addClickHandler(s,this.doDown,this)}},_createCloseButton:function(t){if(this._options.showCloseButton){var e=this._closeBtn=$common.createClassDiv("CloseBtn Button InfoButton icononly aicon-close");e.title="关闭",$common.addClickHandler(e,this.doClose,this),t.appendChild(e)}},_createArrowButton:function(t){if(this._options.showArrowButton){var e=this._leftBtn=$common.createClassDiv("LeftArrow Button InfoButton icononly aicon-left");e.title="上一张",$common.addClickHandler(e,this.doPrev,this);var i=this._rightBtn=$common.createClassDiv("RightArrow Button InfoButton icononly aicon-right");i.title="下一张",$common.addClickHandler(i,this.doNext,this),t.appendChild(e),t.appendChild(i)}},doMax:function(t){new Sys.ImageViewer({className:"AbsViewer",srcField:this._options.srcField,index:this._index}).showImages(this._urls)},doTrans:function(t){this.doChangeTimer();var e=-90;this._transNumber>3&&(this._transNumber=0),e*=this._transNumber,this._transNumber++,this._img.style.transform="rotate("+e+"deg)"},doDown:function(t){$common.saveImage(this._img.src)},doMouseWheel:function(t){this.doChangeTimer();var e=this._img;if(e.zoom||(e.zoom=parseInt(e.offsetWidth/e.parentNode.offsetWidth*100)),zoom=t.wheelDelta>0?e.zoom+5:e.zoom-5,zoom>10){var i=zoom+"%";e.style.width=i,e.zoom=zoom,this._dragImg.showCenter(),$common.showTips({html:i,zIndex:999999,timer:500,className:"TextTips noClose"})}t.cancel()},showImages:function(t){this._closed=!1,"string"==typeof t&&(t=t.split(","));t instanceof Array&&0!=t.length&&(this._urls=t,this._index=this._options.index?this._options.index:0,this.initialize(),this.refreshButtons(),this.show(),this.doChangeTimer())},show:function(){this.doChangeTimer(),this._leftBtn&&($Dom.setEnabled(this._leftBtn,0!==this._index),$Dom.setEnabled(this._rightBtn,this._index!==this._urls.length-1)),this._curBtn&&$Dom.removeCssClass(this._curBtn,"cur");var t=this._btnsDiv.childNodes[this._index];$Dom.addCssClass(t,"cur"),this._curBtn=t,this._index<0?this._index=0:this._index>this._urls.length-1&&(this._index=this._urls.length-1);var e=this._urls[this._index],i=e;"object"==typeof i&&(i=e[this._options.srcField]);var s;if(this._options.form){var o=this._options.form;i.startsWith("data:image/")||i.startsWith("http")?(i=i,s=""):i=this._options.rxd?$common.getResourceUrl(i,o):o.convertUrl(i)}else i.startsWith("~/")&&(i=i.substr(2));""!==s&&(s=i),this._options.showName&&(this.txtElt.innerText=s);var n=this,r=this._img;r.style.transform="",this._transNumber=1,$Dom.addCssClass(r,"opacity"),setTimeout(function(){n._closed||(r.src=i,r.style.width="auto",r.zoom=0,n._options.onNext&&n._options.onNext(e,n._index),n._dragImg&&(r.onload=function(){n._dragImg.showCenter(),r.onload=null}),$Dom.removeCssClass(r,"opacity"))},200)},doChangeTimer:function(t){if(this._options.autoTimer){var e=$get("_imgView_chk");if(this._removeTimer(),this._options.autoPlay||e&&e.checked){var i=this;this._timer=setTimeout(function(){i._closed?i._removeTimer():i._dragImg&&i._dragImg.get_hasDragged()?i.doChangeTimer():0!=i._img.offsetWidth?(i._index++,i._index>i._urls.length-1&&(i._index=0),i.show()):i.doChangeTimer()},this._options.autoTimer)}}},_removeTimer:function(){this._timer&&(clearInterval(this._timer),this._timer=null)},refreshButtons:function(){if(!this._btnsDiv){var t=this._btnsDiv=$common.createClassDiv("ButtonsDiv");this._element.appendChild(t),$common.addClickHandler(t,$createDelegate(this,this.changeIndex))}this._timerBlock&&$Dom.setVisible(this._timerBlock,this._urls.length>1&&this._options.autoTimer>100),this._btnsDiv.innerHTML="";for(var e=$common.createFragment(),i=0;i<this._urls.length;i++){var s=$common.createClassDiv("btn");i==this._index&&($Dom.addCssClass(s,"cur"),this._curBtn=s),s.setAttribute("index",i),s.innerHTML=i+1,e.appendChild(s)}this._btnsDiv.appendChild(e)},changeIndex:function(t){var e=t.target.getAttribute("index");Object.isUndefinedOrNull(e)||(this._index=e,this.show())},doKeyDown:function(t){switch(t.keyCode){case Sys.UI.Key.up:case Sys.UI.Key.left:this.doPrev();break;case Sys.UI.Key.space:case Sys.UI.Key.down:case Sys.UI.Key.right:this.doNext();break;case Sys.UI.Key.esc:this.doClose()}t.cancel()},doPrev:function(t){this._index--,this._index<=0&&(this._index=0),this.show()},doNext:function(t){this._index++,this._index>=this._urls.length-1&&(this._index=this._urls.length-1),this.show()},doClose:function(t){this._closed=!0,this._removeTimer(),$clearHandlers(this._element),$clearHandlers(this._img),$clearHandlers(this._leftBtn),$clearHandlers(this._rightBtn),$clearHandlers(this._closeBtn),this._dragImg&&this._dragImg.dispose(),this._options.allowShortcut&&$common.removeKeyDownHandler(document.body,this._bodyKeyHandler),$removeNode(this._element)},get_element:function(){return this._element},get_parent:function(){return this._options.parentNode?this._options.parentNode:document.body},set_parent:function(t){this._options.parentNode=t}};﻿Craba.Web.Script.ListViewDataService=function(t){Craba.Web.Script.ListViewDataService.initializeBase(this,[t])},Craba.Web.Script.ListViewDataService.prototype={GetPagerData:function(t,e,i,s,n,a,r,o,l){var h=this._getData(t,e,i,s,n,a);return this._invokeBindData("GetPagerData",h,r,o,l)}},Craba.Web.Script.ListViewDataService.registerClass("Craba.Web.Script.ListViewDataService",Craba.Web.Script.PagerDataService),Craba.Web.Script.ListViewDataService.create=function(t,e){var i=new Craba.Web.Script.ListViewDataService(e);return i.set_enableShowWaiting(!1),i.set_form(t),i},_Z_178=function(t,e,i,s){_Z_178.initializeBase(this),this._index=t,this._item=e,this._modify=i,this._ev=s},_Z_178.prototype={get_index:function(){return this._index},get_item:function(){return this._item},get_data:function(){return this._item.get_data()},get_target:function(){return this._item._clickTarget},get_isModify:function(){return this._modify},get_event:function(){return this._ev}},_Z_178.registerClass("_Z_178",_Z_162),Sys.UI.Controls.ListView=function(t){Sys.UI.Controls.ListView.initializeBase(this,[t]),this._dataSource=[],this._itemWidth=-1,this._itemHeight=-1,this._itemMargin=-1,this._defaultColumnCount=0,this._configID=0,this._resizeMinTopValue=0,this._items=[],this._enabled=!0,this._bindClick=!1,this._selectedItemsData={},this._bindPagerDataSource=!0,this._dropDownNumericButton=$settings.GridPagerDropDownNumericButton},Sys.UI.Controls.ListView.prototype={initialize:function(){this.get_form()._hasFlexBlock=!0,Sys.UI.Controls.ListView.callBaseMethod(this,"initialize"),this._bindClick&&$common.addClickHandler(this.get_element(),this._doClick,this),this._initDrag()},dispose:function(t){if(this._disposeDragEvents(),t)for(var e=this.get_form(),i=0,s=this._templateCotrols.length;i<s;i++){var n=this._templateCotrols[i];e.removeControl(n),Array.remove(e._controls,n)}this._windowResizeHandler&&$common.removeResizeHandler(window,this._windowResizeHandler),this._disposeItems(),$removeNode(this._template),delete this._template,delete this._selectedItemsData,t&&$removeNode(this.get_element().parentNode),this._template=null,Sys.UI.Controls.ListView.callBaseMethod(this,"dispose")},get_parentElement:function(){return this.get_element().parentNode},set_width:function(t){$common.setWidth(this.get_element().parentNode,t)},set_height:function(t){$common.setHeight(this.get_element().parentNode,t)},get_itemCssField:function(){return this._itemCssField},set_itemCssField:function(t){this._itemCssField=t},get_itemStyleField:function(){return this._styleField},set_itemStyleField:function(t){this._styleField=t},get_configID:function(){return this._configID},set_configID:function(t){this._configID=t},get_guid:function(){return this._guid},set_guid:function(t){this._guid=t},set_autoScroll:function(t){this._autoScroll=t},get_autoScroll:function(){return this._autoScroll},appendData:function(t){this.insertData(this._dataSource.length+1,t)},insertData:function(t,e){this._isValidIndex(t)||(t=this._dataSource.length),Array.insert(this._dataSource,t,e),this._createHTMLByData(t,e),this._resetOffsetIndex(t,1),this._viewResize()},modifyData:function(t,e){this._checkIndex(t);var i=this._dataSource[t];e===i&&(e=Object.clone(e)),Object.cloneTo(e,i);var s=this._items[t];s.updateControlData(i),this._doItemRendering(t,s,!0)},modifyDataById:function(t){var e=t[this.get_dataKeyField()],i=this._getKeyFieldIndex(e);if(i<0)throw Error.invalidOperation("没有找到指定的数据，修改失败");this.modifyData(i,t)},deleteData:function(t){this._checkIndex(t),Array.removeAt(this._dataSource,t);this._items[t].dispose(),Array.removeAt(this._items,t);var e=this.get_element();e.removeChild(e.childNodes[t]),this._resetOffsetIndex(t-1,-1),this._viewResize()},deleteDataByKey:function(t){var e=this._getKeyFieldIndex(t);e<0||this.deleteData(e)},findData:function(t){return this._isValidIndex(t)?this._dataSource[t]:null},findItem:function(t){return this._isValidIndex(t)?this._items[t]:null},findItemByKey:function(t){var e=this._getKeyFieldIndex(t);return e<0?null:this._items[e]},findDataByKey:function(t){var e=this._getKeyFieldIndex(t);return e<0?null:this._dataSource[e]},getData:function(t){return this._checkIndex(t),this._dataSource[t]},_getKeyFieldIndex:function(t){var e=this.get_dataKeyField();if(!e)throw Error.invalidOperation("ListView需要设置DataKeyField属性");for(var i=-1,s=0;s<this._dataSource.length;s++){if(this._dataSource[s][e]==t){i=s;break}}return i},doSaveData:function(){if(this._dataField){this.saveData();var t=this._dataSource;this.get_form().get_dataController().setValue(this._dataField,t)}},saveData:function(){if(this._isBindingData)return null;for(var t=this.getItems(),e=0,i=this.getItems().length;e<i;e++)t[e].doSaveData();return this._dataSource},cloneData:function(){return Object.clone(this.saveData())},dataBind:function(t){if(!t){var e=this._dataField;if(!e)return;var i=this.get_form().get_dataController();t=i.getValue(e)}if(t){var s=this;asyncCall(function(){s.refresh(t),s.doDataBind()})}},getItems:function(){return this._items},get_items:function(){return this._items},selectAll:function(t){var e=!1;"boolean"==typeof t&&(e=t),"string"!=typeof t&&(t=this._firstChkField),this._selectAll(t,!0,e)},set_selectAll:function(t){if(this._useSelect)for(var e=this.getItems(),i=0,s=e.length;i<s;i++){var n=e[i].get_element();$Dom.setCssClass(t,n,"selected")}},deselectAll:function(t){t||(t=this._firstChkField),this._selectAll(t,!1)},_selectAll:function(t,e,i){if(!t)throw Error.abort("ListView的全选功能必须包含复选框控件DataCheckBox");if(!this._dataKeyField)throw Error.abort("ListView的全选功能必须指定DataKeyField属性");for(var s=this.getItems(),n=0,a=s.length;n<a;n++){var r=s[n],o=r[t];if(!i||o.get_visible()){o.set_value(e);var l=r.get_data();l[t]=e,this._saveSelectedChange(l,e)}}},_saveSelectedChange:function(t,e){var i=t[this._dataKeyField];e?this._selectedItemsData[i]=t:delete this._selectedItemsData[i]},_checkHasDataKeyField:function(){var t=this._dataKeyField;if(!t)throw Error.invalidOperation("ListView的必须指定DataKeyField属性");return t},get_selectedItems:function(){this._checkHasDataKeyField();var t=[];for(var e in this._selectedItemsData){var i=this._selectedItemsData[e];t.push(i)}return Object.clone(t)},get_selectedDatas:function(){if(!this._useSelect)return[];for(var t=[],e=this.getItems(),i=0,s=e.length;i<s;i++){var n=e[i],a=n.get_element();if($Dom.hasClass(a,"selected")){var r=n.get_data();t.push(r)}}return Object.clone(t)},get_selectedRowData:function(){return this._curItem?this._curItem.get_data():null},get_selectedRowIndex:function(){return this._curItem?this._curItem.get_index():-1},set_selectedRowIndex:function(t){var e=this.findItem(t);this._setCurItem(e)},_resetOffsetIndex:function(t,e){t<0&&(t=-1);for(var i=this.get_recordCount()-1;i>t;i--)this._items[i].updateIndex(e)},_resetIndex:function(){for(var t=0,e=this._items.length;t<e;t++)this._items[t]._index=t},_doClick:function(t){var e=this.getEventItem(t);if(e){this._setCurItem(e);var i=this.get_events().getHandler("_itemClick");i&&(e._clickTarget=t.target,this._item=e,this._doControlEvents(i,this,t))}},_setCurItem:function(t){this._useSelect&&(this._curItem&&this._curItem.removeCssClass("active"),this._curItem=t,this._curItem.addCssClass("active"),$Dom.toggleCssClass(t.get_element(),"selected"))},getEventItem:function(t){var e=t.target,i=this.get_element();if(!e||!e.tagName||e==i)return null;for(var s=e;!(s._control&&_Z_179.isInstanceOfType(s._control)||s==i);)s=s.parentNode;var n=s._control;return n||null},set_useSelect:function(t){t&&(this._bindClick=!0),this._useSelect=t},get_useSelect:function(){return this._useSelect},_isValidIndex:function(t){var e=this._dataSource.length;return t>=0&&t<e},_checkIndex:function(t){if(!this._isValidIndex(t))throw Error.invalidOperation(String.format("记录索引范围应为 [0-{0}]",this._dataSource.length-1))},_disposeItems:function(){for(var t=0,e=this._items.length;t<e;t++){var i=this._items[t];i.dispose(),delete i}this._items=[]},_clearBody:function(){this.get_element().innerHTML=""},doFormInit:function(){this._initIsVisible=this.get_visible(),this._initTemplate(),this.refresh(),this._initEvents()},get_enabled:function(){return this._enabled},set_enabled:function(t){this._enabled!=t&&(this._enabled=t,this.get_isInitialized()&&$craba._initEnabledlay(this))},_getOverlayDom:function(){return this.get_element().parentNode},_initTemplate:function(){var t=this.get_element(),e=this._template=$common.getFirstChildByTagName(t,"div");e&&(this._templateCotrols=$common.getElementChildControls(e),t.removeChild(e),e.style.display="")},_doControlEvents:function(t,e,i){var s=e._item,n=new _Z_178(s.get_index(),s,null,i);return t(e,n),i&&n.get_cancel()&&i.stopPropagation(),n},_clear:function(t){if(this._overlay&&$removeNode(this._overlay),this._disposeItems(),this._clearBody(),!1!==t&&this._autoScroll){var e=this.get_element(),i=$common.getFirstScrollParent(e);i&&i.scrollTop>0&&(i.scrollTop=0)}},get_recordCount:function(){return this._dataSource.length},refresh:function(t,e){if(this._isBindingData=!0,this._clear(e),t&&this.set_dataSource(t),!this._dataSource||0==this._dataSource.length)return this._isBindingData=!1,void this._doAfterDataBind();for(var i=0;i<this.get_recordCount();i++){var s=this._dataSource[i];this._createHTMLByData(i,s)}this._viewResize(),this._doAfterDataBind(),this.doFormResized()},set_visible:function(t){var e=this.get_element().parentNode;this._setControlAndLabelVisible(e,t),$Dom.setVisible(e,t,"flex"),Sys.UI.Controls.ListView.callBaseMethod(this,"set_visible",[t]),!1===this._initIsVisible&&this._viewResize()},_getFieldValue:function(t,e){return e&&t?t[e]:""},_createHTMLByData:function(t,e){var i=this.get_form(),s=this.get_controlScripts(),n=this.get_element(),a=this._template.cloneNode(!0),r=new _Z_179(t,this,a),o=r.get_data();this._itemCssField&&$Dom.addCssClass(a,this._getFieldValue(o,this._itemCssField)),this._styleField&&(a.style.cssText=this._getFieldValue(o,this._styleField)),r.__form=i,Array.insert(this._items,t,r),this._itemWidth>3&&(a.style.width=this._itemWidth+"px"),this._itemHeight>3&&(a.style.height=this._itemHeight+"px");var l=n.childNodes[t];l?n.insertBefore(a,l):n.appendChild(a);var h=[];this._bindChildrenHasAttribute(a,h,"_id");for(var _=0,d=s.length;_<d;_++){var c=s[_],g=c.id,u=this._getElementById(h,g),m=g.split("$");m[2]=i.get_controlID(m[2]+_),u.id=m.join("$");var f=new(0,c.type)(u);i.addControl(f),_Z_242$_setProperties(f,c.properties),f._id=g,f._item=r,f._view=this,f._allEvents=c.events,r.addControl(f),f._initData(e)}this._doItemRendering(t,r)},_doItemRendering:function(t,e,i){var s=this.get_events().getHandler("_itemRendering");if(s){s(this,new _Z_178(t,e,i))}},_getElementById:function(t,e){for(var i=0,s=t.length;i<s;i++){var n=t[i];if(n.getAttribute("_id")===e)return n}return null},_bindChildrenHasAttribute:function(t,e,i){for(var s=t.childNodes,n=0,a=s.length;n<a;n++){var r=s[n];r.tagName&&(null!=r.getAttribute(i)&&e.push(r),this._bindChildrenHasAttribute(r,e,i))}},doFormResized:function(){if(this.get_resizeMode()==_Z_241.auto){var t=this;setTimeout(function(){t._doViewResize()},10)}},_doViewResize:function(){var t=this.getItems(),e=this.get_bounds();if(!(e.y<=0)){var i=t.length,s=-1;this.get_element().style.position="relative";var n=this._defaultColumnCount,a=parseInt(e.width/this._itemWidth);n>0&&(a=Math.min(a,n));var r=0,o=0,l=startLeft=0,h=e.width-a*this._itemWidth;if(i<a&&(h=e.width-i*this._itemWidth),this._isStretch)r=parseInt(h/(a+1));else{var _=Math.ceil(i/a),d=e.height-_*this._itemHeight;l=startLeft=parseInt(h/2),o=parseInt(d/2),o=Math.max(o,1)}o=Math.max(this._resizeMinTopValue,o);for(var s=0,c=!1,g=0,u=t.length;g<u;g++){var m=t[g].get_element(),f="UI_ListItem";0==g?f+=" rowFirst":g%a==0&&(o+=this._itemHeight,l=(c=s%2==0)?l-this._itemWidth:startLeft,f+=" rowFirst",s++),(g+1)%a==0&&(f+=" rowLast"),g==u-1&&(f+=" viewLast"),f+=" rowIndex"+s,m.className=f,m.style.position="absolute",m.style.left=l+"px",m.style.top=o+"px",m.style.margin=0;var v=this._itemWidth+r;l=c?l-v:l+v}}},set_resizeMinTopValue:function(t){this._resizeMinTopValue=t},get_resizeMinTopValue:function(){return this._resizeMinTopValue},set_isStretch:function(t){this._isStretch=t},_delayResizeFun:function(){this.get_isDisposed()||this._doViewResize()},_initEvents:function(){this._resizeMode==_Z_241.auto||this._itemWidth<3||(this._windowResizeHandler=$createDelegate(this,this._viewResize),$common.addResizeHandler(window,this._windowResizeHandler))},_viewResize:function(t){if(this._resizeMode!=_Z_241.auto&&this._dataSource&&!(this._itemWidth<3)){var e=this.get_element(),i=e.clientWidth;0==i&&(i=e.offsetWidth-2);var s=0,n=0,a=this._itemWidth,r=this._itemMargin;if(r>-1){var o=a+r,l=i/o;n=(i-(s=(s=parseInt(l))>this.get_recordCount()?this.get_recordCount():s)*o+r)/2}else{var h=(l=i/a)-(s=parseInt(l));n=s<2?(i-a)/2:parseInt(h*a/(s-1))}n<0&&(n=0),Sys.Browser.isIE6&&(n/=2);for(var _=$common.getChildrenByTagName(e,"div"),d=0,c=_.length;d<c;d++){var g=_[d].style;(d+1)%s!=0?this._itemMargin>-1?(g.marginRight=this._itemMargin+"px",g.marginLeft=d%s==0?n+"px":"0px"):(g.marginLeft="0px",g.marginRight=n+"px"):1==s?g.marginLeft=n+"px":(g.marginLeft="0px",g.marginRight="0px")}}},_raiseChange:function(t){var e=t.get_dataField();if(e){var i=t._item.get_index(),s=t.get_value();this._modifyDataSource(i,e,s)}},_modifyDataSource:function(t,e,i){this._dataSource[t][e]=i},set_pager:function(t){this._pager1?this._pager2||(this._pager2=t):this._pager1=t},get_pager:function(){return this._pager1},_updatePager:function(t,e){this._pager1&&this._pager1._updatePager(t,e),this._pager2&&this._pager2._updatePager(t,e)},set_defaultColumnCount:function(t){this._defaultColumnCount=t},get_defaultColumnCount:function(t){return this._defaultColumnCount},get_dataField:function(){return this._dataField},set_dataField:function(t){this._dataField=t},set_itemWidth:function(t){this._itemWidth=t},get_itemWidth:function(){return this._itemWidth},set_itemHeight:function(t){this._itemHeight=t},get_itemHeight:function(){return this._itemHeight},set_itemMargin:function(t){this._itemMargin=t},get_itemMargin:function(){return this._itemMargin},set_pagerId:function(t){this._pagerId=t},get_pagerId:function(){return this._pagerId},set_controlScripts:function(t){this._controlScripts=t},get_controlScripts:function(){return this._controlScripts},get_dataKeyField:function(){return this._dataKeyField},set_dataKeyField:function(t){this._dataKeyField=t},get_dropDownNumericButton:function(){return this._dropDownNumericButton},set_dropDownNumericButton:function(t){this._dropDownNumericButton=t},get_dataSource:function(){return Object.clone(this._dataSource)},set_dataSource:function(t){var e=this._changeDataToList(t);this._dataSource!=t&&this._doBeforeDataSourceChanged(),this._dataSource=e},_changeDataToList:function(t){if(t&&t.dataType&&1==t.dataType){for(var e=t.fields,i=e.length,s=t.rows,n=s.length,a=new Array(n),r=0;r<n;r++){for(var o=s[r],l=new Object,h=0;h<i;h++)l[e[h]]=o[h];a[r]=l}return a}return t},get_allowDrag:function(){return this._allowDrag},set_allowDrag:function(t){this._allowDrag=t,this.addCssClass("posrel"),this.get_isInitialized()&&(t?this._initDrag():this._disposeDragEvents())},get_allowDrop:function(){return this._allowDrop},set_allowDrop:function(t){this._allowDrop=t},_disposeDragEvents:function(){this._clearEvent(),this._mouseDownHandler&&($common.removeMouseDownHandler(this.get_element(),this._mouseDownHandler),this._mouseDownHandler=null),this._placeBlock&&($removeNode(this._placeBlock),$removeNode(this._spacer),this._placeBlock=null)},_clearEvent:function(){this._prevTarget=null,this._mouseMoveHandler&&($common.removeMouseMoveHandler(document,this._mouseMoveHandler),$common.removeMouseUpHandler(document,this._mouseUpHandler),this._mouseMoveHandler=null)},_initDrag:function(){this._allowDrag&&(this._mouseDownHandler=$common.addMouseDownHandler(this.get_element(),this.doViewMouseDown,this),this._initDragElement())},_initDragElement:function(){this._placeBlock||(this._placeBlock=$common.createClassDiv("UI_ListItem ViewDragBlock"),this._spacer=$common.createClassDiv("InsertSpacer"))},doViewMouseDown:function(t){if(this.get_enabled()&&2!=t.button){var e=t.target;if(e&&e.tagName&&e!=this.get_element()){for(;;){if(_Z_179.isInstanceOfType(e._control)){if(e._control._listView==this)break}if("BODY"==e.tagName)return;e=e.parentNode}if(this._insertItem=e._control,this._insertItem.get_allowDrag()){var i=this.get_element(),s=$Dom.getLocation(i),n=$Dom.getLocation(e);this._isVert=$Dom.hasClass(i,"vert"),this._startX=n.x-s.x,this._startY=n.y-s.y,this._startEvent=t,this._isTimeout=!0,t.cancel(),this._mouseMoveHandler||(this._mouseMoveHandler=$common.addMouseMoveHandler(document,this._startDrag,this),this._mouseUpHandler=$common.addMouseUpHandler(document,this._endDrag,this))}}}},_startDrag:function(t){t.cancel();var e=this._insertItem,i=this.get_element(),s=t.clientX-this._startEvent.clientX,n=t.clientY-this._startEvent.clientY;if(!this._draging&&(Math.abs(s)>10||Math.abs(n)>10)){this._draging=!0,_Z_238.IsDraging=!0;var a=e.get_element(),r=a.getBoundingClientRect(),o=this._placeBlock;i.insertBefore(o,a),$common.setBounds(o,r.width-3,r.height),$Dom.setVisible(o,!0),$Dom.addCssClass(a,"ViewMoveItem")}if(this._isTimeout&&this._draging&&!this.get_isDisposed()){this._isTimeout=!1;var l=this;setTimeout(function(){l._isTimeout=!0},50),this._moveDragItemByPos(e,t,s,n),_Z_238.dragMove(t,this)}},_moveDragItemByPos:function(t,e,i,s){var n=this.get_element(),a=t.get_element(),r=Math.max(this._startX+i,0)+n.scrollLeft,o=Math.max(this._startY+s,0)+n.scrollTop;if(a.style.left=r+"px",a.style.top=o+"px",o!=n.scrollTop){(s=o+a.offsetHeight)>n.scrollTop+n.offsetHeight&&(n.scrollTop+=20)}else n.scrollTop-=20},_dragMove:function(t){this._draging=!0;var e=this.get_element(),i=this._insertItem.get_element(),s=$common.getFirstScrollParent(i),n=0,a=0;s&&(n=s.scrollLeft,a=s.scrollTop,s!=e&&(a+=e.offsetTop-s.offsetTop));var r=$Dom.getBounds(i),o=document.elementFromPoint(r.x+5-n,r.y+5-a);if(o&&o!=e){if(o==this._placeBlock)return $Dom.setVisible(this._spacer,!1),void(this._isOk=!1);for(;;){if(_Z_179.isInstanceOfType(o._control)&&o._control._listView==this)break;if("BODY"==o.tagName)return;o=o.parentNode}var l=o._control;if(l&&l.get_allowDrag()&&(!this._prevTarget||this._prevTarget!=o||!this._prevTimer)){var h=this;this._prevTimer=setTimeout(function(){h._prevTimer=null},300),this._prevTarget&&$Dom.removeCssClass(this._prevTarget,"CurDrop"),this._prevTarget=o,$Dom.addCssClass(o,"CurDrop"),this._isOk=!0;var _,d=$Dom.getBounds(e),c=$Dom.getBounds(o),g=this._spacer;if($Dom.setVisible(g,!0),this._isVert?(_=c.y+c.height/2>r.y,g.style.height="0",g.style.width=i.offsetWidth+"px"):(_=c.x+c.width/2>r.x,g.style.height=i.offsetHeight+"px",g.style.width="0"),this._isLast=!1,this._targetItem=l,_)return this._getDragIndex()+1==this._getDragIndex(!0)?($Dom.setVisible(g,!1),void(this._isOk=!1)):(g.style.left=Math.max(0,c.x-d.x+n-5)+"px",g.style.top=c.y-d.y+a+"px",e.insertBefore(g,o));g.style.left=c.x-d.x+n+c.width+5+"px",g.style.top=c.y-d.y+a+"px";var u=this.getNextItem(o);if(u)return this._getDragIndex()-1==this._getDragIndex(!0)?($Dom.setVisible(g,!1),void(this._isOk=!1)):(this._targetItem=u,e.insertBefore(g,u.get_element()));this._isLast=!0}}},getNextItem:function(t){for(;t&&(t=$common.getNextSibling(t));)if(t.control)return t.control;return null},_dragClass:function(t,e){$Dom.setCssClass(t,this._element.parentNode,e)},_endDrag:function(t){_Z_238.IsDraging=!1,$removeNode(this._spacer),this._prevTarget&&$Dom.removeCssClass(this._prevTarget,"CurDrop"),this._clearEvent(),this._draging&&!this.get_isDisposed()?(this._draging=!1,this._dragClass(!1,"DropStyle"),this._insertItem&&this._isOk?_Z_238.endDrag(t,this):this._clearStyle()):$removeNode(this._placeBlock)},_clearStyle:function(){if(this._insertItem){$removeNode(this._placeBlock),this._insertItem.removeCssClass("transition3"),this._insertItem.removeCssClass("ViewMoveItem");var t=this._insertItem.get_element();t.style.left="",t.style.top=""}},_emitDragMove:function(t,e){this._dragMove(t)},_emitDragEnd:function(t,e){this._draging=!1,this._clearStyle(),$removeNode(this._placeBlock),$removeNode(this._spacer)},_emitDragLeave:function(t,e){this._draging=!1,$removeNode(this._placeBlock),$removeNode(this._spacer)},cancelDrag:function(){this._clearStyle()},okDrag:function(){if(_Z_238._prevDropTarget==this&&this._isOk){this._isOk=!1;var t=this._insertItem,e=this._getDragIndex(!0),i=t.get_data(),s=t.get_index();if(s!=e&&s+1!=e){var n=t.get_element(),a=this.get_element();if(this._isLast){var r=this._targetItem.get_element();(o=$common.getNextSibling(r))?(a.insertBefore(n,o),a.insertBefore(this._placeBlock,o)):(a.appendChild(n),a.appendChild(this._placeBlock))}else{var o=this._targetItem.get_element();a.insertBefore(n,o),a.insertBefore(this._placeBlock,o)}Array.removeAt(this._items,s),Array.removeAt(this._dataSource,s),e<s?(Array.insert(this._items,e,t),Array.insert(this._dataSource,e,i)):(Array.insert(this._items,e-1,t),Array.insert(this._dataSource,e-1,i)),this._resetIndex();var l=$common.getNextSibling(n);if(l||(!0,l=$common.getPreviousSibling(n)),l){this._insertItem.addCssClass("transition3"),n.style.left=$common.pix(l.offsetLeft),n.style.top=$common.pix(l.offsetTop);var h=this;setTimeout(function(){h.get_isDisposed()||h._clearStyle()},300)}else this._clearStyle()}else this._clearStyle()}else this._clearStyle()},getDragData:function(t){return t?this._isLast?null:this._targetItem.get_data():this._insertItem.get_data()},_getDragIndex:function(t){if(t){var e=this._targetItem.get_index();return this._isLast?e+1:e}return this._insertItem.get_index()},_doBeforeDataSourceChanged:function(){},_internalDoPagerBeforeRefresh:function(){this._selectedItemsData&&(this._selectedItemsData={})},add_afterDataBind:function(t){this.get_events().addHandler("afterDataBind",t)},remove_afterDataBind:function(t){this.get_events().removeHandler("afterDataBind",t)},_doAfterDataBind:function(){var t=this.get_events().getHandler("afterDataBind");t&&t(this),this._isBindingData=!1,this._overlay&&this._element.appendChild(this._overlay),$craba._initEnabledlay(this)},add_change:function(t,e){return this.get_events().addHandler("_change",t,e)},remove_change:function(t){this.get_events().removeHandler("_change",t)},add_itemRendering:function(t,e){return this.get_events().addHandler("_itemRendering",t,e)},remove_itemRendering:function(t){this.get_events().removeHandler("_itemRendering",t)},add_itemClick:function(t,e){return this._bindClick=!0,this.get_events().addHandler("_itemClick",t,e)},remove_itemClick:function(t){this.get_events().removeHandler("_itemClick",t)},add_drop:function(t){this.get_events().addHandler("_drop",t),this._allowDrop=!0},remove_drop:function(t){this.get_events().removeHandler("_drop",t),this._allowDrop=!1},get_bindPagerDataSource:function(){return this._bindPagerDataSource},set_bindPagerDataSource:function(t){this._bindPagerDataSource=t},_savePageSize:function(t){var e={PageSize:t},i=this.get_guid()+"_"+this.get_configID();if(!$craba.checkConfig("form",i,e)){Craba.Web.Script.DataServiceBase.create(this.get_form()).SavePanelConfig(i,e,Function.emptyMethod,Function.emptyMethod)}},add_pagerPageBeforeChanged:function(t){this.get_events().addHandler("pagerPageBeforeChanged",t)},remove_pagerPageBeforeChanged:function(t){this.get_events().removeHandler("pagerPageBeforeChanged",t)},_internalDoPagerPageBeforeChanged:function(t){var e=this.get_events().getHandler("pagerPageBeforeChanged");if(e){var i=new _Z_162;return i.pageIndex=t,e(this,i),!i.get_cancel()}return!0}},Sys.UI.Controls.ListView.registerClass("Sys.UI.Controls.ListView",Sys.UI.Control),_Z_179=function(t,e,i){_Z_179.initializeBase(this,[i]),this._controls=[],this._index=t,this._listView=e,this._element=i,this._enabled=!0,this._allowDrag=!0,i._control=this},_Z_179.prototype={dispose:function(){if(!this.get_isDisposed()){for(var t=0;t<this._controls.length;t++){var e=this._controls[t];if(!e.get_isDisposed()){var i=e.__form;i?this.removeControl(e,i):e.dispose()}}this._controls=null,_Z_179.callBaseMethod(this,"dispose")}},removeControl:function(t,e){t.dispose();var i=t.get_idPart();i&&e[i]==t&&delete e[i],Array.remove(e._controls,t),t=null},get_allowDrag:function(){return this._allowDrag&&this._listView.get_allowDrag()},set_allowDrag:function(t){this._allowDrag=t},get_enabled:function(){return this._enabled},set_enabled:function(t){this._enabled!=t&&(this._enabled=t,$craba._initEnabledlay(this))},deleteControl:function(t){var e=this[t];if(e){delete this[t],Array.remove(this._controls,e),$removeNode(e.get_element());var i=e.__form;i?this.removeControl(e,i):e.dispose()}},set_IndexControl:function(t){this._indexControl=t},updateIndex:function(t){this._index+=t,this._indexControl&&this._indexControl.updateIndex()},updateControlData:function(t){for(var e=0;e<this._controls.length;e++){var i=this._controls[e];i._initData&&i._initData(t)}},get_bounds:function(){return $Dom.getBounds(this._element)},get_index:function(){return this._index},get_data:function(){return this._listView.findData(this._index)},doSaveData:function(){for(var t=this.get_data(),e=0,i=this._controls.length;e<i;e++){var s=this._controls[e];if(s._dataField&&s.get_value){t[s._dataField]=s.get_value()}}},findValue:function(t){var e=this.get_data();return e?e[t]:null},addControl:function(t,e){var i=this._controls;i||(i=this._controls=[]);if(t.dataBind&&(t.oldBind=t.dataBind),t.dataBind=null,t.doSaveData=null,!e&&!t._initData&&t.oldBind&&(t._initData=function(t){this.oldBind(t)},t.doChange&&(t.doChange=function(t){if(this._changeRaised=!0,this._view._raiseChange(this),this._allEvents&&this._allEvents.change){var e=this._allEvents.change;this._view._doControlEvents(e,this,t)}}),t.doClick)){var s=t.doClick;t.doClick=function(t){if(s.apply(this,t),this._allEvents&&this._allEvents.click){var e=this._allEvents.click;this._view._doControlEvents(e,this,t)}}}var n=t._id;if(n){var a=n.split("$")[2];if(a){if("undefined"!=typeof this[a])throw Error.invalidOperation(String.format(Sys.Res.appDuplicateComponent,n));this[a]=t}}else t._dataField&&(this[t._dataField]=t);t._item=this,Array.add(i,t)},createControl:function(t,e,i,s){var n=$create(t,e,i,s,this.__form,!1);return this.addControl(n,!0),n},get_element:function(){return this._element},addCssClass:function(t){$Dom.addCssClass(this._element,t)},removeCssClass:function(t){$Dom.removeCssClass(this._element,t)},addLayoutCssClass:function(t){$Dom.addCssClass(this._element.firstChild,t)},removeLayoutCssClass:function(t){$Dom.removeCssClass(this._element.firstChild,t)}},_Z_179.registerClass("_Z_179",Sys.UI.Control),Sys.UI.Controls.DataImage=function(t){Sys.UI.Controls.DataImage.initializeBase(this,[t]),this._item=null,this._view=null,this._allEvents=null},Sys.UI.Controls.DataImage.prototype={get_dataField:function(){return this._dataField},set_dataField:function(t){this._dataField=t},_initData:function(t){var e=this._dataField;if(e){var i=t[e];this.set_src(i)}},doClick:function(t){if(this._allEvents&&this._allEvents.click){var e=this._allEvents.click;this._view._doControlEvents(e,this,t)}}},Sys.UI.Controls.DataImage.registerClass("Sys.UI.Controls.DataImage",Sys.UI.Controls.Image),Sys.UI.Controls.DataIndex=function(t){Sys.UI.Controls.DataIndex.initializeBase(this,[t]),this._dataHintField=null,this._item=null,this._view=null,this._allEvents=null,this._prefix=null},Sys.UI.Controls.DataIndex.prototype={_initData:function(t){this._item.set_IndexControl(this),this._prefix=this.get_text(),this.updateIndex()},updateIndex:function(){var t=this._view.get_pager(),e=this._item.get_index()+1;t&&(e=t.get_pageIndex()*t.get_pageSize()+e);var i=this._prefix.replace("{index}",e);this.set_text(i)},doClick:function(t){if(t&&t.preventDefault(),this._allEvents&&this._allEvents.click){var e=this._allEvents.click;this._view._doControlEvents(e,this,t)}}},Sys.UI.Controls.DataIndex.registerClass("Sys.UI.Controls.DataIndex",Sys.UI.Controls.Label),Sys.UI.Controls.DataBlock=function(t){Sys.UI.Controls.DataBlock.initializeBase(this,[t])},Sys.UI.Controls.DataBlock.prototype={doClick:function(t){if(t&&t.preventDefault(),this._allEvents&&this._allEvents.click){var e=this._allEvents.click;this._view._doControlEvents(e,this,t)}},get_dataCssField:function(){return this._dataCssField},set_dataCssField:function(t){this._dataCssField=t},get_dataEnabledField:function(){return this._dataEnabledField},set_dataEnabledField:function(t){this._dataEnabledField=t},_getFieldValue:function(t,e){return e?t[e]:""},_initData:function(t){var e=this.get_element(),i=this._getFieldValue(t,this._dataCssField);if($Dom.addCssClass(e,i),this._dataEnabledField){var s=this._getFieldValue(t,this._dataEnabledField);Object.isUndefinedOrNull(s)||this.set_enabled(s)}}},Sys.UI.Controls.DataBlock.registerClass("Sys.UI.Controls.DataBlock",Sys.UI.Controls.Block),Sys.UI.Controls.DataText=function(t){Sys.UI.Controls.DataText.initializeBase(this,[t]),this._dataHintField=null,this._item=null,this._view=null,this._allEvents=null},Sys.UI.Controls.DataText.prototype={get_dataHintField:function(){return this._dataHintField},set_dataHintField:function(t){this._dataHintField=t},get_dataCssField:function(){return this._dataCssField},set_dataCssField:function(t){this._dataCssField=t},_getFieldValue:function(t,e){return e?t[e]:""},_initData:function(t){var e=this._dataField,i=this._dataHintField;if(e){var s=t[e];null==s&&(s=""),this.set_text(s)}if(i){var n=t[i];null==n&&(n=""),this.get_element().title=n}var a=this._getFieldValue(t,this._dataCssField);$Dom.addCssClass(this.get_element(),a)},set_enabled:function(t){Sys.UI.Controls.DataText.callBaseMethod(this,"set_enabled",[t]),t||(this.get_element().style.cursor="default")},doClick:function(t){if(t&&t.preventDefault(),this._allEvents&&this._allEvents.click){var e=this._allEvents.click;this._view._doControlEvents(e,this,t)}}},Sys.UI.Controls.DataText.registerClass("Sys.UI.Controls.DataText",Sys.UI.Controls.Label),Sys.UI.Controls.DataNumber=function(t){Sys.UI.Controls.DataNumber.initializeBase(this,[t]),this._item=null,this._view=null},Sys.UI.Controls.DataNumber.prototype={_initData:function(t){var e=this._dataField;if(e){var i=t[e];null==i&&(i=""),(i=i.toString()).indexOf(".")>-1&&(i=(i=i.replace("0+?$","")).replace("[.]$","")),this.set_text(i)}}},Sys.UI.Controls.DataNumber.registerClass("Sys.UI.Controls.DataNumber",Sys.UI.Controls.DataText),Sys.UI.Controls.DataTextEdit=function(t){Sys.UI.Controls.DataTextEdit.initializeBase(this,[t]),this._item=null,this._view=null,this._allEvents=null},Sys.UI.Controls.DataTextEdit.prototype={_initData:function(t){var e=this._dataField;if(e){var i=t[e];null==i&&(i=""),this.set_text(i)}},doChange:function(t){if(this._changeRaised=!0,this._view._raiseChange(this),this._allEvents&&this._allEvents.change){var e=this._allEvents.change;this._view._doControlEvents(e,this,t)}}},Sys.UI.Controls.DataTextEdit.registerClass("Sys.UI.Controls.DataTextEdit",Sys.UI.Controls.TextEdit),Sys.UI.Controls.DataNumberEdit=function(t){Sys.UI.Controls.DataNumberEdit.initializeBase(this,[t]),this._item=null,this._view=null,this._allEvents=null},Sys.UI.Controls.DataNumberEdit.prototype={_initData:function(t){var e=this._dataField;if(e){var i=t[e];null==i&&(i=""),this.set_value(i)}},doChange:function(t){if(this._changeRaised=!0,this._view._raiseChange(this),this._allEvents&&this._allEvents.change){var e=this._allEvents.change;this._view._doControlEvents(e,this,t)}}},Sys.UI.Controls.DataNumberEdit.registerClass("Sys.UI.Controls.DataNumberEdit",Sys.UI.Controls.NumberEdit),Sys.UI.Controls.DataCheckBox=function(t){Sys.UI.Controls.DataCheckBox.initializeBase(this,[t]),this._item=null,this._view=null,this._allEvents=null},Sys.UI.Controls.DataCheckBox.prototype={_initData:function(t){var e=this._dataField;if(e){var i=this._view;i._firstChkField||(i._firstChkField=e);var s=t[e];if(null==s&&(s=""),i._dataKeyField&&e==i._firstChkField){var n=t[i._dataKeyField];i._selectedItemsData[n]?s=!0:1==s&&(i._selectedItemsData[n]=t)}Sys.UI.Controls.DataCheckBox.callBaseMethod(this,"set_value",[s])}},doChange:function(t){this._changeRaised=!0;var e=this._view;if(e._raiseChange(this),this._saveSelectedChange(this.get_value()),this._allEvents&&this._allEvents.change){var i=this._allEvents.change;e._doControlEvents(i,this,t).get_cancel()&&this.set_checked(!this.get_checked())}},_saveSelectedChange:function(t){var e=this._view;if(e._dataKeyField&&e._firstChkField==this._dataField){var i=this._item;e._saveSelectedChange(i.get_data(),t)}},set_value:function(t){Sys.UI.Controls.DataCheckBox.callBaseMethod(this,"set_value",[t]),this._saveSelectedChange(t)}},Sys.UI.Controls.DataCheckBox.registerClass("Sys.UI.Controls.DataCheckBox",Sys.UI.Controls.CheckBox),Sys.UI.Controls.ListPager=function(t){Sys.UI.Controls.ListPager.initializeBase(this,[t]),this._service=null,this._maxPageSize=0},Sys.UI.Controls.ListPager.prototype={initialize:function(){Sys.UI.Controls.ListPager.callBaseMethod(this,"initialize"),this._service=Craba.Web.Script.ListViewDataService.create(this.get_form(),this),this.get_form().addRemoveSessionControls(this)},doFormInit:function(){var t=this.get_element(),e=$common.createClassDiv("PagerContent");t.appendChild(e);var i=this._getTargetControl();this._createSummary(e),this._createPageSizeEditButton(e),i&&i.get_dropDownNumericButton()?this._initDropPager(e):this._initPager(e),this._initSummary(),this._initNavButtons()},refresh:function(t,e,i){t=this._beforeRefresh(t),this._loadPage(0,t,e,i)},refreshPage:function(t,e,i){Object.isUndefinedOrNull(e)&&(e=this.get_pageIndex()),t=this._beforeRefresh(t),this._loadPage(e,t,null,i)},set_target:function(t){this._target=t,this._getTargetControl().set_pager(this)},get_pageCount:function(){return Math.ceil(this._itemCount/this._pageSize)},_initPager:function(t){this._homePageButton=this._createPageButtonByClass(t,"homePage",this._homePage,"首页"),this._prevPageButton=this._createPageButtonByClass(t,"prevPage",this._prevPage);var e=this._pagesCell=$common.createClassDiv("PagerButtons");t.appendChild(e),$common.addClickHandler(e,this._onPageButtonClick,this),this._createNumericButtons(),this._nextPageButton=this._createPageButtonByClass(t,"nextPage",this._nextPage),this._lastPageButton=this._createPageButtonByClass(t,"lastPage",this._lastPage,"尾页")},_initDropPager:function(t){this._homePageButton=this._createPageButtonByClass(t,"homePage",this._homePage,"首页"),this._prevPageButton=this._createPageButtonByClass(t,"prevPage",this._prevPage,"上一页"),this._createPageDrpEdit(t),this._refreshDropDownPageEdit(),this._nextPageButton=this._createPageButtonByClass(t,"nextPage",this._nextPage,"下一页"),this._lastPageButton=this._createPageButtonByClass(t,"lastPage",this._lastPage,"尾页")},_refreshPager:function(){this._initSummary(),this._initNavButtons(),this._initNumericButtons()},_initNavButtons:function(){var t=this.get_pageIndex(),e=this.get_pageCount(),i=(this.get_itemCount(),t>0),s=t<e-1,n=e>1;$Dom.setEnabled(this._prevPageButton,i),$Dom.setEnabled(this._nextPageButton,s),this._pageDrpEdit&&($Dom.setVisible(this._pageTextF,n),$Dom.setVisible(this._pageTextS,n),this._pageDrpEdit.set_visible(n)),this._pagesCell&&$Dom.setVisible(this._pagesCell,n),$Dom.setVisible(this._prevPageButton,n),$Dom.setVisible(this._nextPageButton,n),this._homePageButton&&($Dom.setVisible(this._homePageButton,n),$Dom.setVisible(this._lastPageButton,n),$Dom.setEnabled(this._homePageButton,i),$Dom.setEnabled(this._lastPageButton,s))},_initSummary:function(){this.get_pageCount();var t=null==this._itemCount?0:this._itemCount;this._summary.innerHTML=String.format("共{0}条",t)},_updatePager:function(t,e){this._pageIndex=t,this._itemCount=e,this._refreshPager()},gotoPage:function(t,e){this._loadPage(t,null,null,e)},_loadPage:function(t,e,i,s){if(!this._loading){var n=this.get_form();if(n&&!n.get_isDisposed()){this._beginLoading(this._getTargetControl()),this._pageIndex=t;var a=this.get_id(),r=t*this._pageSize,o=$createDelegate(this,function(t){var e=s?function(t){this._dataLoaded(t),s()}:this._dataLoaded;$createDelegate(this,e)(t)}),l=$createDelegate(this,this._dataFailed);void 0===e&&(e=null),void 0===i&&(i=null);var h=this._service,_=n.get_pageTimeout();_>0&&h.set_timeout(_),h.GetPagerData(a,e,i,null,r,this._pageSize,o,l)}}},_getTargetControl:function(){var t=this.get_target();if(this._targetControl)return this._targetControl;var e=this._targetControl=$find(t);if(!e)throw Error.invalidOperation("找不到Pager的目标："+t);return e},_dataLoaded:function(t){if(this.get_isDisposed())this.endLoading();else{var e=this._getTargetControl();e._updatePager(this._pageIndex,t.itemCount),e.refresh(t.itemList),this.endLoading()}}},Sys.UI.Controls.ListPager.registerClass("Sys.UI.Controls.ListPager",_Z_83);﻿Sys.Net.PageRequestEx=function(t,e,i){Sys.Net.PageRequestEx.initializeBase(this),this.serverResolve=t,this.isCors=e,this.corsHost=i},Sys.Net.PageRequestEx.prototype={_doSuccess:function(t,e,i,a){function r(t){var i=$createType(t.actionType,!0);if(!i)return t.updateContext(),void o(t);var r=new i;if(window[t.get_actionID()]=r,"function"!=typeof r.context)return t.updateContext(),void o(t);r.set_form(d._form),r.end=s,r.pageTag=t;var n=Object.prototype.toString.call(r.context);try{var l=r.context.apply(r,[function(e,i,a,n){delete r.pageTag,function(t,e,i,a,r){if("string"==typeof e)return s(e);t.updateContext(e,i,a,r),t.Context.scriptIncludes=[],o(t)}(t,e,i,a,n),delete r.end},e,t]);n.indexOf("AsyncFunction")>1&&l["catch"](function(t){delete r.end,s(t)})}catch(h){throw a&&a(!1),h}}function s(t){var e=t&&t.message?t.message:t;"string"==typeof e&&$common.alert(e),a&&a(!1),$common.hideWaiting()}function n(r){try{e.html=r.renderHTML(d.serverResolve)}catch(s){throw a&&a(s),s}e.scriptBlock=r.renderScript(),e.styleBlock=r.renderPageStyle(),1==$common.getUrlParam("debugGspx")&&($debug.traceDump(e.html),$debug.traceDump(e.styleBlock),$debug.traceDump(e.scriptBlock)),r.loadPageCss(function(){r.loadAfterStyle(),r.dispose(),e.scriptIncludes=Array.removeRepeatString(e.scriptIncludes),t(e,i)})}function o(a){if(!a)return e.scriptIncludes=Array.removeRepeatString(e.scriptIncludes),void t(e,i);a.loadChilds(l)}function l(t){$common._doLoadPageScript(d,t,h,a)}function h(t){t.loadChildContext(t,n,a)}var u=$crabaJSON.deserialize(e.gspx),d=this;delete e.gspx,function(){if("Page"==u.Name){this.rebuildSettings(e),this.rebuildVariables(e);var t=this.resolveGspx(u,e),i=u.Attributes.ActionType?u.Attributes.ActionType:u.Attributes["@ActionType"];t.setHost(this.corsHost),t.set_actionType(i),t.initActionType(),t.actionType?$createType(t.actionType,!0)?r(t):$common._doLoadPageScript(d,t,r,a):o(t)}else o()}.apply(d)},resolveGspx:function(t,e,i,a){var r=this.convertToControl(t,e),s=i||r;r._setPage(s,a),r.Context=e;var n=t.Childs;if(!n)return r;for(var o=0,l=n.length;o<l;o++){var h=n[o],u=this.resolveGspx(h,e,s,a);r.addControl(u)}return r},convertToControl:function(t,e){var i=t.Name,a=i.indexOf(":"),r="Craba.UI."+(i=a>0?i.substring(a+1):i);try{return new($createType(r))(t)}catch(n){"parsererror"==i&&$common.alert("请检查gspx文件，xml文件有语法错误，比如节点属性要么都用单引号，要么都用双引号；且一个节点不能存在重复的属性");var s=new Craba.UI.HTMLTag(t);return $typeCaches[r]=s.constructor,s}},rebuildSettings:function(t){if(this.isCors&&(t.settings&&(window.$corsSettings=t.settings),window.$corsSettings)){window.$oldSettings=Object.clone(window.$settings);var e=$crabaJSON.deserialize(window.$corsSettings);Object.copyTo(e,window.$settings)}},rebuildVariables:function(t){var e=t.variables,i=$settings.ClientWidthContextName,a=$settings.ClientHeightContextName;if(984==e[i]&&555==e[a]){var r=window.getClientBounds();e[i]=r.width-10,e[a]=r.height-10}},_initHeader:function(t){Sys.Net.PageRequestEx.callBaseMethod(this,"_initHeader",[t]),this.isCors&&window.$corsSettings===undefined&&(t.get_headers().GetSettings="1")},_parseReply:function(t,e,i){e&&(t=t.replace(/\r\n/gi,"\\r\\n"));var a={};a.variables=i,a.clientContext=i,a.gspx="",a.scriptBlock="",a.styleBlock="",a.error="";for(var r,s,n,o=0;o<t.length;){var l;if(-1===(l=t.indexOf("|",o))){a.error=this._findText(t,o);break}if((r=parseInt(t.substring(o,l),10))%1!=0){a.error="(块没有长度)"+this._findText(t,o);break}if(o=l+1,-1===(l=t.indexOf("|",o))){a.error="(块没有类型)"+this._findText(t,o);break}if(s=t.substring(o,l),(o=l+1)+r>=t.length){a.error="(块长度不对)"+this._findText(t,t.length);break}if(n=t.substr(o,r),o+=r,"|"!==t.charAt(o)){a.error="(块没有结束)"+this._findText(t,o);break}switch(o++,s){case"variables":a.variables=$crabaJSON.deserialize(n);break;case"clientContext":a.clientContext=$crabaJSON.deserialize(n);break;case"html":a.html+=n;break;case"reportSession":a.reportSession=$crabaJSON.deserialize(n);break;case"gspx":a.gspx+=n;break;case"version":a.version=n;break;case"apracVersion":a.apracVersion=n;break;case"convertUrl":a.convertUrl=n;break;case"lastValue":a.lastValue=n;break;case"controllerName":a.controllerName=n;break;case"webMethodBasePath":a.webMethodBasePath=n;break;case"vCodeID":a.vCodeID=n;break;case"hasController":a.hasController="true"==n.toLowerCase();break;case"hasWebService":a.hasWebService="true"==n.toLowerCase();break;case"styleBlock":a.styleBlock+=n;break;case"scriptBlock":a.scriptBlock+=n;break;case"scriptIncludePage":a.scriptIncludePath=n.trim();break;case"configDatas":a.configDatas=$crabaJSON.deserialize(n);break;case"itemCountDatas":a.itemCountDatas||(a.itemCountDatas=$crabaJSON.deserialize(n)),Object.copyTo($crabaJSON.deserialize(n),a.itemCountDatas);break;case"gridColumnExpandDatas":a.gridColumnExpandDatas=$crabaJSON.deserialize(n);break;case"rootUrl":a.rootUrl=n;break;case"baseUrl":a.baseUrl=n;break;case"scriptPath":a.scriptPath=n;break;case"showVersionTips":a.showVersionTips=n;break;case"scriptInclude":a.scriptIncludes||(a.scriptIncludes=[]),Array.add(a.scriptIncludes,n);break;case"pageId":a.pageId=n;case"internalID":a.internalID=n;case"pageTitle":a.pageTitle=n;break;case"hAlign":a.hAlign=parseInt(n);break;case"activeControl":a.activeControl=n;break;case"error":a.error&&(a.error+="<br>"),a.error+=n;break;case"redirect":a.redirect=n;break;case"settings":a.settings=n;break;default:a.error&&(a.error+="<br>"),a.error+="(块类型"+s+"错)"+n}}return a}},Sys.Net.PageRequestEx.registerClass("Sys.Net.PageRequestEx",Sys.Net.PageRequest),Type.registerNamespace("Craba.UI"),Craba.UI.Common=function(){},Craba.UI.Common.lowerFirstChar=function(t){return"string"==typeof t&&t.length>0?t.substring(0,1).toLowerCase()+t.substring(1):""},Craba.UI.Common.SuffixExpress=function(){},Craba.UI.Common.SuffixExpress.prototype={convert2SuffixExpress:function(t){for(var e=[],i=[],a=new Sys.StringBuilder,r=0,s=t.length;r<s;r++){var n=t.charAt(r);if(" "!=n)if(this._isOperator(n)){if(0!=a._parts.length&&(i.push(a.toString()),a.clear()),"&"==n||"|"==n){r++;var o=t.charAt(r);if("&"==n&&"&"==o)n="&&";else{if("|"!=n||"|"!=o)throw Error.invalidOperation("error： 错误的表达式"+t);n="||"}}if("("==n)e.push(n);else if(")"==n){for(var l=e.pop();"("!=l&&e.length>0;)i.push(l),l=e.pop();if("("!=l)throw Error.invalidOperation("error : 表达式不匹配："+t)}else{for(;e.length>0&&this._comparePrioraty(n,e[e.length-1]);)i.push(e.pop());e.push(n)}}else a.append(n)}if(0!=a._parts.length&&(i.push(a.toString()),a.clear()),e.length>0){if(")"==e[e.length-1]||"("==e[e.length-1])throw Error.invalidOperation("error : 表达式不匹配："+t);for(;e.length>0;)i.push(e.pop())}return e=null,i},calcValue:function(t,e){var i=[];if(!t||0==t.length)return null;for(var a=e.variables;t.length>0;){var r=t.shift();if(this._isOperator(r)){if("!"==r){o=i.pop();o=evil2("!"+o),i.push(o);continue}if("&&"==r||"||"==r){o=i.pop()+r+i.pop();o=evil2(o),i.push(o);continue}if(i.length<2)throw Error.invalidOperation("error : 计算表达式出错");var s=i.pop(),n=i.pop(),o=new Number(s);s=isNaN(o)&&a?a[s]:o,o=new Number(n),n=isNaN(o)&&a?a[n]:o;var l=this._calcValues(n,s,r);i.push(l)}else{if(r.indexOf("?")>=0){var h=r.indexOf("?");if(0==h){o=evil2(i.pop()+r);i.push(o);continue}var u=[];Array.add(u,r.substring(0,h));o=this.calcValue(u,a)+r.substring(h);o=evil2(o),i.push(o);continue}if("function"==typeof(o=this._getVarValue(r,e))){var d=t[0];d&&!this._isOperator(d)?(d=(d=t.shift()).split(","),Array.forEach(d,function(t,i){d[i]=this._getVarValue(t,e)},this)):d=null,o=o.apply(o,d)}i.push(o)}}if(1!=i.length)throw Error.invalidOperation("error : 计算表达式结果有误");return i[0]},_getVarValue:function(t,e){var i,a=e.variables,r=t.toString().toLowerCase();return"true"===r||"false"===r?i=Boolean.convert(t):(i=new Number(t),i=isNaN(i)&&a?this._checkContextValue(t,e):i),i},_checkContextValue:function(t,e){var i=e.variables,a=$craba.getPropValue(i,t);if(a===undefined){if($craba.notThowContextError||!1===e.throwError)return null;throw $common.hideLoading(),new Error.abort("页面定义的变量“${"+t+"}”不存在\r\n"+e.scriptPath)}return a},_isOperator:function(t){return"+-*/()!&&||".indexOf(t)>-1},_comparePrioraty:function(t,e){return this._getPrioraty(t)<=this._getPrioraty(e)},_getPrioraty:function(t){switch(t){case"+":case"-":return 1;case"*":case"/":return 2;case"!":return 3;case"&&":case"||":return 0;default:return-1}},_calcValues:function(t,e,i){return evil2(t+i+e)}},Craba.UI.Common.MiddleExpress=function(){this.sExpress=new Craba.UI.Common.SuffixExpress},Craba.UI.Common.MiddleExpress.prototype={calcValue:function(t,e){do{for(outputStack=this.catchSubIntervalBrackets(t);outputStack.length>0;){var i=outputStack.pop(),a="";if(i.indexOf("!")>=0||i.indexOf("&&")>=0)a=this.calcValue(i,e);else{var r=this.sExpress.convert2SuffixExpress(i);a=this.sExpress.calcValue(r,e)}t=t.replace(i,a)}}while(outputStack.length>0);var s=this.sExpress.convert2SuffixExpress(t);return this.sExpress.calcValue(s,e)},catchSubIntervalBrackets:function(t){for(var e=[],i=-1,a=0,r=t.length;a<r;a++){var s=t.charAt(a);if(this._isOperator(s),"("!=s){if(-1!=i&&")"==s){var n=t.substring(i+1,a);e.push(n),i=-1}}else i=a}if(-1!=i)throw Error.invalidOperation("表达式错误");return e},_isOperator:function(t){return"!,&&,||".indexOf(t)>-1}},Craba.UI.Common.Express=function(){this._suffixExpress=new Craba.UI.Common.SuffixExpress,this._middleExparess=new Craba.UI.Common.MiddleExpress,this._tagExg=new RegExp("\\${.*?}","g")},Craba.UI.Common.Express.prototype={getValue:function(t,e){if(!t||!t.match)return t;var i=t.match(this._tagExg);if(!i||0==i.length)return t;for(var a=[],r=0,s=i.length;r<s;r++){var n=i[r];t=t.replace(n,"${"+r+"}"),n=n.substring(2,n.length-1).trim(),a.push(this.expressTagValue(n,e))}if(t.length<5)return a[0];for(var r=0,s=a.length;r<s;r++)t=t.replace("${"+r+"}",a[r]);return t},expressTagValue:function(t,e){if(t.indexOf("!")>0||t.indexOf("&&")>0)return this._middleExparess.calcValue(t,e);var i=this._suffixExpress.convert2SuffixExpress(t);return this._suffixExpress.calcValue(i,e)},strToBoolean:function(t){var e=t.toString().toLowerCase();return"true"===e||"false"===e?Boolean.convert(t):t},toNumber:function(t){var e=Number(t);return isNaN(e)?t:e}},$express=new Craba.UI.Common.Express,Craba.UI.Common.HAlignToString=function(t,e){switch(t){case _Z_250.center:return"center";case _Z_250.right:return"right";default:return e?"":"left"}},Craba.UI.Common.VAlignToString=function(t){switch(t){case _Z_251.top:return"top";case _Z_251.bottom:return"bottom";default:return""}},Craba.UI.Common.getAccessKeyHtml=function(t,e){if(!e||!t)return t;var i=t.indexOf(e);return i>=0?t.substring(0,i)+"<u>"+e+"</u>"+t.substring(i+1):t+"(<u>"+e+"</u>)"},Craba.UI.Common.ItemsToList=function(t,e,i){t||(t=[]);var a=t.length,r=0,s=null;if(e){if("string"!=typeof e)throw Error.argument('ListItems属性必须为逗号分隔的字符串, 如: ListItems="0=男,1=女"');r=(s=(e=e.trim()).split(",")).length}for(var n=[],o=0;o<a;o++){p={value:t[o].get_value(),text:t[o].get_text()};Array.add(n,p)}for(o=0;o<r;o++){var l,h,u=s[o],d=u.split("=");if(d.length>=2){var c=d[0];try{l=parseInt(c),(isNaN(l)||l.toString()!=c)&&(l=$express.strToBoolean(c))}catch(C){l=c}h=d[1]}else l=o,h=u;var p={value:l,text:h};Array.add(n,p)}return n},_Z_106=function(){this.styles={}},_Z_106.prototype={clear:function(){this.styles=null,this.styles={}},get_value:function(){return this.styles},toString:function(){var t=new Sys.StringBuilder;for(var e in this.styles){t.isEmpty()||t.append(";");var i=this.styles[e];null!=i&&t.append(e).append(":").append(i)}return t.toString()},add:function(t){if(t)for(var e=t.split(";"),i=0,a=e.length;i<a;i++){var r=e[i].split(":");2==r.length&&this.set(r[0].trim(),r[1].trim())}},set:function(t,e){this.styles[t]=e},remove:function(t){delete this.styles[t]},set_hidden:function(t){this._hidden=t,t?this.styles.visibility="hidden":delete this.styles.visibility},set_visible:function(t){this._visible=t,t?delete this.styles.display:this.styles.display="none"},set_width:function(t,e){this._width=t,this.styles.width=t.toString()+(e||"px")},set_height:function(t,e){this._height=t,this.styles.height=t+(e||"px")},set_lineHeight:function(t){this.styles["line-height"]=t+"px"}},Craba.UI.HtmlWriter=function(t){this.buffer=new Sys.StringBuilder,this.indenting=t,this._newElem=!1,this._depth=0,this.nodeStack=[]},Craba.UI.HtmlWriter.prototype={dispose:function(){this.clear(),delete this.buffer},clear:function(){this.buffer.clear()},text:function(t){return this._attrCheck(!1),(t=this._getStr(t))&&this._doWrite(t),this},toString:function(){return this.buffer.toString()},writeBegin:function(t){this._doWriteBegin(t,this._depth,!0)},writeEnd:function(){this._doWriteEnd(this._depth,!0)},attr:function(t,e){if(!(e=this._getStr(e)))return this;if(!(t=t.trim()))throw Error.argumentNull("name");var i=" "+t+'="'+this._attributeQuote(e)+'"';if(!(this.nodeStack.length>0&&this._newElem))throw Error.invalidOperation(String.format("写属性{0} 时标签已完成",i));return this._doWrite(i),this},writeEnabled:function(t){t||this.attr("disabled",!0)},writeVisible:function(t){t||this.attr("style","display:none")},writeClass:function(t){this.attr("class",t)},writeAttrs:function(t){if(!t)return this;for(var e in t)this.attr(e,t[e]);return this},_doWrite:function(t){this.buffer.append(t)},_write:function(t,e){var i=this.indenting?StringUtils.repeat(" ",e)+t:t;this._doWrite(i)},_writeLine:function(){this._doWrite("\n")},_writeNewLine:function(t){t&&this.indenting&&this._writeLine()},_attrCheck:function(t){this._newElem&&(this._doWrite(">"),this._writeNewLine(t)),this._newElem=!1},_attributeQuote:function(t){return t.indexOf('"')<0?t:t.replace('"',"&quot;")},_doWriteBegin:function(t,e,i){this._attrCheck(i),this._write("<"+t,e),this._depth+=2;var a,r=this.nodeStack.length;r>0&&((a=this.nodeStack[r-1]).HasChildren||(a.HasChildren=!0)),(a={}).TagName=t,a.HasChildren=!1,this.nodeStack.push(a),this._newElem=!0},_doWriteEnd:function(t,e){if(0==this.nodeStack.len)throw Error.invalidOperation();var i=this.nodeStack.pop();if("br"!=i.TagName){var a="</"+i.TagName+">";this._newElem?this._doWrite(">"+a):(t=i.HasChildren?t-2:0,this._write(a,t))}this._writeNewLine(e),this._newElem=!1,this._depth-=2},_getStr:function(t){return void 0===t||null==t?"":("string"!=typeof t&&(t=t.toString()),t)},writeTag:function(t,e,i){this.writeBegin(t);var a=this.styleToString(i);return a&&(e||(e={}),e.style=a),this.writeAttrs(e),this},writeStyle:function(t){this.attr("style",this.styleToString(t))},styleToString:function(t){if(!t||"string"==typeof t)return t;var e=new Sys.StringBuilder,i=null;t.__cssStyle&&(i=t.__cssStyle,delete t.__cssStyle);for(var a in t){e.isEmpty()||e.append(";");var r=t[a];null!=r&&e.append(a).append(":").append(r)}return i&&!e.isEmpty()&&e.append(";"),e.toString()},_end:function(){return this.writeEnd(),this},div:function(t,e){return this.writeTag("div",t,e)},_div:function(){return this._end()},button:function(t,e){return this.writeTag("button",t,e)},_button:function(){return this._end()},input:function(t,e){return this.writeTag("input",t,e)},_input:function(){return this._end()},textArea:function(t,e){return this.writeTag("textarea",t,e)},_textArea:function(){return this._end()},span:function(t,e){return this.writeTag("span",t,e)},_span:function(){return this._end()},a:function(t,e){return this.writeTag("a",t,e)},_a:function(){return this._end()},label:function(t,e){return this.writeTag("label",t,e)},_label:function(){return this._end()},img:function(t,e){return this.writeTag("img",t,e)},_img:function(){return this._end()},canvas:function(t,e){return this.writeTag("canvas",t,e)},_canvas:function(){return this._end()},iframe:function(t,e){return this.writeTag("iframe",t,e)},_iframe:function(){return this._end()},br:function(){return this.writeTag("br"),this._end()},table:function(t,e){return e||(e={}),this.writeTag("table",t,e)},_table:function(){return this._end()},writeTable:function(t,e,i){return this.writeAttrs({cellspacing:e,cellpadding:i,border:t})},tbody:function(t,e){return e||(e={}),this.writeTag("tbody",t,e)},_tbody:function(){return this._end()},tr:function(t,e){return this.writeTag("tr",t,e)},_tr:function(){return this._end()},td:function(t,e){return this.writeTag("td",t,e)},_td:function(){return this._end()},script:function(t,e){return this.writeTag("script",t,e)},_script:function(){return this._end()}},Craba.UI.HtmlWriter.registerClass("Craba.UI.HtmlWriter");var $createControl=function(t,e,i,a,r){if("string"!=typeof t||t.startsWith("Craba.UI.")||(t="Craba.UI."+t),!(t=$createType(t)).inheritsFrom(Craba.UI.Control))throw Error.argument("type",String.format(Sys.Res.createNotUIControl,t.getName()));try{e||(e={});var s=t.getName(),n=s.substring(s.lastIndexOf(".")+1),o=e.ID||e["@ID"],l=e.DataField||e["@DataField"];o||l||"Craba.UI.Block"==s||(s=Craba.UI.Common.lowerFirstChar(n),o=i.get_controlID(s));var h={Name:n,Attributes:{}};Object.copyTo(e,h.Attributes),h.Attributes.ID=o;var u=new t(h);if(u.ID=o,u.Context=i.Context,u.__form=i,u._selfDispose=r,a){if("function"!=typeof a.addControl)throw Error.argument("$createControl->指定的parent参数没有addControl方法");a.addControl(u),a._selfDispose&&(u._selfDispose=!0)}return u}catch(d){throw Error.create("创建控件失败:"+d.message,d)}},$createControlFromGspx=function(t){var e=[],i=new Sys.UI.Controls.CustomControl;i.set_form(t.form),i.set_gspx(t.gspx),i.set_onlyGspx(!0),i.set_roots(e);var a=t.target;if(a)t.eventIsAction||i.set_eventTarget(a),i.appendTo(a,t.context,t);else{var r=$common.createDiv();(a=new Sys.UI.Controls.FlexBlock(r)).set_form(t.form),t.eventIsAction||i.set_eventTarget(a),i.appendTo(a,t.context,t)}return e};Craba.UI.Control=function(t){this.xmlNode=t,this.page=null,this.parentControl=null,this.childControls=[],this._showLabel=!1,this.supportsLayout=!0,this._visible=!0,this._enabled=!0,this._noItem=!1},Craba.UI.Control.prototype={initialize:function(t){var e=this.xmlNode;if(e){var i=e.Attributes.ID;if(i||(i=e.Attributes.DataField),i&&this.Context.resolveData){var a=this.Context.resolveData[i];Object.copyTo(a,e.Attributes)}if(this._langID&&"undefined"!=typeof NGPLanguage){var r=$craba.getLang(NGPLanguage,this._langID);r&&this.updateLang(r)}for(var s in e.Attributes){var n="@"==s[0]?s.substring(1):s,o=e.Attributes[s];this.doPropertys(n,o,t)}}},set_noItem:function(t){this._noItem=t},dispose:function(){var t;if(this.childControls)for(;t=this.childControls.shift();)t.dispose(),t=null;delete this._page,delete this.parentControl,delete this.xmlNode,delete this.childControls},hasAttr:function(t){if(!this.xmlNode)return!1;return!!this.xmlNode.Attributes[t]},setAttr:function(t,e){if(!this.xmlNode)return!1;this.xmlNode.Attributes[t]=e},updateLang:function(t){},set_langID:function(t){this._langID=t},invokeBody:function(t,e){for(var i=0,a=this._getCount();i<a;i++){var r=this.childControls[i];r.initialize(),e&&!e.apply(this,[r])||r.doTag(t)}},insertBefore:function(t,e,i){var a=$craba._toElt(t),r=a.parentNode;this.appendTo(r,e,i,{insert:!0,dom:a})},insertAfter:function(t,e,i){var a=$craba._toElt(t),r=a.parentNode,s=$common.getNextSibling(a);this.appendTo(r,e,i,{insert:!0,dom:s})},appendTo:function(t,e,i,a){function r(t){var i=t.renderTag(),r=t.renderDynamic();1==$common.getUrlParam("debugGspx")&&($debug.traceDump(i),$debug.traceDump(r));var s=$common.createDiv();s.innerHTML=i;for(var o=s.childNodes,l=$common.createFragment(),h=0,u=o.length;h<u;h++){var d=o[0];d.tagName&&l.appendChild(d)}a&&a.insert?n.insertBefore(l,a.dom):n.appendChild(l),$jsLoader.getInstance().addScriptElement(r,!0),t.dispose(),"function"==typeof e&&e()}function s(t){t.loadChildContext(t,r)}var n=$craba._toElt(t);i&&(this.Context.variables=i);var o=new Craba.UI.Page;o._isDynamic=!0,o.addControl(this),o.Context=this.Context,o.Context.scriptIncludes=[],o.actionId=o.get_actionID();var l=this.__form.get_childForms();l&&(o.controlsId.runTag=l.length),this._doSetPage(this,o);var h=this;o.loadChilds(function(t){t.Context.scriptIncludes&&t.Context.scriptIncludes.length>0?$common._doLoadPageScript(h,t,s):s(t)})},_doSetPage:function(t,e){t._setPage(e),Array.forEach(t.childControls,function(t,i){t._doSetPage(t,e)})},addControl:function(t){t._setParent(this),this.childControls.push(t)},doTag:function(t){var e=this.get_parent();e&&e.getType().implementsInterface(Craba.UI.ILayoutGroup)&&this.supportsLayout?e.addItem(this._label,this):this.renderTag(t)},renderTag:function(){},getType:function(){return Object.getType(this)},typeIs:function(t){return this.constructor},_getCount:function(){return this.childControls.length},_setParent:function(t){this.parentControl=t},get_parent:function(){return this.parentControl},get_prev:function(){if(this._prev)return this._prev;var t=this.get_parent().childControls,e=Array.indexOf(t,this);return e>0&&(this._prev=t[e-1],this._next=t[e+1]),this._prev},get_next:function(){return this._next||this.get_prev(),this._next},_setContext:function(t){this.Context=t},_setPage:function(t){this.page=t},get_page:function(){var t=this.page;return t||(t=this.page=this.get_parent().get_page()),t},findParentImplementsInterface:function(t,e){var i=t.get_parent();return null!=i?i.getType().implementsInterface(e)?i:i.findParentImplementsInterface(i,e):null},findAncestorWithType:function(t,e){for(;null!=t;){if(e.isInstanceOfType(t))return t;t=t.get_parent()}return null},createControl:function(t,e){return new($createType(t))(this.get_page(),e)},findTag:function(t){for(var e=0,i=this._getCount();e<i;e++){var a=this.childControls[e];if(a.xmlNode.Attributes.ID==t)return a;var r=a.findTag(t);if(r)return r}return null}},Craba.UI.Control.registerClass("Craba.UI.Control"),Craba.UI.ScriptControl=function(t){Craba.UI.ScriptControl.initializeBase(this,[t]),this.styles=new _Z_106,this._cssClass="",this.events={},this.properties={},this._required=!1,this._width=0,this.isNullId=!1,this._selfDispose=!1},Craba.UI.ScriptControl.prototype={dispose:function(){Craba.UI.ScriptControl.callBaseMethod(this,"dispose"),delete this.events,delete this.properties,this.express=null,this.styles.clear()},namespace:function(){return"Sys.UI.Controls"},typeName:function(){return""},get_scriptFullName:function(){var t=this.namespace(),e=this.typeName();return t&&e?t+"."+e:null},registerScript:function(t,e){var i=this.get_scriptFullName();if(i){var a=this.get_page();a.checkControl(this),this.initScript();var r=a.scriptBuilder;$settings.AllowGspxPropertys&&r.append(";var __control="),r.append("$create("+i+", "),r.append($crabaJSON.serialize(this.properties,!0)),r.append(","),this.isNullId?r.append("null"):r.append('"'+(e?this.get_page().get_controlClientID(e):this.get_clientID())+'"'),r.append(","),this.initEvent(r),r.append(",form"),this._selfDispose?r.append(",true"):r.append(",false"),a._isDynamic&&r.append(",newControls"),r.append(");"),$settings.AllowGspxPropertys&&this.xmlNode&&this.xmlNode.Attributes&&r.append('__control && (__control.gspxProp = JSON.parse("'+JSON.stringify(this.xmlNode.Attributes).split('"').join("'")+"\".split('\\'').join('\"')));")}},set_selfDispose:function(t){this._selfDispose=t},initScript:function(){},initEvent:function(t){var e=0;t.append("{");for(var i in this.events)e>0&&t.append(","),t.append(this.resolveEvent(i,this.events[i])),e++;t.append("}")},resolveEvent:function(t,e){if(e===undefined)return"";var i=this.get_actionID();if("function"==typeof e){var a=this.get_ID()+"_"+t;return window[i]._addHandler(a,e),t+":function(){"+i+'._doHandler("'+a+'", arguments);}'}if(e.startsWith("#"))return t+":function(sender) {var form = sender.get_form(); form."+e.substring(2,e.length-1)+";}";if(e.indexOf(".")>2){var r=e.split(".");i="window."+r[0],e=r[1]}return t+":$createDelegate("+i+', "'+e+'")'},get_createParams:function(){this.initScript();var t={type:new Sys.RawText(this.get_scriptFullName()),properties:this.properties},e=Object.isEmpty(this.events)?null:{};for(var i in this.events){var a=this.events[i].trim(),r=a;a.startsWith("#")&&(r="function(sender) {"+a.substring(2,a.length-1)+";}"),e[i]=new Sys.RawText(this.get_page().get_scriptEvent(r))}return e&&(t.events=e),this.getOtherParams(t),t},getOtherParams:function(t){},get_actionID:function(){return this.actionId?this.actionId:"$"+this.Context.pageId+"$__action"},get_clientID:function(t){return t&&t.get_ID&&t.get_ID()?this.get_page().get_controlClientID(t.get_ID()):"undefined"!=typeof this._clientId?this._clientId:this._clientId=this.get_page().get_controlClientID(this.get_ID())},set_required:function(t){this._required=t},set_requiredRule:function(t){this._requiredRule=t},set_iD:function(t){this._id=t,this.internalID=t},get_internalID:function(){return this.internalID},get_ID:function(){if(this._id!==undefined)return this._id;var t=this.internalID?this.internalID:this._dataField?this._dataField.replace(".","_"):null;if(!t){var e=this.typeName();e&&(t=this.get_page().get_controlID(Craba.UI.Common.lowerFirstChar(e)))}return this._id=t},get_guid:function(){return this.guid||(this.guid=this.get_page().get_internalID()+"_"+this.get_ID()),this.guid},doPropertys:function(t,e,i){if(t.startsWith("On"))this.addEvent(Craba.UI.Common.lowerFirstChar(t.substring(2)),e);else{if(t=Craba.UI.Common.lowerFirstChar(t),this.resolveProp(t,e,i))return;e=this["_"+t],this.addProp(t,e)}},addEvent:function(t,e){e&&(this.events[t]=e)},get_event:function(t){return this.events[t]},resolveProp:function(t,e,i){Craba.UI.ScriptControl.prototype.customResolveProp&&(e=Craba.UI.ScriptControl.prototype.customResolveProp(t,e));var a=this["set_"+t];this.Context.throwError=i;var r=$express.getValue(e,this.Context),s=typeof this["_"+t];return"boolean"==s?r=Boolean.convert(r):"number"==s&&(r=$express.toNumber(r)),void 0!==a?(a.apply(this,[r]),!0):(this["_"+t]=r,!1)},addProp:function(t,e,i){e!=i&&null!==e&&void 0!==e&&(Date.isInstanceOfType(e)&&(e=new Date(e.getTime())),this.properties[t]=e)},get_configData:function(){if(this.configData!==undefined)return this.configData;this.Context.configDatas||(this.Context.configDatas={});var t=this.Context.configDatas[this.get_ID()];if(t)return this.configData=t;if(!window.userConfigData)return this.configData=null;var e=this.get_configGUID();return this.configData=window.userConfigData[e]},get_enumTypeValue:function(t,e){var i=t[Craba.UI.Common.lowerFirstChar(e)];return void 0===i?-1:i},get_numberEnumTypeValue:function(t,e){var i=Craba.UI.Common.lowerFirstChar(e);"float"!=i&&"int"!=i&&"default"!=i&&"boolean"!=i||(i="_"+i);var a=t[i];return void 0===a?-1:a},set_shortcut:function(t){this._shortcut=this.get_enumTypeValue(Craba.UI.Shortcut,t),this._shortcut<0?this._shortcut=0:this._shortString=t},set_cssStyle:function(t){this.styles.add(t)},set_cssClass:function(t){this._cssClass=t},set_visible:function(t){this._visible=t,this.styles.set_visible(t)},set_width:function(t){this._width=t,this._isSetWidth=!0,this.styles.set_width(t)},set_height:function(t){this._height=t,this._isSetHeight=!0,this.styles.set_height(t)},set_textColor:function(t){this._textColor=t,this.styles.set("color",t)},set_colSpan:function(t){this._colSpan=t}},Craba.UI.ScriptControl.registerClass("Craba.UI.ScriptControl",Craba.UI.Control),Craba.UI.WebControl=function(t){Craba.UI.WebControl.initializeBase(this,[t]),this._showLabel=!0,this._reportVisible=!0,this._tabIndex=-2,this._defaultTab=-2,this._tabOnEnter=!0,this._colSpan=1},Craba.UI.WebControl.prototype={renderTag:function(t){this.renderHTML(t),this.registerScript()},beginRender:function(t){t.writeTag(this.htmlTag())},renderHTML:function(t){this.beginRender(t),this.writeAttr(t),this.endRender(t)},writeAttr:function(t){var e=$skin.joinCssClass(this.get_cssClass(),this._cssClass);if(t.attr("class",e),this.writeID(t),t.writeStyle(this.styles.get_value()),t.writeEnabled(this._enabled),this._tabIndex>-2&&t.attr("tabindex",this._tabIndex),t.attr("title",this._hint),this._attrs){var i=this._attrs.split(",");Array.forEach(i,function(e){t._doWrite(" "+e)})}},writeID:function(t){t.attr("id",this.get_clientID())},set_attrs:function(t){this._attrs=t},endRender:function(t){},initScript:function(){this.addProp("tag",this._tag),this.addProp("accessKey",this._keyCode),this.addProp("tabOnEnter",this._tabOnEnter,!0),this.addProp("tabIndex",this._tabIndex,this._defaultTab),this.addProp("enabled",this._enabled,!0),this.addProp("dataField",this._dataField),this.addProp("label",this._label),this.addProp("textColor",this._textColor),this.addProp("reportField",this._reportField),this.addProp("reportVisible",this._reportVisible,!0)},get_needClient:function(){return this.get_internalID()||this._dataField||this._reportField||this.events.labelClick||this.events.click||this._tag||this._langId},set_outerCss:function(t){this._outerCss=t},set_itemCssClass:function(t){this._itemCssClass=t},set_tag:function(t){this._tag=t},set_tabStop:function(t){this._tabIndex=t?-2:-1},set_label:function(t){this._label=t},set_labelHint:function(t){this._labelHint=t},get_hasLabel:function(){return!!this._label},set_accessKey:function(t){this._accessKey=t;var e;e="string"==typeof t?t.toUpperCase().charCodeAt(0):t.toString().charCodeAt(0),this._keyCode=e},htmlTag:function(){return"div"},get_cssClass:function(){return""},get_configGUID:function(){return this._configGUID?this._configGUID:this._configGUID=this.get_page().get_internalID()+"_"+this.get_ID()+"_"+this._configID}},Craba.UI.WebControl.registerClass("Craba.UI.WebControl",Craba.UI.ScriptControl),Craba.UI.Page=function(t){Craba.UI.Page.initializeBase(this,[t]),this.page=this,this.headStyles=new Sys.StringBuilder,this.scriptBuilder=new Sys.StringBuilder,this.writer=new Craba.UI.HtmlWriter(!1),this.pagePartInitScripts="",this.controlsId={},this.cssLinks=[],this.controls={},this._vAlign=_Z_251.top,this._hAlign=_Z_250.left,this._bindSource=null,this._configID=0,this._minWidth=0,this._minHeight=0,this._allowResize=!0,this._fullWindow=!1,this._bindAll=!0,this._useEsc=!0,this._showCloseButton=!0,this.rootValidationRule=[]},Craba.UI.Page.prototype={initialize:function(){this._inited||(Craba.UI.Page.callBaseMethod(this,"initialize"),this._hAlign!=_Z_250.left&&(this.Context.hAlign=this._hAlign)),this._inited=!0},dispose:function(){Craba.UI.Page.callBaseMethod(this,"dispose"),this.controlsId=null,this.controls=null,this.cssLinks=null,this.writer.dispose(),this.scriptBuilder.clear(),delete this.Context.variables,this.Context.variables=null,this._bindSource=null},addSplitter:function(t){this.splitters||(this.splitters=[]),this.splitters.push(t)},initSplitter:function(){if(this.splitters){var t=this.get_configData();Array.forEach(this.splitters,function(e,i){e.initialize();var a=$craba.FormConfigName+e.get_ID(),r=t?t[a]:null;e.doConfig(r)})}},loadChilds:function(t){var e=this;if(e.customTags&&0!=e.customTags.length){var i=e.customTags.shift();i.initialize(!1);var a=i._src;if(!a)return e.loadChilds(t);a=$common.addUrlParam(a,"pageID",e.Context.pageId),a=$common.addUrlParam(a,"clientID",e.get_controlID("runTag"));var r=i._url=e.convertUrl(a),s=new Sys.Net.WebRequest;Object.copyTo({custom:1},s.get_headers()),s.set_url(r,$settings.CacheGspx),s.set_httpVerb("GET"),s.set_withCredentials(!1),s.add_completed(function(a,r){var s=i._url+"子页面加载失败，可能是路径拼写错误。请刷新重试";if(a.get_responseAvailable()){var n=a.get_statusCode();if(n>=200&&n<300){if(window._testing){var o=(new Date).getTime()-a.get_webRequest()._createdTime;$debug.log("子页面："+i._src+"\n网络费时: "+o)}var l=a.get_responseData(),h=$common.gspxParse?$common.gspxParse(i._url,l,i._paramsString):l,u=new Sys.Net.PageRequestEx,d=u._parseReply(h),c=$crabaJSON.deserialize(d.gspx),p=i._thisPage=u.resolveGspx(c,d,null,e),C=c.Attributes.ActionType?c.Attributes.ActionType:c.Attributes["@ActionType"];p.properties=i.properties?JSON.parse(JSON.stringify(i.properties)):{},p.set_actionType(C),p.initActionType(e),p._isDynamic=e._isDynamic,e.loadChilds(t)}else $common.alert(s)}else $common.alert(s)}),i._params&&(i._paramsString=$crabaJSON.serialize(i._params,!0)),s.invoke()}else t(e)},loadChildContext:function(t,e,i){if(!t.customPages||0==t.customPages.length)return e(t);var a=t.customPages.shift();if(!a.actionType)return t.loadChildContext(t,e);var r=$createType(a.actionType,!0);if(!r)return t.loadChildContext(t,e);var s=new r,n=$app.getForm(a.Context.pageId,!1);if(s.set_form(n),window[a.get_actionID()]=s,"function"!=typeof s.context)return t.loadChildContext(t,e);s.properties=a.properties;try{s.context.apply(s,[function(i,r,s,n){a.updateContext(i,r,s,n),t.loadChildContext(t,e)},a.Context])}catch(o){throw i&&i(!1),o}},updateContext:function(t,e,i,a){var r=this.Context;if(r.resolveData=a,r.variables||(r.variables={}),Object.copyTo(t,r.variables),r.clientContext||(r.clientContext=Object.clone(r.variables,!0)),e)for(var s in e){var n=s+"_pager1",o=s+"_pager2";r.itemCountDatas[n]=e[s],r.itemCountDatas[o]=e[s]}i&&(r.configDatas=i)},setValidation:function(t,e){var i={dataField:t,attribute:e,childNodes:[]};return this.rootValidationRule.push(i),i},setHost:function(t){this.host=t},convertUrl:function(t){return t?t.startsWith("http")?t:(t.startsWith("~/")&&(t=this.Context.convertUrl+t.substring(2)),this.host?this.host+(t.startsWith("/")?t:"/"+t):t):""},getWebUrl:function(t){return t?(t=(window.__webResourceURI?window.__webResourceURI:"")+t,this.host?this.host+t:t):""},getCrabaResourceUrl:function(t){return t?(t=window.__crabaResourceURI+t,this.host?this.host+t:t):""},renderTag:function(){return this.invokeBody(this.writer),this.writer.toString()},addPagePartInitScript:function(t){this.pagePartInitScripts+=t},addPagePart:function(t){this.pagePartIDs||(this.pagePartIDs=[]),this.pagePartIDs.push(t)},renderHTML:function(t){this.initialize();var e=this.writer;if(this.initSplitter(),(!t||this._cssClass)&&!$get(this.Context.pageId)){var i=$skin.joinCssClass("PageBlock",this._cssClass);return this.renderPageBlock(e,i),e.toString()}return this.invokeBody(e),e.toString()},renderPageBlock:function(t,e){e||(e=this._cssClass),t.div(),t.attr("id",this.Context.pageId),t.writeClass(e),t.writeStyle(this.styles.get_value()),this.invokeBody(t),t.writeEnd()},renderPagePart:function(t){this.invokeBody(t);var e=this.rootPage,i=this._getRootPage(),a="form.setActionInfo("+$crabaJSON.serialize(this._childProperties)+","+$crabaJSON.serialize(this._childEvents)+");",r=this.doPrepareInitScript(null,!1,a);r.append("form.set_url('").append(this.Context.scriptPath).append("');"),this._idPart&&r.append("form.set_idPart('"+this._idPart+"');"),this._dataField&&r.append("form._dataField = '"+this._dataField+"';"),this._paramsString&&r.append("form._pageParams = "+this._paramsString+";"),r.append("form.setContexts("+$crabaJSON.serialize(this.Context.clientContext,!0)+");"),e.addPagePart(this.Context.pageId),i.addPagePartInitScript(r.toString())},_getRootPage:function(){var t=this.rootPage;if(!t)return null;for(;t.rootPage;)t=t.rootPage;return t},renderDynamic:function(){var t=new Sys.StringBuilder,e=this.Context.pageId;t.append("Sys.Application.add_init(function() {"),t.append(this.pagePartInitScripts),t.append('var form = Sys.Application.getForm("'+e+'", true);'),t.append("var newControls = [];"),t.append(this.scriptBuilder.toString()),t.append("form.doInitControls(newControls, true);form.doLoadedControls(newControls);newControls=null;"),this.pagePartInitScripts.length>0&&(t.append("form._addChilds(").append($crabaJSON.serialize(this.pagePartIDs)).append(");"),t.append("form._initChilds();")),t.append("});");var i=t.toString();return delete t,i},renderScript:function(){var t=new Sys.StringBuilder;t.append("Sys.Application.add_init(function() {"),t.append(this.pagePartInitScripts),this.doPrepareInitScript(t,!0),t.append("});");var e=t.toString();return delete t,e},doPrepareInitScript:function(t,e,i){var a=this.Context.pageId;t||(t=new Sys.StringBuilder),t.append('var form = Sys.Application.getForm("'+a+'", '+e+");"),this.actionType&&this.get_actionID()&&t.append("var action = $createAction("+this.actionType+', "'+this.get_actionID()+'", form, '+this.get_actionID()+");"),i&&t.append(i),t.append(this.scriptBuilder.toString()),t.append('if (form.set_internalId) { form.set_internalId("'+this.Context.internalID+'"); }'),0!==this._configID&&t.append("form.set_configId(").append(this._configID).append(");"),t.append("form.set_configGUID('").append(this.get_configGUID()).append("');"),this._minWidth>0&&t.append("form.set_minWidth(").append(this._minWidth).append(");"),this._minHeight>0&&t.append("form.set_minHeight(").append(this._minHeight).append(");"),this._allowResize||t.append("form.set_allowResize(false);"),t.append('form.set_rootUrl("'+this.Context.rootUrl+'");'),t.append('form.set_baseUrl("'+this.Context.baseUrl+'");'),t.append('form.set_resourcePath("'+this.Context.scriptIncludePath+'");'),t.append('form.set_scriptPath("'+this.Context.scriptPath+'");'),this._icon&&t.append('form.set_icon("'+this._icon+'");');var r=this.get_configData();if(r&&t.append("form.set_configData(").append($crabaJSON.serialize(r)).append(");"),this.addFormEvent(t,"init"),this._fullWindow&&t.append("form.set_fullWindow(true);"),this._useEsc||t.append("form.set_useEsc(false);"),this._closePosition&&t.append("form.set_closePosition('"+this._closePosition+"');"),this._showCloseButton||t.append("form.set_showCloseButton(false);"),this.rootValidationRule.length>0){t.append('form.setValidationNode("", {"": [], childNodes: [');for(var s=0,n=this.rootValidationRule.length;s<n;s++){var o=this.rootValidationRule[s];o.dataField&&(s>0&&t.append(","),t.append("{'"+o.dataField+"':[$createValidator(Sys.Validators."+o.attribute.scriptTypeName+")]"),o.childNodes.length>0&&(t.append(",childNodes:["),Array.forEach(o.childNodes,function(e,i){i>0&&t.append(","),t.append("{'"+e.dataField+"':[$createValidator(Sys.Validators."+e.attribute.scriptTypeName+")]}")}),t.append("]")),t.append("}"))}t.append("]});")}this.pagePartIDs&&t.append("form._addChilds(").append($crabaJSON.serialize(this.pagePartIDs)).append(");");var l=this.Context.hasWebService?this.Context.controllerName+"._staticInstance":"null";return this.rootPage?t.append("form._service="+l+";"):t.append("form.doInit("+l+");"),this._bindSource&&(t.append("form.dataBind("),t.append(this._bindSource),this._bindAll||t.append(",false"),t.append(", true);")),this.addFormEvent(t,"active"),this.addFormEvent(t,"deactive"),this.addFormEvent(t,"close"),this.addFormEvent(t,"change"),this.addFormEvent(t,"loaded"),this.addFormEvent(t,"resize"),t},addFormEvent:function(t,e){this.events[e]&&(t.append("form.add_"+e+"($createDelegate("),t.append(this.get_actionID()+","),t.append('"'+this.events[e]+'"'),t.append("), true);"))},set_bindAll:function(t){this._bindAll=t},renderPageStyle:function(){return this.headStyles.toString()},loadAfterStyle:function(){if(this.afterStyles)for(var t in this.afterStyles)$skin.appendStyle(this.afterStyles[t],t)},addAfterStyle:function(t,e){t&&e&&(this.afterStyles||(this.afterStyles={}),this.afterStyles[e]=t)},appendStyle:function(t){var e=this._getRootPage();e?e.appendStyle(t):this.headStyles.append(t)},registerCssLink:function(t){var e=this._getRootPage();e?e.registerCssLink(t):this.cssLinks.push(t)},loadPageCss:function(t){$skin.loadCss(this.cssLinks,this.Context.pageId,t)},set_hAlign:function(t){this._hAlign=this.get_enumTypeValue(_Z_250,t)},set_vAlign:function(t){this._vAlign=this.get_enumTypeValue(_Z_251,t)},set_title:function(t){this.Context.pageTitle=t},set_subTitle:function(t){this.Context.pageSubTitle=t},set_activeControl:function(t){this.Context.activeControl=t},set_closePosition:function(t){this._closePosition=t},get_internalID:function(){return this.Context.internalID},get_configGUID:function(){return this._configGUID?this._configGUID:this._configGUID=this.get_internalID()+"_"+this._configID},get_ID:function(){return this.get_internalID()},set_actionType:function(t){this._actionType=t},initActionType:function(t){var e=t?t.Context.scriptIncludes:this.Context.scriptIncludes;if(e||(e=this.Context.scriptIncludes=[]),this._actionType){for(var i=this._actionType.split(","),a=this.Context.scriptIncludePath.trim(),r=0,s=i.length;r<s;r++)if(0!=r){(n=i[r].toString().trim()).toLowerCase().startsWith("http")?e.push(n):e.push(a+n)}else this.actionType=i[r],this.actionId=this.get_actionID();t&&(t.customPages||(t.customPages=[]),t.customPages.push(this))}if(this.Context.hasWebService&&this.Context.hasController){var n=this.Context.webMethodBasePath+"/js?v="+this.Context.version;e.push(n)}},doPropertys:function(t,e){t.indexOf("xmlns")>-1||Craba.UI.Page.callBaseMethod(this,"doPropertys",[t,e])},get_scriptEvent:function(t){if(this.get_actionID()){return t.indexOf(".")<=0?"$createDelegate("+this.get_actionID()+', "'+t+'")':t}return t},checkControl:function(t){var e=t._id;if(e){if(this.controls[e])throw Error.invalidOperation(String.format("请检查有控件的ID重复，控件{0}设置的ID“{1}”有重复",t.getType().getName(),e));this.controls[e]=t}},get_controlClientID:function(t){var e=t;return t&&t.trim().length>0&&(e="$"+this.Context.pageId+"$"+t),e},get_controlID:function(t){var e,i=this.controlsId[t];return e=i?parseInt(i)+1:1,this.controlsId[t]=e,t+e},set_dataSource:function(t){t&&(this._bindSource=$crabaJSON.serialize(t,!0))}},Craba.UI.Page.registerClass("Craba.UI.Page",Craba.UI.ScriptControl),Craba.UI.Button=function(t){Craba.UI.Button.initializeBase(this,[t]),this.supportsAction=!0,this._tabIndex=0,this._defaultTab=0,this._flat=!1,this._rightIconVisible=!0},Craba.UI.Button.prototype={updateLang:function(t){this.setAttr("Text",t)},initScript:function(){Craba.UI.Button.callBaseMethod(this,"initScript"),this.addProp("shortcut",this._shortcut,Craba.UI.Shortcut.none),this.addProp("cancel",this._cancel,!1),this.addProp("buttonKind",this._buttonKind,_Z_107.none),this.addProp("webMethod",this._webMethod)},renderHTML:function(t){Craba.UI.Button.callBaseMethod(this,"renderHTML",[t]),this._renderText(t),this.supportsAction&&this.invokeBody()},_renderText:function(t){var e=Craba.UI.Common.getAccessKeyHtml(this._text,this._accessKey);t.text(e),t.writeEnd()},set_iconSrc:function(t){this._iconSrc=t},set_text:function(t){this._text=t},set_height:function(t){this._height=t,this.styles.set_height(t),this.styles.set_lineHeight(t)},get_cssClass:function(){var t=this._flat?"Button dselect SpeedButton":"Button dselect";return(this._isPrint||this._popupMenu)&&(t=$skin.joinCssClass(t,"hasRight")),this._isRprint||this.get_event("click")||!this._popupMenu||(t=$skin.joinCssClass(t,"noClick")),t},htmlTag:function(){return"button"},typeName:function(){return"Button"}},Craba.UI.Button.registerClass("Craba.UI.Button",Craba.UI.WebControl),Craba.UI.PrintButton=function(t){Craba.UI.PrintButton.initializeBase(this,[t]),this._isPrint=!0},Craba.UI.PrintButton.prototype={typeName:function(){return"PrintButton"}},Craba.UI.PrintButton.registerClass("Craba.UI.PrintButton",Craba.UI.Button),Craba.UI.BadgeButton=function(t){Craba.UI.BadgeButton.initializeBase(this,[t])},Craba.UI.BadgeButton.prototype={initScript:function(){Craba.UI.BadgeButton.callBaseMethod(this,"initScript"),this.addProp("value",this._value),this.addProp("max",this._max,99),this.addProp("isDot",this._isDot,!1)},get_cssClass:function(){return"Button BadgeButton"},typeName:function(){return"BadgeButton"}},Craba.UI.BadgeButton.registerClass("Craba.UI.BadgeButton",Craba.UI.Button),Craba.UI.SpeedButton=function(t){Craba.UI.SpeedButton.initializeBase(this,[t]),this._flat=!0},Craba.UI.SpeedButton.prototype={},Craba.UI.SpeedButton.registerClass("Craba.UI.SpeedButton",Craba.UI.Button),Craba.UI.CancelButton=function(t){Craba.UI.CancelButton.initializeBase(this,[t]),this.set_iD("btnCancel"),this._buttonKind=_Z_107.cancel,this._text=$settings.CancelButtonText,this._cancel=!0},Craba.UI.CancelButton.prototype={get_cssClass:function(){return Craba.UI.CancelButton.callBaseMethod(this,"get_cssClass")+" SecondButton"}},Craba.UI.CancelButton.registerClass("Craba.UI.CancelButton",Craba.UI.Button),Craba.UI.CloseButton=function(t){Craba.UI.CloseButton.initializeBase(this,[t]),this.set_iD("btnClose"),this._buttonKind=_Z_107.cancel,this._text=$settings.CloseButtonText,this._cancel=!0},Craba.UI.CloseButton.prototype={get_cssClass:function(){return Craba.UI.CloseButton.callBaseMethod(this,"get_cssClass")+" SecondButton"}},Craba.UI.CloseButton.registerClass("Craba.UI.CloseButton",Craba.UI.Button),Craba.UI.OkButton=function(t){Craba.UI.OkButton.initializeBase(this,[t]),this.set_iD("btnOk"),this._buttonKind=_Z_107.ok,this._text=$settings.OkButtonText},Craba.UI.OkButton.registerClass("Craba.UI.OkButton",Craba.UI.Button),Craba.UI.Buttons=function(t){Craba.UI.Buttons.initializeBase(this,[t]),this._items=[],this._multiple=!1,this._mustOne=!1,this._selectedIndex=-1},Craba.UI.Buttons.prototype={initScript:function(){if(Craba.UI.Buttons.callBaseMethod(this,"initScript"),this._dataSource)this.addProp("items",this._dataSource);else{var t=Craba.UI.Common.ItemsToList(this._items,this._listItems,this);t.length>0&&(this._dataValueField="value",this._dataTextField="text"),this.addProp("items",t),this.addProp("dataValueField",this._dataValueField),this.addProp("dataTextField",this._dataTextField),this.addProp("value",this._value),Object.isUndefinedOrNull(this._value)&&this.addProp("selectedIndex",this._selectedIndex,-1)}},endRender:function(t){Craba.UI.Buttons.callBaseMethod(this,"endRender",[t]),this.invokeBody(t),t.writeEnd()},set_dataSource:function(t){this._dataSource=t},set_listItems:function(t){this._listItems=t},set_value:function(t){this._value=t},set_selectedIndex:function(t){this._selectedIndex=t},get_cssClass:function(){return"Buttons dselect"},typeName:function(){return"Buttons"}},Craba.UI.Buttons.registerClass("Craba.UI.Buttons",Craba.UI.WebControl),Craba.UI.SwitchButton=function(t){Craba.UI.SwitchButton.initializeBase(this,[t]),this._checked=!1,this._checkedValue=!0},Craba.UI.SwitchButton.prototype={endRender:function(t){t.writeEnd()},get_cssClass:function(){return"SwitchButton"},typeName:function(){return"SwitchButton"}},Craba.UI.SwitchButton.registerClass("Craba.UI.SwitchButton",Craba.UI.WebControl),Craba.UI.Image=function(t){Craba.UI.Image.initializeBase(this,[t]),this.hAlign="Left"},Craba.UI.Image.prototype={typeName:function(){return"Image"},beginRender:function(t){if(this.src||this.url){if(this.src&&this.src.startsWith("#"))throw Error.invalidOperation("图片地址“"+this.src+"”以#开头是不对的")}else this.src=$skin.getBlankImageSrc();(this.events.click||this.events.dblClick)&&this.styles.set("cursor","pointer"),t.writeTag(this.htmlTag(),{},this.styles.get_value()),t.attr("src",this.src?this.get_page().convertUrl(this.src,this._useServer):this.get_page().getWebUrl(this.url)),t.attr("align",this.hAlign)},endRender:function(t){t.writeEnd()},set_useServer:function(t){this._useServer=t},set_src:function(t){this.src=t},set_url:function(t){this.url=t},set_hAlign:function(t){this.hAlign=t},htmlTag:function(){return"img"}},Craba.UI.Image.registerClass("Craba.UI.Image",Craba.UI.WebControl),Craba.UI.Label=function(t){Craba.UI.Label.initializeBase(this,[t]),this._text="",this.fontColor="",this.replaceText="",this.isMemo=!1,this.innerText=t.Value},Craba.UI.Label.prototype={updateLang:function(t){this.hasAttr("Label")?this.setAttr("Label",t):this.setAttr("Text",t)},get_cssClass:function(){return"Label"},set_wordWrap:function(t){this._wordWrap=t},writeAttr:function(t){Craba.UI.Label.callBaseMethod(this,"writeAttr",[t]),this.get_event("dblclick")&&t.attr("onselectstart","return false;")},renderHTML:function(t){this._hasEvent()&&this.styles.set("cursor","pointer"),Craba.UI.Label.callBaseMethod(this,"renderHTML",[t]);var e=this.replaceText?this.replaceText:this._text;this.innerText&&(e+=this.innerText),this.isMemo&&(e=$common.textToHtml(e)),t.text(e),t.writeEnd()},initScript:function(){Craba.UI.Label.callBaseMethod(this,"initScript"),this.isMemo&&this.addProp("text",this._text)},set_fontColor:function(t){this.styles.set("color",t)},set_text:function(t){this._text=t},set_boldFont:function(t){t?this.styles.set("font-weight","bold"):this.styles.remove("font-weight")},set_fontSize:function(t){this.styles.set("font-size",t+"px")},set_replaceText:function(t){this.replaceText=t},typeName:function(){return this.get_needClient()||this._hasEvent()?"Label":null},_hasClass:function(){return!!this._cssClass&&this._cssClass.indexOf("ellipsis")>-1},_hasEvent:function(){return this.get_event("click")||this.get_event("dblclick")||this._hasClass()},set_isBLock:function(t){this._isBlock=t},htmlTag:function(){return this._label||this._isBlock||this.get_parent().getType().inheritsFrom(Craba.UI.LayoutGroup)?"div":"span"}},Craba.UI.Label.registerClass("Craba.UI.Label",Craba.UI.WebControl),Craba.UI.Title=function(t){Craba.UI.Title.initializeBase(this,[t])},Craba.UI.Title.prototype={get_cssClass:function(){return"Title"}},Craba.UI.Title.registerClass("Craba.UI.Title",Craba.UI.Label),Craba.UI.BlockBase=function(t){Craba.UI.BlockBase.initializeBase(this,[t]),this._showBorder=!1},Craba.UI.BlockBase.prototype={typeName:function(){return this._label!==undefined||this.get_needClient()?"Block":null},set_hidden:function(t){this.styles.set_hidden(t)},set_showBorder:function(t){this._showBorder=t},renderHTML:function(t){this._showBorder&&(this._cssClass=$skin.joinCssClass("Border",this._cssClass)),Craba.UI.BlockBase.callBaseMethod(this,"renderHTML",[t])}},Craba.UI.BlockBase.registerClass("Craba.UI.BlockBase",Craba.UI.WebControl),Craba.UI.CustomBlock=function(t,e){Craba.UI.CustomBlock.initializeBase(this,[t]),this._direction=e,this._hAlign=_Z_250.left},Craba.UI.CustomBlock.prototype={beginRender:function(t){var e=this.get_parent();(this._direction==Sys.UI.Controls.LayoutDirection.vert&&!Craba.UI.HBlock.isInstanceOfType(e)||Craba.UI.VBlock.isInstanceOfType(e))&&this.styles.set("clear","both"),this._hAlign==_Z_250.right?(this.styles.set("float","right"),this.needClear=!0):this._hAlign==_Z_250.center&&(this.styles.set("margin","auto"),this.styles.set("text-align","center")),Craba.UI.CustomBlock.callBaseMethod(this,"beginRender",[t])},endRender:function(t){this.invokeBody(t);var e=this.get_parent();(this._forceClear||this.needClear&&!Craba.UI.HBlock.isInstanceOfType(e)&&!Craba.UI.VBlock.isInstanceOfType(e))&&(t.div(),t.writeClass("clear"),t.writeEnd()),t.text(this.xmlNode.Value),t.writeEnd()},set_hAlign:function(t){this._hAlign=this.get_enumTypeValue(_Z_250,t)}},Craba.UI.CustomBlock.registerClass("Craba.UI.CustomBlock",Craba.UI.BlockBase),Craba.UI.HBlock=function(t){Craba.UI.HBlock.initializeBase(this,[t,Sys.UI.Controls.LayoutDirection.horz])},Craba.UI.HBlock.prototype={get_cssClass:function(){return"HBlock"},renderHTML:function(t){var e=this.get_parent();Craba.UI.HBlock.isInstanceOfType(e)&&this.styles.set("padding",0),Craba.UI.HBlock.callBaseMethod(this,"renderHTML",[t])}},Craba.UI.HBlock.registerClass("Craba.UI.HBlock",Craba.UI.CustomBlock),Craba.UI.VBlock=function(t){Craba.UI.VBlock.initializeBase(this,[t,Sys.UI.Controls.LayoutDirection.vert])},Craba.UI.VBlock.prototype={get_cssClass:function(){return"VBlock"}},Craba.UI.VBlock.registerClass("Craba.UI.VBlock",Craba.UI.CustomBlock),Craba.UI.Block=function(t){Craba.UI.Block.initializeBase(this,[t]),this._align=-1},Craba.UI.Block.prototype={get_cssClass:function(){return"Block"},renderHTML:function(t){var e=this.get_parent();Craba.UI.VBlock.isInstanceOfType(e)&&this.styles.set("clear","both"),Craba.UI.Block.callBaseMethod(this,"renderHTML",[t]),this.invokeBody(t),t.writeEnd()},set_align:function(t){this._align=this.get_enumTypeValue(_Z_250,t),this._align==_Z_250.left?this.styles.set("float","left"):this._align==_Z_250.right&&this.styles.set("float","right"),this.alignSetted=!0,this.get_parent().getType().inheritsFrom(Craba.UI.CustomBlock)&&(this.get_parent()._forceClear=!0)}},Craba.UI.Block.registerClass("Craba.UI.Block",Craba.UI.BlockBase),Craba.UI.FlexBlock=function(t){Craba.UI.FlexBlock.initializeBase(this,[t]),this._layoutDirection=Sys.UI.Controls.LayoutDirection.horz},Craba.UI.FlexBlock.prototype={typeName:function(){return"FlexBlock"},get_cssClass:function(){var t=this._layoutDirection==Sys.UI.Controls.LayoutDirection.horz?"FlexBlock":"FlexBlock vert";return(this._isSetHeight||this._isSetWidth)&&(t+=" Flex0"),this._visible||(t+=" Hided"),t},set_layoutDirection:function(t){this._layoutDirection=this.get_enumTypeValue(Sys.UI.Controls.LayoutDirection,t)},endRender:function(t){this.invokeBody(t),t.writeEnd()},set_visible:function(t){this._visible=t}},Craba.UI.FlexBlock.registerClass("Craba.UI.FlexBlock",Craba.UI.WebControl),Craba.UI.FlexColumn=function(t){Craba.UI.FlexColumn.initializeBase(this,[t]),this._layoutDirection=Sys.UI.Controls.LayoutDirection.vert},Craba.UI.FlexColumn.prototype={typeName:function(){return"FlexColumn"}},Craba.UI.FlexColumn.registerClass("Craba.UI.FlexColumn",Craba.UI.FlexBlock),Craba.UI.ILayoutGroup=function(){throw Error.notImplemented()},Craba.UI.ILayoutGroup.prototype={addItem:function(t,e){throw Error.notImplemented()}},Craba.UI.ILayoutGroup.registerInterface("Craba.UI.ILayoutGroup"),Craba.UI.LayoutGroup=function(t,e){Craba.UI.LayoutGroup.initializeBase(this,[t]),this._showBorder=!1,this._vAlign=_Z_251.top,this._hAlign=_Z_250.left,this._width=0,this._height=0,this.direction=e,this.level=1,this.items=[],this.forceVAlignTop=!1},Craba.UI.LayoutGroup.prototype={updateLang:function(t){this.setAttr("Caption",t)},doTag:function(t){this.checkLevel(),this.invokeBody(t),Craba.UI.LayoutGroup.callBaseMethod(this,"doTag",[t])},addItem:function(t,e){var i={key:t,control:e};Array.add(this.items,i)},checkLevel:function(){var t=this.get_parent();if(t.getType().inheritsFrom(Craba.UI.LayoutGroup)&&(this.level=t.level+1,this.level>$settings.LayoutMaxLevel))throw Error.message(String.format("HPanel/VPanel标签嵌套层级不能超过{0}层，当前Panel层级为{1},请优化布局。",$settings.LayoutMaxLevel,this.level))},renderHTML:function(t){var e,i,a,r=this.get_parent().getType(),s=(this._vAlign!=_Z_251.top||this._hAlign!=_Z_250.left)&&!r.inheritsFrom(Craba.UI.LayoutGroup),n=this._width&&this._width>0;s&&(e={},this._hAlign==_Z_250.left||n||(e.width="100%"),this._vAlign!=_Z_251.top&&(e.height="100%"),t.table(e).writeTable(0,0,0).tr().td({width:"100%",height:"100%",align:Craba.UI.Common.HAlignToString(this._hAlign,!1),valign:Craba.UI.Common.VAlignToString(this._vAlign)}));var o=this.get_hasCaption(),l=this._showBorder||o,h=this._hasSize();if(h){if(e={},i={},a=l?"LayoutGroupBorder":"LayoutGroupBlock",n){var u=this._width;i.width=u+"px",this.styles.remove("width")}if(this._height&&parseInt(this._height)>0){var d=this._height;i.height=d+"px",i.overflow="auto"}s||(i["text-align"]=Craba.UI.Common.HAlignToString(this._hAlign)),(l||this._height&&parseInt(this._height)>0)&&!this._visible&&(i.display="none"),t.div(e,i).attr("class",a)}e={},a="",h||!l&&!o||(a="LayoutGroupBorder"),h&&o&&(e.width="100%"),Sys.Browser.isStandard&&n&&this._hAlign==_Z_250.right&&this.styles.set("float","right"),this._cssClass&&(a=$skin.joinCssClass(a,this._cssClass));var c=Craba.UI.Page.isInstanceOfType(this.get_parent())||Craba.UI.FlexBlock.isInstanceOfType(this.get_parent());c&&!h&&(t.div(),t.attr("class","LayoutBlock")),t.writeTag("table",e,this.styles.get_value()),t.attr("class",a),t.writeTable(0,0,0),this.writeAttr(t),a="LayoutGroupVSpacer",l&&!o?t.tr().td().attr("class",a)._td()._tr():l||this.direction!=Sys.UI.Controls.LayoutDirection.horz||this.get_parent()!=this.get_page()&&r!=$typeCaches["Craba.UI.VPanel"]||t.tr().td().attr("class",a)._td()._tr(),this.doRender(this,t),l&&t.tr().td().attr("class",a)._td()._tr(),t._table(),c&&!h&&t._div(),h&&t._div(),s&&t._td()._tr()._table()},doRender:function(t,e){var i=0;if(t.direction==Sys.UI.Controls.LayoutDirection.vert){for(var a=!1,r=0,s=t.items.length;r<s;r++){(o=t.items[r].control).getType().inheritsFrom(Craba.UI.LayoutGroup)&&o.direction==Sys.UI.Controls.LayoutDirection.horz?i=Math.max(i,o.items.length):a=!0}if(i>0&&!a){this.renderCaption(t,i,e);for(var n=!1,r=0,s=t.items.length;r<s;r++){var o=t.items[r].control;o.getType().inheritsFrom(Craba.UI.LayoutGroup)&&(t._visible||o.set_visible(!1),o.direction==Sys.UI.Controls.LayoutDirection.horz&&this.renderGroup(o,i,n,e),n||(n=!0))}}else this.renderGroup(t,0,!1,e)}else this.renderGroup(t,0,!1,e)},renderCaption:function(t,e,i){if(t.get_hasCaption()){var a=null!=t.panelContainer,r={};0==e&&(e=t.direction==Sys.UI.Controls.LayoutDirection.horz?t.items.length:1),e>0&&(r.colspan=2*e),i.tr().td(r).attr("class","LayoutGroupCaption"),a&&i.table({width:"98%"}).writeTable(0,0,0).tbody().tr().td(),i.attr("align","left").text(t._caption)._td(),a&&(i.td(),t.panelContainer.renderHTML(i),i._td()._tr()._tbody()._table()._td()),i._tr().tr().td().attr("class","LayoutGroupVSpacer")._td()._tr()}},renderGroup:function(t,e,i,a){this.renderCaption(t,e,a);var r=t.direction==Sys.UI.Controls.LayoutDirection.vert;r||(a.tr(),t._visible||a.attr("style","display:none;"),e>0&&t.get_needClient()&&(a.attr("id",t.get_clientID()),t.registerScript()));for(var s=0,n=0,o=0,l=t.items.length;o<l;o++){var h=t.items[o].control;!t._visible&&h.set_visible&&h.set_visible(!1);var u=!Craba.UI.HiddenField.isInstanceOfType(h),d=h._visible&&u,c=0==n;r&&(a.tr(),d||a.attr("style","display:none"),i=!c);var p=h._showLabel;if(p&&u){a.td(),r&&a.attr("align","right");var C=h.get_hasLabel(),_=C?"LayoutItemLabel":c?"LayoutFirstItemNoLabel":"LayoutItemNoLabel";if(a.attr("class",_),r||d||a.attr("style","display:none;"),C){i&&a.div().attr("class","LayoutItemLabelVSpace");var g=h._label;h.get_event("labelClick")&&(g="<a href='javascript:;' title='"+h._labelHint+"' class='LabelLink'>"+g+"</a>");var I=h.get_clientID(),f={style:""};I&&(f.id=I+"_label"),h._accessKey&&(f.accesskey=h._accessKey),h._labelStyle&&(f.style=h._labelStyle),h._visible||(f.style+=";display:none;"),h._labelCssClass&&(f["class"]=h._labelCssClass),a.label(f),I&&a.attr("for",I),a.text(Craba.UI.Common.getAccessKeyHtml(g,h._accessKey))._label(),i&&a._div()}a._td()}var b=h.getType().inheritsFrom(Craba.UI.LayoutGroup)||Craba.UI.CustomControl.isInstanceOfType(h),m="LayoutItemControl";p||(m="LayoutItemLabel "+m),b&&(m=""),i&&(m+=" LayoutItemControlVSpace");var U={},y=p?0:2;r?U._vert=!0:(d||(U.style="display:none"),t._colSpan>1?(y+=2*t._colSpan-1,s+=t._colSpan-1):b&&h.typeIs(Craba.UI.HPanel)&&h._colSpan>1&&(y=2*h._colSpan-(p?1:0),h._colSpan=1,s+=h._colSpan)),y>0&&(U.colspan=y),b?(h._hasSize()||(U.align=Craba.UI.Common.HAlignToString(h._hAlign,!1)),U.valign=Craba.UI.Common.VAlignToString(h._vAlign)):(U.align="left",t.forceVAlignTop&&(U.valign="top")),a.td(U),a.attr("class",m),h.renderTag(a),a._td(),r&&a._tr(),n++}if(!r){var S=e-t.items.length-s;if(S>0){var w=2*S;a.td({colspan:w})._td()}a._tr()}},set_hAlign:function(t){this._hAlign=this.get_enumTypeValue(_Z_250,t)},set_vAlign:function(t){this._vAlign=this.get_enumTypeValue(_Z_251,t),this.forceVAlignTop=this._vAlign==_Z_251.top},_hasSize:function(){return this._width&&this._width>0||this._height&&this._height>0},set_caption:function(t){this._caption=t},get_hasCaption:function(){return this._caption&&this._caption.trim().length>0},typeName:function(){return this.get_needClient()?"LayoutGroup":null},set_showBorder:function(t){this._showBorder=t},setPanelContainer:function(t){this.panelContainer=t}},Craba.UI.LayoutGroup.registerClass("Craba.UI.LayoutGroup",Craba.UI.WebControl,Craba.UI.ILayoutGroup),Craba.UI.VPanel=function(t){Craba.UI.VPanel.initializeBase(this,[t,Sys.UI.Controls.LayoutDirection.vert])},Craba.UI.VPanel.prototype={},Craba.UI.VPanel.registerClass("Craba.UI.VPanel",Craba.UI.LayoutGroup),Craba.UI.HPanel=function(t){Craba.UI.HPanel.initializeBase(this,[t,Sys.UI.Controls.LayoutDirection.horz])},Craba.UI.HPanel.prototype={},Craba.UI.HPanel.registerClass("Craba.UI.HPanel",Craba.UI.LayoutGroup),Craba.UI.PanelContainer=function(t){Craba.UI.PanelContainer.initializeBase(this,[t])},Craba.UI.PanelContainer.prototype={writeAttr:function(t){Craba.UI.PanelContainer.callBaseMethod(this,"writeAttr",[t]),t.attrs({"text-align":"right",overflow:"hidden"})},doTag:function(){var t=this.get_parent();if(!t.getType().inheritsFrom(Craba.UI.LayoutGroup))throw Errof.invalidOperation("PanelContainer 标签只能在 VPanel或HPanel 标签中使用");t.setPanelContainer(this)},endRender:function(t){this.invokeBody(t),t.writeEnd()},get_cssClass:function(){return"LayoutGroupContainer"}},Craba.UI.PanelContainer.registerClass("Craba.UI.PanelContainer",Craba.UI.WebControl),Craba.UI.FlowPanel=function(t){Craba.UI.FlowPanel.initializeBase(this,[t]),this._layoutDirection=Sys.UI.Controls.LayoutDirection.horz,this._showBorder=!1,this._allowConfig=!1,this._itemWidth=0,this._itemLabelWidth=0,this._configID=0,this.items=[],this.DefaultDesignIds=[],this.ChildIds=[],this.PopupItems=null,this.StaticItems=null,this._itemMarginRight=$settings.FlowItemMarginRight},Craba.UI.FlowPanel.prototype={updateLang:function(t){this.setAttr("Caption",t)},doTag:function(t){if(this._itemWidth>0&&this._itemLabelWidth>this._itemWidth)throw Error.invalidOperation(this.get_ID()+"的ItemWidth值必须大于ItemLabelWidth");this.invokeBody(t),Craba.UI.FlowPanel.callBaseMethod(this,"doTag",[t])},set_itemMarginRight:function(t){this._itemMarginRight=t},addItem:function(t,e){var i={key:t,control:e};Array.add(this.items,i)},get_cssClass:function(){var t=this._expandPopup?"FlowPanel ExpandPopup":"FlowPanel";return this._layoutDirection==Sys.UI.Controls.LayoutDirection.vert&&(t+=" vert"),this._caption&&(this._showBorder=!0,t+=" hasCaption"),this._showBorder&&(t+=" Border"),this._colSpan>1&&(t+=" HasColSpan"),t},typeName:function(){return"FlowPanel"},set_showBorder:function(t){this._showBorder=t},endRender:function(t){this.createCaptionDiv(t),this.invokeItems(t),t.writeEnd()},invokeItems:function(t){this.dealDefaultIds();var e=this.dealConfigItems(t);this.renderItems(t,e),this.renderMoreBtn(t),this.renderPopupItems(t)},renderMoreBtn:function(t){if(this._allowConfig){this.renderStaticItems(t),t.div(),t.writeClass("FlowItem MoreItem");var e={Name:"Button",Value:null,Attributes:{"@ID":this.get_ID()+"_moreBtn","@Text":"更多..","@RightIcon":"aicon-shezhi"},Childs:[]},i=new Craba.UI.Button(e);i._setPage(this.page),i.Context=this.Context,i.initialize(),i.renderTag(t),t.writeEnd()}},_hasFlowTable:function(){return!!this._cssClass&&this._cssClass.indexOf("FlowTable")>-1},renderItems:function(t,e){for(var i=this._itemWidth>0,a=this._hasFlowTable(),r=a?0:this._itemMarginRight,s=0,n=e.length;s<n;s++){var o=e[s].control;if(o._noItem||!o.get_clientID||!o.get_clientID()&&this.hasChild(o))this._layoutDirection==Sys.UI.Controls.LayoutDirection.horz&&(o._cssClass=$skin.joinCssClass(o._cssClass,"FloatLeft")),o.renderTag(t);else if(Craba.UI.FlowPanel.isInstanceOfType(o)||Craba.UI.FlexBlock.isInstanceOfType(o))o._cssClass=$skin.joinCssClass(o._cssClass,"clear"),o.renderTag(t);else{var l="FlowItem",h=new _Z_106;o._visible||h.set_visible(!1);if(Craba.UI.Button.isInstanceOfType(o))l+=" NotEdit";else if(this._colSpan>1){u=100/this._colSpan*o._colSpan;h.set_width(u,"%"),this._clearWidth(o),o._colSpan}else if(i){var u=this._itemWidth,d=o._colSpan;if(d>1)u=u*d+(d-1)*r;else if(o._width&&o._width>0){var c=o._width+this._itemLabelWidth;u=u*(d=Math.ceil(c/u))+(d-1)*r}(d>1||0==o._width)&&(this._clearWidth(o),a&&(u-=d-1)),h.set_width(u)}o._itemCssClass&&(l=$skin.joinCssClass(l,o._itemCssClass)),t.div(),t.writeClass(l),t.writeStyle(h.toString()),o.get_hasLabel()&&this.writeControlLabel(o,t),o.renderTag(t),t.writeEnd()}}},_clearWidth:function(t){t._cssClass+=" FlexAuto",t._width=0,delete t._isSetWidth,t.styles.remove("width")},dealDefaultIds:function(){for(var t=this._popupIds?this._popupIds.split(","):[],e=this._staticIds?this._staticIds.split(","):[],i=0,a=this.items.length;i<a;i++){var r=this.items[i].control,s=this.getControlId(r);s&&(this.ChildIds.push(s),Array.contains(e,s)||Array.contains(t,s)||this.DefaultDesignIds.push(s))}},getControlId:function(t){return Craba.UI.HiddenField.isInstanceOfType(t)?null:t._panelConfigID?t._panelConfigID:t.get_ID()},dealConfigItems:function(t){if(this._allowConfig&&this.dealStaticItems(),!this.get_configData())return this.dealPopupItems(!0),this.items;var e=[],i=this._getDesignIds();return i.length>0&&this.intoItems(i,e),this.dealPopupItems(!1),this.items.length>0&&this.dealPopupItems(!0),this.items.length>0&&Array.addRange(e,this.items),e},_getDesignIds:function(){var t=this.get_configData().design.split(",");if(this._notConfigIds){var e=this._notConfigIds.split(",");Array.addRange(t,e),Array.removeRepeatString(t)}return t},renderStaticItems:function(t){if(null!=this.StaticItems&&0!=this.StaticItems.length)for(var e=0,i=this.StaticItems.length;e<i;e++){var a=this.StaticItems[e];t.div(),t.writeClass("FlowItem");a.control.renderTag(t),t.writeEnd()}},dealPopupItems:function(t){var e=this.getPopupIds(t);e&&(this.PopupItems=this.PopupItems?this.PopupItems:[],this.intoItems(e,this.PopupItems))},getPopupIds:function(t){return t?this._popupIds?this._popupIds.split(","):null:this.get_configData()?this.get_configData().popup.split(","):null},dealStaticItems:function(){this._staticIds&&(this.StaticItems=[],this.intoItems(this._staticIds.split(","),this.StaticItems))},renderPopupItems:function(t){this._allowConfig&&(t.div(),t.attr("id",this.get_clientID()+"_popup"),t.writeVisible(!1),this.PopupItems&&this.renderItems(t,this.PopupItems),t.writeEnd())},intoItems:function(t,e){for(var i=0,a=t.length;i<a;i++){var r=t[i],s=this.getItemById(r);null!=s&&e.push(s)}},getItemById:function(t){if(!t)return null;if(0==this.items.length)return null;for(var e=0,i=this.items.length;e<i;e++){var a=this.items[e];if(this.getControlId(a.control)==t)return Array.remove(this.items,a),a}return null},writeControlLabel:function(t,e){var i=t.get_clientID(),a={};i&&(a.id=i+"_label"),t._accessKey&&(a.accesskey=t._accessKey);var r=new _Z_106;r.add(t._labelStyle),this._itemLabelWidth>0&&r.set_width(this._itemLabelWidth),t._visible||r.set_visible(!1),a["class"]=$skin.joinCssClass(t._labelCssClass,"FlowLabel"),a.style=r.toString(),e.label(a),i?e.attr("for",i):this._itemLabelWidth>0&&13*t._label.length>this._itemLabelWidth&&e.attr("title",t._label),e.text(Craba.UI.Common.getAccessKeyHtml(t._label,t._accessKey))._label()},hasChild:function(t){return t._cssClass&&(t._cssClass.indexOf("clear")>-1||t._cssClass.indexOf("Flex1")>-1)},set_icon:function(t){this._icon=t},createCaptionDiv:function(t){if(this._caption||this._icon){var e=$skin.joinCssClass("FlowCaption",this._icon);t.div(),t.writeClass(e),t.text(this._caption),t.writeEnd()}},initScript:function(){Craba.UI.FlowPanel.callBaseMethod(this,"initScript"),this._allowConfig&&(this.addProp("configData",this.get_configData()),this.addProp("popupIds",this._popupIds)),this.addProp("staticIds",this._staticIds),this.addProp("childIds",this.ChildIds),this.addProp("defaultDesignIds",this.DefaultDesignIds),this.addProp("guid",this.get_guid()),this.addProp("layoutDirection",this._layoutDirection,Sys.UI.Controls.LayoutDirection.horz)},set_popupIds:function(t){this._popupIds=t},set_layoutDirection:function(t){this._layoutDirection=this.get_enumTypeValue(Sys.UI.Controls.LayoutDirection,t)}},Craba.UI.FlowPanel.registerClass("Craba.UI.FlowPanel",Craba.UI.WebControl,Craba.UI.ILayoutGroup),Craba.UI.SplitterBase=function(t){Craba.UI.SplitterBase.initializeBase(this,[t]),this._isExpanded=!0,this._allowDrag=!0},Craba.UI.SplitterBase.prototype={initialize:function(){this._inited||(Craba.UI.SplitterBase.callBaseMethod(this,"initialize"),this._mode==_Z_27.none&&(this._cssClass=$skin.joinCssClass(this._cssClass,"noShape"))),this._inited=!0},initScript:function(){Craba.UI.SplitterBase.callBaseMethod(this,"initScript"),this.addProp("saveOffset",this._saveOffset)},_setPage:function(t){Craba.UI.SplitterBase.callBaseMethod(this,"_setPage",[t]),t.addSplitter(this)},endRender:function(t){t.writeEnd()}},Craba.UI.SplitterBase.registerClass("Craba.UI.SplitterBase",Craba.UI.WebControl),Craba.UI.VSplitter=function(t){Craba.UI.VSplitter.initializeBase(this,[t]),this._mode=_Z_27.hideLeft},Craba.UI.VSplitter.prototype={doConfig:function(t){var e=this.get_prev(),i=this.get_next();if(e&&i){var a=e;this._mode==_Z_27.hideRight&&(a=i);var r=t?t.AdjustOffset:0,s=!t||t.IsExpanded;if(isNaN(r)&&(r=0),!1===s||!this._isExpanded){var n="position:absolute;left:auto;top:auto;left:-10000px;top:-10000px;";a._outerCss!==undefined?a._outerCss=n:a.set_cssStyle(n),this._cssClass=$skin.joinCssClass(this._cssClass,"collapse")}if(this._allowDrag&&0!=r){var o=a.xmlNode.Attributes.Width;if(o){var l=$express.getValue(o,this.Context);this._saveOffset=$express.toNumber(l),a.xmlNode.Attributes.Width=this._saveOffset+r}}}},get_cssClass:function(){return this._mode==_Z_27.hideRight?"VSplitter VRight":"VSplitter VLeft"},typeName:function(){return"VSplitter"},initScript:function(){Craba.UI.VSplitter.callBaseMethod(this,"initScript"),this.addProp("mode",this._mode,_Z_27.hideLeft)},set_mode:function(t){this._mode=this.get_enumTypeValue(_Z_27,t)}},Craba.UI.VSplitter.registerClass("Craba.UI.VSplitter",Craba.UI.SplitterBase),Craba.UI.HSplitter=function(t){Craba.UI.HSplitter.initializeBase(this,[t]),this._mode=_Z_26.hideDown},Craba.UI.HSplitter.prototype={doConfig:function(t){var e=this.get_prev(),i=this.get_next();if(e&&i){var a=i;this._mode==_Z_26.hideUp&&(a=e),"PageControl"==a.xmlNode.Name&&this._mode!=_Z_26.none&&(this._cssClass=$skin.joinCssClass(this._cssClass,"hasTab"));var r=t?t.AdjustOffset:0,s=!t||t.IsExpanded;if(isNaN(r)&&(r=0),!1===s||!this._isExpanded){var n="position:absolute;left:auto;top:auto;left:-10000px;top:-10000px;";a._outerCss!==undefined?a._outerCss=n:a.set_cssStyle(n),this._cssClass=$skin.joinCssClass(this._cssClass,"collapse")}if(this._allowDrag&&0!=r){var o=a.xmlNode.Attributes.Height;if(o){var l=$express.getValue(o,this.Context);this._saveOffset=$express.toNumber(l),a.xmlNode.Attributes.Height=this._saveOffset+r}}}},get_cssClass:function(){return this._mode==_Z_26.hideUp?"HSplitter HTop":"HSplitter HBottom"},typeName:function(){return"HSplitter"},initScript:function(){Craba.UI.HSplitter.callBaseMethod(this,"initScript"),this.addProp("mode",this._mode,_Z_26.hideDown)},set_mode:function(t){this._mode=this.get_enumTypeValue(_Z_26,t)}},Craba.UI.HSplitter.registerClass("Craba.UI.HSplitter",Craba.UI.SplitterBase),Craba.UI.CustomEdit=function(t){Craba.UI.CustomEdit.initializeBase(this,[t]),this._text="",this._allowDelIcon=$settings.DefaultAllowClearIcon,this._readOnly=!1,this._allowTags=!1,this._delayTime=100,this._widthUnit=Craba.UI.CssLengthUnit.pixel},Craba.UI.CustomEdit.prototype={initialize:function(){Craba.UI.CustomEdit.callBaseMethod(this,"initialize"),this._dataField&&(this._required||this._requiredRule)&&this.get_page().setValidation(this._dataField,{scriptTypeName:"NotEmptyValidator",required:this._required,rule:this._requiredRule})},updateLang:function(t){this.setAttr("Label",t)},initScript:function(){Craba.UI.CustomEdit.callBaseMethod(this,"initScript"),this._required&&this.addProp("required",!0)},set_readOnly:function(t){this._readOnly=t},writeAttr:function(t){Craba.UI.CustomEdit.callBaseMethod(this,"writeAttr",[t]),this._readOnly&&t.attr("readonly","true"),t.attr("spellcheck","false"),t.attr("autocomplete","off")},get_cssClass:function(){return"Edit"},set_widthUnit:function(t){this._widthUnit=this.get_enumTypeValue(Craba.UI.CssLengthUnit,t)},set_value:function(t){this._value=t}},Craba.UI.CustomEdit.registerClass("Craba.UI.CustomEdit",Craba.UI.WebControl),Craba.UI.TextEdit=function(t){Craba.UI.TextEdit.initializeBase(this,[t])},Craba.UI.TextEdit.prototype={endRender:function(t){t.writeEnd()},writeAttr:function(t){Craba.UI.TextEdit.callBaseMethod(this,"writeAttr",[t]),t.attr("type",this.get_inputTypeName()),t.attr("value",this._text)},get_inputTypeName:function(){return"text"},typeName:function(){return"TextEdit"},htmlTag:function(){return"input"}},Craba.UI.TextEdit.registerClass("Craba.UI.TextEdit",Craba.UI.CustomEdit),Craba.UI.ButtonEditBase=function(t){Craba.UI.ButtonEditBase.initializeBase(this,[t])},Craba.UI.ButtonEditBase.prototype={get_cssClass:function(){return"ButtonEdit Edit"}},Craba.UI.ButtonEditBase.registerClass("Craba.UI.ButtonEditBase",Craba.UI.TextEdit),Craba.UI.ColorEdit=function(t){Craba.UI.ColorEdit.initializeBase(this,[t])},Craba.UI.ColorEdit.prototype={typeName:function(){return"ColorEdit"}},Craba.UI.ColorEdit.registerClass("Craba.UI.ColorEdit",Craba.UI.ButtonEditBase),Craba.UI.HiddenField=function(t){Craba.UI.HiddenField.initializeBase(this,[t]),this._noItem=!0},Craba.UI.HiddenField.prototype={get_inputTypeName:function(){return"hidden"},typeName:function(){return"HiddenField"},writeAttr:function(t){Craba.UI.HiddenField.callBaseMethod(this,"writeAttr",[t]),t.attr("type",this.get_inputTypeName()),t.attr("value",this._text)},set_value:function(t){this._value=t,this.addProp("value",t)},set_text:function(t){this._text=t,this.addProp("text",t)},endRender:function(t){t.writeEnd()},htmlTag:function(){return"input"}},Craba.UI.HiddenField.registerClass("Craba.UI.HiddenField",Craba.UI.CustomEdit),Craba.UI.NumberEdit=function(t){Craba.UI.NumberEdit.initializeBase(this,[t]),this._value=Number.MAX_SAFE_INTEGER,this._minValue=Number.MIN_SAFE_INTEGER,this._maxValue=Number.MAX_SAFE_INTEGER,this._increment=Number.MAX_SAFE_INTEGER,this._decimalDigits=0,this._decimalPrecision=0,this._decimalScale=-1,this._numberType=_Z_28._float,this._displayZeroToDigits=$settings.DisplayZeroToDigits,this._showCalculator=$settings.NumberEditDefaultShowCalculator,this._displayThousandSeperator=!1,this._showEmpty=!1,this._stepButton=!1,this._useSpin=!0},Craba.UI.NumberEdit.prototype={doTag:function(t){if(!this._stepButton)return Craba.UI.NumberEdit.callBaseMethod(this,"doTag",[t]);this._isSetWidth?this.set_width(this._width-$craba.editorButtonWidth):this.set_width(47),Craba.UI.NumberEdit.callBaseMethod(this,"doTag",[t])},initScript:function(){Craba.UI.NumberEdit.callBaseMethod(this,"initScript"),Craba.UI.NumberEdit.setProp(this)},set_decimalDigits:function(t){this._decimalDigits=t},set_numberType:function(t){this._numberType=this.get_numberEnumTypeValue(_Z_28,t)},get_decimalPrecision:function(){return this._decimalPrecision>0?this._decimalPrecision:$settings.DecimalPrecision},get_decimalScale:function(){return this._decimalScale>=0?this._decimalScale:$settings.DecimalScale},typeName:function(){return"NumberEdit"}},Craba.UI.NumberEdit.registerClass("Craba.UI.NumberEdit",Craba.UI.ButtonEditBase),Craba.UI.NumberEdit.setProp=function(t){var e=t.get_decimalScale();0==e&&0==t._decimalDigits&&(t._numberType==_Z_28.positiveFloat?t._numberType=_Z_28.positiveInt:t._numberType=_Z_28._int),t.addProp("numberType",t._numberType,_Z_28._float),t.addProp("decimalDigits",t._decimalDigits,0),t._value!=Number.MAX_SAFE_INTEGER&&t.addProp("value",t._value),t._maxValue!=Number.MAX_SAFE_INTEGER&&t._numberType==_Z_28.positiveInt&&(t._maxValue=Math.round(t._maxValue),t._decimalPrecision=t._maxValue.toString().length,e=t._decimalScale=0);var i=t.get_decimalPrecision();if(i>0&&(t.addProp("decimalPrecision",i,0),e>=0)){if(i<e)throw Error.invalidOperation(String.format("DecimalPrecision={0} 应大于 DecimalScale={1}",i,e));t.addProp("decimalScale",e)}},Craba.UI.SpinEdit=function(t){Craba.UI.SpinEdit.initializeBase(this,[t])},Craba.UI.SpinEdit.prototype={typeName:function(){return"SpinEdit"}},Craba.UI.SpinEdit.registerClass("Craba.UI.SpinEdit",Craba.UI.NumberEdit),Craba.UI.SearchEdit=function(t){Craba.UI.SearchEdit.initializeBase(this,[t]),this._interval=500},Craba.UI.SearchEdit.prototype={typeName:function(){return"SearchEdit"}},Craba.UI.SearchEdit.registerClass("Craba.UI.SearchEdit",Craba.UI.TextEdit),Craba.UI.PasswordEdit=function(t){Craba.UI.PasswordEdit.initializeBase(this,[t]),this._allowSoftKeyboard=!1,this._showIcon=!0,this._allowBrowserPassword=$settings.DefaultAllowBrowserPassword},Craba.UI.PasswordEdit.prototype={initScript:function(){Craba.UI.PasswordEdit.callBaseMethod(this,"initScript"),this._allowSoftKeyboard&&(this.addProp("showIcon",this._showIcon),this.addProp("keyboardData",this.Context.lastValue))},set_showIcon:function(t){this._showIcon=t},typeName:function(){return"PasswordEdit"},get_inputTypeName:function(){return this._allowBrowserPassword?"password":"text"}},Craba.UI.PasswordEdit.registerClass("Craba.UI.PasswordEdit",Craba.UI.ButtonEditBase),Craba.UI.ButtonEdit=function(t){Craba.UI.ButtonEdit.initializeBase(this,[t]),this._buttonVisible=!0},Craba.UI.ButtonEdit.prototype={typeName:function(){return"ButtonEdit"}},Craba.UI.ButtonEdit.registerClass("Craba.UI.ButtonEdit",Craba.UI.ButtonEditBase),Craba.UI.SelectorEdit=function(t){Craba.UI.SelectorEdit.initializeBase(this,[t]),this._selectorWidth=0,this._selectorHeight=0,this._requiredFlag=!0,this._selectOnly=!1,this._allowHandInput=!1,this._autoFocusNext=!1,this._trimDelimiters=!1,this._clickNotFocus=!1,this._showMDI=!1},Craba.UI.SelectorEdit.prototype={typeName:function(){return"SelectorEdit"},initScript:function(){Craba.UI.SelectorEdit.callBaseMethod(this,"initScript"),this.addProp("value",this._value),this.addProp("displayField",this.get_displayField()),this.addProp("selectorWidth",this.get_selectorWidth()),this.addProp("selectorHeight",this.get_selectorHeight()),this._hasSelector()&&(this.selector.setPage(this._page),this.selector.registerScript(),this.addProp("selectorType",this.selector.scriptTypeFullName)),this.addProp("selectorPage",this.get_selectorPage())},set_displayField:function(t){this._displayField=t},get_displayField:function(){return!this._displayField&&this._hasSelector()&&this.selector.defaultDisplayField&&(this._displayField=this.dataField+"."+this.selector.defaultDisplayField),this._displayField},set_selectOnly:function(t){this.addProp("selectOnly",t),this.addProp("readOnly",t)},set_selectorPage:function(t){this._hasSelector()?this.selector.selectorPage=t:this.selectorPage=t},get_selectorPage:function(){return this._hasSelector()?this.selector.selectorPage:this.selectorPage},set_selectorWidth:function(t){this._hasSelector()?this.selector.selectorWidth=t:this.selectorWidth=t},get_selectorWidth:function(){return this._hasSelector()?this.selector.selectorWidth:this.selectorWidth},set_selectorHeight:function(t){this._hasSelector()?this.selector.selectorHeight=t:this.selectorHeight=t},get_selectorHeight:function(){return this._hasSelector()?this.selector.selectorHeight:this.selectorHeight},_hasSelector:function(t){return null!=this.selector}},Craba.UI.SelectorEdit.registerClass("Craba.UI.SelectorEdit",Craba.UI.ButtonEdit),Craba.UI.DateEdit=function(t){Craba.UI.DateEdit.initializeBase(this,[t]),this._selectOnly=!1},Craba.UI.DateEdit.prototype={typeName:function(){return"DateEdit"},initScript:function(){Craba.UI.DateEdit.callBaseMethod(this,"initScript"),this.addProp("value",this._value),this.addProp("valueType",this._valueType,_Z_59._default),this.addProp("defaultValue",this.defaultValue)},set_value:function(t){this._value=this._initValue(t)},set_defaultValue:function(t){this.defaultValue=this._initValue(t)},_initValue:function(t){if(!t)return null;if("string"==typeof t)if("MinValue"==t)t=new Date("1900-01-01");else if("MaxValue"==t)t=new Date("9999-01-01");else if("Today"==t)t=new Date;else{if("Now"!=t)return t;t=new Date}return Date.dateToStr(t)},set_valueType:function(t){this._valueType=this.get_numberEnumTypeValue(_Z_59,t)}},Craba.UI.DateEdit.registerClass("Craba.UI.DateEdit",Craba.UI.ButtonEditBase),Craba.UI.DateTimeEdit=function(t){Craba.UI.DateTimeEdit.initializeBase(this,[t]),this._editKind=_Z_49.normal,this._showSecond=!0},Craba.UI.DateTimeEdit.prototype={initScript:function(){Craba.UI.DateTimeEdit.callBaseMethod(this,"initScript"),this.addProp("editKind",this._editKind,_Z_49.normal)},typeName:function(){return"DateTimeEdit"},set_editKind:function(t){this._editKind=this.get_enumTypeValue(_Z_49,t)}},Craba.UI.DateTimeEdit.registerClass("Craba.UI.DateTimeEdit",Craba.UI.DateEdit),Craba.UI.DateRangeEdit=function(t){Craba.UI.DateRangeEdit.initializeBase(this,[t]),this._layoutDirection=Sys.UI.Controls.LayoutDirection.horz,this._useClick=$settings.DateRangeEditUseClick},Craba.UI.DateRangeEdit.prototype={doTag:function(t){this._isSetWidth||this.set_width(this._isDate()?190:290),Craba.UI.DateRangeEdit.callBaseMethod(this,"doTag",[t])},_isDate:function(){return this._editKind==_Z_49.date},get_cssClass:function(){var t=Craba.UI.DateRangeEdit.callBaseMethod(this,"get_cssClass");return t=this._selectOnly||this._useClick?t+" SelectOnly":t,this._isHorz()||(t+=" vert"),t},initScript:function(){Craba.UI.DateRangeEdit.callBaseMethod(this,"initScript"),this.addProp("useClick",this._useClick,!1),this.addProp("layoutDirection",this._layoutDirection,Sys.UI.Controls.LayoutDirection.horz)},typeName:function(){return"DateRangeEdit"},set_layoutDirection:function(t){this._layoutDirection=this.get_enumTypeValue(Sys.UI.Controls.LayoutDirection,t)},_isHorz:function(){return this._layoutDirection==Sys.UI.Controls.LayoutDirection.horz},htmlTag:function(){return this._isHorz()?"input":"textarea"}},Craba.UI.DateRangeEdit.registerClass("Craba.UI.DateRangeEdit",Craba.UI.DateTimeEdit),Craba.UI.MonthEdit=function(t){Craba.UI.MonthEdit.initializeBase(this,[t]),this._editKind=_Z_53.yearMonth},Craba.UI.MonthEdit.prototype={initScript:function(){Craba.UI.MonthEdit.callBaseMethod(this,"initScript"),this.addProp("editKind",this._editKind,_Z_53.yearMonth)},typeName:function(){return"MonthEdit"},set_editKind:function(t){this._editKind=this.get_enumTypeValue(_Z_53,t)}},Craba.UI.MonthEdit.registerClass("Craba.UI.MonthEdit",Craba.UI.DateEdit),Craba.UI.TimeEdit=function(t){Craba.UI.TimeEdit.initializeBase(this,[t]),this._editKind=_Z_50.normal},Craba.UI.TimeEdit.prototype={initScript:function(){Craba.UI.TimeEdit.callBaseMethod(this,"initScript"),this.addProp("editKind",this._editKind,_Z_50.normal)},typeName:function(){return"TimeEdit"},set_editKind:function(t){this._editKind=this.get_enumTypeValue(_Z_50,t)}},Craba.UI.TimeEdit.registerClass("Craba.UI.TimeEdit",Craba.UI.ButtonEditBase),Craba.UI.DateLimitEdit=function(t){Craba.UI.DateLimitEdit.initializeBase(this,[t])},Craba.UI.DateLimitEdit.prototype={typeName:function(){return"DateLimitEdit"}},Craba.UI.DateLimitEdit.registerClass("Craba.UI.DateLimitEdit",Craba.UI.DateEdit),Craba.UI.Calendar=function(t){Craba.UI.Calendar.initializeBase(this,[t])},Craba.UI.Calendar.prototype={typeName:function(){return"Calendar"},get_cssClass:function(){return"Calendar"},endRender:function(t){t.writeEnd()}},Craba.UI.Calendar.registerClass("Craba.UI.Calendar",Craba.UI.CustomEdit),Craba.UI.ColorBlock=function(t){Craba.UI.ColorBlock.initializeBase(this,[t])},Craba.UI.ColorBlock.prototype={typeName:function(){return"ColorBlock"},get_cssClass:function(){return"ColorBlock"},endRender:function(t){t.writeEnd()}},Craba.UI.ColorBlock.registerClass("Craba.UI.ColorBlock",Craba.UI.CustomEdit),Craba.UI.FileEdit=function(t){Craba.UI.FileEdit.initializeBase(this,[t]),this._multiple=!1},Craba.UI.FileEdit.prototype={typeName:function(){return"FileEdit"},get_cssClass:function(){return"FileEdit"},endRender:function(t){t.attr("name",this.get_ID()),t.attr("type","file"),t.attr("contenteditable",!1),t.attr("accept",this._accept),this._multiple&&t.attr("multiple","true"),t.writeEnd()},htmlTag:function(){return"input"},set_multiple:function(t){this._multiple=t},set_accept:function(t){this._accept=t}},Craba.UI.FileEdit.registerClass("Craba.UI.FileEdit",Craba.UI.CustomEdit),Craba.UI.MemoEdit=function(t){Craba.UI.MemoEdit.initializeBase(this,[t]),this._maxLength=0,this._rows=0,this._maxByteLength=0,this.set_height(120)},Craba.UI.MemoEdit.prototype={typeName:function(){return"MemoEdit"},get_cssClass:function(){return"TextArea"},initScript:function(){Craba.UI.MemoEdit.callBaseMethod(this,"initScript"),this._widthUnit==Craba.UI.CssLengthUnit.percent&&this.addProp("isPercentWidth",!0),this._maxLength>0&&this.addProp("maxLength",this._maxLength),this._maxByteLength>0&&this.addProp("maxByteLength",this._maxByteLength)},endRender:function(t){this._rows>0&&t.attr("rows",this._rows),this.xmlNode.Value&&(this._text+=this.xmlNode.Value),t.text(this._text),t.writeEnd()},htmlTag:function(){return"textarea"},set_rows:function(t){this._rows=t}},Craba.UI.MemoEdit.registerClass("Craba.UI.MemoEdit",Craba.UI.CustomEdit),Craba.UI.DropDownEditBase=function(t){Craba.UI.DropDownEditBase.initializeBase(this,[t]),this._items=[],this._text=null,this._listItems=null,this._dataSource=null,this._selectedIndex=-1,this._selectOnly=!1,this._dropDownStyle=_Z_24.dropDown},Craba.UI.DropDownEditBase.prototype={set_listItems:function(t){this._listItems=t},initScript:function(){if(Craba.UI.DropDownEditBase.callBaseMethod(this,"initScript"),this._dataSource)this.addProp("items",this._dataSource);else{var t=Craba.UI.Common.ItemsToList(this._items,this._listItems,this);t.length>0&&(this._dataValueField="value",this._dataTextField="text"),this.addProp("items",t)}this.addProp("dataValueField",this._dataValueField),this.addProp("dataTextField",this._dataTextField),this.addProp("selectedIndex",this._selectedIndex,-1),this.addProp("value",this._value),this.addProp("dropDownRows",this._dropDownRows,10),this.addProp("dropDownStyle",this._dropDownStyle,_Z_24.dropDown),this.addProp("valueType",this._valueType,_Z_59._default),this.addProp("enabledField",this._enabledField)},endRender:function(t){Craba.UI.DropDownEditBase.callBaseMethod(this,"endRender",[t]);var e=[];this.invokeBody(t,function(t){return!!Craba.UI.ListItem.isInstanceOfType(t)||(e.push(t.xmlNode),!1)}),e.length>0&&this.addProp("childGspx",e)},set_dataSource:function(t){this._dataSource=t},get_items:function(){return this._items},set_dropDownStyle:function(t){this._dropDownStyle=this.get_enumTypeValue(_Z_24,t)},set_selectedIndex:function(t){this._selectedIndex=t},set_valueType:function(t){this._valueType=this.get_numberEnumTypeValue(_Z_59,t)}},Craba.UI.DropDownEditBase.registerClass("Craba.UI.DropDownEditBase",Craba.UI.ButtonEditBase),Craba.UI.DropDownEdit=function(t){Craba.UI.DropDownEdit.initializeBase(this,[t])},Craba.UI.DropDownEdit.prototype={typeName:function(){return"DropDownEdit"}},Craba.UI.DropDownEdit.registerClass("Craba.UI.DropDownEdit",Craba.UI.DropDownEditBase),Craba.UI.ImageDropDownEdit=function(t){Craba.UI.ImageDropDownEdit.initializeBase(this,[t]),this._imageWidth=0,this._imageHeight=0},Craba.UI.ImageDropDownEdit.prototype={get_cssClass:function(){return"ButtonEdit Edit ImageEdit"},typeName:function(){return"ImageDropDownEdit"},htmlTag:function(){return"div"},get_inputTypeName:function(){return"image"},set_imageWidth:function(t){this.set_width(t+28)}},Craba.UI.ImageDropDownEdit.registerClass("Craba.UI.ImageDropDownEdit",Craba.UI.DropDownEditBase),Craba.UI.ColorDropDownEdit=function(t){Craba.UI.ColorDropDownEdit.initializeBase(this,[t]),this._imageWidth=0,this._imageHeight=0},Craba.UI.ColorDropDownEdit.prototype={typeName:function(){return"ColorDropDownEdit"}},Craba.UI.ColorDropDownEdit.registerClass("Craba.UI.ColorDropDownEdit",Craba.UI.DropDownEditBase),Craba.UI.ListItem=function(t){Craba.UI.ListItem.initializeBase(this,[t]),this._selected=!1},Craba.UI.ListItem.prototype={doTag:function(){if(!this._text)throw Error.invalidOperation("ListItem必须设置Text值");var t=this.get_parent().get_items();Array.add(t,this)},set_value:function(t){this._value=t},get_value:function(){return this._value},get_selected:function(){return this._selected},set_selected:function(t){this._selected=t},set_text:function(t){this._text=$common.htmlDecode(t)},get_text:function(){return this._text}},Craba.UI.ListItem.registerClass("Craba.UI.ListItem",Craba.UI.ScriptControl),Craba.UI.DropDownCheckBoxList=function(t){Craba.UI.DropDownCheckBoxList.initializeBase(this,[t]),this._noSortValue=!1,this._itemWidth=0,this._columnSplit=1,this._hideCheckAll=!1,this._showButtons=!1,this._showOkButton=!0},Craba.UI.DropDownCheckBoxList.prototype={initScript:function(){Craba.UI.DropDownCheckBoxList.callBaseMethod(this,"initScript"),this.addProp("layoutDirection",this._layoutDirection,Sys.UI.Controls.LayoutDirection.vert)},get_cssClass:function(){var t="ButtonEdit Edit";return this._showButtons?t+" Buttons Selector":t},typeName:function(){return"DropDownCheckBoxList"},htmlTag:function(){return this._showButtons?"div":Craba.UI.DropDownCheckBoxList.callBaseMethod(this,"htmlTag")},set_layoutDirection:function(t){this._layoutDirection=this.get_enumTypeValue(Sys.UI.Controls.LayoutDirection,t)}},Craba.UI.DropDownCheckBoxList.registerClass("Craba.UI.DropDownCheckBoxList",Craba.UI.DropDownEditBase),Craba.UI.CustomSelectableList=function(t){Craba.UI.CustomSelectableList.initializeBase(this,[t]),this._items=[],this._height=0,this._width=0,this._rows=0,this._columnSplit=1,this._showBorder=!0,this._wordWrap=!0,this._selectedIndex=-1,this._itemWidth=0,this._layoutDirection=Sys.UI.Controls.LayoutDirection.vert},Craba.UI.CustomSelectableList.prototype={doTag:function(t){this.invokeBody(t),Craba.UI.CustomSelectableList.callBaseMethod(this,"doTag",[t])},renderHTML:function(t){Craba.UI.CustomSelectableList.callBaseMethod(this,"renderHTML",[t]),t.writeEnd()},initScript:function(){if(Craba.UI.CustomSelectableList.callBaseMethod(this,"initScript"),this._dataSource)this.addProp("items",this._dataSource);else{this.get_scriptItems().length>0&&(this._dataValueField="value",this._dataTextField="text",this.addProp("items",this.get_scriptItems()))}if(this.addProp("enabledField",this._enabledField),this.addProp("dataValueField",this._dataValueField),this.addProp("dataTextField",this._dataTextField),this.addProp("value",this._value),this.addProp("layoutDirection",this._layoutDirection,Sys.UI.Controls.LayoutDirection.vert),this._columnSplit>1){if(this._layoutDirection!=Sys.UI.Controls.LayoutDirection.horz)throw Error.invalidOperation("暂时只支持先从左到右后从上到下的列拆分布局");this.addProp("columnSplit",this._columnSplit,1)}this.addProp("wordWrap",this._wordWrap,!0),this.addProp("selectedIndex",this._selectedIndex,-1)},set_selectedIndex:function(t){this._selectedIndex=t},set_dataSource:function(t){this._dataSource=t},set_listItems:function(t){this._listItems=t},get_items:function(){return this._items},set_rows:function(t){this._rows=t},set_layoutDirection:function(t){this._layoutDirection=this.get_enumTypeValue(Sys.UI.Controls.LayoutDirection,t)},set_showBorder:function(t){this._showBorder=t},get_itemCount:function(){return this._dataSource?typeof this._dataSource==typeof Array?this._dataSource.length:0:this.get_scriptItems().length},get_scriptItems:function(){return this.scriptItems&&0!=this.scriptItems.length||(this.scriptItems=Craba.UI.Common.ItemsToList(this._items,this._listItems,this)),this.scriptItems},_borderCssClass:function(){var t=this._enabled?"":"disabled";return this._showBorder?"Border "+t:t}},Craba.UI.CustomSelectableList.registerClass("Craba.UI.CustomSelectableList",Craba.UI.CustomEdit),Craba.UI.CheckBoxList=function(t){Craba.UI.CheckBoxList.initializeBase(this,[t])},Craba.UI.CheckBoxList.prototype={get_cssClass:function(){var t=$skin.joinCssClass("CheckBoxList",this._borderCssClass());return this._layoutDirection==Sys.UI.Controls.LayoutDirection.vert&&(t=$skin.joinCssClass(t,"Vert")),t},typeName:function(t){return"CheckBoxList"}},Craba.UI.CheckBoxList.registerClass("Craba.UI.CheckBoxList",Craba.UI.CustomSelectableList),Craba.UI.RadioButtonList=function(t){Craba.UI.RadioButtonList.initializeBase(this,[t])},Craba.UI.RadioButtonList.prototype={initScript:function(){Craba.UI.RadioButtonList.callBaseMethod(this,"initScript"),this.addProp("selectedIndex",this._selecteIndex,-1)},get_cssClass:function(){var t=$skin.joinCssClass("RadioButtonList",this._borderCssClass());return this._layoutDirection==Sys.UI.Controls.LayoutDirection.vert&&(t=$skin.joinCssClass(t,"Vert")),t},typeName:function(t){return"RadioButtonList"}},Craba.UI.RadioButtonList.registerClass("Craba.UI.RadioButtonList",Craba.UI.CustomSelectableList),Craba.UI.ListBox=function(t){Craba.UI.ListBox.initializeBase(this,[t]),this._selectedIndex=-1},Craba.UI.ListBox.prototype={get_cssClass:function(){return"ListBox ScrollBar"},typeName:function(){return"ListBox"},initScript:function(){Craba.UI.ListBox.callBaseMethod(this,"initScript"),this.addProp("selectedIndex",this._selectedIndex,-1),this.addProp("selectedField",this._selectedField),this.addProp("multiSelect",this._multiSelect,!1)}},Craba.UI.ListBox.registerClass("Craba.UI.ListBox",Craba.UI.CustomSelectableList),Craba.UI.CustomCheckBox=function(t){Craba.UI.CustomCheckBox.initializeBase(this,[t]),this._checked=!1},Craba.UI.CustomCheckBox.prototype={updateLang:function(t){this.hasAttr("Label")?this.setAttr("Label",t):this.setAttr("Text",t)},renderHTML:function(t){var e=this.getBoxCssClass()+" ChkBoxStyle";t.div(),t.writeClass($skin.joinCssClass(e,this._cssClass)),this._cssClass="",this._visible||this.styles.set("display","none"),t.writeStyle(this.styles.get_value()),this.styles.clear(),Craba.UI.CustomCheckBox.callBaseMethod(this,"renderHTML",[t])},getBoxCssClass:function(){return""},endRender:function(t){t.writeEnd(),this._text&&this._renderLabel(t),t.writeEnd()},writeAttr:function(t){Craba.UI.CustomCheckBox.callBaseMethod(this,"writeAttr",[t]),t.attr("type",this.get_inputTypeName()),this._checked&&t.attr("checked",!0),t.attr("value",!0)},htmlTag:function(){return"input"},set_textColor:function(t){this._textColor=t},_renderLabel:function(t){var e=this.get_clientID(),i={};e&&(i.id=e+"_text"),this._accessKey&&(i.accesskey=this._accessKey),i.style="",this._textColor&&(i.style+="color:"+this._textColor+";"),this._labelStyle&&(i.style+=this._labelStyle),t.writeTag("label",i),e&&t.attr("for",e);var a=$common.htmlDecode(this._text);t.text(Craba.UI.Common.getAccessKeyHtml(a,this._accessKey)),t.writeEnd()}},Craba.UI.CustomCheckBox.registerClass("Craba.UI.CustomCheckBox",Craba.UI.CustomEdit),Craba.UI.CheckBox=function(t){Craba.UI.CheckBox.initializeBase(this,[t])},Craba.UI.CheckBox.prototype={getBoxCssClass:function(){return"CheckBox"},typeName:function(){return"CheckBox"},get_inputTypeName:function(){return"checkbox"}},Craba.UI.CheckBox.registerClass("Craba.UI.CheckBox",Craba.UI.CustomCheckBox),Craba.UI.RadioButton=function(t){Craba.UI.RadioButton.initializeBase(this,[t]),this._groupName="RadioButton"},Craba.UI.RadioButton.prototype={getBoxCssClass:function(){return"RadioButton"},typeName:function(){return"RadioButton"},get_inputTypeName:function(){return"radio"},set_groupName:function(t){this._groupName=t},writeAttr:function(t){Craba.UI.RadioButton.callBaseMethod(this,"writeAttr",[t]);var e=String.format("{0}${1}",this.Context.pageId,this._groupName);t.attr("name",e)}},Craba.UI.RadioButton.registerClass("Craba.UI.RadioButton",Craba.UI.CustomCheckBox),Craba.UI.HTMLTag=function(t){if(Craba.UI.HTMLTag.initializeBase(this,[t]),this.attributes={},t.Value&&t.Value.indexOf("${")>=0){var e=t.Value,i=e.indexOf("${"),a=e.substring(0,i),r=e.substring(i).trim(),s=r.indexOf("}")+1,n=r.substring(s);r=r.substring(0,s),this.innerText=a+$express.getValue(r,this.Context)+n}else this.innerText=t.Value;this.tagName=t.Name},Craba.UI.HTMLTag.prototype={dispose:function(){Craba.UI.HTMLTag.callBaseMethod(this,"dispose"),delete this.attributes},get_ID:function(){return null},renderTag:function(t){if("link"==this.tagName.toLowerCase()){var e=$$get("HEAD")[0],i=document.createElement("link");return i.type=this.attributes.type,i.rel=this.attributes.rel,i.href=this.attributes.href,void e.appendChild(i)}t.writeTag(this.htmlTag(),this.attributes),t.text(this.innerText),this.invokeBody(t),t.writeEnd()},doPropertys:function(t,e){this.attributes[t]=$express.getValue(e,this.Context)},htmlTag:function(){return this.tagName}},Craba.UI.HTMLTag.registerClass("Craba.UI.HTMLTag",Craba.UI.Control),Craba.UI.HtmlPanel=function(t){Craba.UI.HtmlPanel.initializeBase(this,[t])},Craba.UI.HtmlPanel.prototype={renderHTML:function(t){Craba.UI.HtmlPanel.callBaseMethod(this,"renderHTML",[t]),this._width&&t.div({align:this._hAlign?this._hAlign:"left",style:"width:100%;"}),this.invokeBody(t),this._width&&t._div(),t.writeEnd()},get_cssClass:function(){return"Panel"}},Craba.UI.HtmlPanel.registerClass("Craba.UI.HtmlPanel",Craba.UI.WebControl),Craba.UI.A=function(t){Craba.UI.A.initializeBase(this,[t]),this.innerText=t.Value,this._target="_blank"},Craba.UI.A.prototype={writeAttr:function(t){Craba.UI.A.callBaseMethod(this,"writeAttr",[t]),t.attr("href",this.get_page().convertUrl(this._href)),t.attr("target",this._target)},set_href:function(t){this._href=t},set_target:function(t){this._target=t},set_text:function(t){this._text=t},renderHTML:function(t){Craba.UI.A.callBaseMethod(this,"renderHTML",[t]),this._text?t.text(this._text):this.innerText&&t.text(this.innerText),t.writeEnd()},get_cssClass:function(){return"ATag"},htmlTag:function(){return"a"}},Craba.UI.A.registerClass("Craba.UI.A",Craba.UI.WebControl),Craba.UI.SpacerBase=function(t){Craba.UI.SpacerBase.initializeBase(this,[t]),this._repeat=1},Craba.UI.SpacerBase.prototype={renderTag:function(t){for(var e=0;e<this._repeat;e++)this.renderHTML(t)}},Craba.UI.SpacerBase.registerClass("Craba.UI.SpacerBase",Craba.UI.WebControl),Craba.UI.HSpacer=function(t){Craba.UI.HSpacer.initializeBase(this,[t])},Craba.UI.HSpacer.prototype={get_cssClass:function(){return"HSpacer"},renderHTML:function(t){Sys.Browser.isStandard&&this.styles.set("display","inline-block"),Craba.UI.HSpacer.callBaseMethod(this,"renderHTML",[t]),t.text(this._text?this._text:"&nbsp;"),t.writeEnd()},set_width:function(t){this.styles.set("padding-left",t-1+"px")},htmlTag:function(){return"span"}},Craba.UI.HSpacer.registerClass("Craba.UI.HSpacer",Craba.UI.SpacerBase),Craba.UI.VSpacer=function(t){Craba.UI.VSpacer.initializeBase(this,[t])},Craba.UI.VSpacer.prototype={get_cssClass:function(){return"VSpacer"},endRender:function(t){t.writeEnd()},htmlTag:function(){return"div"}},Craba.UI.VSpacer.registerClass("Craba.UI.VSpacer",Craba.UI.SpacerBase),Craba.UI.Link=function(t){Craba.UI.Link.initializeBase(this,[t]),this._showLabel=!1},Craba.UI.Link.prototype={doTag:function(t){if(!this.url)throw Error.invalidOperation("Link控件必须包含Url属性");Craba.UI.Link.callBaseMethod(this,"doTag",[t])},writeAttr:function(t){Craba.UI.Link.callBaseMethod(this,"writeAttr",[t]),t.attr("target",this._target),t.attr("title",this._hint),t.attr("href",this.url)},endRender:function(t){t.text(this._text),t.writeEnd()},set_url:function(t){this.url=this.get_page().convertUrl(t)},htmlTag:function(){return"a"}},Craba.UI.Link.registerClass("Craba.UI.Link",Craba.UI.WebControl),Craba.UI.ListView=function(t){Craba.UI.ListView.initializeBase(this,[t]),this._itemWidth=-1,this._itemHeight=-1,this._itemMargin=-1,this._pagerNumericButtonCount=$settings.PagerNumericButtonCount,this._pageSize=10,this._pagerPosition=Craba.UI.PagerPosition.none,this._pagerSaveQueryParams=$settings.GridDefaultSavedQueryParams,this._pagerDropDownNumericButton=$settings.GridPagerDropDownNumericButton,this._configID=0,this._maxPageSize=0,this._defaultRowCount=0,this._defaultColumnCount=0,this._bindClick=!1,this._useResize=!0,this._useSelect=!1,this._allowDrag=!1,this.dataControls=[],this._autoScroll=!1,this._useSelect=!1,this._outerCss=""},Craba.UI.ListView.prototype={get_cssClass:function(){return"UI_ListView"},typeName:function(){return"ListView"},initScript:function(){Craba.UI.ListView.callBaseMethod(this,"initScript"),this.pager&&this.addProp("pagerId",this.pager.get_ID()),this.addProp("dropDownNumericButton",this._pagerDropDownNumericButton,$settings.GridPagerDropDownNumericButton),this.addProp("dataSource",this._dataSource),this.addProp("controlScripts",this.get_controlsScripts())},registerScript:function(){Craba.UI.ListView.callBaseMethod(this,"registerScript"),this._pager2&&this._pager2.registerScript(),this._pager1&&this._pager1.registerScript()},addDataControl:function(t){this.dataControls.push(t)},get_controlsScripts:function(){for(var t=[],e=0,i=this.dataControls.length;e<i;e++)Array.add(t,this.dataControls[e].get_createParams());return t},renderHTML:function(t){t.div();var e="",i="ListViewBlock";this._isSetHeight&&(e="height:"+this._height+"px;",this.styles.remove("height")),this._isSetWidth&&(e+="width:"+this._width+"px;",this.styles.remove("width")),this._outerCss&&(e+=this._outerCss),e&&(t.writeStyle(e),i=$skin.joinCssClass(i,"Flex0")),this._cssClass&&(i=$skin.joinCssClass(i,this._cssClass),delete this._cssClass),t.writeClass(i),this._pagerPosition!=Craba.UI.PagerPosition.top&&this._pagerPosition!=Craba.UI.PagerPosition.topAndBottom||(this._pager2=this.pager=this.createPager(t,"ListTopPager","pager2")),Craba.UI.ListView.callBaseMethod(this,"renderHTML",[t]),this.invokeBody(t),t.writeEnd(),this._pagerPosition!=Craba.UI.PagerPosition.bottom&&this._pagerPosition!=Craba.UI.PagerPosition.topAndBottom||(this._pager1=this.pager=this.createPager(t,"ListBottomPager","pager1")),t.writeEnd()},createPager:function(t,e,i){var a=new Craba.UI.ListPager(null,this);return a._cssClass=e,a.set_iD(this.get_ID()+"_"+i),a._dataSource=this._dataSource,a._target=this.get_clientID(),a._pageSize=this._pageSize,a._maxPageSize=this._maxPageSize,a._numericButtonCount=this._pagerNumericButtonCount,a.renderHTML(t),a},set_pageSize:function(t){this._pageSize=t},set_maxPageSize:function(t){this._maxPageSize=t},set_pagerNumericButtonCount:function(t){this._pagerNumericButtonCount=t},set_pagerDropDownNumericButton:function(t){this._pagerDropDownNumericButton=t},set_defaultRowCount:function(t){this._defaultRowCount=t},set_pager:function(t){this._pagerPosition=this.get_enumTypeValue(Craba.UI.PagerPosition,t)}},Craba.UI.ListView.registerClass("Craba.UI.ListView",Craba.UI.WebControl),Craba.UI.ListTemplate=function(t){Craba.UI.ListTemplate.initializeBase(this,[t])},Craba.UI.ListTemplate.prototype={doTag:function(t){if(!Craba.UI.ListView.isInstanceOfType(this.get_parent()))throw Error.invalidOperation("请把 ListTemplate 标签放到 ListView 标签内");Craba.UI.ListTemplate.callBaseMethod(this,"doTag",[t])},get_cssClass:function(){return"UI_ListItem"},renderHTML:function(t){this.styles.set_visible(!1),Craba.UI.ListTemplate.callBaseMethod(this,"renderHTML",[t]),this.invokeBody(t),t.writeEnd()}},Craba.UI.ListTemplate.registerClass("Craba.UI.ListTemplate",Craba.UI.WebControl),Craba.UI.DataControl=function(t){Craba.UI.DataControl.initializeBase(this,[t])},Craba.UI.DataControl.prototype={doTag:function(t){var e=this._listView=this.findAncestorWithType(this.get_parent(),Craba.UI.ListView);if(!e||!Craba.UI.ListView.isInstanceOfType(e))throw Error.invalidOperation("该标签必须包含在ListView");e.addDataControl(this),Craba.UI.DataControl.callBaseMethod(this,"doTag",[t])},beginRender:function(t){this.events.click&&this.styles.set("cursor","pointer"),Craba.UI.DataControl.callBaseMethod(this,"beginRender",[t])},writeAttr:function(t){var e=$skin.joinCssClass(this.get_cssClass(),this._cssClass);t.attr("class",e),t.attr("_id",this.get_clientID()),t.writeStyle(this.styles.get_value())},registerScript:function(){this.initScript()},getOtherParams:function(t){t.id=this.get_clientID()}},Craba.UI.DataControl.registerClass("Craba.UI.DataControl",Craba.UI.WebControl),Craba.UI.DataBlock=function(t){Craba.UI.DataBlock.initializeBase(this,[t])},Craba.UI.DataBlock.prototype={typeName:function(){return"DataBlock"},get_cssClass:function(){return"DataBlock"},set_isControl:function(t){this._isControl=t},invokeBody:function(t){for(var e=0,i=this._getCount();e<i;e++){var a=this.childControls[e];a.initialize(),this._isControl&&a.get_needClient&&a.get_needClient()&&(a.registerScript=function(){this.initScript()},a.writeID=function(t){t.attr("_id",this.get_clientID())},a.getOtherParams=function(t){t.id=this.get_clientID()},this._listView.addDataControl(a)),a.doTag(t)}},endRender:function(t){this.invokeBody(t),t.writeEnd()}},Craba.UI.DataBlock.registerClass("Craba.UI.DataBlock",Craba.UI.DataControl),Craba.UI.DataImage=function(t){Craba.UI.DataImage.initializeBase(this,[t]),this._hAlign=_Z_250.left},Craba.UI.DataImage.prototype={typeName:function(){return"DataImage"},beginRender:function(t){this._hAlign!=_Z_250.left&&(t.div(),this.styles.set("text-align",Craba.UI.Common.HAlignToString(this._hAlign,!0))),t.writeBegin("img")},endRender:function(t){Craba.UI.DataImage.callBaseMethod(this,"endRender",[t]);var e;this._url?(e=this._url.toLowerCase().startsWith("http")?this._url:this.get_page().getWebUrl(this._url),t.attr("src",e)):this._src?(e=this._src.toLowerCase().startsWith("http")?this._src:this.get_page().getWebUrl(this._src),t.attr("src",e)):t.attr("src",$skin.getBlankImageSrc()),t.writeEnd(),_Z_250.left!=this._hAlign&&t.writeEnd()},set_hAlign:function(t){this._hAlign=this.get_enumTypeValue(_Z_250,t)}},Craba.UI.DataImage.registerClass("Craba.UI.DataImage",Craba.UI.DataControl),Craba.UI.CustomText=function(t){Craba.UI.CustomText.initializeBase(this,[t])},Craba.UI.CustomText.prototype={initScript:function(){Craba.UI.CustomText.callBaseMethod(this,"initScript"),this.addProp("text",this._text)},get_cssClass:function(){return"DataText"},endRender:function(t){this.hasEvent()&&t.attr("href","javascript:;"),this._hint&&t.attr("title",this._hint),t.text(this._text),t.writeEnd()},hasEvent:function(){return this.events.click},htmlTag:function(){return this.hasEvent()?"a":"span"}},Craba.UI.CustomText.registerClass("Craba.UI.CustomText",Craba.UI.DataControl),Craba.UI.DataCheckBox=function(t){Craba.UI.DataCheckBox.initializeBase(this,[t])},Craba.UI.DataCheckBox.prototype={typeName:function(){return"DataCheckBox"},beginRender:function(t){t.div(),t.writeClass("ChkBoxStyle"),t.writeBegin("input"),t.attr("type","checkbox")},endRender:function(t){t.writeEnd(),t.writeEnd()}},Craba.UI.DataCheckBox.registerClass("Craba.UI.DataCheckBox",Craba.UI.DataControl),Craba.UI.DataIndex=function(t){Craba.UI.DataIndex.initializeBase(this,[t])},Craba.UI.DataIndex.prototype={typeName:function(){return"DataIndex"}},Craba.UI.DataIndex.registerClass("Craba.UI.DataIndex",Craba.UI.CustomText),Craba.UI.DataText=function(t){Craba.UI.DataText.initializeBase(this,[t])},Craba.UI.DataText.prototype={typeName:function(){return"DataText"}},Craba.UI.DataText.registerClass("Craba.UI.DataText",Craba.UI.CustomText),Craba.UI.DataNumber=function(t){Craba.UI.DataNumber.initializeBase(this,[t])},Craba.UI.DataNumber.prototype={typeName:function(){return"DataNumber"}},Craba.UI.DataNumber.registerClass("Craba.UI.DataNumber",Craba.UI.CustomText),Craba.UI.DataTextEdit=function(t){Craba.UI.DataTextEdit.initializeBase(this,[t])},Craba.UI.DataTextEdit.prototype={typeName:function(){return"DataTextEdit"},get_cssClass:function(){return"Edit"},initScript:function(){Craba.UI.DataTextEdit.callBaseMethod(this,"initScript"),this.addProp("focusText",this._focusText)},endRender:function(t){t.writeEnd()},htmlTag:function(){return"input"}},Craba.UI.DataTextEdit.registerClass("Craba.UI.DataTextEdit",Craba.UI.DataControl),Craba.UI.DataNumberEdit=function(t){Craba.UI.DataNumberEdit.initializeBase(this,[t]),this._numberType=_Z_28._float,this._decimalScale=-1,this._decimalPrecision=0,this._decimalDigits=0,this._value=0,this._minValue=Number.MIN_SAFE_INTEGER,this._maxValue=Number.MAX_SAFE_INTEGER,this._displayZeroToDigits=$settings.DisplayZeroToDigits,this._showCalculator=$settings.NumberEditDefaultShowCalculator,this._displayThousandSeperator=!1,this._showEmpty=!1,this._stepButton=!1,this._useSpin=!0},Craba.UI.DataNumberEdit.prototype={typeName:function(){return"DataNumberEdit"},initScript:function(){Craba.UI.DataNumberEdit.callBaseMethod(this,"initScript"),Craba.UI.NumberEdit.setProp(this),this._minValue!=Number.MIN_SAFE_INTEGER&&this.addProp("minValue",this._minValue),this._maxValue!=Number.MAX_SAFE_INTEGER&&this.addProp("maxValue",this._maxValue)},get_decimalPrecision:function(){return this._decimalPrecision>0?this._decimalPrecision:$settings.DecimalPrecision},get_decimalScale:function(){return this._decimalScale>=0?this._decimalScale:$settings.DecimalScale},set_numberType:function(t){this._numberType=this.get_numberEnumTypeValue(_Z_28,t)}},Craba.UI.DataNumberEdit.registerClass("Craba.UI.DataNumberEdit",Craba.UI.DataTextEdit),Craba.UI.ITagWithMenuItems=function(){throw Error.notImplemented()},Craba.UI.ITagWithMenuItems.prototype={get_items:function(){throw Error.notImplemented()}},Craba.UI.ITagWithMenuItems.registerInterface("Craba.UI.ITagWithMenuItems"),Craba.UI.MenuItem=function(t){Craba.UI.MenuItem.initializeBase(this,[t]),this.parentMenuItem=null,this.index=-1,this.items=new Craba.MenuItemCollection,this._beginGroup=!1},Craba.UI.MenuItem.prototype={updateLang:function(t){this.setAttr("Text",t)},doTag:function(t){var e=this.get_parent();e.get_items&&e.get_items().add(this),this.invokeBody(t)},set_text:function(t){this._text=t,this.addProp("text",this._text)},get_ID:function(){var t=Craba.UI.MenuItem.callBaseMethod(this,"get_ID");if(!t){var e=this.parentMenuItem;null==e&&(e=this.findParentImplementsInterface(this,Craba.UI.ITagWithMenuItems)),t=null==e?this.get_RootID(this):e.get_ID()+"_"+this.get_index()}return t},get_index:function(){if(this.index<0){var t;return t=null!=parentMenuItem?parentMenuItem.get_items():this.get_parentTag().get_items(),Array.indexOf(t,this)}return this.index},set_index:function(t){this.index=t},get_RootID:function(t){var e=t.get_internalID();if(!e){var i=t.parentControl;e=Craba.UI.PopupMenu.isInstanceOfType(i)||Craba.UI.MenuBar.isInstanceOfType(i)?i.get_ID():"mnuRoot",e+=t.get_index()}return e},get_parentTag:function(){var t=this.findParentImplementsInterface(this,Craba.UI.ITagWithMenuItems);if(!t)throw Error.invalidOperation("MenuItem标签必须嵌入到 ITagWithMenuItems 标签内");return t},set_groupDirection:function(t){this._groupDirection=this.get_enumTypeValue(Sys.UI.Controls.LayoutDirection,t)},hasChildren:function(){return this.items.childs.length>0},get_items:function(){return this.items}},Craba.UI.MenuItem.registerClass("Craba.UI.MenuItem",Craba.UI.ScriptControl,Craba.UI.ITagWithMenuItems),Craba.UI.DynamicMenu=function(t){Craba.UI.DynamicMenu.initializeBase(this,[t])},Craba.UI.DynamicMenu.prototype={doTag:function(t){if(!this._dataSource)throw Error.invalidOperation("DynamicMenu缺少DataSource属性");var e=this.get_parent();if(!e||!Craba.UI.MenuBar.isInstanceOfType(e))throw Error.invalidOperation("请把 DynamicMenu 标签放到 MenuBar 或 MenuItem 标签内");this._addNode(this._dataSource,e,!1)},_addNode:function(t,e,i){var a=e;if(i){var r={Attributes:{}},s=r.Attributes;s.ID=t.ID,s.Text=t.Text,s.Param=t.Param,s.Icon=t.Icon,s.ShowPage=t.ShowPage,s.NavigateUrl=t.NavigateUrl,s.BeginGroup=!1!==t.BeginGroup,s.OnClick=t.OnClick,s.Shortcut=t.Shortcut,s.Enabled=!1!==t.Enabled,s.Visible=!1!==t.Visible,s.CssClass=t.CssClass;var n=new Craba.UI.MenuItem(r);n._setPage(this.get_page()),n.Context=this.Context,e.addControl(n),n.initialize(),e.get_items().add(n),a=n}if(t&&t.ChildNodes)for(var o=0,l=t.ChildNodes.length;o<l;o++){var h=t.ChildNodes[o];this._addNode(h,a,!0)}},set_dataSource:function(t){this._dataSource=t}},Craba.UI.DynamicMenu.registerClass("Craba.UI.DynamicMenu",Craba.UI.ScriptControl,Craba.UI.ITagWithMenuItems),Craba.MenuItemCollection=function(t){this.parent=t,this.childs=[],this.id=null,this.parent=null,this.page},Craba.MenuItemCollection.prototype={get_ID:function(){return this.id?this.id:this.parent.get_ID()+"_menu"},set_ID:function(t){this.id=t},add:function(t){Array.add(this.childs,t)},length:function(){return this.childs.length},set_parent:function(t){this.parent=t}},Craba.UI.CustomMenu=function(t){Craba.UI.CustomMenu.initializeBase(this,[t]),this.items=new Craba.MenuItemCollection,this.menuList=[]},Craba.UI.CustomMenu.prototype={_renderMenu:function(t,e){t.div(),t.writeClass($skin.joinCssClass("NormalMenu Menu",this._cssClass)),t.attr("id",this.get_page().get_controlClientID(e.get_ID())),this._renderMenuHeadFoot(t,"thead"),e.add&&(e=e.childs);for(var i=0,a=e.length;i<a;i++)this._renderMenuItem(t,e[i]);this._renderMenuHeadFoot(t,"tfoot"),t.writeEnd()},_renderMenuHeadFoot:function(t,e){t.div(),t.writeClass(e),t.writeEnd()},_renderMenuItem:function(t,e){e._beginGroup&&(t.div(),e._visible||t.attr("style","display:none"),t.writeClass("MenuSeperator"),t.writeEnd());var i=e._enabled?"MenuItem":"MenuItem disabled";i=$skin.joinCssClass(i,e._cssClass),t.div(),t.writeClass(i),t.attr("id",e.get_clientID()),t.writeEnabled(e._enabled),t.writeVisible(e._visible),t.writeTag("span"),t.writeClass("MenuSpacerLeft"),t.writeEnd();var a="MenuImage",r=$craba.isIconfont(e._icon);r&&(a=$skin.joinCssClass(a,e._icon)),t.span(),t.writeClass(a),!r&&e._icon&&(t.img(),t.attr("src",this.get_page().getWebUrl(e._icon)),t.writeEnd()),t.writeEnd(),t.writeTag("span"),t.writeClass("MenuCaption"),t.text(e._text),t.writeEnd(),t.writeTag("span");var s=e.hasChildren(),n=e._shortcut;t.writeClass(s?"MenuMore aicon-children":n?"MenuShortcut":"MenuNoMore"),t.text(s?"":n?$craba.shortcutToString(e._shortString):""),t.writeEnd(),t.writeTag("span"),t.writeClass("MenuSpacerRight"),t.writeEnd(),t.writeEnd()},get_items:function(){return this.items},_scanMenuItems:function(t,e){for(var i=0,a=e.childs.length;i<a;i++){var r=e.childs[i];if(r.parentMenuItem=t,r.set_index(i),r.hasChildren()){var s=r.get_items();s.set_parent(r),Array.add(this.menuList,s),this._scanMenuItems(r,s)}}},registerMenuScript:function(t,e,i){new Craba.UI.MenuScript(this.get_page(),t,e,i).registerScript()},registerMenuItemScript:function(t){for(var e=0,i=t.childs.length;e<i;e++){this.getMenuItemScript(t.childs[e]).registerScript()}},registerMenuListScript:function(){for(var t=0,e=this.menuList.length;t<e;t++)this.registerMenuScript(this.menuList[t],!1,null);for(var t=0,e=this.menuList.length;t<e;t++)this.registerMenuItemScript(this.menuList[t])},getMenuItemScript:function(t){var e=new Craba.UI.MenuItemScript(this.get_page(),t);return t.hasChildren&&t.hasChildren()&&(e.subMenu=t.get_items().get_ID()),e.shortcut=t._shortcut,e},getMenuScript:function(t,e,i){var a=new Craba.UI.MenuScript(this.get_page(),t);return a.set_iD(t.get_ID()),a._isPopup=e,i&&a.addEvent("popup",i),a}},Craba.UI.CustomMenu.registerClass("Craba.UI.CustomMenu",Craba.UI.WebControl,Craba.UI.ITagWithMenuItems),Craba.UI.MenuBar=function(t){Craba.UI.MenuBar.initializeBase(this,[t]),this._lazyLoad=!0,this._mouseHoverShow=!1,this._layoutMode=Sys.LayoutMode.normal,this._groupDirection=Sys.UI.Controls.LayoutDirection.vert,this._layoutDirection=Sys.UI.Controls.LayoutDirection.horz},Craba.UI.MenuBar.prototype={typeName:function(){return"MenuBar"},get_cssClass:function(){return this._layoutMode==Sys.LayoutMode.tree||this._layoutMode==Sys.LayoutMode.treeOnly?"MenuBar vert TreeBar":this._layoutDirection==Sys.UI.Controls.LayoutDirection.horz?"MenuBar":"MenuBar vert"},set_logo:function(t){this._icon=t},set_icon:function(t){this._icon=t},initScript:function(){if(Craba.UI.MenuBar.callBaseMethod(this,"initScript",[]),this.addProp("layoutMode",this._layoutMode,Sys.LayoutMode.normal),this.addProp("groupDirection",this._groupDirection,Sys.UI.Controls.LayoutDirection.vert),this.addProp("layoutDirection",this._layoutDirection,Sys.UI.Controls.LayoutDirection.horz),this._lazyLoad){for(var t=[],e=0,i=this.menuList.length;e<i;e++){var a=this.menuList[e],r=this.getMenuScript(a,!1),s=r.get_createParams();s.id=r.get_ID(),s.items=this.getMenuItems(a.childs),Array.add(t,s)}this.addProp("menus",t)}},set_controlItem:function(t){this.controlItem=t},get_controlItem:function(){return this.controlItem},getMenuItems:function(t){for(var e=[],i=0,a=t.length;i<a;i++){var r=t[i],s=this.getMenuItemScript(r),n=s.get_createParams();n.id=s.get_ID();var o={};o.beginGroup=!!r._beginGroup&&r._beginGroup,o.hidden=!r._visible,o.disabled=!r._enabled,o.icon=r._icon?r._icon:"",r._shortcut&&r._shortcut!=Craba.UI.Shortcut.none&&(o.shortcut=$craba.shortcutToString(r._shortString)),n.renderProps=o,Array.add(e,n)}return e},set_layoutDirection:function(t){this._layoutDirection=this.get_enumTypeValue(Sys.UI.Controls.LayoutDirection,t)},set_groupDirection:function(t){this._groupDirection=this.get_enumTypeValue(Sys.UI.Controls.LayoutDirection,t)},set_layoutMode:function(t){this._layoutMode=this.get_enumTypeValue(Sys.LayoutMode,t)},endRender:function(t){this.invokeBody(t),this._scanMenuItems(null,this.items),t.div().attr("class","MenuBarHandle")._div(),t.div(),t.writeClass("MenuRoots");for(var e=0,i=this.items.length();e<i;e++)this._renderMenuRoot(t,this.items.childs[e]);if(t.writeEnd(),this._text&&this.get_controlItem())throw Error.invalidOperation("Text 和 ControlItem 不能同时使用");if(t.div().attr("class","MenuRootSpacer"),this._text&&t.text(this._text+"&nbsp;"),this.get_controlItem()&&this.controlItem.invokeBody(t),t._div(),t.writeEnd(),!this._lazyLoad)for(var e=0,i=this.menuList.length;e<i;e++)this._renderMenu(t,this.menuList[e])},_renderMenuRoot:function(t,e){var i=e.hasChildren()?"MenuRoot aicon-children":"MenuRoot";i=$skin.joinCssClass(i,e._cssClass),t.div().writeClass(i);var a=e.get_RootID(e);e.set_iD(a);var r=this.get_clientID(e);t.attr("id",r),t.writeVisible(e._visible),e._hint&&t.attr("title",e._hint);var s="MenuRootImage",n=$craba.isIconfont(e._icon);n&&(s=$skin.joinCssClass(s,e._icon)),t.div(),t.writeClass(s),!n&&e._icon&&(t.img(),t.attr("src",this.get_page().getWebUrl(e._icon)),t.writeEnd()),t.writeEnd(),t.div(),t.attr("class","MenuRootCaption"),t.text(e._text),t.writeEnd(),t.writeEnd()},registerScript:function(){Craba.UI.MenuBar.callBaseMethod(this,"registerScript",[]);for(var t=0,e=this.items.childs.length;t<e;t++){var i=this.items.childs[t],a=this.createControl("Craba.UI.MenuRootScript",i);a.copyPropsFrom(i),i.hasChildren()&&a.set_menu(i.get_items().get_ID()),a.registerScript()}this._lazyLoad||this.registerMenuListScript()}},Craba.UI.MenuBar.registerClass("Craba.UI.MenuBar",Craba.UI.CustomMenu),Craba.UI.ControlItem=function(t){Craba.UI.ControlItem.initializeBase(this,[t])},Craba.UI.ControlItem.prototype={doTag:function(t){var e=this.get_parent();if(!e||e.getType()!=Craba.UI.MenuBar)throw Error.invalidOperation("ControlItem 必须放在MenuBar标签中");e.set_controlItem(this)}},Craba.UI.ControlItem.registerClass("Craba.UI.ControlItem",Craba.UI.Control),Craba.UI.PopupMenu=function(t){Craba.UI.PopupMenu.initializeBase(this,[t]),this.supportsLayout=!1},Craba.UI.PopupMenu.prototype={doTag:function(t){if(!this.get_ID())throw Error.invalidOperation("PopupMenu标签必须设置ID属性");this.invokeBody(t),this.items.set_ID(this.get_ID()),this._scanMenuItems(null,this.items),this._renderMenu(t,this.items);for(var e=0,i=this.menuList.length;e<i;e++)this._renderMenu(t,this.menuList[e]);this.registerMenuScript(this.items,!0,this.events.popup),this.registerMenuItemScript(this.items),this.registerMenuListScript()}},Craba.UI.PopupMenu.registerClass("Craba.UI.PopupMenu",Craba.UI.CustomMenu,Craba.UI.ITagWithMenuItems),Craba.UI.MenuItemBaseScript=function(t,e){Craba.UI.MenuItemBaseScript.initializeBase(this),this._id=e.get_ID(),this.menuItem=e,this.page=t,this.Context=t.Context},Craba.UI.MenuItemBaseScript.prototype={initScript:function(){Craba.UI.MenuItemBaseScript.callBaseMethod(this,"initScript"),this.addProp("hint",this.menuItem._hint),this.addProp("text",this.menuItem._text),this.addProp("cssClass",this.menuItem._cssClass),this.addProp("param",this.menuItem._param),this.addProp("showPage",this.menuItem._showPage),this.addProp("navigateUrl",this.menuItem._navigateUrl),this.addProp("enabled",this.menuItem._enabled,!0),this.addProp("groupDirection",this.menuItem._groupDirection),this.addEvent("click",this.menuItem.events.click),this.addEvent("subMenu",this.menuItem.events.subMenu)},dispose:function(){Craba.UI.MenuItemBaseScript.callBaseMethod(this,"dispose")},get_ID:function(){return this._id},copyPropsFrom:function(t){this.set_iD(t.get_ID()),this._hint=t._hint,this._text=t._text,this._cssClass=t._cssClass,this.param=t._param,this._navigateUrl=t._navigateUrl,this._showPage=t._showPage,this.addEvent("click",t.events.click),this.addEvent("subMenu",t.events.subMenu),this._enabled=t._enabled}},Craba.UI.MenuItemBaseScript.registerClass("Craba.UI.MenuItemBaseScript",Craba.UI.ScriptControl),Craba.UI.MenuRootScript=function(t,e){Craba.UI.MenuRootScript.initializeBase(this,[t,e])},Craba.UI.MenuRootScript.prototype={typeName:function(){return"MenuRoot"},set_menu:function(t){this.addProp("menu",t)}},Craba.UI.MenuRootScript.registerClass("Craba.UI.MenuRootScript",Craba.UI.MenuItemBaseScript),Craba.UI.MenuScriptBase=function(){Craba.UI.MenuScriptBase.initializeBase(this)},Craba.UI.MenuScriptBase.prototype={registerScript:function(){this._id=this.get_ID(),Craba.UI.MenuScriptBase.callBaseMethod(this,"registerScript",[this._id,this._id])}},Craba.UI.MenuScriptBase.registerClass("Craba.UI.MenuScriptBase",Craba.UI.ScriptControl),Craba.UI.MenuScript=function(t,e,i,a){Craba.UI.MenuScript.initializeBase(this),this._id=e.get_ID(),this.page=t,this.Context=t.Context,this._isPopup=i,this._onPopup=a},Craba.UI.MenuScript.prototype={initScript:function(){Craba.UI.MenuScript.callBaseMethod(this,"initScript"),this.addProp("isPopup",this._isPopup,!1),this.addEvent("popup",this._onPopup)},dispose:function(){Craba.UI.MenuScript.callBaseMethod(this,"dispose")},get_ID:function(){return this._id},typeName:function(){return"Menu"}},Craba.UI.MenuScript.registerClass("Craba.UI.MenuScript",Craba.UI.MenuScriptBase),Craba.UI.MenuItemScript=function(t,e){Craba.UI.MenuItemScript.initializeBase(this,[t,e])},Craba.UI.MenuItemScript.prototype={initScript:function(){Craba.UI.MenuItemScript.callBaseMethod(this,"initScript"),this.addProp("shortcut",this.shortcut,Craba.UI.Shortcut.none),this.addProp("subMenu",this.subMenu)},dispose:function(){Craba.UI.MenuItemScript.callBaseMethod(this,"dispose")},typeName:function(){return"MenuItem"}},Craba.UI.MenuItemScript.registerClass("Craba.UI.MenuItemScript",Craba.UI.MenuItemBaseScript),Craba.UI.Grid=function(t){Craba.UI.Grid.initializeBase(this,[t]),this._noItem=!0,this.cDefaultGridHeaderHeight=20,this.cDefaultRowNoColumnWidth=40,this.cFooterHeight=21,this.cVScrollBarWidth=17,this.cHScrollBarHeight=17,this.cDefaultPageSize=$settings.GridPagerDefaultPageSize,this.cDefaultRowNoColumnWidth=40,this.cDefaultMouseHoverTime=200,this._checkEnabled=!0,this.rowNoMaxWidth=0,this.maxHeaderLevel=1,this.allColumnWidth=0,this._configID=0,this._mouseHoverTime=this.cDefaultMouseHoverTime,this._outerCss="",this._width=0,this._defaultColumnWidth=85,this._minHeight=100,this._maxHeight=0,this._autoMaxRowCount=-1,this._maxRowCount=-1,this._lazyPageSize=$settings.GridLazyPageSize,this._childLazyPageSize=$settings.TreeGridLazyPageSize,this._rowNoColumnWidth=-1,this._pagerNumericButtonCount=$settings.PagerNumericButtonCount,this._pagerPosition=Craba.UI.PagerPosition.none,this._defaultRowCount=$settings.GridDefaultRowCount,this._pagerPageSize=0,this._frozenColumnCount=0,this._displayRowCount=0,this.columns=[],this._autoHeight=!1,this._showHeader=!0,this._useBodyMenu=!1,this._showFooter=!1,this._showRowNo=!0,this._reportRowNo=!0,this._allowPageCache=!1,this._allowMouseWheel=!0,this._scrollUsePageSize=$settings.GridDefaultScrollUsePageSize,this._reportRowNo=$settings.GridDefaultReportRowNo,this._showQueryTips=$settings.GridDefaultShowQueryTips,this._defaultShowEditor=$settings.GridDefaultShowEditor,this._showLines=$settings.GridDefaultShowLines,this._afterCreateRows=$settings.GridAfterCreateRows,this._hideSelection=!1,this._allowSort=!1,this._clientSort=!1,this._allowFilter=$settings.GridDefaultAllowFilter,this._allowPopup=$settings.GridDefaultAllowPopup,this._allowConfig=$settings.GridDefaultAllowConfig,this._saveConfig=!0,this._allowFrozen=$settings.GridDefaultAllowFrozen,this._allowResize=$settings.GridDefaultAllowResize,this._showRowIndicator=$settings.GridDefaultShowRowIndicator,this._allowCopy=$settings.GridDefaultAllowCopy,this._allowDrag=!1,this._allowMultiSelectedRow=$settings.GridAllowMultiSelectedRow,this._useCustomScrollBar=$settings.UseCustomScrollBar,this._showPrintSummaryText=!0,this._showScrollBar=!0,this._showHScrollBar=!0,this._readOnly=!0,this._modifyOnly=!1,this._autoPagerPageSize=$settings.GridDefaultAutoPagerPageSize,this._autoDefaultRowCount=!1,this._pagerShowAll=!1,this._pagerSaveQueryParams=$settings.GridDefaultSavedQueryParams,this._pagerShowItemCount=!0,this._pagerShowGotoButton=$settings.GridPagerDefaultShowGotoButton,this._pagerShowRefreshButton=$settings.GridPagerDefaultShowRefreshButton,this._pagerDropDownNumericButton=$settings.GridPagerDropDownNumericButton,this._wordWrap=$settings.GridDefaultWordWrap,this._pagerAutoFocus=!0,this._strongFocus=!0,this._pagerHasSummary=!1,this._needRowIndex=!1,this._autoWidth=!1,this._useCustomRendering=!1,this._useEvenRowColor=!0,this._useHoverRowColor=!0,this._useEvenHeaderColor=!1,this._allowCollection=!1,this._allowSubtotal=!1,this._foundColumnExpand=!1,this._defaultRowHeight=$settings.GridDefaultRowHeight,this.cGridSpace=$settings.DefaultGridSpace,this._maxPageSize=$settings.GridPagerDefaultMaxPageSize,this._rowNoColumnCaption=$settings.GridRowNoColumnCaption},Craba.UI.Grid.prototype={dispose:function(){Craba.UI.Grid.callBaseMethod(this,"dispose"),this.columns=null},set_pagerNumericButtonCount:function(t){this._pagerNumericButtonCount=t},set_summaryText:function(t){this._summaryText=t},set_showQueryTips:function(t){this._showQueryTips=t},set_reportRowNo:function(t){this._reportRowNo=t},renderHTML:function(t){t.div(),t.writeVisible(this._visible);var e="",i="GridBlock";this._isSetHeight&&(this.styles.remove("height"),e="height:"+this._height+"px;"),this._isSetWidth&&(this.styles.remove("width"),e+="width:"+this._width+"px;"),this._minHeight>90&&!this._autoHeight&&this._autoMaxRowCount<1&&(e+="min-height:"+this._minHeight+"px;"),this._outerCss&&(e+=this._outerCss),e&&t.writeStyle(e),(this._isSetHeight||this._isSetWidth)&&(i=$skin.joinCssClass(i,"Flex0")),this._cssClass&&(i=$skin.joinCssClass(i,this._cssClass),delete this._cssClass),this._showHeader||(i=$skin.joinCssClass(i,"NoHeader")),t.writeClass(i),this._saveConfig&&(this.configData=this.get_configData()),this._pagerPosition!=Craba.UI.PagerPosition.top&&this._pagerPosition!=Craba.UI.PagerPosition.topAndBottom||(this._pager2=this.createPager(t,"PagerTop","pager2")),this.invokeBody(t),this.doConfigColumns(),this.handleColumnsDisplayOrder(),this.initColumns(),this.allColumnWidth=this.get_allColumnWidth(!1),this._height=this.getDisplayBodyHeight(),this._isSetHeight&&this.styles.set_height(this._height),Craba.UI.Grid.callBaseMethod(this,"renderHTML",[t]),this.doRenderGridBody(t),t.writeEnd(),this._pagerPosition!=Craba.UI.PagerPosition.bottom&&this._pagerPosition!=Craba.UI.PagerPosition.topAndBottom||(this._pager1=this.createPager(t,"PagerBottom","pager1")),t.writeEnd()},registerScript:function(){Craba.UI.Grid.callBaseMethod(this,"registerScript"),this._pager2&&this._pager2.registerScript(),this._pager1&&this._pager1.registerScript()},initScript:function(){Craba.UI.Grid.callBaseMethod(this,"initScript"),this.addProp("visible",this._visible,!0),this.addProp("guid",this.get_guid()),this.addProp("readOnly",this._readOnly,!0),this._readOnly||this.addProp("modifyOnly",this._modifyOnly,!1),this._rowNoColumnWidth>0&&this.addProp("rowNoColumnWidth",this._rowNoColumnWidth),this.addProp("minHeight",this._minHeight,100),this.addProp("maxHeight",this._maxHeight,0),this.addProp("useCustomScrollBar",this._useCustomScrollBar,!1),this.addProp("strongFocus",this._strongFocus&&!this._autoHeight,!0),this.addProp("maxHeaderLevel",this.maxHeaderLevel,1),this.addProp("allowConfig",this._allowConfig,$settings.GridDefaultAllowConfig),this.addProp("reportRowNo",this._reportRowNo,$settings.GridDefaultReportRowNo),this.addProp("allowCopy",this._allowCopy,$settings.GridDefaultAllowCopy),this.addProp("allowFilter",this._allowFilter,$settings.GridDefaultAllowFilter),this.addProp("allowMultiSelectedRow",this._allowMultiSelectedRow,!1),this.addProp("allowResize",this._allowResize,$settings.GridDefaultAllowResize),this.addProp("dropDownNumericButton",this._pagerDropDownNumericButton,$settings.GridPagerDropDownNumericButton),this.addProp("showRowIndicator",this._showRowIndicator,$settings.GridDefaultShowRowIndicator),this.addProp("showScrollBar",this._showScrollBar,!0),this.addProp("allColumnWidth",this.allColumnWidth-(this._showScrollBar?this.cVScrollBarWidth:0),0),this.addProp("showPrintSummaryText",this._showPrintSummaryText,!0),this.Context.variables&&this.addProp("allowCollection",this.Context.variables.____gridDataCollection);var t=this._displayRowCount>0?this._displayRowCount:this.get_defaultRowCount();if(t<=1&&(t=this._pagerPageSize>0?this._pagerPageSize:this.cDefaultPageSize),this.addProp("pageSize",t),this.addProp("defaultRowCount",this._defaultRowCount,10),this.addProp("maxRowCount",this._maxRowCount,-1),this.addProp("bands",this.bands),this.addColumnsScript(),this.pager){var e=this.get_columnExpands();this.addProp("pagerId",this.pager.get_ID()),this.addProp("dataSource",this._dataSource),this.addProp("columnExpands",e)}else this.addProp("dataSource",this._dataSource);this.addProp("autoPagerPageSize",this._autoPagerPageSize,!1),this.addProp("configData",this.configData),this.addProp("designColumnsDisplayOrder",this.designColumnsDisplayOrder),this.addProp("mouseHoverTime",this._mouseHoverTime,this.cDefaultMouseHoverTime),this.addProp("columnExpands",this._columnExpands)},addColumnsScript:function(){var t=null;this._required&&this._dataField&&(t=this.get_page().setValidation(this._dataField,{scriptTypeName:"NotEmptyValidator",required:this._required,rule:this._requiredRule}));for(var e=this.columns.length,i=[],a={},r=0;r<e;r++){var s=this.columns[r];if(a[s.get_name()]=s.xmlNode.Attributes,!s.get_hasChildren()){var n=s.get_createParams();i.push(n),null!=t&&s._checkAddValid(t)}}this.addProp("columnsParams",i),$settings.AllowGspxPropertys&&this.addProp("columnsGspxs",a)},doConfigColumns:function(){},get_columnExpands:function(){return this.Context.gridColumnExpandDatas[this._id]},handleColumnsDisplayOrder:function(){if($settings.GridUseColumnsDisplayOrder){for(var t=this.configData,e=this.designColumnsDisplayOrder=[],i={},a=0,r=this.columns.length;a<r;a++){var s=this.columns[a];if(!s.get_hasChildren()){var n=s.get_name();e.push(n),i[n]=s}}var o=null;this._columnsDisplayOrder&&(o=this._columnsDisplayOrder.split(","));var l=t?t.ColumnsDisplayOrder:null,h=l&&0!=l.length,u=o&&0!=o.length,d=null;if(h||u){if(h&&!u){if(0==(d=this.getColumnDisplayOrders(l,i)).length)return void delete this.configData.ColumnsDisplayOrder}else if(!h&&u){if(null==(d=this.getSpecifiedDisplayOrders(o,i)))return}else if(null==(d=this.getMergedDisplayOrders(o,t,i)))return;this.columns.sort(function(t,i){if(t.get_hasChildren()&&!i.get_hasChildren())return 1;if(t.get_hasChildren()&&i.get_hasChildren())return 0;if(!t.get_hasChildren()&&i.get_hasChildren())return 1;var a=t.get_name(),r=d[a];Object.isUndefinedOrNull(r)&&(r=Array.indexOf(e,a));var s=i.get_name(),n=d[s];return Object.isUndefinedOrNull(n)&&(n=Array.indexOf(e,s)),r-n})}}else this.configData&&delete this.configData.ColumnsDisplayOrder},getColumnDisplayOrders:function(t,e){for(var i={},a=0,r=0,s=t.length;r<s;r++){var n=t[r];null!=e[n]&&(i[n]=a,a++)}return i},set_columnsDisplayOrder:function(t){this._columnsDisplayOrder=t},getSpecifiedDisplayOrders:function(t,e){return t.length>this.columns.length?null:this.getColumnDisplayOrders(t,e)},getMergedDisplayOrders:function(t,e,i){var a=e.ColumnsDisplayOrder,r=null;if(a.length>this.columns.length||t.length>this.columns.length)return null;if(a.length==this.columns.length){var s=this.getColumnDisplayOrders(a,i);return null==s&&delete e.ColumnsDisplayOrder,s}return r=this.mergeDisplayOrders(a,t),this.getColumnDisplayOrders(r,i)},mergeDisplayOrders:function(t,e){for(var i=[],a=0,r=t.length;a<r;a++){s=t[a];i.push(s)}for(var a=0,r=e.length;a<r;a++){var s=e[a];Array.indexOf(i,s)<0&&i.push(s)}return i.length>this.columns.length?null:i},initColumns:function(){for(var t=this.columns.length,e=[],i=0,a=0,r=0;r<t;r++){var s=this.columns[r];if(s._sortOrder!=_Z_157.none&&s._dataField){if(null!=this._defultDataOrder)throw new InvalidOperationException("只支持在一个列设置 SortOrder 属性");this._defultDataOrder={dataFiled:s._dataField,ascending:s._sortOrder==_Z_157.ascending}}if(s.hasName()&&(this._foundColumnExpand=!0),s.get_hasChildren()){var n={index:a,name:s.get_name(),caption:s._caption,reportField:s._reportField};s.parentColumn?n.parentBandIndex=s.parentColumn.index:n.parentBandIndex=-1,e.push(n);for(var o=0,l=s.children.length;o<l;o++){var h=s.children[o];h.bandIndex=a,h.hasName()&&(this._foundColumnExpand=!0)}s.index=a,a++}else s.index=i,i++}this.bands=e},doRenderGridBody:function(t){var e="width:"+this.allColumnWidth+"px;";this._showHeader&&(this.doRenderGridHeader(t,e),this.cDefaultGridHeaderHeight),this._showFooter&&this.cFooterHeight,t.div(),t.attr("class","GridBody"),t._div(),this.doRenderGridFooter(t,e)},doRenderGridHeader:function(t,e){t.div(),t.writeClass("GridHeaderBar"),this.renderHeader(t,e),t.writeEnd()},doRenderGridFooter:function(t,e){this._showFooter&&(t.div(),t.writeClass("GridFooterBar"),this.renderFooter(t,e),t.writeEnd())},renderHeader:function(t,e){var i=1==this.maxHeaderLevel;if(t.table(),t.attr("class","GridHeader"),t.writeTable(0,0,0),t.attr("style",e),i){t.tr(),t.attr("class","GridHeaderRow"),this._showRowNo&&this.renderRowNoHeader(t,1);for(var a=0,r=this.columns.length;a<r;a++)this.columns[a].renderTag(t);this._showScrollBar&&this.renderScrollBarHeader(t,1),t.writeEnd()}else{t.writeBegin("colgroup"),t.attr("id",this.get_clientID()+"_colgroup"),this._showRowNo&&this.writeColWidth(t,this.get_rowNoColumnWidth());for(var a=0,r=this.columns.length;a<r;a++){!(n=this.columns[a]).get_hasChildren()&&n.get_realVisible()&&this.writeColWidth(t,n.get_realWidth())}this._showScrollBar&&this.writeColWidth(t,null),t.writeEnd();for(a=1;a<=this.maxHeaderLevel;a++){t.tr(),t.attr("class","GridHeaderRow"),1==a&&this._showRowNo&&this.renderRowNoHeader(t,this.maxHeaderLevel);for(var s=0,r=this.columns.length;s<r;s++){var n=this.columns[s];n.level==a&&n.renderTag(t)}1==a&&this._showScrollBar&&this.renderScrollBarHeader(t,this.maxHeaderLevel),t.writeEnd()}}t.writeEnd()},renderFooter:function(t,e){if(t.table(),t.attr("class","GridFooter"),t.writeTable(0,0,0),t.attr("style",e),t.tr(),t.attr("class","GridFooterRow"),this._showRowNo){var i=this.get_rowNoColumnWidth();i=Sys.Browser.isIE?i+1:i,this.doRenderFooter(t,!0,i,null!=this._summaryText,this._summaryText,null)}for(var a=0,r=this.columns.length;a<r;a++){var s=this.columns[a];s.get_hasChildren()||this.doRenderFooter(t,s.get_realVisible(),s.get_realWidth(),!0,null,s)}this._showScrollBar&&this.doRenderFooter(t,!0,null,!1,null,null),t.writeEnd(),t.writeEnd()},doRenderFooter:function(t,e,i,a,r,s){t.td(),t.attr("class","GridFooterCell"),1!=e&&t.attr("style","display:none"),t.attr("width",i),a&&(t.attr("align","right"),t.div(),t.attr("class","GridFooterCellText"),t.text(r),t.writeEnd()),t.writeEnd()},renderRowNoHeader:function(t,e){Craba.UI.Column.doRenderHeader(t,null,!0,this.get_rowNoColumnWidth(),"center",this._rowNoColumnCaption,e,1,null,null,!0)},renderScrollBarHeader:function(t,e){Craba.UI.Column.doRenderHeader(t,null,!0,null,"center",null,e,1,null,null,!1)},writeColWidth:function(t,e){t.writeBegin("col"),t.attr("width",e),t.writeEnd()},createPager:function(t,e,i){pager=this.pager=new Craba.UI.Pager(null,this),pager._cssClass=e,pager.set_iD(this.get_ID()+"_"+i),pager.set_dataSource(this._dataSource),pager._target=this.get_ID(),pager._hasSummary=this._showFooter||this._pagerHasSummary;var a=this.get_pagerPageSize();return a>0&&(pager._pageSize=a),pager._showAll=this._pagerShowAll,pager._saveQueryParams=this._pagerSaveQueryParams,pager._showItemCount=this._pagerShowItemCount,pager._numericButtonCount=this._pagerNumericButtonCount,pager._showRefreshButton=this._pagerShowRefreshButton,pager._showGotoButton=this._pagerShowGotoButton,pager._maxPageSize=this._maxPageSize,pager._autoFocus=this._pagerAutoFocus,pager._summaryLabel=this._pagerSummaryLabel,pager.renderHTML(t),pager},set_pagerHasSummary:function(t){this._pagerHasSummary=t},set_pagerDropDownNumericButton:function(t){this._pagerDropDownNumericButton=t},set_maxPageSize:function(t){this._maxPageSize=t},set_pager:function(t){this._pagerPosition=this.get_enumTypeValue(Craba.UI.PagerPosition,t)},getDisplayBodyHeight:function(){var t=this._height;return t?t-=this.cGridSpace:t=this.get_nonBodyHeight()+((this._displayRowCount>0?this._displayRowCount:this._defaultRowCount)*this._defaultRowHeight+1),t>this._minHeight?t:this._minHeight},get_nonBodyHeight:function(){var t=this.cHScrollBarHeight,e=this._showFooter?this.cFooterHeight:0;return this.cDefaultGridHeaderHeight+e+t},set_minHeight:function(t){this._minHeight=t},set_pagerShowItemCount:function(t){this._pagerShowItemCount=t},set_rowNoColumnWidth:function(t){this._rowNoColumnWidth=t},get_rowNoColumnWidth:function(){var t=this._rowNoColumnWidth&&this._rowNoColumnWidth>0?this._rowNoColumnWidth:this.cDefaultRowNoColumnWidth;return this.get_columnWidth("rowNo",t,this._allowResize)},get_scrollBarColumnWidth:function(){return this.cVScrollBarWidth-1},get_defaultRowCount:function(){return this._autoDefaultRowCount?this.get_pagerPageSize():this._defaultRowCount},get_pagerPageSize:function(){if(this.configData&&this.configData.PageSize>0)return this.configData.PageSize;if(this._autoPagerPageSize||this._autoDefaultRowCount){var t=this._height;if(this._isSetHeight){var e=t-this.get_nonBodyHeight()-1-this.cHScrollBarHeight;this._allowFilter&&(e-=30);var i=parseInt((e+1)/this._defaultRowHeight);return i>1?i:2}}return this._pagerPageSize},set_dataSource:function(t){this._dataSource=t},set_pagerShowAll:function(t){this._pagerShowAll=t},set_pagerSaveQueryParams:function(t){this._pagerSaveQueryParams=t},set_pagerShowRefreshButton:function(t){this._pagerShowRefreshButton=t},set_pagerShowGotoButton:function(t){this._pagerShowGotoButton=t},set_pagerSummaryLabel:function(t){this._pagerSummaryLabel=t},set_autoDefaultRowCount:function(t){this._autoDefaultRowCount=t},set_displayRowCount:function(t){this._displayRowCount=t},set_pagerPageSize:function(t){this._pagerPageSize=t},get_allColumnWidth:function(t){for(var e=0,i=0,a=this.columns.length;i<a;i++){var r=this.columns[i];this._readOnly&&Craba.UI.RowDeleteColumn.isInstanceOfType(r)&&(r._visible=!1),r.get_realVisible()&&!r.get_hasChildren()&&(e+=t?r.get_designWidth():r.get_realWidth())}return(this._showRowNo?this.get_rowNoColumnWidth():0)+e+(this._showScrollBar?this.cVScrollBarWidth:0)},get_columnVisible:function(t,e){return null!=this.configData&&null!=this.configData.ColumnsVisible&&null!=t&&this.configData.ColumnsVisible[t]!==undefined?this._allowConfig?this.configData.ColumnsVisible[t]:(this.configData.ColumnsVisible[t]=e,e):e},get_columnWidth:function(t,e,i){if(this._allowResize&&i&&null!=this.configData&&null!=this.configData.ColumnsWidth&&null!=t&&this.configData.ColumnsWidth[t]){var a=parseInt(this.configData.ColumnsWidth[t]);if(a>0)return a}return e},set_autoPagerPageSize:function(t){this._autoPagerPageSize=t},set_pagerAutoFocus:function(t){this._pagerAutoFocus=t},get_defaultColumnWidth:function(){return this._defaultColumnWidth},typeName:function(){return"Grid"},get_columnCaption:function(t,e){if(null!=this.configData&&null!=this.configData.ColumnsCaption&&null!=t){var i=this.configData.ColumnsCaption[t];if(i)return i}return e},addColumn:function(t){this.columns.push(t),t.set_grid(this)},get_cssClass:function(){return this._wordWrap?"Grid":"Grid NoWordWrap"},setMaxLevel:function(t){this.maxHeaderLevel<t&&(this.maxHeaderLevel=t)}},Craba.UI.Grid.registerClass("Craba.UI.Grid",Craba.UI.WebControl),Craba.UI.TreeGrid=function(t){Craba.UI.TreeGrid.initializeBase(this,[t]),this._strongFocus=!1,this._allowCheckRelation=!0},Craba.UI.TreeGrid.prototype={typeName:function(){return"TreeGrid"}},Craba.UI.TreeGrid.registerClass("Craba.UI.TreeGrid",Craba.UI.Grid),Craba.UI.FzDressGrid=function(t){Craba.UI.FzDressGrid.initializeBase(this,[t])},Craba.UI.FzDressGrid.prototype={typeName:function(){return"FzDressGrid"},initScript:function(){Craba.UI.FzDressGrid.callBaseMethod(this,"initScript"),this.addProp("displayMode",this._displayMode,Sys.Dress.DressDisplayMode.detail)},set_displayMode:function(t){this._displayMode=this.get_enumTypeValue(Sys.Dress.DressDisplayMode,t)}},Craba.UI.FzDressGrid.registerClass("Craba.UI.FzDressGrid",Craba.UI.Grid),Craba.UI.FzDressTreeGrid=function(t){Craba.UI.FzDressTreeGrid.initializeBase(this,[t])},Craba.UI.FzDressTreeGrid.prototype={typeName:function(){return"FzDressTreeGrid"}},Craba.UI.FzDressTreeGrid.registerClass("Craba.UI.FzDressTreeGrid",Craba.UI.FzDressGrid),Craba.UI.PagerBase=function(t,e){Craba.UI.PagerBase.initializeBase(this,[t]),this._pageSize=$settings.GridPagerDefaultPageSize,this._maxPageSize=$settings.GridPagerDefaultMaxPageSize,this._saveQueryParams=$settings.GridDefaultSavedQueryParams,this._numericButtonCount=10,this._itemCountCache=-1},Craba.UI.PagerBase.prototype={endRender:function(t){t.writeEnd()},initScript:function(){Craba.UI.PagerBase.callBaseMethod(this,"initScript"),this.addProp("target",this._target),this.addProp("pageSize",this._pageSize,10),this.addProp("numericButtonCount",this._numericButtonCount,10),this._dataSource&&this.addProp("itemCount",this.get_dataSourceItemCount(),0)}},Craba.UI.PagerBase.registerClass("Craba.UI.PagerBase",Craba.UI.WebControl),Craba.UI.Pager=function(t,e){Craba.UI.Pager.initializeBase(this,[t]),this.owner=e,e&&(this._setPage(e.get_page()),this.Context=e.Context),this._hasSummary=!1,this._showItemCount=!0,this._showAll=!1,this._showRefreshButton=$settings.GridPagerDefaultShowRefreshButton,this._showGotoButton=$settings.GridPagerDefaultShowGotoButton,this._autoFocus=!0,this._width=0},Craba.UI.Pager.prototype={get_cssClass:function(){return"Pager"},typeName:function(){return"Pager"},initScript:function(){Craba.UI.Pager.callBaseMethod(this,"initScript"),this.addProp("showItemCount",this._showItemCount,!0),this.addProp("showRefreshButton",this._showRefreshButton,$settings.GridPagerDefaultShowRefreshButton),this.addProp("showGotoButton",this._showGotoButton,$settings.GridPagerDefaultShowGotoButton),this.addProp("maxPageSize",this._maxPageSize,$settings.GridPagerDefaultMaxPageSize),this.addProp("showAll",this._showAll,!1);var t=this.get_hasDataSource();(t||this._dataSource)&&(this.addProp("hasSummary",this._hasSummary&&t,!1),this.addProp("hasDataSource",t,!1)),this.addProp("summaryLabel",this._summaryLabel),this.addProp("follow",this._follow),this.addProp("autoFocus",this._autoFocus,!0)},set_dataSource:function(t){this._dataSource=t},get_dataSourceItemCount:function(){var t=this.Context.itemCountDatas[this.get_ID()];return t!==undefined?t:this._dataSource.length},get_hasDataSource:function(){var t=this.Context.itemCountDatas[this.get_ID()]!==undefined,e=this.owner&&!!this.owner._bindPagerDataSource;return t||e}},Craba.UI.Pager.registerClass("Craba.UI.Pager",Craba.UI.PagerBase),Craba.UI.ListPager=function(t,e){Craba.UI.ListPager.initializeBase(this,[t]),this._listView=e,this._setPage(e.get_page()),this.Context=e.Context},Craba.UI.ListPager.prototype={get_cssClass:function(){return"Pager ListPager"},typeName:function(){return"ListPager"},get_dataSourceItemCount:function(){var t=this.Context.itemCountDatas[this.get_ID()];return t!==undefined?t:this._dataSource.length},initScript:function(){Craba.UI.ListPager.callBaseMethod(this,"initScript"),this.addProp("maxPageSize",this._maxPageSize,0)}},Craba.UI.ListPager.registerClass("Craba.UI.ListPager",Craba.UI.PagerBase),Craba.UI.Column=function(t){Craba.UI.Column.initializeBase(this,[t]),this._width=90,this._minWidth=50,this.index=-1,this.bindIndex=-1,this.level=1,this._delayTime=100,this._sortOrder=_Z_157.none,this._defaultAlign="",this._defaultHeader="",this._textAlign=_Z_250.left,this._headerAlign=_Z_250.left,this._summaryKind=_Z_156.none,this._reportVisible=!1,this._reportShowFooter=!0,this._readOnly=!1,this._mergeSameRow=!1,this._allowConfig=!0,this._allowResize=!0,this._allowFilter=!0,this._allowHTML=!1,this._tabStop=!0,this._allowStretch=!1,this._allowFrozen=!0,this._showImage=!1,this._allowSort=!0,this.children=[]},Craba.UI.Column.prototype={dispose:function(){Craba.UI.Column.callBaseMethod(this,"dispose"),this.children=null},updateLang:function(t){this.setAttr("Caption",t)},doTag:function(t){var e=this.get_parent(),i=Craba.UI.Column.isInstanceOfType(e);if(!Craba.UI.Grid.isInstanceOfType(e)&&!i)throw Error.invalidOperation("请把 Column 标签放到 Grid 或 Column 标签内");i?(e.addChild(this),this.grid=e.grid,this.level=e.level+1,this.grid.setMaxLevel(this.level)):(this.grid=e,this.level=1),this.grid.addColumn(this),this.invokeBody(t)},_checkAddValid:function(t){if(this._required&&this._dataField){var e={dataField:this._dataField,attribute:{scriptTypeName:"NotEmptyValidator",required:this._required,rule:this._requiredRule}};t.childNodes.push(e)}},addChild:function(t){t.parentColumn=this,this.children.push(t)},initScript:function(){Craba.UI.Column.callBaseMethod(this,"initScript"),this.addProp("name",this.get_name()),this.addProp("designCaption",this._caption?this._caption:this._dataField),this.addProp("designReportCaption",this._reportCaption),this.addProp("reportShowFooter",this._reportShowFooter,!0),this.addProp("dataField",this._dataField),this.addProp("designWidth",this.get_designWidth(),0),this.addProp("designVisible",this._visible,!0),this.addProp("readOnly",this._readOnly,!1),this.addProp("enabled",this._enabled,!0),this.addProp("headerAlign",this.get_internalGetHeaderAlign(),this._defaultHeader),this.addProp("textAlign",this.get_internalGetTextAlign(),this._defaultAlign),this.addProp("allowConfig",this._allowConfig,!0),this.addProp("allowResize",this._allowResize,!0),this.addProp("allowFilter",this._allowFilter,!0),this.addProp("filterType",this._filterType,_Z_73.like),this.addProp("sortOrder",this._sortOrder,_Z_157.none),this.addProp("summaryKind",this._summaryKind,_Z_156.none),this.addProp("bandIndex",this.bandIndex,-1),this.addProp("cssClass",this._cssClass)},set_icon:function(t){this._icon=t},renderTag:function(t){var e,i=!this.get_hasChildren(),a=this.grid.get_clientID()+(i?"_column":"_band"),r=this.index>=0?a+this.index:"",s=this.get_realVisible(),n=i?this.grid.maxHeaderLevel-this.level+1:1;i?e=1:0==(e=this.get_realVisibleChildCount())&&(s=!1);!$craba.isIconfont(this._icon)&&this._icon&&(this._icon=this.get_page().getWebUrl(this._icon)),Craba.UI.Column.doRenderHeader(t,r,s,this.get_realWidth(),this.get_internalGetHeaderAlign(),this.get_realCaption(),n,e,this._icon,this._headerCssClass,!0)},set_grid:function(t){this.grid=t},set_headerCssClass:function(t){this._headerCssClass=t},get_realVisibleChildCount:function(){for(var t=0,e=0,i=this.children.length;e<i;e++){var a=this.children[e];a.get_realVisible()&&(a.get_hasChildren()?t+=a.get_realVisibleChildCount():t++)}return t},get_realCaption:function(){return this.grid.get_columnCaption(this.get_name(),this._caption)},get_internalGetHeaderAlign:function(){return Craba.UI.Common.HAlignToString(this._headerAlign,!0)},get_internalGetTextAlign:function(){return Craba.UI.Common.HAlignToString(this._textAlign,!0)},set_width:function(t){this._designWidth=t,this._width=t},set_dataField:function(t){this._dataField=t,this.addProp("dataField",t)},set_caption:function(t){this._caption=t,this._designCaption=t,this.addProp("caption",t),this.addProp("designCaption",t)},hasName:function(){return null!=this.get_name()},get_name:function(){var t=this._name;if(t||(t=this.get_defaultName()),!t){if(!this._caption)throw Error.invalidOperation("Column缺少DataField 或 Caption 或 Name属性");t="column_"+this._caption}return t},get_defaultName:function(){return this._dataField},get_realWidth:function(){if(this.get_hasChildren()){for(var t=0,e=0,i=this.children.length;e<i;e++){var a=this.children[e];a.get_realVisible()&&(t+=a.get_realWidth())}return t}return this.grid.get_columnWidth(this.get_name(),this.get_designWidth(),this._allowResize)},get_hasChildren:function(){return this.children.length>0},get_designWidth:function(){if(!this.get_hasChildren())return this._width&&parseInt(this._width)>0?this._width:this.grid.get_defaultColumnWidth();throw Error.invalidOperation("父列不支持取 DesignWidth")},get_headerAlign:function(){return this.get_hasChildren()?_Z_250.center:$settings.GridColumnDefaultHeaderAlignCache},set_headerAlign:function(t){this._headerAlign=this.get_enumTypeValue(_Z_250,t)},get_textAlign:function(){return this._textAlign},set_textAlign:function(t){this._textAlign=this.get_enumTypeValue(_Z_250,t)},set_summaryKind:function(t){this._summaryKind=this.get_enumTypeValue(_Z_156,t)},set_filterType:function(t){this._filterType=this.get_enumTypeValue(_Z_73,t)},set_sortOrder:function(t){this._sortOrder=this.get_enumTypeValue(_Z_157,t)},set_visible:function(t){this._visible=t},get_realVisible:function(){return this.grid.get_columnVisible(this.get_name(),this._visible)},set_reportCaption:function(t){this.addProp("designReportCaption",t)}},Craba.UI.Column.registerClass("Craba.UI.Column",Craba.UI.ScriptControl),Craba.UI.Column.doRenderHeader=function(t,e,i,a,r,s,n,o,l,h,u){t.td(),t.attr("id",e),t.attr("class",$skin.joinCssClass("GridHeaderCaption",h)),i||t.attr("style","display:none"),n<=1&&o<=1&&null!==a&&t.attr("width",a),t.attr("align",r),n>1&&t.attr("rowspan",n),o>1&&t.attr("colspan",o);var d=u?"GridHeaderCaptionText":"",c=$craba.isIconfont(l);c&&(d=$skin.joinCssClass(d,l)),t.div(),t.attr("class",d),t.text(s||"&nbsp;"),l&&!c&&t.img({src:l})._img(),t._div(),t.writeEnd()},Craba.UI.TextColumn=function(t){Craba.UI.TextColumn.initializeBase(this,[t]),this._maxLength=0,this._textWrap=!1,this._maxByteLength=0},Craba.UI.TextColumn.prototype={typeName:function(){return"TextColumn"}},Craba.UI.TextColumn.registerClass("Craba.UI.TextColumn",Craba.UI.Column),Craba.UI.ImageColumn=function(t){Craba.UI.ImageColumn.initializeBase(this,[t]),this._readOnly=!0,this._useResource=!0,this._textAlign=_Z_250.center,this._headerAlign=_Z_250.center},Craba.UI.ImageColumn.prototype={initScript:function(){Craba.UI.ImageColumn.callBaseMethod(this,"initScript"),this.addProp("useResource",this._useResource,!0),this._image&&this.addProp("imageUrl",this.get_page().getWebUrl(this._image)),this._hoverImage&&this.addProp("hoverImageUrl",this.get_page().getWebUrl(this._hoverImage)),delete this.properties.image},typeName:function(){return"ImageColumn"}},Craba.UI.ImageColumn.registerClass("Craba.UI.ImageColumn",Craba.UI.Column),Craba.UI.ImageListColumn=function(t){Craba.UI.ImageListColumn.initializeBase(this,[t]),this._textAlign=_Z_250.center,this._headerAlign=_Z_250.center},Craba.UI.ImageListColumn.prototype={initScript:function(){Craba.UI.ImageListColumn.callBaseMethod(this,"initScript"),this._dataSource&&this.addProp("items",this._dataSource),this.addProp("dataValueField",this._dataValueField),this.addProp("dataTextField",this._dataTextField),this.addProp("dataHintField",this._dataHintField)},set_dataSource:function(t){this._dataSource=t},typeName:function(){return"ImageListColumn"}},Craba.UI.ImageListColumn.registerClass("Craba.UI.ImageListColumn",Craba.UI.Column),Craba.UI.GraphicColumn=function(t){Craba.UI.GraphicColumn.initializeBase(this,[t]),this._readOnly=!0},Craba.UI.GraphicColumn.prototype={typeName:function(){return"GraphicColumn"}},Craba.UI.GraphicColumn.registerClass("Craba.UI.GraphicColumn",Craba.UI.TextColumn),Craba.UI.CheckBoxColumn=function(t){Craba.UI.CheckBoxColumn.initializeBase(this,[t]),this._headerAlign=_Z_250.center,this._textAlign=_Z_250.center,this._displayNull=!0},Craba.UI.CheckBoxColumn.prototype={initScript:function(){Craba.UI.CheckBoxColumn.callBaseMethod(this,"initScript"),this.addProp("textChecked",this._textToHtml(this._textChecked)),this.addProp("textUnchecked",this._textToHtml(this._textUnchecked))},_textToHtml:function(t){return null!=t?t.Length>0?t:"&nbsp;":t},typeName:function(){return"CheckBoxColumn"}},Craba.UI.CheckBoxColumn.registerClass("Craba.UI.CheckBoxColumn",Craba.UI.Column),Craba.UI.MultiSelectColumn=function(t){Craba.UI.MultiSelectColumn.initializeBase(this,[t]),this._showHeaderCheckBox=$settings.GridMultiSelectColumnDefaultShowHeaderCheckBox,this._allowConfig=!1,this._dataField="__selected"},Craba.UI.MultiSelectColumn.prototype={initScript:function(){Craba.UI.MultiSelectColumn.callBaseMethod(this,"initScript"),this.addProp("allowConfig",this._allowConfig),this.addProp("showHeaderCheckBox",this._showHeaderCheckBox,$settings.GridMultiSelectColumnDefaultShowHeaderCheckBox)},typeName:function(){return"MultiSelectColumn"}},Craba.UI.MultiSelectColumn.registerClass("Craba.UI.MultiSelectColumn",Craba.UI.CheckBoxColumn),Craba.UI.RowDeleteColumn=function(t){Craba.UI.RowDeleteColumn.initializeBase(this,[t]),this._textAlign=_Z_250.center,this._width=40,this._readOnly=!0,this._tabStop=!1,this._name="__rowDelete",this._displayNull=!0},Craba.UI.RowDeleteColumn.prototype={typeName:function(){return"RowDeleteColumn"}},Craba.UI.RowDeleteColumn.registerClass("Craba.UI.RowDeleteColumn",Craba.UI.Column),Craba.UI.HyperLinkColumn=function(t){Craba.UI.HyperLinkColumn.initializeBase(this,[t]),this._readOnly=!0},Craba.UI.HyperLinkColumn.prototype={typeName:function(){return"HyperLinkColumn"}},Craba.UI.HyperLinkColumn.registerClass("Craba.UI.HyperLinkColumn",Craba.UI.Column),Craba.UI.NumberColumn=function(t){Craba.UI.NumberColumn.initializeBase(this,[t]),this._defaultAlign="right",this._defaultHeader="center",this._textAlign=_Z_250.right,this._headerAlign=_Z_250.center,this._filterType=_Z_73.range,this._displayThousandSeperator=$settings.DisplayThousandSeperator,this._showCalculator=$settings.NumberEditDefaultShowCalculator,this._displayEmptyForZero=$settings.DisplayEmptyForZero,this._displayZeroToDigits=$settings.DisplayZeroToDigits,this._decimalDigits=0,this._decimalPrecision=0,this._decimalScale=-1,this._stepButton=!1,this._formatNumber=$settings.NumberColumnFormatNumber,this._minValue=Number.MIN_SAFE_INTEGER,this._maxValue=Number.MAX_SAFE_INTEGER},Craba.UI.NumberColumn.prototype={initScript:function(){Craba.UI.NumberColumn.callBaseMethod(this,"initScript"),Craba.UI.NumberEdit.setProp(this),this.addProp("allowResize",this._allowResize,!0),this.addProp("displayEmptyForZero",this._displayEmptyForZero,!1),this.addProp("displayThousandSeperator",this._displayThousandSeperator,!1),this.addProp("showCalculator",this._showCalculator,$settings.NumberEditDefaultShowCalculator)},get_decimalPrecision:function(){return this._decimalPrecision>0?this._decimalPrecision:$settings.DecimalPrecision},get_decimalScale:function(){return this._decimalScale>=0?this._decimalScale:$settings.DecimalScale},typeName:function(){return"NumberColumn"},set_numberType:function(t){this._numberType=this.get_numberEnumTypeValue(_Z_28,t)}},Craba.UI.NumberColumn.registerClass("Craba.UI.NumberColumn",Craba.UI.Column),Craba.UI.FiscalColumn=function(t){Craba.UI.FiscalColumn.initializeBase(this,[t]),this._cellWidth=$settings.FiscalColumnCellWidth,this._maxValueLength=11,this._borderWidth=1,this._fullInput=!1},Craba.UI.FiscalColumn.prototype={initialize:function(){Craba.UI.FiscalColumn.callBaseMethod(this,"initialize"),this._width=this._maxValueLength*(this._cellWidth+this._borderWidth)},set_cellWidth:function(t){this._cellWidth=t},typeName:function(){return"FiscalColumn"}},Craba.UI.FiscalColumn.registerClass("Craba.UI.FiscalColumn",Craba.UI.NumberColumn),Craba.UI.PercentColumn=function(t){Craba.UI.PercentColumn.initializeBase(this,[t])},Craba.UI.PercentColumn.prototype={typeName:function(){return"PercentColumn"}},Craba.UI.PercentColumn.registerClass("Craba.UI.PercentColumn",Craba.UI.NumberColumn),Craba.UI.DateColumn=function(t){Craba.UI.DateColumn.initializeBase(this,[t]),this._valueType=_Z_59._default,this._filterType=_Z_73.range,this._selectOnly=!1},Craba.UI.DateColumn.prototype={initScript:function(){Craba.UI.DateColumn.callBaseMethod(this,"initScript"),this.addProp("valueType",this._valueType,_Z_59._default)},typeName:function(){return"DateColumn"},set_valueType:function(t){this._valueType=this.get_numberEnumTypeValue(_Z_59,t)}},Craba.UI.DateColumn.registerClass("Craba.UI.DateColumn",Craba.UI.Column),Craba.UI.DateTimeColumn=function(t){Craba.UI.DateTimeColumn.initializeBase(this,[t])},Craba.UI.DateTimeColumn.prototype={typeName:function(){return"DateTimeColumn"}},Craba.UI.DateTimeColumn.registerClass("Craba.UI.DateTimeColumn",Craba.UI.DateColumn),Craba.UI.MemoColumn=function(t){Craba.UI.MemoColumn.initializeBase(this,[t])},Craba.UI.MemoColumn.prototype={typeName:function(){return"MemoColumn"}},Craba.UI.MemoColumn.registerClass("Craba.UI.MemoColumn",Craba.UI.Column),Craba.UI.DynamicColumn=function(t){Craba.UI.DynamicColumn.initializeBase(this,[t])},Craba.UI.DynamicColumn.prototype={typeName:function(){return"DynamicColumn"}},Craba.UI.DynamicColumn.registerClass("Craba.UI.DynamicColumn",Craba.UI.Column),Craba.UI.ButtonColumn=function(t){Craba.UI.ButtonColumn.initializeBase(this,[t])},Craba.UI.ButtonColumn.prototype={typeName:function(){return"ButtonColumn"}},Craba.UI.ButtonColumn.registerClass("Craba.UI.ButtonColumn",Craba.UI.Column),Craba.UI.ListBaseColumn=function(t){Craba.UI.ListBaseColumn.initializeBase(this,[t]),this._readOnly=!0,this._displayNull=!1,this._textAlign=_Z_250.center,this._headerAlign=_Z_250.center,this._layoutDirection=Sys.UI.Controls.LayoutDirection.horz},Craba.UI.ListBaseColumn.prototype={initScript:function(){Craba.UI.ListBaseColumn.callBaseMethod(this,"initScript"),this.addProp("layoutDirection",this._layoutDirection,Sys.UI.Controls.LayoutDirection.horz)},set_layoutDirection:function(t){this._layoutDirection=this.get_enumTypeValue(Sys.UI.Controls.LayoutDirection,t)}},Craba.UI.ListBaseColumn.registerClass("Craba.UI.ListBaseColumn",Craba.UI.Column),Craba.UI.DynamicButtonColumn=function(t){Craba.UI.DynamicButtonColumn.initializeBase(this,[t])},Craba.UI.DynamicButtonColumn.prototype={typeName:function(){return"DynamicButtonColumn"}},Craba.UI.DynamicButtonColumn.registerClass("Craba.UI.DynamicButtonColumn",Craba.UI.ListBaseColumn),Craba.UI.IconColumn=function(t){Craba.UI.IconColumn.initializeBase(this,[t])},Craba.UI.IconColumn.prototype={typeName:function(){return"IconColumn"}},Craba.UI.IconColumn.registerClass("Craba.UI.IconColumn",Craba.UI.ListBaseColumn),Craba.UI.CheckBoxListColumn=function(t){Craba.UI.CheckBoxListColumn.initializeBase(this,[t]),this._readOnly=!1,this._showHeaderCheckBox=$settings.GridMultiSelectColumnDefaultShowHeaderCheckBox},Craba.UI.CheckBoxListColumn.prototype={typeName:function(){return"CheckBoxListColumn"}},Craba.UI.CheckBoxListColumn.registerClass("Craba.UI.CheckBoxListColumn",Craba.UI.ListBaseColumn),Craba.UI.ProgressColumn=function(t){Craba.UI.ProgressColumn.initializeBase(this,[t]),this._width=150},Craba.UI.ProgressColumn.prototype={typeName:function(){return"ProgressColumn"},initScript:function(){Craba.UI.ProgressColumn.callBaseMethod(this,"initScript")}},Craba.UI.ProgressColumn.registerClass("Craba.UI.ProgressColumn",Craba.UI.Column),Craba.UI.ExpandColumn=function(t){Craba.UI.ExpandColumn.initializeBase(this,[t]),this._allowFilter=!1,this._allowSort=!1,this._textAlign=_Z_250.center,this._dataField="__expand",this._expandAll=!1,this._allowMultiExpand=!1},Craba.UI.ExpandColumn.prototype={initScript:function(){Craba.UI.ExpandColumn.callBaseMethod(this,"initScript"),this.addProp("allowMultiExpand",this._allowMultiExpand)},get_name:function(){return this._displayField?this._displayField:Craba.UI.ExpandColumn.callBaseMethod(this,"get_name")},typeName:function(){return"ExpandColumn"}},Craba.UI.ExpandColumn.registerClass("Craba.UI.ExpandColumn",Craba.UI.Column),Craba.UI.IMStatusColumn=function(t){Craba.UI.IMStatusColumn.initializeBase(this,[t]),this._readOnly=!0,this._headerAlign=_Z_250.center},Craba.UI.IMStatusColumn.prototype={initScript:function(){Craba.UI.IMStatusColumn.callBaseMethod(this,"initScript")},typeName:function(){return"IMStatusColumn"}},Craba.UI.IMStatusColumn.registerClass("Craba.UI.IMStatusColumn",Craba.UI.Column),Craba.UI.SelectorColumn=function(t){Craba.UI.SelectorColumn.initializeBase(this,[t]),this._selectorWidth=0,this._selectorHeight=0,this._selectOnly=!1,this._allowHandInput=!1,this._buttonVisible=!0,this._maxByteLength=0,this._clickNotFocus=!1,this._showMDI=!1},Craba.UI.SelectorColumn.prototype={initScript:function(){Craba.UI.SelectorColumn.callBaseMethod(this,"initScript"),this.addProp("displayField",this.get_displayField()),this.addProp("selectorPage",this.get_page().convertUrl(this._selectorPage)),this.addProp("shortcut",this._shortcut,Craba.UI.Shortcut.none),this.get_hasSelector()&&(this._selector.setPage(this.get_page()),this._selector.initScript(),this.addProp("selectorType",this._selector.get_scriptFullName()))},typeName:function(){return"SelectorColumn"},get_displayField:function(){var t=this._displayField;return t||!this.get_hasSelector()||this._selector.get_defaultDisplayField()||(t=this._dataField+"."+this._selector.get_defaultDisplayField()),t},get_defaultName:function(){return this._dataField+(this._displayField?"_"+this._displayField:"")},get_hasSelector:function(){return null!=this._selector}},Craba.UI.SelectorColumn.registerClass("Craba.UI.SelectorColumn",Craba.UI.Column),Craba.UI.DropDownColumnBase=function(t){Craba.UI.DropDownColumnBase.initializeBase(this,[t]),this._items=[],this._dropDownStyle=_Z_24.dropDown},Craba.UI.DropDownColumnBase.prototype={initScript:function(){if(Craba.UI.DropDownColumnBase.callBaseMethod(this,"initScript"),this._dataSource)this.addProp("items",this._dataSource);else{var t=Craba.UI.Common.ItemsToList(this._items,this._listItems,this);t.length>0&&(this._dataValueField="value",this._dataTextField="text"),this.addProp("items",t)}this.addProp("dropDownStyle",this._dropDownStyle,_Z_24.dropDown),this.addProp("dataValueField",this._dataValueField),this.addProp("dataTextField",this._dataTextField),this.addProp("valueType",this._valueType,_Z_59._default)},set_listItems:function(t){this._listItems=t},get_items:function(){return this._items},set_dataSource:function(t){this._dataSource=t},set_dataValueField:function(t){this._dataValueField=t},set_dataTextField:function(t){this._dataTextField=t},set_valueType:function(t){this._valueType=this.get_numberEnumTypeValue(_Z_59,t)},set_dropDownStyle:function(t){this._dropDownStyle=this.get_enumTypeValue(_Z_24,t)}},Craba.UI.DropDownColumnBase.registerClass("Craba.UI.DropDownColumnBase",Craba.UI.Column),Craba.UI.ColorDropDownColumn=function(t){Craba.UI.ColorDropDownColumn.initializeBase(this,[t])},Craba.UI.ColorDropDownColumn.prototype={typeName:function(){return"ColorDropDownColumn"}},Craba.UI.ColorDropDownColumn.registerClass("Craba.UI.ColorDropDownColumn",Craba.UI.DropDownColumnBase),Craba.UI.DropDownColumn=function(t){Craba.UI.DropDownColumn.initializeBase(this,[t]),this._filterType=_Z_73.equals},Craba.UI.DropDownColumn.prototype={typeName:function(){return"DropDownColumn"}},Craba.UI.DropDownColumn.registerClass("Craba.UI.DropDownColumn",Craba.UI.DropDownColumnBase),Craba.UI.DropDownCheckColumn=function(t){Craba.UI.DropDownCheckColumn.initializeBase(this,[t]),this._filterType=_Z_73.equals},Craba.UI.DropDownCheckColumn.prototype={typeName:function(){return"DropDownCheckColumn"}},Craba.UI.DropDownCheckColumn.registerClass("Craba.UI.DropDownCheckColumn",Craba.UI.DropDownColumnBase),Craba.UI.SwitchButtonColumn=function(t){Craba.UI.SwitchButtonColumn.initializeBase(this,[t]),this._checkedValue=!0,this._textAlign=_Z_250.center,this._headerAlign=_Z_250.center,this._filterType=_Z_73.equals},Craba.UI.SwitchButtonColumn.prototype={typeName:function(){return"SwitchButtonColumn"}},Craba.UI.SwitchButtonColumn.registerClass("Craba.UI.SwitchButtonColumn",Craba.UI.Column),Craba.UI.ImageDropDownColumn=function(t){Craba.UI.ImageDropDownColumn.initializeBase(this,[t]),this._imageWidth=0,this._imageHeight=0,this._width=42},Craba.UI.ImageDropDownColumn.prototype={typeName:function(){return"ImageDropDownColumn"},set_imageWidth:function(t){this._width=t+26}},Craba.UI.ImageDropDownColumn.registerClass("Craba.UI.ImageDropDownColumn",Craba.UI.DropDownColumnBase),Craba.UI.SearchEditColumn=function(t){Craba.UI.SearchEditColumn.initializeBase(this,[t]),this._interval=500},Craba.UI.SearchEditColumn.prototype={typeName:function(){return"SearchEditColumn"},initScript:function(){Craba.UI.SearchEditColumn.callBaseMethod(this,"initScript"),this.addProp("targetGrid",this._grid)}},Craba.UI.SearchEditColumn.registerClass("Craba.UI.SearchEditColumn",Craba.UI.Column),Craba.UI.ClientPanelBase=function(t){Craba.UI.ClientPanelBase.initializeBase(this,[t])},Craba.UI.ClientPanelBase.prototype={initialize:function(){this.set_iD("__mainPanel"),Craba.UI.ClientPanelBase.callBaseMethod(this,"initialize")}},Craba.UI.ClientPanelBase.registerClass("Craba.UI.ClientPanelBase",Craba.UI.WebControl),Craba.UI.MDIPanel=function(t){Craba.UI.MDIPanel.initializeBase(this,[t]),this._showTabHeader=!0,this._pageAllowClose=!0,this._showPageAllowClose=!0,this._offsetWidth=0,$Dom.addCssClass(document.body.parentNode,"MDIDocument")},Craba.UI.MDIPanel.prototype={get_cssClass:function(){return"MDIPanel"},typeName:function(){return"MDIPanel"},initScript:function(){null!=this._pageGroups&&this._pageGroups.length>0&&this.addProp("pageGroups",this._pageGroups),Craba.UI.MDIPanel.callBaseMethod(this,"initScript")},endRender:function(t){t.div();this._showTabHeader||$skin.joinCssClass("MDIBar","dnone"),t.writeClass("MDIBar"),t.div(),t.writeClass("MDITabCaptions"),t.writeEnd(),t.writeEnd(),t.div(),t.writeClass("MDIChilds"),t.writeEnd(),t.writeEnd()}},Craba.UI.MDIPanel.registerClass("Craba.UI.MDIPanel",Craba.UI.ClientPanelBase),Craba.UI.StatusBar=function(t){Craba.UI.StatusBar.initializeBase(this,[t])},Craba.UI.StatusBar.prototype={get_cssClass:function(){return"StatusBar"},typeName:function(){return"StatusBar"},endRender:function(t){t.div(),t.attr("class","StatusBarHandle"),t.writeEnd(),t.div(),this.invokeBody(t),t.writeEnd(),t.writeEnd()}},Craba.UI.StatusBar.registerClass("Craba.UI.StatusBar",Craba.UI.WebControl),Craba.UI.ECharts=function(t){Craba.UI.ECharts.initializeBase(this,[t])},Craba.UI.ECharts.prototype={doTag:function(t){var e=this.Context.scriptIncludes,i=this.get_page().getCrabaResourceUrl("js/echarts-all.js");e.push(i),Craba.UI.ECharts.callBaseMethod(this,"doTag",[t])},get_cssClass:function(){return"ECharts"},typeName:function(){return"ECharts"},endRender:function(t){t.writeEnd()}},Craba.UI.ECharts.registerClass("Craba.UI.ECharts",Craba.UI.WebControl),Craba.UI.WebBlock=function(t){Craba.UI.WebBlock.initializeBase(this,[t])},Craba.UI.WebBlock.prototype={renderHTML:function(t){this.writeStyle(),Craba.UI.WebBlock.callBaseMethod(this,"renderHTML",[t]),this.invokeBody(t),t.writeEnd()},writeStyle:function(){this.styles.set("position","absolute"),this.styles.set("left","-10000px"),this.styles.set("top","-10000px")}},Craba.UI.WebBlock.registerClass("Craba.UI.WebBlock",Craba.UI.WebControl),Craba.UI.PopupBlock=function(t){Craba.UI.PopupBlock.initializeBase(this,[t]),this._noItem=!0},Craba.UI.PopupBlock.prototype={typeName:function(){return"PopupBlock"}},Craba.UI.PopupBlock.registerClass("Craba.UI.PopupBlock",Craba.UI.WebBlock),Craba.UI.InnerBlock=function(t){Craba.UI.InnerBlock.initializeBase(this,[t])},Craba.UI.InnerBlock.prototype={typeName:function(){return"InnerBlock"},get_cssClass:function(){return"InnerBlock"}},Craba.UI.InnerBlock.registerClass("Craba.UI.InnerBlock",Craba.UI.WebBlock),Craba.UI.HintBlock=function(t){Craba.UI.HintBlock.initializeBase(this,[t])},Craba.UI.HintBlock.prototype={typeName:function(){return"HintBlock"},writeStyle:function(){},get_cssClass:function(){return"HintBlock"}},Craba.UI.HintBlock.registerClass("Craba.UI.HintBlock",Craba.UI.WebBlock),Craba.UI.HtmlEditor=function(t){Craba.UI.HtmlEditor.initializeBase(this,[t]),this._showImgJustify=!0,this._showInsertImgButton=!0,this._showInsertTextArea=!0,this._imgAutoResize=!0,this.commands={},this.cSkinName="ui",this._autoSave=!1,this._showAllButton=!1},Craba.UI.HtmlEditor.prototype={typeName:function(){return"HtmlEditor"},get_cssClass:function(){var t="HtmlEditor";return(this._isSetHeight||this._isSetWidth)&&(t=$skin.joinCssClass(t,"Flex0")),this._showAllButton?t:t+" Normal"},set_showAllButton:function(t){this._showAllButton=t},initScript:function(){Craba.UI.HtmlEditor.callBaseMethod(this,"initScript"),this.addProp("guid",this._guid),this.addProp("autoSave",this._autoSave),this.addProp("commands",this.commands),this.addProp("imgAutoResize",this._imgAutoResize),this.addProp("imgHostUrl",this._imgHostUrl)},renderHTML:function(t){Craba.UI.HtmlEditor.callBaseMethod(this,"renderHTML",[t]),this.renderToolBar(t),t.writeBegin("iframe"),t.attr("id",this.get_clientID()+"_iframe"),t.attr("class","HtmlEditorBody"),t.attr("frameborder",0),t.writeEnd(),t.writeEnd()},newToolBar:function(t){return toolBar=this.toolBar=new Craba.UI.ToolBar,toolBar._setPage(this.get_page()),toolBar._showBottomLine=!1,toolBar._showHandle=!1,toolBar._cssClass=t,toolBar},renderToolBar:function(t){this.newToolBar("Bar1"),this.addButton("bold","粗体",!1,"aicon-bold"),this.addButton("italic","斜体",!1,"aicon-italic"),this.addButton("underline","下划线",!1,"aicon-underline"),this.addButton("fontColor","文字颜色",!1,"aicon-font-colors"),this.addButton("bgColor","背景颜色",!1,"aicon-bg-colors"),this.addButton("fontName","字体",!0,"aicon-ziti"),this.addButton("fontSize","字号",!1,"aicon-font-size"),this.addButton("removeFormat","清除格式",!0,"aicon-qingkong"),this.addButton("undo","撤消",!1,"aicon-chexiao"),this.addButton("redo","恢复",!1,"aicon-huifu"),this.addButton("paste","粘贴",!1,"aicon-niantie"),this.addButton("cut","剪切",!1,"aicon-jianqie"),this.addButton("copy","复制",!1,"aicon-fuzhi"),this.addButton("paraFormat","段落",!1,"aicon-dingdan"),this.addButton("orderedList","编号列表",!0,"aicon-orderedlist"),this.addButton("unorderedList","项目列表",!1,"aicon-unorderedlist"),this.addButton("outdent","减少缩进",!1,"aicon-outdent"),this.addButton("indent","增加缩进",!1,"aicon-indent"),this.addButton("insertHr","插入横线",!1,"aicon-dash"),this.addButton("justifyLeft","左对齐",!0,"aicon-align-left"),this.addButton("justifyCenter","居中对齐",!1,"aicon-align-center"),this.addButton("justifyRight","右对齐",!1,"aicon-align-right"),this.addButton("justifyFull","两端对齐",!1,"aicon-menu"),this._showInsertImgButton&&this.addButton("insertImg","插入图片",!0,"aicon-image-fill"),this.addButton("insertSwf","插入视频",!1,"aicon-shipin1"),this.addButton("insertLink","插入链接",!0,"aicon-bangding"),this.addButton("insertTable","插入表格",!1,"aicon-table"),this._showImgJustify&&this.addButton("imgJustify","图片排版",!1,"aicon-pic-right"),this.addButton("preview","预览文章",!0,"aicon-yulan1"),this.toolBar.renderTag(t)},get_skinImage:function(t){return"htmlEditor/editor/"+t+".gif"},addItem:function(t,e){this.toolBar.addItem(t),this.commands[t.get_realName()]=e},addButton:function(t,e,i,a){var r=new Craba.UI.ToolButton;r._name=t,a?r._skinIcon=a:(r._skinName=this.cSkinName,r._skinIcon=this.get_skinImage(t)),r._hint=e,r._beginGroup=i,this.addItem(r,t)},addImage:function(t,e,i){var a=new Craba.UI.ToolImage;a._name=t,a._skinName=this.cSkinName,a._skinImage=this.get_skinImage(t),a._width=e,a._beginGroup=i,this.addItem(a,t)},set_showInsertTextArea:function(t){this._showInsertTextArea=t},set_showInsertFace:function(t){this._showInsertFace=t},addSeperator:function(){var t=new Craba.UI.ToolSeperator;this.toolBar.addItem(t)}},Craba.UI.HtmlEditor.registerClass("Craba.UI.HtmlEditor",Craba.UI.WebControl),Craba.UI.NavBar=function(t){Craba.UI.NavBar.initializeBase(this,[t]),this.items=[]},Craba.UI.NavBar.prototype={typeName:function(){return"NavBar"},get_cssClass:function(){return"NavBar"},endRender:function(t){this.invokeBody(t),t.writeEnd()}},Craba.UI.NavBar.registerClass("Craba.UI.NavBar",Craba.UI.WebControl),Craba.UI.NavGroup=function(t){Craba.UI.NavGroup.initializeBase(this,[t]),this._align=_Z_250.center,this._expanded=!0,this._autoHeight=!1,this.items=[]},Craba.UI.NavGroup.prototype={doTag:function(t){if(null==this._text)throw Error.invalidOperation("该标签缺少Text属性");this.get_parent().items.push(this),Craba.UI.NavGroup.callBaseMethod(this,"doTag",[t])},typeName:function(){return"NavBarGroup"},initScript:function(){this.addProp("groupName",this._groupName)},set_icon:function(t){this._icon=t},get_ID:function(){var t=this.internalID;if(!t){t=this.get_parent().get_ID()+"_group"+this.get_index()}return t},set_align:function(t){this._align=t},get_index:function(){return Array.indexOf(this.get_parent().items,this)},set_text:function(t){this._text=t},renderHTML:function(t){t.div(),this.writeAttr(t),this.renderHeader(t),this.renderContent(t),t.writeEnd()},renderHeader:function(t){t.div(),t.writeClass("NBGroupHeader");var e=$skin.joinCssClass("NBCaptionText",this._icon);t.div(),t.writeClass(e),t.text(this._text),t.writeEnd();var i=this._expanded?"NBIcon aicon-moreunfold expand":"NBIcon aicon-moreunfold";t.div(),t.writeClass(i),t.writeEnd(),t.writeEnd()},renderContent:function(t){var e=this._expanded?"NBGroupBody":"NBGroupBody collapse";t.div(),t.writeClass(e),this._expanded&&t.writeStyle("height:auto"),this.invokeBody(t),t.writeEnd()}},Craba.UI.NavGroup.registerClass("Craba.UI.NavGroup",Craba.UI.WebControl),Craba.UI.ToolBar=function(t){Craba.UI.ToolBar.initializeBase(this,[t]),this.items=[],this._showHandle=!1,this._showBottomLine=!0,this._itemSpacing=1,this._seperatorWidth=0,this._seperatorHeight=0},Craba.UI.ToolBar.prototype={typeName:function(){return"ToolBar"},get_cssClass:function(){var t="ToolBar";return this._showBottomLine||(t+=" ToolBarNoBottomLine"),t},set_text:function(t){this._text=t},addItem:function(t){t._setParent(this),t._setPage(this.get_page()),this.items.push(t)},renderHTML:function(t){Craba.UI.ToolBar.callBaseMethod(this,"renderHTML",[t]),this.invokeBody(t),t.div(),t.writeClass("CustomToolBarRows"),this._height>0&&t.attr("style","height:"+this._height+"px");var e=this.get_items(_Z_250.left),i=this.get_items(_Z_250.right);this.renderItems(t,e,this._showHandle,!1,i.length>0),t.writeEnd(),i.length>0&&(t.div(),t.writeClass("FloatRight"),this.renderItems(t,i,!1,!0,!1),t.writeEnd()),t.writeEnd()},renderItems:function(t,e,i,a,r){i&&(t.div(),t.writeClass(this.get_toolBarHandleCssClass()),t.writeEnd()),a&&this._text&&(t.div(),t.writeClass("ToolBarText"),t.attr("id",this.get_clientID()+"_text"),t.text(this._text),t.writeEnd());for(var s=0,n=e.length;s<n;s++){var o=e[s];o._beginGroup&&Craba.UI.ToolSeperator.renderSeperator(t,o._visible,this.get_toolSeperatorCssClass(),this.get_page(),this._seperatorBgImage,this._seperatorWidth,this._seperatorHeight),t.div(),t.attr("id",o.get_clientID()),t.writeVisible(o._visible),t.writeEnabled(o._enabled),t.writeClass(o.get_cssClass()),t.attr("title",o._hint),o.renderTag(t),t.writeEnd(),r&&s==n-1&&Craba.UI.ToolSeperator.renderSeperator(t,!0,this.get_toolSeperatorCssClass(),this.get_page(),this._seperatorBgImage,this._seperatorWidth,this._seperatorHeight)}},get_toolBarHandleCssClass:function(){return"ToolBarHandle"},get_toolSeperatorCssClass:function(){return"ToolSeperator"},get_items:function(t){for(var e=[],i=0,a=this.items.length;i<a;i++){var r=this.items[i];r._align==t&&e.push(r)}return e},set_itemSpacing:function(t){this._itemSpacing=t}},Craba.UI.ToolBar.registerClass("Craba.UI.ToolBar",Craba.UI.WebControl),Craba.UI.LargeToolBar=function(t){Craba.UI.LargeToolBar.initializeBase(this,[t])},Craba.UI.LargeToolBar.prototype={get_cssClass:function(){return"LargeToolBar"},typeName:function(){return"LargeToolBar"},get_toolBarHandleCssClass:function(){return"LargeToolBarHandle"},get_toolSeperatorCssClass:function(){return"LargeToolSeperator"}},Craba.UI.LargeToolBar.registerClass("Craba.UI.LargeToolBar",Craba.UI.ToolBar),Craba.UI.CustomToolBar=function(t){Craba.UI.CustomToolBar.initializeBase(this,[t])},Craba.UI.CustomToolBar.prototype={get_cssClass:function(){return null},typeName:function(){return"ToolBar"}},Craba.UI.CustomToolBar.registerClass("Craba.UI.CustomToolBar",Craba.UI.ToolBar),Craba.UI.ToolItem=function(t){Craba.UI.ToolItem.initializeBase(this,[t]),this._beginGroup=!1,this._align=_Z_250.left},Craba.UI.ToolItem.prototype={initScript:function(){Craba.UI.ToolItem.callBaseMethod(this,"initScript"),this.addProp("param",this._param),this.addProp("dropDownMenuId",this._dropDownMenu),this.addProp("shortcut",this._shortcut,Craba.UI.Shortcut.none)},doTag:function(t){var e=this.get_parent();if(!e||!Craba.UI.ToolBar.isInstanceOfType(e))throw Error.invalidOperation("ToolItem标签必须在 ToolBar 标签中使用");e.addItem(this)},renderImg:function(t,e,i,a,r,s,n){var o=null!=e,l=null!=a;if(!i&&!o&&!l)throw Error.invalidOperation("缺少 Icon 或 Image 参数");t.img(),t.attr("width",r),t.attr("height",s),t.attr("align","absmiddle"),t.attr("src",o?this.get_page().convertUrl(e):l?this.get_page().getCrabaResourceUrl("skins/"+this._skinName+"/"+a):this.get_page().getWebUrl(i)),n&&t.attr("style","cursor:pointer"),t.writeEnd()},get_realName:function(){var t=this.get_parent();return t.get_ID()+"_"+(this._name?this._name:"item"+Array.indexOf(t.items,this))},get_ID:function(){return this.get_internalID()?Craba.UI.ToolItem.callBaseMethod(this,"get_ID"):this.get_realName()},set_text:function(t){this._text=t},set_dropDownMenu:function(t){this._dropDownMenu=t},set_name:function(t){this._name=t},set_beginGroup:function(t){this._beginGroup=t},set_icon:function(t){this._icon=t},set_align:function(t){switch(t){case"Right":this._align=2;break;case"Center":this._align=1}}},Craba.UI.ToolItem.registerClass("Craba.UI.ToolItem",Craba.UI.WebControl),Craba.UI.ToolText=function(t){Craba.UI.ToolText.initializeBase(this,[t])},Craba.UI.ToolText.prototype={typeName:function(){return"ToolItem"},renderHTML:function(t){this.initStyle(),t.writeTag("div",{},this.styles.get_value()),t.text(this._text),t.writeEnd()},initStyle:function(){this._fontSize&&this.styles.set("fontsize",this._fontSize),this._fontColor&&this.styles.set("fontcolor",this._fontColor),this._boldFont&&this.styles.set("boldFont",this._boldFont),this.events.onClick&&this.styles.set("cursor","pointer")},set_fontSize:function(t){this._fontSize=t}},Craba.UI.ToolText.registerClass("Craba.UI.ToolText",Craba.UI.ToolItem),Craba.UI.ToolSpacer=function(t){Craba.UI.ToolSpacer.initializeBase(this,[t]),this._width=6},Craba.UI.ToolSpacer.prototype={renderHTML:function(t){t.div(),t.attr("style","width:"+this._width+";"),t.writeEnd()},set_width:function(t){this._width=t}},Craba.UI.ToolSpacer.registerClass("Craba.UI.ToolSpacer",Craba.UI.ToolItem),Craba.UI.ToolLink=function(t){Craba.UI.ToolLink.initializeBase(this,[t]),this._target="_blank",this._href=null},Craba.UI.ToolLink.prototype={renderHTML:function(t){this.initStyle(),t.writeTag("a",{},this.styles.get_value()),this._href?(t.attr("target",this._target),t.attr("href",this._href)):(t.attr("href","javascript:void(0);"),this.events.onClick||t.attr("onclick","return false;")),t.text(this._text),t.writeEnd()},set_width:function(t){this._width=t},set_href:function(t){this._href=t}},Craba.UI.ToolLink.registerClass("Craba.UI.ToolLink",Craba.UI.ToolText),Craba.UI.ToolButton=function(t){Craba.UI.ToolButton.initializeBase(this,[t])},Craba.UI.ToolButton.prototype={typeName:function(){return"ToolButton"},get_cssClass:function(){var t="ToolButton";return this._name&&(t+=" "+this._name),$craba.isIconfont(this._skinIcon)&&(t+=" "+this._skinIcon),t},renderHTML:function(t){$craba.isIconfont(this._skinIcon)||this.renderImg(t,this._iconSrc,this._icon,this._skinIcon,16,16)}},Craba.UI.ToolButton.registerClass("Craba.UI.ToolButton",Craba.UI.ToolItem),Craba.UI.ToolSpeedButton=function(t){Craba.UI.ToolSpeedButton.initializeBase(this,[t])},Craba.UI.ToolSpeedButton.prototype={typeName:function(){return"ToolSpeedButton"},get_cssClass:function(){return"ToolSpeedButton"},renderHTML:function(t){t.div(),t.attr("class","ToolSpeedButtonContent");var e=null!=this._icon;e&&(t.table().writeTable(0,0,0),t.tr().td(),this.renderImg(t,null,this._icon,null,16,16),t._td(),t.td(),t.attr("nowrap",!0)),t.text(this._text),e&&t._td()._tr()._table(),t.writeEnd()}},Craba.UI.ToolSpeedButton.registerClass("Craba.UI.ToolSpeedButton",Craba.UI.ToolItem),Craba.UI.ToolSeperator=function(t){Craba.UI.ToolSeperator.initializeBase(this,[t])},Craba.UI.ToolSeperator.prototype={renderHTML:function(t){this.renderSeperator(t,this._visible,"ToolSeperator",null,null,0,0)}},Craba.UI.ToolSeperator.registerClass("Craba.UI.ToolSeperator",Craba.UI.ToolItem),Craba.UI.ToolSeperator.renderSeperator=function(t,e,i,a,r,s,n){t.div(),e||t.attr("display","none"),t.div(),t.attr("class","ToolSeperator");var o="";r&&(o="backgroundImageUrl:"+this.get_page().getWebUrl(r)),s>0&&(o+=";width:"+s+"px;"),n>0&&(o+=";height:"+n+"px;"),t.attr("style",o),t.writeEnd(),t.writeEnd()},Craba.UI.ToolImage=function(t){Craba.UI.ToolImage.initializeBase(this,[t]),this._height=20},Craba.UI.ToolImage.prototype={typeName:function(){return"ToolImage"},initScript:function(){Craba.UI.ToolImage.callBaseMethod(this,"initScript"),this.addProp("navigateUrl",this._navigateUrl)},get_cssClass:function(){return this._name?"ToolImage "+this._name:"ToolImage"},set_image:function(t){this._image=t},renderHTML:function(t){if(this._width<=0)throw Error.invalidOperation("缺少Width");this.renderImg(t,this._imageSrc,this._image,this._skinImage,this._width,this._height,this.get_event("click")?"pointer":null)}},Craba.UI.ToolImage.registerClass("Craba.UI.ToolImage",Craba.UI.ToolItem),Craba.UI.PageControl=function(t){Craba.UI.PageControl.initializeBase(this,[t]),this._showTabHeader=!0,this._tabHeaderHidden=!1,this._selectedTabIndex=0,this._height=0,this._autoFocus=!0,this._tabPosition=Craba.UI.TabPosition.top,this.tabs=[],this._noItem=!0},Craba.UI.PageControl.prototype={typeName:function(){return"PageControl"},set_tabPosition:function(t){this._tabPosition=this.get_enumTypeValue(Craba.UI.TabPosition,t)},registerScript:function(){Craba.UI.PageControl.callBaseMethod(this,"registerScript");for(var t=0,e=this.tabs.length;t<e;t++){this.tabs[t].registerScript()}this.tabContainer&&this.tabContainer.registerScript()},initScript:function(){Craba.UI.PageControl.callBaseMethod(this,"initScript"),this.addProp("selectedTabIndex",this._selectedTabIndex,-1)},get_cssClass:function(){var t=this._tabPosition,e="";return e=t==Craba.UI.TabPosition.top?"TabTop":t==Craba.UI.TabPosition.left?"TabLeft":t==Craba.UI.TabPosition.right?"TabRight":"TabBottom",e=$skin.joinCssClass("PageControl",e),(this._isSetHeight||this._isSetWidth)&&(e=$skin.joinCssClass(e,"Flex0")),e},endRender:function(t){this.invokeBody(t);var e=this.tabs.length;if(0==e)throw Error.invalidOperation("PageControl标签中至少必须有一个TabPage标签");this._tabPosition!=Craba.UI.TabPosition.bottom&&this.renderHeader(t),t.div(),t.attr("class",this._showTabHeader?"TabBody":"TabBodyNoHeader"),this._height>0&&t.attr("style","height:"+this._height+"px;overflow:auto;");for(var i=0;i<e;i++){var a=this.tabs[i],r=i==this._selectedTabIndex;r&&!a._visible&&(r=!1,this._selectedTabIndex++),r||(a._cssClass=$skin.joinCssClass(a._cssClass,"Hided")),a._visible||a.set_cssStyle("display:none"),a.renderHTML(t)}t.writeEnd(),this._tabPosition==Craba.UI.TabPosition.bottom&&this.renderHeader(t),t.writeEnd()},renderHeader:function(t){var e="TabHeader dselect";this._showTabHeader||(e=$skin.joinCssClass("dnone",e)),t.div(),t.writeClass(e),t.div(),t.writeClass("TabCaptions");for(var i=0,a=this.tabs.length;i<a;i++){var r=this.tabs[i],s=r._cssClass;s&&(s+="_Caption"),r._icon&&(s=$skin.joinCssClass(s,r._icon)),t.div(),t.attr("id",r.get_clientID()+"_button"),r._visible||t.attr("style","display:none"),t.writeClass($skin.joinCssClass("TabCaption",s)),t.attr("tabindex",0),t.text(r._caption),t.writeEnd()}t.writeEnd(),t.div(),t.writeClass("TabSpace"),null!=this.tabContainer&&this.tabContainer.renderHTML(t),t.writeEnd(),t.writeEnd()},addTab:function(t){t._setParent(this),t._setPage(this.get_page()),this.tabs.push(t)},setTabContainer:function(t){this.tabContainer=t}},Craba.UI.PageControl.registerClass("Craba.UI.PageControl",Craba.UI.WebControl),Craba.UI.TabPage=function(t){Craba.UI.TabPage.initializeBase(this,[t])},Craba.UI.TabPage.prototype={updateLang:function(t){this.setAttr("Caption",t)},typeName:function(){return"TabPage"},doTag:function(t){var e=this.get_parent();if(!e||!Craba.UI.PageControl.isInstanceOfType(e))throw Error.invalidOperation("TabPage标签必须在 PageControl 标签中使用");e.addTab(this)},initScript:function(){this.addProp("pageControlId",this.get_parent().get_ID()),this.addProp("visible",this._visible,!0)},set_text:function(t){this._caption=t},set_caption:function(t){this._caption=t},set_icon:function(t){this._icon=t},get_cssClass:function(){return"TabPage"},set_visible:function(t){this._visible=t},renderHTML:function(t){Craba.UI.TabPage.callBaseMethod(this,"renderHTML",[t]),this.invokeBody(t),t.writeEnd()}},Craba.UI.TabPage.registerClass("Craba.UI.TabPage",Craba.UI.WebControl),Craba.UI.TabContainer=function(t){Craba.UI.TabContainer.initializeBase(this,[t])},Craba.UI.TabContainer.prototype={typeName:function(){return"TabContainer"},doTag:function(t){var e=this.get_parent();if(!e||!Craba.UI.PageControl.isInstanceOfType(e))throw Error.invalidOperation("TabContainer标签必须在 PageControl 标签中使用");e.setTabContainer(this)},initScript:function(){this.addProp("tag",this._tag),this.addProp("pageControlId",this.get_parent().get_ID()),this.addProp("activeControl",this._activeControl),this.addProp("textColor",this._textColor)},get_cssClass:function(){return"TabContainer"},renderHTML:function(t){this.styles.set("text-align","right"),this.styles.set("overflow","hidden"),Craba.UI.TabContainer.callBaseMethod(this,"renderHTML",[t]),this.invokeBody(t),t.writeEnd()}},Craba.UI.TabContainer.registerClass("Craba.UI.TabContainer",Craba.UI.WebControl),Craba.UI.FileUpload=function(t){Craba.UI.FileUpload.initializeBase(this,[t]),this._noItem=!0},Craba.UI.FileUpload.prototype={typeName:function(){return"FileUpload"},initScript:function(){if(!this._webMethod)throw Error.invalidOperation("缺少webMethod属性");var t=this._webMethod;this.Context.webMethodBasePath&&(t=this.Context.webMethodBasePath+"/"+t),this.addProp("webMethodPath",t),this.addProp("timeout",this._timeout,0)},renderHTML:function(t){Craba.UI.FileUpload.callBaseMethod(this,"renderHTML",[t]),t.attr("method","post"),t.attr("enctype","multipart/form-data"),t.attr("target",this.get_targetID()),this.invokeBody(t),t.writeBegin("input"),t.attr("type","hidden"),t.attr("name","_dataField"),t.writeEnd(),t.writeEnd(),t.writeBegin("iframe"),t.attr("id",this.get_targetID()),t.attr("name",this.get_targetID()),t.attr("style","display:none"),t.writeEnd()},htmlTag:function(){return"form"},set_webMethod:function(t){this._webMethod=t},get_targetID:function(){return this.get_clientID()+"_frame"}},Craba.UI.FileUpload.registerClass("Craba.UI.FileUpload",Craba.UI.WebControl),Craba.UI.Flash=function(t,e,i,a,r){Craba.UI.Flash.initializeBase(this),this.allowNetworking="all",this.vmode="opaque",this.id=t,this.movie=a,this._width=e,this._height=i,this.writeCodeBase=!0,this.flashVars=r},Craba.UI.Flash.prototype={set_ID:function(t){this.id=t},set_vMode:function(t){this.vmode=t},set_allowNetworking:function(t){this.allowNetworking=t},set_writeCodeBase:function(t){this.writeCodeBase=t},render:function(t){var e=new Sys.StringBuilder;e.append("<object"),e.append(' id="'+this.id+'"'),e.append(' classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"');e.append(">"),this.movie&&e.append('<param name="movie" value="'+this.movie+'"/>'),e.append('<param name="allowScriptAccess" value="always"/>'),e.append('<param name="allownetworking" value="'+this.allowNetworking+'"/>'),e.append('<param name="quality" value="high"/>'),e.append('<param name="menu" value="false"/>'),e.append('<param name="wmode" value="'+this.vmode+'"/>'),this.flashVars&&e.append('<param name="FlashVars" value="'+this.flashVars+'"/>'),e.append("<embed"),e.append(' src="'+this.movie+'"'),e.append(" type=application/x-shockwave-flash"),e.append(' allowScriptAccess="always"'),this.allowNetworking&&e.append(' allownetworking="'+this.allowNetworking+'"'),e.append(' quality="high";'),e.append(' menu="false"'),this.vmode&&e.append(' wmode="'+this.vmode+'"'),this.flashVars&&e.append(' FlashVars="'+this.flashVars+'"'),e.append(' pluginspage="//www.macromedia.com/go/getflashplayer"/>'),e.append("</object>"),t.text(e.toString())}},Craba.UI.Flash.registerClass("Craba.UI.Flash"),Craba.UI.MultiFileUpload=function(t){Craba.UI.MultiFileUpload.initializeBase(this,[t]),this._maxSize=10,this._clientMaxSize=10,this._maxFileCount=-1,this._uploadCount=0,this._buttonText="上传多图",this._allowDelete=!0,this._allowShowPopup=!0,this._typeFilter="*.jpg;*.png;*.gif"},Craba.UI.MultiFileUpload.prototype={typeName:function(){return"MultiFileUpload"},initScript:function(){if(!this._webMethod)throw Error.invalidOperation("缺少webMethod属性");this.addProp("webMethodPath",this.webMethodPath)},get_cssClass:function(){var t="MultiFileUpload "+Craba.UI.MultiFileUpload.callBaseMethod(this,"get_cssClass");return this._allowShowPopup||(t+=" NoPopup"),t},_renderText:function(t){t.div(),t.attr("class","FlashText");var e=new Sys.StringBuilder;e.append(String.format("url={0}",this.webMethodPath)),e.append(String.format("&maxSize={0}",this._maxSize)),e.append(String.format("&typeFilter={0}",this._typeFilter)),e.append(String.format("&maxFileCount={0}",this._maxFileCount)),e.append(String.format("&uploadCount={0}",this._uploadCount)),e.append(String.format("&clientMaxSize={0}",this._clientMaxSize));var i=this.get_page().getCrabaResourceUrl("UI/Flash/multiFileUpload.swf"),a=new Craba.UI.Flash(this.get_clientID()+"flash",null,null,i,e.toString());a.vmode="transparent",a.render(t),t.writeBegin("span"),t.text(this._text?this._text:this._buttonText),t.writeEnd(),t.writeEnd(),t.writeBegin("span"),t.attr("class","iconfont LoadingIcon"),t.writeEnd(),t.writeEnd()},set_typeFilter:function(t){this._typeFilter=t},set_webMethod:function(t){var e=this.Context.webMethodBasePath+"/"+t+"?MultiFileUpload=1";e=this.get_page().convertUrl(e),this._webMethod=e,this.webMethodPath=e},htmlTag:function(){return"div"}},Craba.UI.MultiFileUpload.registerClass("Craba.UI.MultiFileUpload",Craba.UI.Button),Craba.UI.TreeView=function(t){Craba.UI.TreeView.initializeBase(this,[t]),this.ChildNodes=[],this._readOnly=!0,this._allowDoubleClickEvent=!1,this._allowDrag=!1,this._allowDrop=!1,this._showRootNode=!1,this._showCheckBoxes=!1,this._notUpdateParentCheck=!1,this._nodeTextMaxLength=20,this._showToolBar=!1,this._expandLevel=100,this._noItem=!0,this._outerCss="",this._showColumns=!1},Craba.UI.TreeView.prototype={typeName:function(){return"TreeView"},get_cssClass:function(){var t="TreeView ScrollBar";return this._showColumns?t=$skin.joinCssClass(t,"ShowColumns"):($settings.TreeShowLine&&(t=$skin.joinCssClass(t,"ShowLine")),t)},initScript:function(){Craba.UI.TreeView.callBaseMethod(this,"initScript");var t=!1;if(this._dataSource){var e=this._dataSource.ChildNodes;if(e)if(this._showRootNode)this.ChildNodes.push(this._dataSource),this._showRootNode=!1;else for(var i=0,a=e.length;i<a;i++){var r=e[i];this.ChildNodes.push(r)}else t=!0}this._icon&&this.addProp("icon",this.get_page().getWebUrl(this._icon)),this.addProp("dataSource",t?this._dataSource:this.get_nodeScriptData(this)),this._showColumns&&(this.addProp("showRootNode",!1),this.addProp("expandLevel",0))},get_nodeScriptData:function(t){var e=[],i=this._getScriptData(t);i&&e.push(i);for(var a=0,r=t.ChildNodes.length;a<r;a++){var s=t.ChildNodes[a];e.push(this.get_nodeScriptData(s))}return e},_getScriptData:function(t){if(t==this)return null;if(t.get_scriptData)return t.get_scriptData();return{_text:t.Text,_data:t.Data}},set_dataSource:function(t){this._dataSource=t},beginRender:function(t){t.div();var e="",i="TreeBlock";this._isSetHeight&&(e="height:"+this._height+"px;",this.styles.remove("height")),this._isSetWidth&&(e+="width:"+this._width+"px;",this.styles.remove("width")),this._outerCss&&(e+=this._outerCss),e&&(t.writeStyle(e),i=$skin.joinCssClass(i,"Flex0")),this._cssClass&&(i=$skin.joinCssClass(i,this._cssClass),delete this._cssClass),t.writeClass(i),Craba.UI.TreeView.callBaseMethod(this,"beginRender",[t])},endRender:function(t){t.writeEnd(),t.writeEnd(),this.invokeBody(t)}},Craba.UI.TreeView.registerClass("Craba.UI.TreeView",Craba.UI.WebControl),Craba.UI.TreeNode=function(t){Craba.UI.TreeNode.initializeBase(this,[t]),this.ChildNodes=[]},Craba.UI.TreeNode.prototype={doTag:function(t){if(!this._text)throw Error.invalidOperation("缺少Text属性");var e=this.get_parent();if(!e||Craba.UI.TreeNode.isInstanceOfType(e)&&Craba.UI.TreeView.isInstanceOfType(e))throw Error.invalidOperation("这个标签只能作为 ITreeNode 标签的子标签");e.ChildNodes.push(this),this.invokeBody(t)},get_scriptData:function(){return this._text}},Craba.UI.TreeNode.registerClass("Craba.UI.TreeNode",Craba.UI.ScriptControl),Craba.UI.NavTreeView=function(t){Craba.UI.NavTreeView.initializeBase(this,[t])},Craba.UI.NavTreeView.prototype={typeName:function(){return"NavTreeView"}},Craba.UI.NavTreeView.registerClass("Craba.UI.NavTreeView",Craba.UI.TreeView),Craba.UI.NavTreeNode=function(t){Craba.UI.NavTreeNode.initializeBase(this,[t])},Craba.UI.NavTreeNode.prototype={get_scriptData:function(){return{_text:this._text,showPage:this._showPage,navUrl:this._navUrl,target:this._target}}},Craba.UI.NavTreeNode.registerClass("Craba.UI.NavTreeNode",Craba.UI.TreeNode),Craba.UI.LazyTree=function(t){Craba.UI.LazyTree.initializeBase(this,[t]),this._parentNodeShowCheckBox=!0},Craba.UI.LazyTree.prototype={typeName:function(){return"LazyTree"},addEvent:function(t,e){e&&("expandedClick"==t?t="nodeExpandedClick":"checkBoxClick"==t&&(t="treeNodeCheckBoxClick"),this.events[t]=e)}},Craba.UI.LazyTree.registerClass("Craba.UI.LazyTree",Craba.UI.TreeView),Craba.UI.IFrame=function(t){Craba.UI.IFrame.initializeBase(this,[t]),this._scrolling=!0},Craba.UI.IFrame.prototype={htmlTag:function(){return"iframe"},get_cssClass:function(){return"IFrame"},typeName:function(){return"IFrame"},set_src:function(t){this._src=t},set_url:function(t){this._url=t},set_scrolling:function(t){this._scrolling=t},renderHTML:function(t){Craba.UI.IFrame.callBaseMethod(this,"renderHTML",[t]),(this._src||this._url)&&t.attr("src",this._src?this._src:this.get_page().getWebUrl(this._url)),t.attr("frameborder",0),this._scrolling||t.attr("scrolling","no"),t.writeEnd()}},Craba.UI.IFrame.registerClass("Craba.UI.IFrame",Craba.UI.WebControl),Craba.UI.Player=function(t){Craba.UI.Player.initializeBase(this,[t]),this._autoPlay=!1,this._controls=!1,this._loop=!1,this._htmlTag="audio"},Craba.UI.Player.prototype={htmlTag:function(){return this._htmlTag},set_htmlTag:function(t){this._htmlTag=t},typeName:function(){return"Player"},get_cssClass:function(){return"Player"},set_autoPlay:function(t){this._autoPlay=t},set_controls:function(t){this._controls=t},set_loop:function(t){this._loop=t},set_src:function(t){this._src=t},set_url:function(t){this._url=t},renderHTML:function(t){Craba.UI.Player.callBaseMethod(this,"renderHTML",[t]);var e=this._url;this._src&&(e=this._src),t.attr("src",this.get_page().convertUrl(e)),this._autoPlay&&!1!==$cache.get("MusicPlayer.AutoPlay")&&t.attr("autoplay","autoplay"),this._controls&&t.attr("controls","controls"),this._loop&&t.attr("loop","loop"),t.writeEnd()}},Craba.UI.Player.registerClass("Craba.UI.Player",Craba.UI.WebControl),Craba.UI.TextLabel=function(t){Craba.UI.TextLabel.initializeBase(this,[t])},Craba.UI.TextLabel.prototype={htmlTag:function(){return"input"},typeName:function(){return"TextLabel"},get_cssClass:function(){return"TextLabel"},initScript:function(){Craba.UI.TextLabel.callBaseMethod(this,"initScript"),this.addProp("text",this._getText())},endRender:function(t){t.writeEnd()},writeAttr:function(t){Craba.UI.TextLabel.callBaseMethod(this,"writeAttr",[t]),t.attr("type","text"),t.attr("readonly",!0),t.attr("value",this._getText())},_getText:function(){return this._replaceText?this._replaceText:this._text}},Craba.UI.TextLabel.registerClass("Craba.UI.TextLabel",Craba.UI.WebControl),Craba.UI.ServerStatus=function(t){Craba.UI.ServerStatus.initializeBase(this,[t]),this._loopTime=5},Craba.UI.ServerStatus.prototype={htmlTag:function(){return"span"},endRender:function(t){t.writeEnd()},typeName:function(){return"ServerStatus"},initScript:function(){Craba.UI.ServerStatus.callBaseMethod(this,"initScript"),this.addProp("loopTime",this._loopTime)}},Craba.UI.ServerStatus.registerClass("Craba.UI.ServerStatus",Craba.UI.WebControl),Craba.UI.ProgressBar=function(t){Craba.UI.ProgressBar.initializeBase(this,[t]),this._value=0,this._maxValue=100,this._showValue=!0},Craba.UI.ProgressBar.prototype={typeName:function(){return"ProgressBar"},get_cssClass:function(){return"ProgressBar"},htmlTag:function(){return"div"},set_value:function(t){this._value=t},set_maxValue:function(t){this._maxValue=t},initScript:function(){Craba.UI.ProgressBar.callBaseMethod(this,"initScript"),this.addProp("maxValue",this._maxValue,100),this.addProp("value",this._value,0)}},Craba.UI.ProgressBar.registerClass("Craba.UI.ProgressBar",Craba.UI.CustomSelectableList),Craba.UI.Style=function(t){Craba.UI.Style.initializeBase(this,[t]),this.innerText=t.Value},Craba.UI.Style.prototype={doTag:function(t){if(this._url)this.get_page().registerCssLink(this.get_page().getWebUrl(this._url));else if(this._src)this.get_page().registerCssLink(this.get_page().convertUrl(this._src));else{var e=this.innerText;e&&(e=e.replace(/\s+/g," "),this.get_page().appendStyle(e))}}},Craba.UI.Style.registerClass("Craba.UI.Style",Craba.UI.ScriptControl),Craba.UI.VerificationCode=function(t){Craba.UI.VerificationCode.initializeBase(this,[t]),this._length=4},Craba.UI.VerificationCode.prototype={typeName:function(){return"VerificationCode"},get_cssClass:function(){return"CodeImg"},htmlTag:function(){return"img"},renderHTML:function(t){if(Craba.UI.VerificationCode.callBaseMethod(this,"renderHTML",[t]),$settings.CrabaServer){var e="?ID="+this.Context.vCodeID;this._length>0&&(e+="&Len="+this._length),this._imageSrc=this.Context.rootUrl+"_Sys/UI/VerificationCode.gspx"+e}t.attr("src",this._imageSrc),t.attr("title","点击图片 重新获得验证码"),t.writeEnd()},initScript:function(){Craba.UI.VerificationCode.callBaseMethod(this,"initScript"),this.addProp("imageSrc",this._imageSrc)}},Craba.UI.VerificationCode.registerClass("Craba.UI.VerificationCode",Craba.UI.WebControl),Craba.UI.Script=function(t){Craba.UI.Script.initializeBase(this,[t])},Craba.UI.Script.prototype={doTag:function(t){var e=this.get_page(),i=this.Context.scriptIncludes,a=this._src,r=this._url;if(r)a=this.get_page().getWebUrl(r);else{if(!a)return;a=this.get_page().convertUrl(a)}if(this._afterLoad)i.push(a);else{var s=e._scriptIndex;s===undefined&&(s=e._scriptIndex=0),Array.insert(i,s,a),e._scriptIndex++}}},Craba.UI.Script.registerClass("Craba.UI.Script",Craba.UI.ScriptControl),Craba.UI.CustomControl=function(t){Craba.UI.CustomControl.initializeBase(this,[t]),this._paramsString=""},Craba.UI.CustomControl.prototype={initialize:function(t){this._inited||Craba.UI.CustomControl.callBaseMethod(this,"initialize",[t]),this._inited=!0},dispose:function(){Craba.UI.CustomControl.callBaseMethod(this,"dispose"),this._thisPage&&this._thisPage.dispose()},initScript:function(){this.addProp("id","$"+this.Context.pageId+"$"+this.get_ID()),this.addProp("gspx",this.xmlNode)},_hasSize:function(){return!1},_setPage:function(t,e){Craba.UI.CustomControl.callBaseMethod(this,"_setPage",[t]);var i=e||t;i.customTags||(i.customTags=[]),i.customTags.push(this)},typeName:function(){return"CustomControl"},renderTag:function(t){var e=Object.clone(this.events),i=Object.clone(this.properties);if(this.events={},this.properties={},this.registerScript(),this._thisPage){var a=this._thisPage;a.initialize(),a.rootPage=this.get_page(),a.isPagePart=!0,a._idPart=this._id,a._dataField=this._dataField,a._paramsString=this._paramsString,a._childEvents=e,a._childProperties=i,a.set_dataSource(this._dataSource),t.div(),t.attr("id",a.Context.pageId);var r=$skin.joinCssClass(this._cssClass,a._cssClass);(this._isSetHeight||this._isSetWidth)&&(r=$skin.joinCssClass(r,"Flex0")),r&&t.writeClass(r),t.writeStyle(this.styles.get_value()),a.renderPagePart(t),t.writeEnd()}}},Craba.UI.CustomControl.registerClass("Craba.UI.CustomControl",Craba.UI.WebControl),Craba.UI.Meta=function(t){Craba.UI.Meta.initializeBase(this,[t])},Craba.UI.Meta.prototype={doTag:function(t){var e=$$get("HEAD")[0],i=$$get("META");0==i.length&&(i=$$get("TITLE"));var a=i[i.length-1],r=$common.getNextSibling(a),s=document.createElement("meta");s.name=this._name,s.content=this._content,r.tagName?e.insertBefore(s,r):e.appendChild(s)}},Craba.UI.Meta.registerClass("Craba.UI.Meta",Craba.UI.ScriptControl),Craba.UI.Hotkey=function(t){Craba.UI.Hotkey.initializeBase(this,[t]),this.isNullId=!0,this.supportsLayout=!1},Craba.UI.Hotkey.prototype={initScript:function(){this.addProp("id",this.get_clientID()),this.addProp("shortcut",this._shortcut,Craba.UI.Shortcut.none)},doTag:function(t){this.registerScript()},typeName:function(){return"Hotkey"}},Craba.UI.Hotkey.registerClass("Craba.UI.Hotkey",Craba.UI.ScriptControl),Craba.UI.Shortcut=function(){throw Error.notImplemented()},Craba.UI.Shortcut.prototype={none:0,esc:27,ctrlA:131137,ctrlB:131138,ctrlC:131139,ctrlD:131140,ctrlE:131141,ctrlF:131142,ctrlG:131143,ctrlH:131144,ctrlI:131145,ctrlJ:131146,ctrlK:131147,ctrlL:131148,ctrlM:131149,ctrlN:131150,ctrlO:131151,ctrlP:131152,ctrlQ:131153,ctrlR:131154,ctrlS:131155,ctrlT:131156,ctrlU:131157,ctrlV:131158,ctrlW:131159,ctrlX:131160,ctrlY:131161,ctrlZ:131162,ctrlShiftA:196673,ctrlShiftB:196674,ctrlShiftC:196675,ctrlShiftD:196676,ctrlShiftE:196677,ctrlShiftF:196678,ctrlShiftG:196679,ctrlShiftH:196680,ctrlShiftI:196681,ctrlShiftJ:196682,ctrlShiftK:196683,ctrlShiftL:196684,ctrlShiftM:196685,ctrlShiftN:196686,ctrlShiftO:196687,ctrlShiftP:196688,ctrlShiftQ:196689,ctrlShiftR:196690,ctrlShiftS:196691,ctrlShiftT:196692,ctrlShiftU:196693,ctrlShiftV:196694,ctrlShiftW:196695,ctrlShiftX:196696,ctrlShiftY:196697,ctrlShiftZ:196698,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,shiftF1:65648,shiftF2:65649,shiftF3:65650,shiftF4:65651,shiftF5:65652,shiftF6:65653,shiftF7:65654,shiftF8:65655,shiftF9:65656,shiftF10:65657,shiftF11:65658,shiftF12:65659,ctrlF1:131184,ctrlF2:131185,ctrlF3:131186,ctrlF4:131187,ctrlF5:131188,ctrlF6:131189,ctrlF7:131190,ctrlF8:131191,ctrlF9:131192,ctrlF10:131193,ctrlF11:131194,ctrlF12:131195,ctrlShiftF1:196720,ctrlShiftF2:196721,ctrlShiftF3:196722,ctrlShiftF4:196723,ctrlShiftF5:196724,ctrlShiftF6:196725,ctrlShiftF7:196726,ctrlShiftF8:196727,ctrlShiftF9:196728,ctrlShiftF10:196729,ctrlShiftF11:196730,ctrlShiftF12:196731,ins:45,ctrlIns:131117,shiftIns:65581,Del:46,ctrlDel:131118,shiftDel:65582,ctrlEnter:131085,ctrlPageUp:131105,ctrlPageDown:131106,AltRightArrow:262183,AltLeftArrow:262181,AltUpArrow:262182,AltDownArrow:262184,AltBksp:262152,AltF1:262256,AltF2:262257,AltF3:262258,AltF4:262259,AltF5:262260,AltF6:262261,AltF7:262262,AltF8:262263,AltF9:262264,AltF10:262265,AltF11:262266,AltF12:262267,Alt0:262192,Alt1:262193,Alt2:262194,Alt3:262195,Alt4:262196,Alt5:262197,Alt6:262198,Alt7:262199,Alt8:262200,Alt9:262201,ctrl0:131120,ctrl1:131121,ctrl2:131122,ctrl3:131123,ctrl4:131124,ctrl5:131125,ctrl6:131126,ctrl7:131127,ctrl8:131128,ctrl9:131129,ctrlShift0:196656,ctrlShift1:196657,ctrlShift2:196658,ctrlShift3:196659,ctrlShift4:196660,ctrlShift5:196661,ctrlShift6:196662,ctrlShift7:196663,ctrlShift8:196664,ctrlShift9:196665,altA:262209,altB:262210,altC:262211,altD:262212,altE:262213,altF:262214,altG:262215,altH:262216,altI:262217,altJ:262218,altK:262219,altL:262220,altM:262221,altN:262222,altO:262223,altP:262224,altQ:262225,altR:262226,altS:262227,altT:262228,altU:262229,altV:262230,altW:262231,altX:262232,altY:262233,altZ:262234,ctrlAltA:393281,ctrlAltB:393282,ctrlAltC:393283,ctrlAltD:393284,ctrlAltE:393285,ctrlAltF:393286,ctrlAltG:393287,ctrlAltH:393288,ctrlAltI:393289,ctrlAltJ:393290,ctrlAltK:393291,ctrlAltL:393292,ctrlAltM:393293,ctrlAltN:393294,ctrlAltO:393295,ctrlAltP:393296,ctrlAltQ:393297,ctrlAltR:393298,ctrlAltS:393299,ctrlAltT:393300,ctrlAltU:393301,ctrlAltV:393302,ctrlAltW:393303,ctrlAltX:393304,ctrlAltY:393305,ctrlAltZ:393306,ctrlAltF1:393328,ctrlAltF2:393329,ctrlAltF3:393330,ctrlAltF4:393331,ctrlAltF5:393332,ctrlAltF6:393333,ctrlAltF7:393334,ctrlAltF8:393335,ctrlAltF9:393336,ctrlAltF10:393337,ctrlAltF11:393338,ctrlAltF12:393339,rightArrow:39,leftArrow:37,upArrow:38,downArrow:40,ctrlRightArrow:131111,ctrlLeftArrow:131109,ctrlUpArrow:131110,ctrlDownArrow:131112,shiftRightArrow:65575,shiftLeftArrow:65573,shiftUpArrow:65574,shiftDownArrow:65576},Craba.UI.Shortcut.registerEnum("Craba.UI.Shortcut"),Craba.UI.PagerPosition=function(){throw Error.notImplemented()},Craba.UI.PagerPosition.prototype={none:0,bottom:1,top:2,topAndBottom:3},Craba.UI.PagerPosition.registerEnum("Craba.UI.PagerPosition"),Craba.UI.TabPosition=function(){throw Error.notImplemented()},Craba.UI.TabPosition.prototype={top:0,bottom:1,right:2,left:3},Craba.UI.TabPosition.registerEnum("Craba.UI.TabPosition"),Craba.UI.CssLengthUnit=function(){throw Error.notImplemented()},Craba.UI.CssLengthUnit.prototype={pixel:0,percent:1},Craba.UI.CssLengthUnit.registerEnum("Craba.UI.CssLengthUnit"),Craba.UI.ControlAction=function(t){Craba.UI.ControlAction.initializeBase(this,[t]),this.supportsLayout=!1},Craba.UI.ControlAction.prototype={namespace:function(){return"Sys.UI.Actions"},renderTag:function(t){this.invokeBody(),this.registerScript()},registerScript:function(){if(!this.get_internalID()){var t=this.get_bindControl();this.set_iD(t.get_ID()+"_"+this.get_ID())}Craba.UI.ControlAction.callBaseMethod(this,"registerScript")},initScript:function(){Craba.UI.ControlAction.callBaseMethod(this,"initScript"),this.addProp("controlId",this.get_bindControl().get_ID()),this.addProp("id",this.get_clientID())},get_bindControl:function(){if(!this.bindControl&&(this.bindControl=this.findAncestorWithType(this.get_parent(),Craba.UI.Control),!this.bindControl))throw Error.invalidOperation("This tag must be enclosed inside a Control tag");return this.bindControl}},Craba.UI.ControlAction.registerClass("Craba.UI.ControlAction",Craba.UI.ScriptControl),Craba.UI.ReportAction=function(t){Craba.UI.ReportAction.initializeBase(this,[t]),this._productName=$settings.PrintProductName,this._reportMode=Sys.UI.Actions.ReportMode.defaultReport,this._printMode=_Z_29.localAndCloudStyle,this._printOutDevice=_Z_30._default,this._disabledPDF=$settings.PrintDefaultDisabledPDF,this._useService=$settings.AllPrintUseService,this._useWebTool=$settings.AllPrintUseWebTool,this.isNullId=!0,this._ajaxMode=!1,this._createReport=!0,this._directPrint=!1,this._showMasterFields=!0,this._allowPrint=!1,this._allowExport=!1,this._defaultUseNewDesignForm=!0,this._isLocalPrint=!1,this._usePrintPopup=!0,this._showExport=!0,this._createStyle=!1,this._copies=1,this._masterFields=[],this._detailFields=[]},Craba.UI.ReportAction.prototype={initialize:function(){Craba.UI.ReportAction.callBaseMethod(this,"initialize"),this._formUrl=this.Context.rootUrl+"_Sys/UI/Report/Report.gspx",this._setupUrl=this.Context.rootUrl+"_Sys/UI/Report/Setup.gspx"},typeName:function(){return this._useWebTool?"ReportPrintWeb":this._useService?"ReportPrintService":"ReportPrintClound"},initScript:function(){Craba.UI.ReportAction.callBaseMethod(this,"initScript"),this.addProp("useService",this._useService,$settings.AllPrintUseService),this.addProp("formUrl",this.get_page().convertUrl(this._formUrl)),this.addProp("setupUrl",this.get_page().convertUrl(this._setupUrl)),this.addProp("gridId",this._grid),this._initSession(),this._masterFields.length>0&&this.addProp("masterFields",this._masterFields),this._detailFields.length>0&&this.addProp("detailFields",this._detailFields),this.addProp("reportMode",this._reportMode,Sys.UI.Actions.ReportMode.defaultReport),this.addProp("printMode",this._printMode,_Z_29.localAndCloudStyle),this.addProp("printOutDevice",this._printOutDevice,_Z_30._default),this.addProp("reportName",this._reportName),this.addProp("reportNumber",this._reportNumber,0),this.addProp("productName",this._productName)},set_useService:function(t){this._useService=t},_initSession:function(){var t=this.Context.reportSession;if(t){var e=t.masterFields;for(var i in e){var a=this._toFiled(e,i);this._masterFields.push(a)}this.addProp("cookie",t.cookie)}},_toFiled:function(t,e){return{name:e,value:t[e],visible:!1,isFooter:!1,dataField:null,size:0,after:null}},set_reportMode:function(t){this._reportMode=this.get_enumTypeValue(Sys.UI.Actions.ReportMode,t)},set_printOutDevice:function(t){this._printOutDevice=this.get_numberEnumTypeValue(_Z_30,t)},set_printMode:function(t){this._printMode=this.get_enumTypeValue(_Z_29,t)},set_grid:function(t){this._grid=t},addMasters:function(t){this._addField(this._masterFields,t.xmlNode)},addDetails:function(t){this._addField(this._detailFields,t.xmlNode)},_addField:function(t,e){Array.forEach(e.Childs,function(e,i){if("Field"==e.Name){var a=e.Attributes,r=this._copyField(a);t.push(r)}},this)},_copyField:function(t){var e={name:null,size:0,value:null,hidden:!1,columnType:"",isFooter:!1,dataField:null,after:null};for(var i in t){var a=t[i],r=typeof a;a=$express.getValue(a,this.Context);var s=Craba.UI.Common.lowerFirstChar(i);"visible"==s?s="hidden":"type"==s&&(s="columnType"),"boolean"==typeof e[s]&&(a=Boolean.convert(a),"hidden"==s&&(a=!a)),"undefined"!==r&&(e[s]=a)}return e}},Craba.UI.ReportAction.registerClass("Craba.UI.ReportAction",Craba.UI.ControlAction),Craba.UI.BaseFields=function(t){Craba.UI.BaseFields.initializeBase(this,[t])},Craba.UI.BaseFields.prototype={getReport:function(){var t=this.get_parent();if(!t||!Craba.UI.ReportAction.isInstanceOfType(t))throw Error.invalidOperation("MasterFields或DetailFields标签必须在 ReportAction 标签中使用");return t}},Craba.UI.BaseFields.registerClass("Craba.UI.BaseFields",Craba.UI.Control),Craba.UI.MasterFields=function(t){Craba.UI.MasterFields.initializeBase(this,[t])},Craba.UI.MasterFields.prototype={doTag:function(t){this.getReport().addMasters(this)}},Craba.UI.MasterFields.registerClass("Craba.UI.MasterFields",Craba.UI.BaseFields),Craba.UI.DetailFields=function(t){Craba.UI.DetailFields.initializeBase(this,[t])},Craba.UI.DetailFields.prototype={doTag:function(t){this.getReport().addDetails(this)}},Craba.UI.DetailFields.registerClass("Craba.UI.DetailFields",Craba.UI.BaseFields),Craba.UI._Printer=function(t){Craba.UI._Printer.initializeBase(this,[t]),this._useWebTool=$settings.AllPrintUseWebTool,this.set_visible(!1)},Craba.UI._Printer.prototype={endRender:function(t){t.writeEnd()}},Craba.UI._Printer.registerClass("Craba.UI._Printer",Craba.UI.WebControl),Craba.UI.BarcodePrint=function(t){Craba.UI.BarcodePrint.initializeBase(this,[t]),this._copies=1},Craba.UI.BarcodePrint.prototype={typeName:function(){return"BarcodePrint"}},Craba.UI.BarcodePrint.registerClass("Craba.UI.BarcodePrint",Craba.UI._Printer),Craba.UI.PosPrint=function(t){Craba.UI.PosPrint.initializeBase(this,[t]),this._copies=1},Craba.UI.PosPrint.prototype={typeName:function(){return"PosPrint"}},Craba.UI.PosPrint.registerClass("Craba.UI.PosPrint",Craba.UI._Printer),Craba.UI.ExpressPrint=function(t){Craba.UI.ExpressPrint.initializeBase(this,[t])},Craba.UI.ExpressPrint.prototype={typeName:function(){return"ExpressPrint"}},Craba.UI.ExpressPrint.registerClass("Craba.UI.ExpressPrint",Craba.UI._Printer),Craba.UI.EScanAction=function(t){Craba.UI.EScanAction.initializeBase(this,[t])},Craba.UI.EScanAction.prototype={typeName:function(){return"EScanAction"}},Craba.UI.EScanAction.registerClass("Craba.UI.EScanAction",Craba.UI._Printer);﻿var $fc=function(){function e(e,t){var a;if(t!=undefined){switch(Object.getTypeName(t)){case"Object":a=JSON.stringify(t);break;case"Boolean":a=t.toString();break;default:a=t.toString()}}else a="";return a.length+"|"+e+"|"+a}function t(e,t){var a=new Sys.Net.PageRequestEx(!0);a._form=e;var i=a._parseReply(t,!1);if(i.error){var n=Sys.Net.WebServiceProxy.formatWebServiceFailedServerError(i.error);$common.alert(n)}else{var o=$createDelegate(e,e.serverResolvePageLoaded);a._doSuccess(o,i)}}function a(e){Sys.Application.add_init(function(){e.startsWith("/")||(e="/"+e);var a=Sys.Application.getForm($craba.getHashCode(e),!1);!function(e,t,a){var i=new Sys.Net.WebRequest;i.set_url(e),i.add_completed(function(i){var n=i.get_statusCode(),o=i.get_responseData();n>=200&&n<300?(o=$common.gspxParse(e,o),a(t,o)):$common.alert(o)}),i.invoke()}(e,a,t)})}return $app.initSettings({DisableRemoveSessionCache:!0,DecimalPrecision:16,DecimalScale:4,DecimalIntDigits:0,GridRowNoColumnCaption:"<div class='RowNoConfigIcon'></div>",GridPagerDefaultMaxPageSize:100,GridPagerDefaultPageSize:10,GridDefaultRowCount:0,GridDefaultAllowCopy:!0,GridDefaultAllowConfig:!0,GridDefaultAllowResize:!0,GridDefaultShowRowIndicator:!0,GridMultiSelectColumnDefaultShowHeaderCheckBox:!0,GridDefaultRowHeight:30,NumberEditDefaultShowCalculator:!0,GridUseColumnsDisplayOrder:!0,DefaultAllowClearIcon:!0,MaxMDIPageCount:50,ClientWidthContextName:"clientWidth",ClientHeightContextName:"clientHeight",DefaultGridSpace:2,GridPagerDropDownNumericButton:!0,TreeGridLazyPageSize:1e3,EnableGlobalUIConfig:!1}),{loadMainPage:function(t,i){if($fc.inited)return a(t);!function(){$settings.GspxResolveCache=!0,$settings.CacheGspx=!$app.isLocal(),$app.gspxCache={},$common.getGspxCache=function(e,t){var a=$common.removeUrlParams(e);if($settings.CacheGspx){var i=$app.gspxCache[a];if(i)return i}var n=$craba.gspxToJson(t),o=JSON.stringify(n);return $settings.CacheGspx&&($app.gspxCache[a]=o),o},$common.gspxParse=function(t,a,i){t=$common.removeUrlParam(t,$settings.StaticVersionName),i||(i="");var n=$common.getGspxCache(t,a);t.startsWith("/")||t.startsWith("http")||(t="/"+t);var o="/",r=t.indexOf(".gspx"),s=t.substring(0,r);return"undefined"==typeof $ms&&s.lastIndexOf("/")>1&&((o=s.substring(0,s.lastIndexOf("/")+1)).startsWith("/")||(o="/"+o)),function(){for(var e=arguments,t="",a=0;a<e.length;a++)t+=e[a]+"|";return t}(e("configDatas",{}),e("itemCountDatas",{}),e("gridColumnExpandDatas",{}),e("pageId",$craba.getHashCode(t+i)),e("internalID",$craba.getHashCode(s+".gspx")),e("rootUrl",""),e("webMethodBasePath",""),e("scriptIncludePage",""),e("scriptPath",t.startsWith("/")||t.startsWith("http")?t:"/"+t),e("convertUrl","/"),e("baseUrl",o),e("variables",{clientWidth:1410,clientHeight:671,productmentEnv:!1}),e("gspx",n))};var t=document.createElement("div");t.className="aicon-home",t.innerText="这是元素主要作用是预加载字体图标防止闪动",t.style.cssText="position:absolute;left:-1000px;top:-1000px;",document.body.appendChild(t)}(),$fc.inited=!0;var n=(i||"")+"/";if(window.__crabaResourceURI="/",window.__webResourceURI="/",window.__skinBaseURI=n+"skins/",window.__skinPath=n+"skins/blueSky/",window.__rootURI="/",window.__pathMapName="",$app.initialize(!0),!window.LoadConfigData)return a(t);$common.showWaiting(null,"正在读取配置信息..."),window.LoadConfigData(function(e){window.userConfigData=e,$common.hideWaiting(),a(t)})}}}();﻿var initMs=function(e){$settings.UseBigNumber=!0,$ms=function(){var r=function(e){e&&!e.endsWith("/")&&(e+="/"),this._url=e,this._requestInterceptor=null,this._responseInterceptor=null,this._enableShowWaiting=!0,this._isCallBackOnDisposed=$settings.IsCallbackOnDispose,this._reponseGlobalErrorInterceptor=null,$common._waitCounter===undefined&&($common._waitCounter=0)};r.prototype={getUrl:function(){return this._url?this._url:""},setUrl:function(e){this._url=e},setToken:function(e){localStorage.setItem("Authorization",e)},getToken:function(){return localStorage.getItem("Authorization")},setResponseInterceptor:function(e){this._responseInterceptor=e},set_isCallBackOnDisposed:function(e){this._isCallBackOnDisposed=e},getResponseInterceptor:function(e,t,r){return this._responseInterceptor},setReponseGlobalErrorInterceptor:function(e){this._reponseGlobalErrorInterceptor=e},getReponseGlobalErrorInterceptor:function(){return this._reponseGlobalErrorInterceptor},set_owner:function(e){this._owner=e},get_enableShowWaiting:function(){return this._enableShowWaiting},set_enableShowWaiting:function(e){this._enableShowWaiting=e},showWaiting:function(e,t){this._enableShowWaiting=!0,this._waitingText=t,this.set_owner(e),$common._waitCounter++},_showWaiting:function(){var e=this._owner;if(!($common._waitCounter<=0)&&this._waitingText){var t=null;if(e==window)t=window;else if(void 0!==e){if(Sys.UI.CustomForm.isInstanceOfType(e)&&e.get_isDisposed())return}$common.showWaiting(t,this._waitingText)}},hideWaiting:function(e){e&&clearTimeout(e),this.get_enableShowWaiting()&&$common._waitCounter>0&&($common._waitCounter--,$common._waitCounter<1&&$common.hideWaiting(!0)),this._setOwnerEnabled(!0)},_setOwnerEnabled:function(e){var t=this._owner;t&&t.set_enabled&&t.get_isDisposed&&!t.get_isDisposed()&&(t.set_enabled(e),e&&(this._owner=null))},_startWaitingTimer:function(){if(this._enableShowWaiting&&!$common.isWaiting()){var e=this;return setTimeout(function(){e._showWaiting()},$settings.WaitingTimerValue)}return null},_bindCustomHeader:function(e,t){if(e&&t&&"Object"!=typeof e)for(var r=Object.keys(e),n=0;n<r.length;n++){var o=r[n];t[o]=e[o]}},ajax:function(e){return this._convert(e),$common.ajax(e)},ajaxSync:function(e){return this._convert(e),$common.ajaxSync(e)},_convert:function(e){var t=e.url;$common.checkAlert(!t,"get_servcie().ajax必须传url参数"),e.router="ngp",e.waiting=e.waiting||this._waitingText,e.owner=e.owner||this._owner,e.form=e.form||this.action?this.action.get_form(!0):this._owner?this._owner.get_form(!0):null,e.dispose=e.dispose||this._isCallBackOnDisposed},get:function(e,t,r,n){if("function"==typeof t)r=t;else{e.indexOf("?")<0&&(e+="?");var i="";for(var s in t)i+="&"+s+"="+t[s];e+=i.length>0?i.substr(1):""}if($settings.DisabledFetch){var a={url:e,type:"GET",headers:t?t.headers:null,async:!0,success:r,error:n};return this.ajax(a)}var l=null;e.indexOf("://")<0&&(l=o.getRealUrlAndServerName(e),e=o.getServerNameUrl(l.url,l.serverName,!0)),this._setOwnerEnabled(!1);var p=this._startWaitingTimer(),u=this,c=this.apiHeaders();t&&"function"!=typeof t&&this._bindCustomHeader(t.headers,c);var f=200,h=fetch(e,{method:"GET",mode:"cors",headers:c,cache:"default"}).then(function(e){if(200==e.status)return e.headers.get("Content-Type").toLowerCase().startsWith("application/json")?e.text():(u._download(e,r),!0);if(f=e.status,n)n(e.statusText);else{if(e.headers.get("Content-Type").toLowerCase().startsWith("application/json"))return e.text();$common.alert(e.statusText)}}).then(function(t){if(u.hideWaiting(p),!0===t)return!0;if(u.checkDispose()&&!$app._doRequestComplated({statusCode:f,responseText:t,type:"fetch",form:null,url:e})){(t=u.replaceBigData(t))&&(t=JSON.parse(t));var o=t;if(l){var i=u.getResponseInterceptor(l.serverName,e,t);i&&(o=i(t))}return n&&"object"==typeof o&&"200"!=o.code?n(o):r&&r(o),o}})["catch"](function(e){u.handleError(e)});return r?null:h},post:function(e,t,r,n){if(t&&"function"==typeof t&&(r=t,t={}),$settings.DisabledFetch){var i={url:e,data:t,type:"POST",headers:t?t.headers:null,async:!0,success:r,error:n};return this.ajax(i)}var s=null;e.indexOf("://")<0&&(s=o.getRealUrlAndServerName(e),e=o.getServerNameUrl(s.url,s.serverName,!0)),this._setOwnerEnabled(!1);var a=this,l=this._startWaitingTimer(),p=this.apiHeaders();t&&this._bindCustomHeader(t.headers,p);var u=200,c=fetch(e,{method:"POST",mode:"cors",cache:"default",headers:p,body:JSON.stringify(t)}).then(function(e){if(200==e.status)return e.headers.get("Content-Type").toLowerCase().startsWith("application/json")?e.text():(a._download(e,r),!0);if(u=e.status,n)n(e.statusText);else{if(e.headers.get("Content-Type").toLowerCase().startsWith("application/json"))return e.text();$common.alert(e.statusText)}}).then(function(t){if(a.hideWaiting(l),!0===t)return!0;if(a.checkDispose()&&!$app._doRequestComplated({statusCode:u,responseText:t,type:"fetch",form:null,url:e})){(t=a.replaceBigData(t))&&(t=JSON.parse(t));var o=t;if(s){var i=a.getResponseInterceptor(s.serverName,e,t);i&&(o=i(t))}return n&&"object"==typeof o&&"200"!=o.code?n(o):r&&r(o),o}})["catch"](function(e){a.handleError(e)});return r?null:c},_download:function(e,t){e.blob().then(function(r){var n=e.headers.get("Content-Disposition");$common.downloadBlob(r,n),t&&t(!0)})},checkDispose:function(){return!!this._isCallBackOnDisposed||(!this.action||!this.action.get_isDisposed())},handleError:function(e){this.action&&!this.action.get_isInitialized()&&this.action.end?this.action.end(e):(e.showMessage=!0,handleError(e))},replaceBigData:function(e){if(e){for(var t=e.match(/^[+-]?[\d]+([\.][\d]+)?([Ee][+-]?[\d]+)?$/),r={},n=0;t&&n<t.length;n++){var o=t[n];r[o]||parseFloat(o).toString()!=o&&(r[o]='"'+o+'"')}for(var n in r)e=e.replace(new RegExp(n,"gm"),r[n])}return e},customHeaders:function(){return{"content-type":"application/json"}},bindHeaders:function(e){e||(e={});for(var t=Object.keys(e),r=0;r<t.length;r++){if("content-type"==t[r].toLowerCase())return e}return e["Content-Type"]="application/json",e},apiHeaders:function(){return this.bindHeaders(this.customHeaders())}};var n=(new Date).getMilliseconds(),o={append:function(e,r){if(e&&r){if("function"!=typeof e)throw Error.invalidOperation("error： 被附加对象cl，请传入函数对象"+e);for(var n in e.prototype){if("function"==typeof t&&r[n]){var o="error： 不能追加已有的属性 "+n;throw Error.invalidOperation(o)}r[n]=e.prototype[n]}e.prototype=r}},getServerName:function(e){return e},getServerNameUrl:function(e,t,r){if(t?t=t:"string"==typeof params&&(t=params),t){var i=document.createElement("a");i.href=e;var s=i.pathname.replace(/^([^/])/,"/$1").toLocaleLowerCase();if(s=s.substr(s.lastIndexOf(".")+1),["gspx","js","css"].indexOf(s)>=0){var a="try{if($"+t+" && $"+t+".version){ return $"+t+'.version;};return "e_'+n+'";}catch(e){return "e_'+n+'";}',l=new Function(a)(),p=$settings.StaticVersionName+"="+l;e.indexOf(p)<0&&(e=e.indexOf("?")>=0?e+"&"+p:e+"?"+p)}}return e=t?(t=o.getServerName(t,r))+e:"~/"+(t=t?t+"/":"")+e},injectBusinessControl:function(e,t){},getAPIServiceUrl:function(e){return e},getRealUrlAndServerName:function(e,t){o.interceptServerName&&(e=o.interceptServerName(e));(e=e.replace(/item/g,"/")).startsWith("/")&&(e=e.substring(1));var r=e.indexOf("/");if(r<0)throw new Error("请配置服务模块地址   "+e);var n=e.substring(0,r),i={url:e=e.substring(r),serverName:n};return $fc.inited?(o.loadServerInit(i.serverName),i):i},loadServerInit:function(e,t,r,n){if(o.initMap||(o.initMap={}),!o.initMap[e]){o.initMap[e]=!0;var i=$ms.router["ngp-skinName"]||"blueSky";return $skin.loadCss(o.getServerNameUrl("/skins/"+i+"/skin.css",e),e,function(){var i=o.getServerNameUrl("/js/init.js",e);$common.loadScript(i,function(){t&&t(r,n)},null,!0)},function(t){console.log(e+"模块对应的皮肤加载失败,"+t)},!0),!1}return!0},getBusinessInfo:function(e,t){var r=e,n={};if(e.startsWith("{")){if(e=e.replace(new RegExp("'","gm"),'"'),!(n=JSON.parse(e)).Name)throw new Error("采用json格式传递业务控件，请设置业务控件的Name");r=n.Name}var i=r.indexOf("."),s="";return i>=0&&(s=r.substr(0,i)),s?o.loadServerInit(s,t,r,n)&&t&&t(r,n):t&&t(r,n),{business:r,serverName:s,businessData:n}}};(function(){Sys.UI.PageAction.prototype.get_service=function(){var e=o.getServerName(Object.getTypeName(this));o.getAPIServiceUrl&&(e=o.getAPIServiceUrl(e)),e&&!e.endsWith("/")&&(e+="/");var t=new r(e);return t.action=this,t};var e=Craba.UI.Page.prototype.set_actionType;Craba.UI.Page.prototype.set_actionType=function(t){if(t){var r=t.split(","),n=[];n.push(r[0]);var i=this.Context.scriptPath;i||(i="");var s="";(i=i.toLowerCase()).startsWith("http")||(s=o.getRealUrlAndServerName(i));for(var a=1;a<r.length;a++){var l=r[a].trim(),p=o.getRealUrlAndServerName(l);s&&s.serverName!=p.serverName?l.startsWith("/")?n.push(o.getServerNameUrl(l,p.serverName)):n.push(o.getServerNameUrl("/"+l,p.serverName)):n.push(o.getServerNameUrl(p.url,p.serverName))}t=n.join(",")}e.apply(this,[t])};var t=Sys.UI.Form.prototype.showModal;Sys.UI.Form.prototype.showModal=function(e,r){if(e){var n=o.getRealUrlAndServerName(e);t.apply(this,[o.getServerNameUrl(n.url,n.serverName),r])}else t.apply(this)};var n=_Z_60.prototype.showModalDialog;_Z_60.prototype.showModalDialog=function(e,t,r,i){if(e){var s=o.getRealUrlAndServerName(e);n.apply(this,[o.getServerNameUrl(s.url,s.serverName),t,r,i])}};var i=_Z_60.prototype.showDialog;_Z_60.prototype.showDialog=function(e,t,r,n,s){if(e){var a=o.getRealUrlAndServerName(e);i.apply(this,[o.getServerNameUrl(a.url,a.serverName),t,r,n,s])}};var s=_Z_60.prototype.showPage;_Z_60.prototype.showPage=function(e,t,r,n,i){if(t){var a=o.getRealUrlAndServerName(t);return s.apply(this,[e,o.getServerNameUrl(a.url,a.serverName),r,n,i])}};var a=_Z_60.prototype.ajax;_Z_60.prototype.ajax=function(e){if("ngp"!=e.router)return a.apply(this,arguments);var t=e.url;if(t.indexOf("://")<0){var r=o.getRealUrlAndServerName(t);e.url=o.getServerNameUrl(r.url,r.serverName,!0),$settings.DisabledFetch&&(e.responseInterceptor=function(e){var t=e,n=$common.getMSAPI().getResponseInterceptor(r.serverName,r.url,e);return n&&(t=n(e)),t})}return a.apply(this,[e])},_Z_60.prototype.getMSAPI=function(){return this._msAPI?this._msAPI:this._msAPI=new r},_Z_60.prototype.getSysUIBaseURI=function(e){return $getRootURI()+this.getSysUIPath(e)};var l=_Z_95.prototype.doShowStartPage;_Z_95.prototype.doShowStartPage=function(){if(this._showPage){var e=o.getRealUrlAndServerName(this._showPage);this._showPage=o.getServerNameUrl(e.url,e.serverName)}l.apply(this)},_Z_242.prototype.set_business=function(e){e&&(this._business=e.trim())},_Z_242.prototype.get_business=function(){return this._business};var p=Sys.Net.PageRequestEx.prototype._initHeader;Sys.Net.PageRequestEx.prototype._initHeader=function(e){p.apply(this,[e]);var t=(new r).apiHeaders();if(t)for(var n=Object.keys(t),o=0;o<n.length;o++){var i=n[o];e.get_headers()[i]=t[i]}};var u=_Z_242.prototype.endUpdate;_Z_242.prototype.endUpdate=function(){u.apply(this);var e=this.findForm();if(o.injectBusinessControl&&e&&this.get_business()&&e.get_action()){var t=this;o.getBusinessInfo(this.get_business(),function(r,n){o.injectBusinessControl.apply(t,[r,e.get_action(),n])})}},Craba.UI.Image.prototype.set_serverName=function(e){this.serverName=e},Sys.UI.Controls.Image.set_serverName=function(e){this.serverName=e},Sys.UI.Controls.Image.get_serverName=function(){return this.serverName};var c=Sys.UI.Controls.FileUpload.prototype.set_webMethodPath;Sys.UI.Controls.FileUpload.prototype.set_webMethodPath=function(e){var t=o.getRealUrlAndServerName(e);e=o.getServerNameUrl(t.url,t.serverName,!0),c.apply(this,[e])};var f=Sys.UI.Controls.Column.prototype._initEditorControl;Sys.UI.Controls.Column.prototype._initEditorControl=function(e){f.apply(this,[e]);var t=this.findForm(),r=this.get_control(),n=this.get_business();t&&r&&n&&!r[n]&&t.get_action()&&o.getBusinessInfo(this.get_business(),function(e,n){o.injectBusinessControl.apply(r,[e,t.get_action(),n])})},Craba.Web.Script.PagerDataService.prototype._getData=function(e,t,r,n,o,i){return{refresh:null!=t,pageSize:i,pageIndex:o/i+1,sorts:r,filter:n,queryParams:t}};var h=Craba.Web.Script.PagerDataService.prototype._todoData;Craba.Web.Script.PagerDataService.prototype._todoData=function(e,t){h.apply(this,[e,t]),e&&("object"!=typeof e.queryParams&&(e.queryParams={}),delete e.queryParams.gridFilter,e.filter&&e.filter.items&&(e.queryParams.gridFilter=e.filter.items),delete e.filter)};Craba.Web.Script.PrintDataService.prototype._jsonSerialize;Craba.Web.Script.PrintDataService.prototype._jsonSerialize=function(e){return JSON.stringify(e)};var g=Sys.Net.WebRequest.prototype.get_headers;Sys.Net.WebRequest.prototype.get_headers=function(){if(this._setedHeaders)return g.apply(this,[]);var e=(new r).apiHeaders();return e&&this._headers&&(Object.copyTo(e,this._headers),this._setedHeaders=!0),g.apply(this,[])};var m=Sys.Net.WebRequest._resolveUrl;Sys.Net.WebRequest._resolveUrl=function(e,t){if(e.indexOf("://")>=0)return e;var r=o.getRealUrlAndServerName(e);e=o.getServerNameUrl(r.url,r.serverName);var n=m.apply(this,[e,t]);if(e.indexOf("://")>=0)return n;if((n=n.substr(0,n.indexOf(e))).indexOf("/")>=0){var i=n.indexOf("://"),s=n.substr(0,i);(i=(n=n.substr(i+3)).indexOf("/"))>=0&&(n=n.substr(0,i)),n=s+"://"+n}return n+(n.endsWith("/")?"":"/")+(e.startsWith("/")?e.substr(1):e)};var v=_Z_104.prototype.appendCookie;_Z_104.prototype.appendCookie=function(e){var t=(new r).apiHeaders();e.headers=t,e.headers&&(e.headers.reporting=!0),v.apply(this,[e])};var d=_Z_104.prototype.set_dataUrl;_Z_104.prototype.set_dataUrl=function(e){if(e){var t=o.getRealUrlAndServerName(e);e.toLocaleLowerCase().trim().startsWith("http")||(e=o.getServerNameUrl(t.url,t.serverName,!0)).toLocaleLowerCase().trim().startsWith("http")||(e.startsWith("/")||(e="/"+e),e=location.protocol+"//"+location.host+e)}d.apply(this,[e])};var y=_Z_104.prototype._buildDetailParams;_Z_104.prototype._buildDetailParams=function(e,t,r,n,o){var i=y.apply(this,arguments),s=i.queryParams;return n||((s=t.get_queryParams())||(s={}),o.fullDataMode=!0,i.queryParams=s),t._lastFilter&&t._lastFilter.items&&(s.gridFilter=t._lastFilter.items),i.pageIndex=0,i.pageSize=0,i.reporting=!0,i.sorts=t.getLastSort(),i};Craba.Web.Script.PrintDataService.prototype._JsonSerialize;Craba.Web.Script.PrintDataService.prototype._JsonSerialize=function(e){return"string"==typeof e?e:JSON.stringify(e)},Craba.UI.ScriptControl.prototype.customResolveProp=function(e,t){if(("enabled"==e||"visible"==e||"rightIconVisible"==e)&&t.indexOf&&t.indexOf(".")>=0&&!t.trim().startsWith("$")){if(t.indexOf(".")<0)throw new Error("请指定"+e+'="'+t+'"的模块名称【key='+e+"】");t=!!o.getPower&&o.getPower(t)}return t};var _=Craba.UI.Page.prototype.getCrabaResourceUrl;Craba.UI.Page.prototype.getCrabaResourceUrl=function(e){return this.page&&this.page.actionType?e=o.getServerName(this.page.actionType)+"/"+e:_.apply(this,[e])};var S=Craba.UI.Page.prototype.convertUrl;Craba.UI.Page.prototype.convertUrl=function(e,t){if(e=S.apply(this,[e]),!t)return e;if(!e||e.indexOf("/")<0)return e;var r=o.getRealUrlAndServerName(e);return e=o.getServerNameUrl(r.url,r.serverName,!0)};var b=Sys.UI.CustomForm.prototype.saveData;Sys.UI.CustomForm.prototype.saveData=function(e){var t=b.apply(this,[e]),r=this._controls;if(!r)return t;for(var n=0;n<r.length;n++){var o=r[n];if(o.get_business&&o.get_business()&&o[o.get_business()]&&(l=o[o.get_business()])&&l.bindData&&l.bindData(t),"Sys.UI.Controls.Grid"==Object.getTypeName(o))for(var i=o.get_columns(),s=0;s<i.length;s++){var a=i[s];if(a.get_business&&a.get_business()&&a[a.get_business()]){var l=a[a.get_business()];l&&l.bindData&&l.bindData(t)}}}return t},$settings.DisableRemoveSessionCache=!0}).call(o);var i={get_service:function(){return $common.getMSAPI()},get_url:function(e){var t=o.getRealUrlAndServerName(e);return e=o.getServerNameUrl(t.url,t.serverName)}},s=e(i);return s&&("function"==typeof s.apiHeaders&&(!0,r.prototype.customHeaders=s.apiHeaders),"function"==typeof s.responseInterceptor&&(r.prototype.getResponseInterceptor=s.responseInterceptor),"function"==typeof s.globalErrorInterceptor&&(r.prototype.getReponseGlobalErrorInterceptor=s.globalErrorInterceptor),"function"==typeof s.serverName&&(o.getServerName=s.serverName),"function"==typeof s.interceptServerName&&(o.interceptServerName=s.interceptServerName),"function"==typeof s.injectBusinessControl&&(o.injectBusinessControl=s.injectBusinessControl),"function"==typeof s.getAPIServiceUrl&&(o.getAPIServiceUrl=s.getAPIServiceUrl),"function"==typeof s.getSaveGridConfigUrl&&(o.getSaveGridConfigUrl=s.getSaveGridConfigUrl),"function"==typeof s.getPower&&(o.getPower=s.getPower)),i}()};
var crabaVersion = "1.1.1176";var crabaDate = "2021-03-24 10:26:02";console.log(crabaVersion);